@STATIC;1.0;p;15;_CPCornerView.jt;1343;@STATIC;1.0;i;8;CPView.jt;1312;


objj_executeFile("CPView.j", true);

{var the_class = objj_allocateClassPair(CPView, "_CPCornerView"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCornerView").super_class }, "initWithFrame:", aFrame))
    {
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithPatternImage:", CPAppKitImage("tableview-headerview.png", CGSizeMake(1.0, 23.0))));
    }

    return self;
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");

    CGContextSetStrokeColor(context, objj_msgSend(CPColor, "colorWithHexString:", "dce0e2"));

    var points = [
                    CGPointMake(aRect.origin.x, aRect.origin.y),
                    CGPointMake(aRect.origin.x + aRect.size.width, aRect.origin.y),

                    CGPointMake(aRect.origin.x, aRect.origin.y + 0.5),
                    CGPointMake(aRect.origin.x, aRect.origin.y + aRect.size.height)
                 ];

    CGContextStrokeLineSegments(context, points, 2);
}
})]);
}

p;18;_CPDisplayServer.jt;2092;@STATIC;1.0;t;2073;;
var displayObjects = [],
    displayObjectsByUID = { },
    layoutObjects = [],
    layoutObjectsByUID = { },
    runLoop = objj_msgSend(CPRunLoop, "mainRunLoop");
_CPDisplayServerAddDisplayObject= function(anObject)
{
    var UID = objj_msgSend(anObject, "UID");
    if (typeof displayObjectsByUID[UID] !== "undefined")
        return;
    var index = displayObjects.length;
    displayObjectsByUID[UID] = index;
    displayObjects[index] = anObject;
}
_CPDisplayServerAddLayoutObject= function(anObject)
{
    var UID = objj_msgSend(anObject, "UID");
    if (typeof layoutObjectsByUID[UID] !== "undefined")
        return;
    var index = layoutObjects.length;
    layoutObjectsByUID[UID] = index;
    layoutObjects[index] = anObject;
}
{var the_class = objj_allocateClassPair(CPObject, "_CPDisplayServer"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("run"), function(self, _cmd)
{ with(self)
{
    while (layoutObjects.length || displayObjects.length)
    {
        var index = 0;
        for (; index < layoutObjects.length; ++index)
        {
            var object = layoutObjects[index];
            delete layoutObjectsByUID[objj_msgSend(object, "UID")];
            objj_msgSend(object, "layoutIfNeeded");
        }
        layoutObjects = [];
        layoutObjectsByUID = { };
        index = 0;
        for (; index < displayObjects.length; ++index)
        {
            if (layoutObjects.length)
                break;
            var object = displayObjects[index];
            delete displayObjectsByUID[objj_msgSend(object, "UID")];
            objj_msgSend(object, "displayIfNeeded");
        }
        if (index === displayObjects.length)
        {
            displayObjects = [];
            displayObjectsByUID = { };
        }
        else
            displayObjects.splice(0, index);
    }
    objj_msgSend(runLoop, "performSelector:target:argument:order:modes:", sel_getUid("run"), self, nil, 0, [CPDefaultRunLoopMode]);
}
})]);
}
objj_msgSend(_CPDisplayServer, "run");

p;21;_CPImageAndTextView.jt;22076;@STATIC;1.0;I;21;Foundation/CPString.ji;9;CPColor.ji;8;CPFont.ji;9;CPImage.ji;8;CPView.ji;11;CPControl.jt;21964;objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPColor.j", true);
objj_executeFile("CPFont.j", true);
objj_executeFile("CPImage.j", true);
objj_executeFile("CPView.j", true);
objj_executeFile("CPControl.j", true);
var _CPimageAndTextViewFrameSizeChangedFlag = 1 << 0,
    _CPImageAndTextViewImageChangedFlag = 1 << 1,
    _CPImageAndTextViewTextChangedFlag = 1 << 2,
    _CPImageAndTextViewAlignmentChangedFlag = 1 << 3,
    _CPImageAndTextViewVerticalAlignmentChangedFlag = 1 << 4,
    _CPImageAndTextViewLineBreakModeChangedFlag = 1 << 5,
    _CPImageAndTextViewTextColorChangedFlag = 1 << 6,
    _CPImageAndTextViewFontChangedFlag = 1 << 7,
    _CPImageAndTextViewTextShadowColorChangedFlag = 1 << 8,
    _CPImageAndTextViewImagePositionChangedFlag = 1 << 9,
    _CPImageAndTextViewImageScalingChangedFlag = 1 << 10;
var HORIZONTAL_MARGIN = 3.0,
    VERTICAL_MARGIN = 5.0;
{var the_class = objj_allocateClassPair(CPView, "_CPImageAndTextView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_alignment"), new objj_ivar("_verticalAlignment"), new objj_ivar("_lineBreakMode"), new objj_ivar("_textColor"), new objj_ivar("_font"), new objj_ivar("_textShadowColor"), new objj_ivar("_textShadowOffset"), new objj_ivar("_imagePosition"), new objj_ivar("_imageScaling"), new objj_ivar("_image"), new objj_ivar("_text"), new objj_ivar("_textSize"), new objj_ivar("_flags"), new objj_ivar("_DOMImageElement"), new objj_ivar("_DOMTextElement"), new objj_ivar("_DOMTextShadowElement")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:control:"), function(self, _cmd, aFrame, aControl)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPImageAndTextView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _textShadowOffset = { width:0.0, height:0.0 };
        objj_msgSend(self, "setVerticalAlignment:", CPTopVerticalTextAlignment);
        if (aControl)
        {
            objj_msgSend(self, "setLineBreakMode:", objj_msgSend(aControl, "lineBreakMode"));
            objj_msgSend(self, "setTextColor:", objj_msgSend(aControl, "textColor"));
            objj_msgSend(self, "setAlignment:", objj_msgSend(aControl, "alignment"));
            objj_msgSend(self, "setVerticalAlignment:", objj_msgSend(aControl, "verticalAlignment"));
            objj_msgSend(self, "setFont:", objj_msgSend(aControl, "font"));
            objj_msgSend(self, "setImagePosition:", objj_msgSend(aControl, "imagePosition"));
            objj_msgSend(self, "setImageScaling:", objj_msgSend(aControl, "imageScaling"));
        }
        else
        {
            objj_msgSend(self, "setLineBreakMode:", CPLineBreakByClipping);
            objj_msgSend(self, "setAlignment:", CPCenterTextAlignment);
            objj_msgSend(self, "setFont:", objj_msgSend(CPFont, "systemFontOfSize:", 12.0));
            objj_msgSend(self, "setImagePosition:", CPNoImage);
            objj_msgSend(self, "setImageScaling:", CPScaleNone);
        }
        _textSize = NULL;
    }
    return self;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    return objj_msgSend(self, "initWithFrame:control:", aFrame, nil);
}
}), new objj_method(sel_getUid("setAlignment:"), function(self, _cmd, anAlignment)
{ with(self)
{
    if (_alignment === anAlignment)
        return;
    _alignment = anAlignment;
    switch (_alignment)
    {
        case CPLeftTextAlignment: _DOMElement.style.textAlign = "left";
                                        break;
        case CPRightTextAlignment: _DOMElement.style.textAlign = "right";
                                        break;
        case CPCenterTextAlignment: _DOMElement.style.textAlign = "center";
                                        break;
        case CPJustifiedTextAlignment: _DOMElement.style.textAlign = "justify";
                                        break;
        case CPNaturalTextAlignment: _DOMElement.style.textAlign = "";
                                        break;
    }
}
}), new objj_method(sel_getUid("alignment"), function(self, _cmd)
{ with(self)
{
    return _alignment;
}
}), new objj_method(sel_getUid("setVerticalAlignment:"), function(self, _cmd, anAlignment)
{ with(self)
{
    if (_verticalAlignment === anAlignment)
        return;
    _verticalAlignment = anAlignment;
    _flags |= _CPImageAndTextViewVerticalAlignmentChangedFlag;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("verticalAlignment"), function(self, _cmd)
{ with(self)
{
    return _verticalAlignment;
}
}), new objj_method(sel_getUid("setLineBreakMode:"), function(self, _cmd, aLineBreakMode)
{ with(self)
{
    if (_lineBreakMode === aLineBreakMode)
        return;
    _lineBreakMode = aLineBreakMode;
    _flags |= _CPImageAndTextViewLineBreakModeChangedFlag;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("lineBreakMode"), function(self, _cmd)
{ with(self)
{
    return _lineBreakMode;
}
}), new objj_method(sel_getUid("setImagePosition:"), function(self, _cmd, anImagePosition)
{ with(self)
{
    if (_imagePosition == anImagePosition)
        return;
    _imagePosition = anImagePosition;
    _flags |= _CPImageAndTextViewImagePositionChangedFlag;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("imagePosition"), function(self, _cmd)
{ with(self)
{
    return _imagePosition;
}
}), new objj_method(sel_getUid("setImageScaling:"), function(self, _cmd, anImageScaling)
{ with(self)
{
    if (_imageScaling == anImageScaling)
        return;
    _imageScaling = anImageScaling;
    _flags |= _CPImageAndTextViewImageScalingChangedFlag;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("imageScaling"), function(self, _cmd)
{ with(self)
{
    return _imageScaling;
}
}), new objj_method(sel_getUid("setTextColor:"), function(self, _cmd, aTextColor)
{ with(self)
{
    if (_textColor === aTextColor)
        return;
    _textColor = aTextColor;
    _DOMElement.style.color = objj_msgSend(_textColor, "cssString");
}
}), new objj_method(sel_getUid("textColor"), function(self, _cmd)
{ with(self)
{
    return _textColor;
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    if (_font === aFont)
        return;
    _font = aFont;
    _flags |= _CPImageAndTextViewFontChangedFlag;
    _textSize = NULL;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
    return _font;
}
}), new objj_method(sel_getUid("setTextShadowColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_textShadowColor === aColor)
        return;
    _textShadowColor = aColor;
    _flags |= _CPImageAndTextViewTextShadowColorChangedFlag;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("textShadowColor"), function(self, _cmd)
{ with(self)
{
    return _textShadowColor;
}
}), new objj_method(sel_getUid("setTextShadowOffset:"), function(self, _cmd, anOffset)
{ with(self)
{
    if ((_textShadowOffset.width == anOffset.width && _textShadowOffset.height == anOffset.height))
        return;
    _textShadowOffset = { width:anOffset.width, height:anOffset.height };
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("textShadowOffset"), function(self, _cmd)
{ with(self)
{
    return _textShadowOffset;
}
}), new objj_method(sel_getUid("setImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_image == anImage)
        return;
    if (objj_msgSend(_image, "delegate") === self)
        objj_msgSend(_image, "setDelegate:", nil);
    _image = anImage;
    _flags |= _CPImageAndTextViewImageChangedFlag;
    if (objj_msgSend(_image, "loadStatus") !== CPImageLoadStatusCompleted)
        objj_msgSend(_image, "setDelegate:", self);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("imageDidLoad:"), function(self, _cmd, anImage)
{ with(self)
{
    if (anImage === _image)
    {
        _flags |= _CPImageAndTextViewImageChangedFlag;
        objj_msgSend(self, "setNeedsLayout");
    }
}
}), new objj_method(sel_getUid("image"), function(self, _cmd)
{ with(self)
{
    return _image;
}
}), new objj_method(sel_getUid("setText:"), function(self, _cmd, text)
{ with(self)
{
    if (_text === text)
        return;
    _text = text;
    _flags |= _CPImageAndTextViewTextChangedFlag;
    _textSize = NULL;
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("text"), function(self, _cmd)
{ with(self)
{
    return _text;
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var needsDOMTextElement = _imagePosition !== CPImageOnly && (objj_msgSend(_text, "length") > 0),
        hasDOMTextElement = !!_DOMTextElement;
    if (needsDOMTextElement !== hasDOMTextElement)
        if (hasDOMTextElement)
        {
            _DOMElement.removeChild(_DOMTextElement);
            _DOMTextElement = NULL;
            hasDOMTextElement = NO;
        }
        else
        {
            _DOMTextElement = document.createElement("div");
            var textStyle = _DOMTextElement.style;
            textStyle.position = "absolute";
            textStyle.whiteSpace = "pre";
            textStyle.zIndex = 200;
            textStyle.overflow = "hidden";
            _DOMElement.appendChild(_DOMTextElement);
            hasDOMTextElement = YES;
            _flags |= _CPImageAndTextViewTextChangedFlag | _CPImageAndTextViewFontChangedFlag | _CPImageAndTextViewLineBreakModeChangedFlag;
        }
    var textStyle = hasDOMTextElement ? _DOMTextElement.style : nil;
    var needsDOMTextShadowElement = hasDOMTextElement && !!_textShadowColor,
        hasDOMTextShadowElement = !!_DOMTextShadowElement;
    if (needsDOMTextShadowElement !== hasDOMTextShadowElement)
        if (hasDOMTextShadowElement)
        {
            _DOMElement.removeChild(_DOMTextShadowElement);
            _DOMTextShadowElement = NULL;
            hasDOMTextShadowElement = NO;
        }
        else
        {
            _DOMTextShadowElement = document.createElement("div");
            var shadowStyle = _DOMTextShadowElement.style;
            shadowStyle.font = objj_msgSend(_font ? _font : objj_msgSend(CPFont, "systemFontOfSize:", 12.0), "cssString");
            shadowStyle.position = "absolute";
            shadowStyle.whiteSpace = textStyle.whiteSpace;
            shadowStyle.color = objj_msgSend(_textShadowColor, "cssString");
            shadowStyle.zIndex = 150;
            shadowStyle.textOverflow = textStyle.textOverflow;
            if (document.attachEvent)
            {
                shadowStyle.overflow = textStyle.overflow;
                shadowStyle.wordWrap = textStyle.wordWrap;
            }
            else
            {
                shadowStyle.overflowX = textStyle.overflowX;
                shadowStyle.overflowY = textStyle.overflowY;
            }
            _DOMElement.appendChild(_DOMTextShadowElement);
            hasDOMTextShadowElement = YES;
            _flags |= _CPImageAndTextViewTextChangedFlag;
        }
    var shadowStyle = hasDOMTextShadowElement ? _DOMTextShadowElement.style : nil;
    if (hasDOMTextElement)
    {
        if (_flags & _CPImageAndTextViewTextChangedFlag)
            if (CPFeatureIsCompatible(CPJavascriptInnerTextFeature))
            {
                _DOMTextElement.innerText = _text;
                if (_DOMTextShadowElement)
                    _DOMTextShadowElement.innerText = _text;
            }
            else if (CPFeatureIsCompatible(CPJavascriptTextContentFeature))
            {
                _DOMTextElement.textContent = _text;
                if (_DOMTextShadowElement)
                    _DOMTextShadowElement.textContent = _text;
            }
        if (_flags & _CPImageAndTextViewFontChangedFlag)
        {
            var fontStyle = objj_msgSend(_font ? _font : objj_msgSend(CPFont, "systemFontOfSize:", 12.0), "cssString");
            textStyle.font = fontStyle;
            if (shadowStyle)
                shadowStyle.font = fontStyle;
        }
        if (_flags & _CPImageAndTextViewLineBreakModeChangedFlag)
        {
            switch (_lineBreakMode)
            {
                case CPLineBreakByClipping: textStyle.overflow = "hidden";
                                                    textStyle.textOverflow = "clip";
                                                    textStyle.whiteSpace = "pre";
                                                    if (document.attachEvent)
                                                        textStyle.wordWrap = "normal";
                                                    break;
                case CPLineBreakByTruncatingHead:
                case CPLineBreakByTruncatingMiddle:
                case CPLineBreakByTruncatingTail: textStyle.textOverflow = "ellipsis";
                                                    textStyle.whiteSpace = "nowrap";
                                                    textStyle.overflow = "hidden";
                                                    if (document.attachEvent)
                                                        textStyle.wordWrap = "normal";
                                                    break;
                case CPLineBreakByCharWrapping:
                case CPLineBreakByWordWrapping: if (document.attachEvent)
                                                    {
                                                        textStyle.whiteSpace = "pre";
                                                        textStyle.wordWrap = "break-word";
                                                    }
                                                    else
                                                    {
                                                        textStyle.whiteSpace = "-o-pre-wrap";
                                                        textStyle.whiteSpace = "-pre-wrap";
                                                        textStyle.whiteSpace = "-moz-pre-wrap";
                                                        textStyle.whiteSpace = "pre-wrap";
                                                    }
                                                    textStyle.overflow = "hidden";
                                                    textStyle.textOverflow = "clip";
                                                    break;
            }
            if (shadowStyle)
            {
                if (document.attachEvent)
                {
                    shadowStyle.wordWrap = textStyle.wordWrap;
                    shadowStyle.overflow = textStyle.overflow;
                }
                else
                {
                    shadowStyle.overflowX = textStyle.overflowX;
                    shadowStyle.overflowY = textStyle.overflowY;
                }
                shadowStyle.whiteSpace = textStyle.whiteSpace;
                shadowStyle.textOverflow = textStyle.textOverflow;
            }
        }
    }
    var needsDOMImageElement = _image !== nil && _imagePosition !== CPNoImage,
        hasDOMImageElement = !!_DOMImageElement;
    if (needsDOMImageElement !== hasDOMImageElement)
        if (hasDOMImageElement)
        {
            _DOMElement.removeChild(_DOMImageElement);
            _DOMImageElement = NULL;
            hasDOMImageElement = NO;
        }
        else
        {
            _DOMImageElement = document.createElement("img");
            if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
            {
                _DOMImageElement.setAttribute("draggable", "true");
                _DOMImageElement.style["-khtml-user-drag"] = "element";
            }
            var imageStyle = _DOMImageElement.style;
            imageStyle.top = "0px";
            imageStyle.left = "0px";
            imageStyle.position = "absolute";
            imageStyle.zIndex = 100;
            _DOMElement.appendChild(_DOMImageElement);
            hasDOMImageElement = YES;
        }
    var size = objj_msgSend(self, "bounds").size,
        textRect = { origin: { x:0.0, y:0.0 }, size: { width:size.width, height:size.height } };
    if (hasDOMImageElement)
    {
        if (!imageStyle)
            var imageStyle = _DOMImageElement.style;
        if (_flags & _CPImageAndTextViewImageChangedFlag)
            _DOMImageElement.src = objj_msgSend(_image, "filename");
        var centerX = size.width / 2.0,
            centerY = size.height / 2.0,
            imageSize = objj_msgSend(_image, "size"),
            imageWidth = imageSize.width,
            imageHeight = imageSize.height;
        if (_imageScaling === CPScaleToFit)
        {
            imageWidth = size.width;
            imageHeight = size.height;
        }
        else if (_imageScaling === CPScaleProportionally)
        {
            var scale = MIN(MIN(size.width, imageWidth) / imageWidth, MIN(size.height, imageHeight) / imageHeight);
            imageWidth *= scale;
            imageHeight *= scale;
        }
        _DOMImageElement.width = imageWidth;
        _DOMImageElement.height = imageHeight;
        imageStyle.width = imageWidth + "px";
        imageStyle.height = imageHeight + "px";
        if (_imagePosition === CPImageBelow)
        {
            imageStyle.left = FLOOR(centerX - imageWidth / 2.0) + "px";
            imageStyle.top = FLOOR(size.height - imageHeight) + "px";
            textRect.size.height = size.height - imageHeight - VERTICAL_MARGIN;
        }
        else if (_imagePosition === CPImageAbove)
        {
            if (NULL) var ____p = _CGPointApplyAffineTransform(CGPointMake(FLOOR(centerX - imageWidth / 2.0), 0), NULL); else var ____p = { x:FLOOR(centerX - imageWidth / 2.0), y:0 }; _DOMImageElement.style.left = ROUND(____p.x) + "px";_DOMImageElement.style.top = ROUND(____p.y) + "px";;
            textRect.origin.y += imageHeight + VERTICAL_MARGIN;
            textRect.size.height = size.height - imageHeight - VERTICAL_MARGIN;
        }
        else if (_imagePosition === CPImageLeft)
        {
            imageStyle.top = FLOOR(centerY - imageHeight / 2.0) + "px";
            imageStyle.left = "0px";
            textRect.origin.x = imageWidth + HORIZONTAL_MARGIN;
            textRect.size.width -= imageWidth + HORIZONTAL_MARGIN;
        }
        else if (_imagePosition === CPImageRight)
        {
            imageStyle.top = FLOOR(centerY - imageHeight / 2.0) + "px";
            imageStyle.left = FLOOR(size.width - imageWidth) + "px";
            textRect.size.width -= imageWidth + HORIZONTAL_MARGIN;
        }
        else if (_imagePosition === CPImageOnly)
        {
            imageStyle.top = FLOOR(centerY - imageHeight / 2.0) + "px";
            imageStyle.left = FLOOR(centerX - imageWidth / 2.0) + "px";
        }
    }
    if (hasDOMTextElement)
    {
        var textRectX = (textRect.origin.x),
            textRectY = (textRect.origin.y),
            textRectWidth = (textRect.size.width),
            textRectHeight = (textRect.size.height);
        if (_verticalAlignment !== CPTopVerticalTextAlignment)
        {
            if (!_textSize)
            {
                if (_lineBreakMode === CPLineBreakByCharWrapping ||
                    _lineBreakMode === CPLineBreakByWordWrapping)
                    _textSize = objj_msgSend(_text, "sizeWithFont:inWidth:", _font, textRectWidth);
                else
                    _textSize = objj_msgSend(_text, "sizeWithFont:", _font);
            }
            if (_verticalAlignment === CPCenterVerticalTextAlignment)
            {
                textRectY = textRectY + (textRectHeight - _textSize.height) / 2.0;
                textRectHeight = _textSize.height;
            }
            else
            {
                textRectY = textRectY + textRectHeight - _textSize.height;
                textRectHeight = _textSize.height;
            }
        }
        textStyle.top = ROUND(textRectY) + "px";
        textStyle.left = ROUND(textRectX) + "px";
        textStyle.width = ROUND(textRectWidth) + "px";
        textStyle.height = ROUND(textRectHeight) + "px";
        if (shadowStyle)
        {
            if (_flags & _CPImageAndTextViewTextShadowColorChangedFlag)
                shadowStyle.color = objj_msgSend(_textShadowColor, "cssString");
            shadowStyle.top = ROUND(textRectY + _textShadowOffset.height) + "px";
            shadowStyle.left = ROUND(textRectX + _textShadowOffset.width) + "px";
            shadowStyle.width = ROUND(textRectWidth) + "px";
            shadowStyle.height = ROUND(textRectHeight) + "px";
        }
    }
    _flags = 0;
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    var size = CGSizeMakeZero();
    if ((_imagePosition !== CPNoImage) && _image)
    {
        var imageSize = objj_msgSend(_image, "size");
        size.width += imageSize.width;
        size.height += imageSize.height;
    }
    if ((_imagePosition !== CPImageOnly) && objj_msgSend(_text, "length") > 0)
    {
        if (!_textSize)
            _textSize = objj_msgSend(_text, "sizeWithFont:", _font ? _font : objj_msgSend(CPFont, "systemFontOfSize:", 12.0));
        if (_imagePosition === CPImageLeft || _imagePosition === CPImageRight)
        {
            size.width += _textSize.width + HORIZONTAL_MARGIN;
            size.height = MAX(size.height, _textSize.height);
        }
        else if (_imagePosition === CPImageAbove || _imagePosition === CPImageBelow)
        {
            size.width = MAX(size.width, _textSize.width);
            size.height += _textSize.height + VERTICAL_MARGIN;
        }
        else
        {
            size.width = MAX(size.width, _textSize.width);
            size.height = MAX(size.height, _textSize.height);
        }
    }
    objj_msgSend(self, "setFrameSize:", size);
}
})]);
}

p;29;_CPToolbarFlexibleSpaceItem.jt;979;@STATIC;1.0;i;15;CPToolbarItem.jt;941;objj_executeFile("CPToolbarItem.j", true);
{var the_class = objj_allocateClassPair(CPToolbarItem, "_CPToolbarFlexibleSpaceItem"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithItemIdentifier:"), function(self, _cmd, anIgnoredIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarFlexibleSpaceItem").super_class }, "initWithItemIdentifier:", CPToolbarFlexibleSpaceItemIdentifier);
    if (self)
    {
        objj_msgSend(self, "setMinSize:", CGSizeMake(32.0, 32.0));
        objj_msgSend(self, "setMaxSize:", CGSizeMake(10000.0, 32.0));
    }
    return self;
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    return objj_msgSend(self, "init");
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
}
})]);
}

p;25;_CPToolbarSeparatorItem.jt;965;@STATIC;1.0;i;15;CPToolbarItem.jt;927;objj_executeFile("CPToolbarItem.j", true);
{var the_class = objj_allocateClassPair(CPToolbarItem, "_CPToolbarSeparatorItem"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithItemIdentifier:"), function(self, _cmd, anIgnoredIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarSeparatorItem").super_class }, "initWithItemIdentifier:", CPToolbarSeparatorItemIdentifier);
    if (self)
    {
        objj_msgSend(self, "setMinSize:", CGSizeMake(2.0, 0.0));
        objj_msgSend(self, "setMaxSize:", CGSizeMake(2.0, 100000.0));
    }
    return self;
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    return objj_msgSend(self, "init");
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
}
})]);
}

p;26;_CPToolbarShowColorsItem.jt;1503;@STATIC;1.0;i;15;CPToolbarItem.jt;1464;objj_executeFile("CPToolbarItem.j", true);
{var the_class = objj_allocateClassPair(CPToolbarItem, "_CPToolbarShowColorsItem"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithItemIdentifier:"), function(self, _cmd, anIgnoredIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarShowColorsItem").super_class }, "initWithItemIdentifier:", CPToolbarShowColorsItemIdentifier);
    if (self)
    {
        objj_msgSend(self, "setMinSize:", CGSizeMake(32.0, 32.0));
        objj_msgSend(self, "setMaxSize:", CGSizeMake(32.0, 32.0));
        objj_msgSend(self, "setLabel:", "Colors");
        objj_msgSend(self, "setPaletteLabel:", "Show Colors");
        objj_msgSend(self, "setTarget:", CPApp);
        objj_msgSend(self, "setAction:", sel_getUid("orderFrontColorPanel:"));
        objj_msgSend(self, "setImage:", objj_msgSend(CPImage, "imageNamed:", CPImageNameColorPanel));
        objj_msgSend(self, "setAlternateImage:", objj_msgSend(CPImage, "imageNamed:", CPImageNameColorPanelHighlighted));
        objj_msgSend(self, "setToolTip:", "Show the Colors panel.");
    }
    return self;
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    return objj_msgSend(self, "init");
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
}
})]);
}

p;21;_CPToolbarSpaceItem.jt;952;@STATIC;1.0;i;15;CPToolbarItem.jt;914;objj_executeFile("CPToolbarItem.j", true);
{var the_class = objj_allocateClassPair(CPToolbarItem, "_CPToolbarSpaceItem"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithItemIdentifier:"), function(self, _cmd, anIgnoredIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarSpaceItem").super_class }, "initWithItemIdentifier:", CPToolbarSpaceItemIdentifier);
    if (self)
    {
        objj_msgSend(self, "setMinSize:", CGSizeMake(32.0, 32.0));
        objj_msgSend(self, "setMaxSize:", CGSizeMake(32.0, 32.0));
    }
    return self;
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    return objj_msgSend(self, "init");
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
}
})]);
}

p;8;AppKit.jt;3692;@STATIC;1.0;i;9;CALayer.ji;9;CPAlert.ji;13;CPAnimation.ji;15;CPApplication.ji;14;CPBezierPath.ji;7;CPBox.ji;10;CPButton.ji;13;CPButtonBar.ji;12;CPCheckBox.ji;7;CPCib.ji;16;CPCibConnector.ji;23;CPCibControlConnector.ji;14;CPCibLoading.ji;22;CPCibOutletConnector.ji;12;CPClipView.ji;22;CPCollectionViewItem.ji;18;CPCollectionView.ji;9;CPColor.ji;14;CPColorPanel.ji;13;CPColorWell.ji;17;CPCompatibility.ji;11;CPControl.ji;10;CPCookie.ji;10;CPCursor.ji;12;CPDocument.ji;22;CPDocumentController.ji;9;CPEvent.ji;14;CPFlashMovie.ji;13;CPFlashView.ji;8;CPFont.ji;15;CPFontManager.ji;12;CPGeometry.ji;9;CPImage.ji;13;CPImageView.ji;8;CPMenu.ji;12;CPMenuItem.ji;13;CPOpenPanel.ji;9;CPPanel.ji;14;CPPasteboard.ji;15;CPPopUpButton.ji;21;CPProgressIndicator.ji;9;CPRadio.ji;13;CPResponder.ji;15;CPSearchField.ji;14;CPScrollView.ji;12;CPScroller.ji;19;CPSecureTextField.ji;20;CPSegmentedControl.ji;10;CPShadow.ji;10;CPSlider.ji;13;CPSplitView.ji;11;CPTabView.ji;15;CPTableColumn.ji;13;CPTableView.ji;13;CPTextField.ji;11;CPToolbar.ji;15;CPToolbarItem.ji;8;CPView.ji;18;CPViewController.ji;11;CPWebView.ji;10;CPWindow.ji;20;CPWindowController.jt;2556;objj_executeFile("CALayer.j", true);
objj_executeFile("CPAlert.j", true);
objj_executeFile("CPAnimation.j", true);
objj_executeFile("CPApplication.j", true);
objj_executeFile("CPBezierPath.j", true);
objj_executeFile("CPBox.j", true);
objj_executeFile("CPButton.j", true);
objj_executeFile("CPButtonBar.j", true);
objj_executeFile("CPCheckBox.j", true);
objj_executeFile("CPCib.j", true);
objj_executeFile("CPCibConnector.j", true);
objj_executeFile("CPCibControlConnector.j", true);
objj_executeFile("CPCibLoading.j", true);
objj_executeFile("CPCibOutletConnector.j", true);
objj_executeFile("CPClipView.j", true);
objj_executeFile("CPCollectionViewItem.j", true);
objj_executeFile("CPCollectionView.j", true);
objj_executeFile("CPColor.j", true);
objj_executeFile("CPColorPanel.j", true);
objj_executeFile("CPColorWell.j", true);
objj_executeFile("CPCompatibility.j", true);
objj_executeFile("CPControl.j", true);
objj_executeFile("CPCookie.j", true);
objj_executeFile("CPCursor.j", true);
objj_executeFile("CPDocument.j", true);
objj_executeFile("CPDocumentController.j", true);
objj_executeFile("CPEvent.j", true);
objj_executeFile("CPFlashMovie.j", true);
objj_executeFile("CPFlashView.j", true);
objj_executeFile("CPFont.j", true);
objj_executeFile("CPFontManager.j", true);
objj_executeFile("CPGeometry.j", true);
objj_executeFile("CPImage.j", true);
objj_executeFile("CPImageView.j", true);
objj_executeFile("CPMenu.j", true);
objj_executeFile("CPMenuItem.j", true);
objj_executeFile("CPOpenPanel.j", true);
objj_executeFile("CPPanel.j", true);
objj_executeFile("CPPasteboard.j", true);
objj_executeFile("CPPopUpButton.j", true);
objj_executeFile("CPProgressIndicator.j", true);
objj_executeFile("CPRadio.j", true);
objj_executeFile("CPResponder.j", true);
objj_executeFile("CPSearchField.j", true);
objj_executeFile("CPScrollView.j", true);
objj_executeFile("CPScroller.j", true);
objj_executeFile("CPSecureTextField.j", true);
objj_executeFile("CPSegmentedControl.j", true);
objj_executeFile("CPShadow.j", true);
objj_executeFile("CPSlider.j", true);
objj_executeFile("CPSplitView.j", true);
objj_executeFile("CPTabView.j", true);
objj_executeFile("CPTableColumn.j", true);
objj_executeFile("CPTableView.j", true);
objj_executeFile("CPTextField.j", true);
objj_executeFile("CPToolbar.j", true);
objj_executeFile("CPToolbarItem.j", true);
objj_executeFile("CPView.j", true);
objj_executeFile("CPViewController.j", true);
objj_executeFile("CPWebView.j", true);
objj_executeFile("CPWindow.j", true);
objj_executeFile("CPWindowController.j", true);

p;17;CPAccordionView.jt;13170;@STATIC;1.0;I;20;Foundation/CPArray.jI;21;Foundation/CPObject.jI;32;Foundation/CPKeyValueObserving.jI;23;Foundation/CPIndexSet.jI;21;Foundation/CPString.jI;15;AppKit/CPView.jt;12988;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPKeyValueObserving.j", false);
objj_executeFile("Foundation/CPIndexSet.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("AppKit/CPView.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPAccordionViewItem"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_identifier"), new objj_ivar("_view"), new objj_ivar("_label")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("identifier"), function(self, _cmd)
{ with(self)
{
return _identifier;
}
}),
new objj_method(sel_getUid("setIdentifier:"), function(self, _cmd, newValue)
{ with(self)
{
_identifier = newValue;
}
}),
new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
return _view;
}
}),
new objj_method(sel_getUid("setView:"), function(self, _cmd, newValue)
{ with(self)
{
_view = newValue;
}
}),
new objj_method(sel_getUid("label"), function(self, _cmd)
{ with(self)
{
return _label;
}
}),
new objj_method(sel_getUid("setLabel:"), function(self, _cmd, newValue)
{ with(self)
{
_label = newValue;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithIdentifier:", "");
}
}), new objj_method(sel_getUid("initWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPAccordionViewItem").super_class }, "init");
    if (self)
        objj_msgSend(self, "setIdentifier:", anIdentifier);
    return self;
}
})]);
}
{var the_class = objj_allocateClassPair(CPView, "CPAccordionView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_dirtyItemIndex"), new objj_ivar("_itemHeaderPrototype"), new objj_ivar("_items"), new objj_ivar("_itemViews"), new objj_ivar("_expandedItemIndexes")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPAccordionView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _items = [];
        _itemViews = [];
        _expandedItemIndexes = objj_msgSend(CPIndexSet, "indexSet");
        objj_msgSend(self, "setItemHeaderPrototype:", objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:100.0, height:24.0 } }));
    }
    return self;
}
}), new objj_method(sel_getUid("setItemHeaderPrototype:"), function(self, _cmd, aView)
{ with(self)
{
    _itemHeaderPrototype = aView;
}
}), new objj_method(sel_getUid("itemHeaderPrototype"), function(self, _cmd)
{ with(self)
{
    return _itemHeaderPrototype;
}
}), new objj_method(sel_getUid("items"), function(self, _cmd)
{ with(self)
{
    return _items;
}
}), new objj_method(sel_getUid("addItem:"), function(self, _cmd, anItem)
{ with(self)
{
    objj_msgSend(self, "insertItem:atIndex:", anItem, _items.length);
}
}), new objj_method(sel_getUid("insertItem:atIndex:"), function(self, _cmd, anItem, anIndex)
{ with(self)
{
    objj_msgSend(_expandedItemIndexes, "addIndex:", anIndex);
    var itemView = objj_msgSend(objj_msgSend(_CPAccordionItemView, "alloc"), "initWithAccordionView:", self);
    objj_msgSend(itemView, "setIndex:", anIndex);
    objj_msgSend(itemView, "setLabel:", objj_msgSend(anItem, "label"));
    objj_msgSend(itemView, "setContentView:", objj_msgSend(anItem, "view"));
    objj_msgSend(self, "addSubview:", itemView);
    objj_msgSend(_items, "insertObject:atIndex:", anItem, anIndex);
    objj_msgSend(_itemViews, "insertObject:atIndex:", itemView, anIndex);
    objj_msgSend(self, "_invalidateItemsStartingAtIndex:", anIndex);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("removeItem:"), function(self, _cmd, anItem)
{ with(self)
{
    objj_msgSend(self, "removeItemAtIndex:", objj_msgSend(_items, "indexOfObjectIdenticalTo:", anItem));
}
}), new objj_method(sel_getUid("removeItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    objj_msgSend(_expandedItemIndexes, "removeIndex:", anIndex);
    objj_msgSend(_itemViews[anIndex], "removeFromSuperview");
    objj_msgSend(_items, "removeObjectAtIndex:", anIndex);
    objj_msgSend(_itemViews, "removeObjectAtIndex:", anIndex);
    objj_msgSend(self, "_invalidateItemsStartingAtIndex:", anIndex);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("removeAllItems"), function(self, _cmd)
{ with(self)
{
    var count = _items.length;
    while (count--)
        objj_msgSend(self, "removeItemAtIndex:", count);
}
}), new objj_method(sel_getUid("expandItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    if (!objj_msgSend(_itemViews[anIndex], "isCollapsed"))
        return;
    objj_msgSend(_expandedItemIndexes, "addIndex:", anIndex);
    objj_msgSend(_itemViews[anIndex], "setCollapsed:", NO);
    objj_msgSend(self, "_invalidateItemsStartingAtIndex:", anIndex);
}
}), new objj_method(sel_getUid("collapseItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    if (objj_msgSend(_itemViews[anIndex], "isCollapsed"))
        return;
    objj_msgSend(_expandedItemIndexes, "removeIndex:", anIndex);
    objj_msgSend(_itemViews[anIndex], "setCollapsed:", YES);
    objj_msgSend(self, "_invalidateItemsStartingAtIndex:", anIndex);
}
}), new objj_method(sel_getUid("toggleItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    var itemView = _itemViews[anIndex];
    if (objj_msgSend(itemView, "isCollapsed"))
        objj_msgSend(self, "expandItemAtIndex:", anIndex);
    else
        objj_msgSend(self, "collapseItemAtIndex:", anIndex);
}
}), new objj_method(sel_getUid("expandedItemIndexes"), function(self, _cmd)
{ with(self)
{
    return _expandedItemIndexes;
}
}), new objj_method(sel_getUid("collapsedItemIndexes"), function(self, _cmd)
{ with(self)
{
    var indexSet = objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", CPMakeRange(0, _items.length));
    objj_msgSend(indexSet, "removeIndexes:", _expandedIndexes);
    return indexSet;
}
}), new objj_method(sel_getUid("setEnabled:forItemAtIndex:"), function(self, _cmd, isEnabled, anIndex)
{ with(self)
{
    var itemView = _itemViews[anIndex];
    if (!itemView)
        return;
    if (!isEnabled)
        objj_msgSend(self, "collapseItemAtIndex:", anIndex);
    else
        objj_msgSend(self, "expandItemAtIndex:", anIndex);
    objj_msgSend(itemView, "setEnabled:", isEnabled);
}
}), new objj_method(sel_getUid("_invalidateItemsStartingAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    if (_dirtyItemIndex === CPNotFound)
        _dirtyItemIndex = anIndex;
    _dirtyItemIndex = MIN(_dirtyItemIndex, anIndex);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var width = (objj_msgSend(self, "frame").size.width);
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPAccordionView").super_class }, "setFrameSize:", aSize);
    if (width !== (objj_msgSend(self, "frame").size.width))
        objj_msgSend(self, "_invalidateItemsStartingAtIndex:", 0);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    if (_items.length <= 0)
        return objj_msgSend(self, "setFrameSize:", { width:(objj_msgSend(self, "frame").size.width), height:0.0 });
    if (_dirtyItemIndex === CPNotFound)
        return;
    _dirtyItemIndex = MIN(_dirtyItemIndex, _items.length - 1);
    var index = _dirtyItemIndex,
        count = _itemViews.length,
        width = (objj_msgSend(self, "bounds").size.width),
        y = index > 0 ? CGRectGetMaxY(objj_msgSend(_itemViews[index - 1], "frame")) : 0.0;
    _dirtyItemIndex = CPNotFound;
    for (; index < count; ++index)
    {
        var itemView = _itemViews[index];
        objj_msgSend(itemView, "setFrameY:width:", y, width);
        y = CGRectGetMaxY(objj_msgSend(itemView, "frame"));
    }
    objj_msgSend(self, "setFrameSize:", { width:(objj_msgSend(self, "frame").size.width), height:y });
}
})]);
}
{var the_class = objj_allocateClassPair(CPView, "_CPAccordionItemView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_accordionView"), new objj_ivar("_isCollapsed"), new objj_ivar("_index"), new objj_ivar("_headerView"), new objj_ivar("_contentView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isCollapsed"), function(self, _cmd)
{ with(self)
{
return _isCollapsed;
}
}),
new objj_method(sel_getUid("setCollapsed:"), function(self, _cmd, newValue)
{ with(self)
{
_isCollapsed = newValue;
}
}),
new objj_method(sel_getUid("index"), function(self, _cmd)
{ with(self)
{
return _index;
}
}),
new objj_method(sel_getUid("setIndex:"), function(self, _cmd, newValue)
{ with(self)
{
_index = newValue;
}
}), new objj_method(sel_getUid("initWithAccordionView:"), function(self, _cmd, anAccordionView)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPAccordionItemView").super_class }, "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
    if (self)
    {
        _accordionView = anAccordionView;
        _isCollapsed = NO;
        var bounds = objj_msgSend(self, "bounds");
        _headerView = objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", objj_msgSend(_accordionView, "itemHeaderPrototype")));
        if (objj_msgSend(_headerView, "respondsToSelector:", sel_getUid("setTarget:")) && objj_msgSend(_headerView, "respondsToSelector:", sel_getUid("setAction:")))
        {
            objj_msgSend(_headerView, "setTarget:", self);
            objj_msgSend(_headerView, "setAction:", sel_getUid("toggle:"));
        }
        objj_msgSend(self, "addSubview:", _headerView);
    }
    return self;
}
}), new objj_method(sel_getUid("toggle:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(_accordionView, "toggleItemAtIndex:", objj_msgSend(self, "index"));
}
}), new objj_method(sel_getUid("setLabel:"), function(self, _cmd, aLabel)
{ with(self)
{
    if (objj_msgSend(_headerView, "respondsToSelector:", sel_getUid("setTitle:")))
        objj_msgSend(_headerView, "setTitle:", aLabel);
    else if (objj_msgSend(_headerView, "respondsToSelector:", sel_getUid("setLabel:")))
        objj_msgSend(_headerView, "setLabel:", aLabel);
    else if (objj_msgSend(_headerView, "respondsToSelector:", sel_getUid("setStringValue:")))
        objj_msgSend(_headerView, "setStringValue:", aLabel);
}
}), new objj_method(sel_getUid("setEnabled:"), function(self, _cmd, isEnabled)
{ with(self)
{
    if (objj_msgSend(_headerView, "respondsToSelector:", sel_getUid("setEnabled:")))
        objj_msgSend(_headerView, "setEnabled:", isEnabled);
}
}), new objj_method(sel_getUid("setContentView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_contentView === aView)
        return;
    objj_msgSend(_contentView, "removeObserver:forKeyPath:", self, "frame");
    objj_msgSend(_contentView, "removeFromSuperview");
    _contentView = aView;
    objj_msgSend(_contentView, "addObserver:forKeyPath:options:context:", self, "frame", CPKeyValueObservingOptionOld | CPKeyValueObservingOptionNew, NULL);
    objj_msgSend(self, "addSubview:", _contentView);
    objj_msgSend(_accordionView, "_invalidateItemsStartingAtIndex:", objj_msgSend(self, "index"));
}
}), new objj_method(sel_getUid("setFrameY:width:"), function(self, _cmd, aY, aWidth)
{ with(self)
{
    var headerHeight = (objj_msgSend(_headerView, "frame").size.height);
    objj_msgSend(_headerView, "setFrameSize:", { width:aWidth, height:headerHeight });
    objj_msgSend(_contentView, "setFrameOrigin:", { x:0.0, y:headerHeight });
    if (objj_msgSend(self, "isCollapsed"))
        objj_msgSend(self, "setFrame:", { origin: { x:0.0, y:aY }, size: { width:aWidth, height:headerHeight } });
    else
    {
        var contentHeight = (objj_msgSend(_contentView, "frame").size.height);
        objj_msgSend(_contentView, "setFrameSize:", { width:aWidth, height:contentHeight });
        objj_msgSend(self, "setFrame:", { origin: { x:0.0, y:aY }, size: { width:aWidth, height:contentHeight + headerHeight } });
    }
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
}
}), new objj_method(sel_getUid("observeValueForKeyPath:ofObject:change:context:"), function(self, _cmd, aKeyPath, anObject, aChange, aContext)
{ with(self)
{
    if (aKeyPath === "frame" && !CGRectEqualToRect(objj_msgSend(aChange, "objectForKey:", CPKeyValueChangeOldKey), objj_msgSend(aChange, "objectForKey:", CPKeyValueChangeNewKey)))
        objj_msgSend(_accordionView, "_invalidateItemsStartingAtIndex:", objj_msgSend(self, "index"));
}
})]);
}

p;9;CPAlert.jt;8232;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.jI;22;AppKit/CPApplication.jI;17;AppKit/CPButton.jI;16;AppKit/CPColor.jI;15;AppKit/CPFont.jI;16;AppKit/CPImage.jI;20;AppKit/CPImageView.jI;16;AppKit/CPPanel.jI;20;AppKit/CPTextField.jt;7979;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("AppKit/CPApplication.j", false);
objj_executeFile("AppKit/CPButton.j", false);
objj_executeFile("AppKit/CPColor.j", false);
objj_executeFile("AppKit/CPFont.j", false);
objj_executeFile("AppKit/CPImage.j", false);
objj_executeFile("AppKit/CPImageView.j", false);
objj_executeFile("AppKit/CPPanel.j", false);
objj_executeFile("AppKit/CPTextField.j", false);
CPWarningAlertStyle = 0;
CPInformationalAlertStyle = 1;
CPCriticalAlertStyle = 2;
var CPAlertWarningImage,
    CPAlertInformationImage,
    CPAlertErrorImage;
{var the_class = objj_allocateClassPair(CPObject, "CPAlert"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_alertPanel"), new objj_ivar("_messageLabel"), new objj_ivar("_alertImageView"), new objj_ivar("_alertStyle"), new objj_ivar("_windowTitle"), new objj_ivar("_windowStyle"), new objj_ivar("_buttonCount"), new objj_ivar("_buttons"), new objj_ivar("_delegate")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPAlert").super_class }, "init"))
    {
        _buttonCount = 0;
        _buttons = objj_msgSend(CPArray, "array");
        _alertStyle = CPWarningAlertStyle;
        objj_msgSend(self, "setWindowStyle:", nil);
    }
    return self;
}
}), new objj_method(sel_getUid("setWindowStyle:"), function(self, _cmd, styleMask)
{ with(self)
{
    _windowStyle = styleMask;
    _alertPanel = objj_msgSend(objj_msgSend(CPPanel, "alloc"), "initWithContentRect:styleMask:", CGRectMake(0.0, 0.0, 400.0, 110.0), styleMask ? styleMask | CPTitledWindowMask : CPTitledWindowMask);
    objj_msgSend(_alertPanel, "setFloatingPanel:", YES);
    objj_msgSend(_alertPanel, "center");
    objj_msgSend(_messageLabel, "setTextColor:", (styleMask & CPHUDBackgroundWindowMask) ? objj_msgSend(CPColor, "whiteColor") : objj_msgSend(CPColor, "blackColor"));
    var count = objj_msgSend(_buttons, "count");
    for(var i=0; i < count; i++)
    {
        var button = _buttons[i];
        objj_msgSend(button, "setFrameSize:", CGSizeMake(objj_msgSend(button, "frame").size.width, (styleMask == CPHUDBackgroundWindowMask) ? 20.0 : 24.0));
        objj_msgSend(button, "setTheme:", (_windowStyle === CPHUDBackgroundWindowMask) ? objj_msgSend(CPTheme, "themeNamed:", "Aristo-HUD") : objj_msgSend(CPTheme, "defaultTheme"));
        objj_msgSend(objj_msgSend(_alertPanel, "contentView"), "addSubview:", button);
    }
    if (!_messageLabel)
    {
        var bounds = objj_msgSend(objj_msgSend(_alertPanel, "contentView"), "bounds");
        _messageLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMake(57.0, 10.0, CGRectGetWidth(bounds) - 73.0, 62.0));
        objj_msgSend(_messageLabel, "setFont:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 13.0));
        objj_msgSend(_messageLabel, "setLineBreakMode:", CPLineBreakByWordWrapping);
        objj_msgSend(_messageLabel, "setAlignment:", CPJustifiedTextAlignment);
        objj_msgSend(_messageLabel, "setAutoresizingMask:", CPViewWidthSizable|CPViewHeightSizable);
        _alertImageView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CGRectMake(15.0, 12.0, 32.0, 32.0));
    }
    objj_msgSend(objj_msgSend(_alertPanel, "contentView"), "addSubview:", _messageLabel);
    objj_msgSend(objj_msgSend(_alertPanel, "contentView"), "addSubview:", _alertImageView);
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    _windowTitle = aTitle;
}
}), new objj_method(sel_getUid("title"), function(self, _cmd)
{ with(self)
{
    return _windowTitle;
}
}), new objj_method(sel_getUid("windowStyle"), function(self, _cmd)
{ with(self)
{
    return _windowStyle;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, delegate)
{ with(self)
{
    _delegate = delegate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("setAlertStyle:"), function(self, _cmd, style)
{ with(self)
{
    _alertStyle = style;
}
}), new objj_method(sel_getUid("alertStyle"), function(self, _cmd)
{ with(self)
{
    return _alertStyle;
}
}), new objj_method(sel_getUid("setMessageText:"), function(self, _cmd, messageText)
{ with(self)
{
    objj_msgSend(_messageLabel, "setStringValue:", messageText);
}
}), new objj_method(sel_getUid("messageText"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_messageLabel, "stringValue");
}
}), new objj_method(sel_getUid("addButtonWithTitle:"), function(self, _cmd, title)
{ with(self)
{
    var bounds = objj_msgSend(objj_msgSend(_alertPanel, "contentView"), "bounds"),
        button = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CGRectMake(CGRectGetWidth(bounds) - ((_buttonCount + 1) * 90.0), CGRectGetHeight(bounds) - 34.0, 80.0, (_windowStyle == CPHUDBackgroundWindowMask) ? 20.0 : 24.0));
    objj_msgSend(button, "setTitle:", title);
    objj_msgSend(button, "setTarget:", self);
    objj_msgSend(button, "setTag:", _buttonCount);
    objj_msgSend(button, "setAction:", sel_getUid("_notifyDelegate:"));
    objj_msgSend(button, "setTheme:", (_windowStyle === CPHUDBackgroundWindowMask) ? objj_msgSend(CPTheme, "themeNamed:", "Aristo-HUD") : objj_msgSend(CPTheme, "defaultTheme"));
    objj_msgSend(button, "setAutoresizingMask:", CPViewMinXMargin | CPViewMinYMargin);
    objj_msgSend(objj_msgSend(_alertPanel, "contentView"), "addSubview:", button);
    if (_buttonCount == 0)
        objj_msgSend(_alertPanel, "setDefaultButton:", button);
    _buttonCount++;
    objj_msgSend(_buttons, "addObject:", button);
}
}), new objj_method(sel_getUid("runModal"), function(self, _cmd)
{ with(self)
{
    var theTitle;
    switch (_alertStyle)
    {
        case CPWarningAlertStyle: objj_msgSend(_alertImageView, "setImage:", CPAlertWarningImage);
                                        theTitle = "Warning";
                                        break;
        case CPInformationalAlertStyle: objj_msgSend(_alertImageView, "setImage:", CPAlertInformationImage);
                                        theTitle = "Information";
                                        break;
        case CPCriticalAlertStyle: objj_msgSend(_alertImageView, "setImage:", CPAlertErrorImage);
                                        theTitle = "Error";
                                        break;
    }
    objj_msgSend(_alertPanel, "setTitle:", _windowTitle ? _windowTitle : theTitle);
    objj_msgSend(CPApp, "runModalForWindow:", _alertPanel);
}
}), new objj_method(sel_getUid("_notifyDelegate:"), function(self, _cmd, button)
{ with(self)
{
    objj_msgSend(CPApp, "abortModal");
    objj_msgSend(_alertPanel, "close");
    if (_delegate && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("alertDidEnd:returnCode:")))
        objj_msgSend(_delegate, "alertDidEnd:returnCode:", self, objj_msgSend(button, "tag"));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != CPAlert)
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(self, "class"));
    CPAlertWarningImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPAlert/dialog-warning.png"), CGSizeMake(32.0, 32.0));
    CPAlertInformationImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPAlert/dialog-information.png"), CGSizeMake(32.0, 32.0));
    CPAlertErrorImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPAlert/dialog-error.png"), CGSizeMake(32.0, 32.0));
}
})]);
}

p;13;CPAnimation.jt;6775;@STATIC;1.0;I;21;Foundation/CPObject.ji;23;CAMediaTimingFunction.jt;6702;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("CAMediaTimingFunction.j", true);
CPAnimationEaseInOut = 0;
CPAnimationEaseIn = 1;
CPAnimationEaseOut = 2;
CPAnimationLinear = 3;
ACTUAL_FRAME_RATE = 0;
{var the_class = objj_allocateClassPair(CPObject, "CPAnimation"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_lastTime"), new objj_ivar("_duration"), new objj_ivar("_animationCurve"), new objj_ivar("_timingFunction"), new objj_ivar("_frameRate"), new objj_ivar("_progress"), new objj_ivar("_delegate"), new objj_ivar("_timer")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithDuration:animationCurve:"), function(self, _cmd, aDuration, anAnimationCurve)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPAnimation").super_class }, "init");
    if (self)
    {
        _progress = 0.0;
        _duration = MAX(0.0, aDuration);
        _frameRate = 60.0;
        objj_msgSend(self, "setAnimationCurve:", anAnimationCurve);
    }
    return self;
}
}), new objj_method(sel_getUid("setAnimationCurve:"), function(self, _cmd, anAnimationCurve)
{ with(self)
{
    switch (anAnimationCurve)
    {
        case CPAnimationEaseInOut: timingFunctionName = kCAMediaTimingFunctionEaseInEaseOut;
                                    break;
        case CPAnimationEaseIn: timingFunctionName = kCAMediaTimingFunctionEaseIn;
                                    break;
        case CPAnimationEaseOut: timingFunctionName = kCAMediaTimingFunctionEaseOut;
                                    break;
        case CPAnimationLinear: timingFunctionName = kCAMediaTimingFunctionLinear;
                                    break;
        default: objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "Invalid value provided for animation curve");
                                    break;
    }
    _animationCurve = anAnimationCurve;
    _timingFunction = objj_msgSend(CAMediaTimingFunction, "functionWithName:", timingFunctionName);
}
}), new objj_method(sel_getUid("animationCurve"), function(self, _cmd)
{ with(self)
{
    return _animationCurve;
}
}), new objj_method(sel_getUid("setDuration:"), function(self, _cmd, aDuration)
{ with(self)
{
    if (aDuration < 0)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "aDuration can't be negative");
    _duration = aDuration;
}
}), new objj_method(sel_getUid("duration"), function(self, _cmd)
{ with(self)
{
    return _duration;
}
}), new objj_method(sel_getUid("setFrameRate:"), function(self, _cmd, frameRate)
{ with(self)
{
    if (frameRate < 0)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "frameRate can't be negative");
    _frameRate = frameRate;
}
}), new objj_method(sel_getUid("frameRate"), function(self, _cmd)
{ with(self)
{
    return _frameRate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
}
}), new objj_method(sel_getUid("startAnimation"), function(self, _cmd)
{ with(self)
{
    if (_timer || _delegate && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("animationShouldStart:")) && !objj_msgSend(_delegate, "animationShouldStart:", self))
        return;
    if (_progress === 1.0)
        _progress = 0.0;
    ACTUAL_FRAME_RATE = 0;
    _lastTime = new Date();
    _timer = objj_msgSend(CPTimer, "scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:", 0.0, self, sel_getUid("animationTimerDidFire:"), nil, YES);
}
}), new objj_method(sel_getUid("animationTimerDidFire:"), function(self, _cmd, aTimer)
{ with(self)
{
    var currentTime = new Date(),
        progress = MIN(1.0, objj_msgSend(self, "currentProgress") + (currentTime - _lastTime) / (_duration * 1000.0));
    _lastTime = currentTime;
    ++ACTUAL_FRAME_RATE;
    objj_msgSend(self, "setCurrentProgress:", progress);
    if (progress === 1.0)
    {
        objj_msgSend(_timer, "invalidate");
        _timer = nil;
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("animationDidEnd:")))
            objj_msgSend(_delegate, "animationDidEnd:", self);
    }
}
}), new objj_method(sel_getUid("stopAnimation"), function(self, _cmd)
{ with(self)
{
    if (!_timer)
        return;
    objj_msgSend(_timer, "invalidate");
    _timer = nil;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("animationDidStop:")))
        objj_msgSend(_delegate, "animationDidStop:", self);
}
}), new objj_method(sel_getUid("isAnimating"), function(self, _cmd)
{ with(self)
{
    return _timer;
}
}), new objj_method(sel_getUid("setCurrentProgress:"), function(self, _cmd, aProgress)
{ with(self)
{
    _progress = aProgress;
}
}), new objj_method(sel_getUid("currentProgress"), function(self, _cmd)
{ with(self)
{
    return _progress;
}
}), new objj_method(sel_getUid("currentValue"), function(self, _cmd)
{ with(self)
{
    var t = objj_msgSend(self, "currentProgress");
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("animation:valueForProgress:")))
        return objj_msgSend(_delegate, "animation:valueForProgress:", self, t);
    var c1 = [],
        c2 = [];
    objj_msgSend(_timingFunction, "getControlPointAtIndex:values:", 1, c1);
    objj_msgSend(_timingFunction, "getControlPointAtIndex:values:", 2, c2);
    return CubicBezierAtTime(t,c1[0],c1[1],c2[0],c2[1],_duration);
}
})]);
}
var CubicBezierAtTime = CubicBezierAtTime= function(t,p1x,p1y,p2x,p2y,duration)
{
    var ax=0,bx=0,cx=0,ay=0,by=0,cy=0;
    sampleCurveX= function(t) {return ((ax*t+bx)*t+cx)*t;};
    sampleCurveY= function(t) {return ((ay*t+by)*t+cy)*t;};
    sampleCurveDerivativeX= function(t) {return (3.0*ax*t+2.0*bx)*t+cx;};
    solveEpsilon= function(duration) {return 1.0/(200.0*duration);};
    solve= function(x,epsilon) {return sampleCurveY(solveCurveX(x,epsilon));};
    solveCurveX= function(x,epsilon) {var t0,t1,t2,x2,d2,i;
        fabs= function(n) {if(n>=0) {return n;}else {return 0-n;}};
        for(t2=x, i=0; i<8; i++) {x2=sampleCurveX(t2)-x; if(fabs(x2)<epsilon) {return t2;} d2=sampleCurveDerivativeX(t2); if(fabs(d2)<1e-6) {break;} t2=t2-x2/d2;}
        t0=0.0; t1=1.0; t2=x; if(t2<t0) {return t0;} if(t2>t1) {return t1;}
        while(t0<t1) {x2=sampleCurveX(t2); if(fabs(x2-x)<epsilon) {return t2;} if(x>x2) {t0=t2;}else {t1=t2;} t2=(t1-t0)*.5+t0;}
        return t2;
    };
    cx=3.0*p1x; bx=3.0*(p2x-p1x)-cx; ax=1.0-cx-bx; cy=3.0*p1y; by=3.0*(p2y-p1y)-cy; ay=1.0-cy-by;
    return solve(t, solveEpsilon(duration));
};

p;15;CPApplication.jt;32630;@STATIC;1.0;I;21;Foundation/CPBundle.ji;17;CPCompatibility.ji;9;CPEvent.ji;8;CPMenu.ji;13;CPResponder.ji;22;CPDocumentController.ji;14;CPThemeBlend.ji;14;CPCibLoading.ji;12;CPPlatform.jt;32437;objj_executeFile("Foundation/CPBundle.j", false);
objj_executeFile("CPCompatibility.j", true);
objj_executeFile("CPEvent.j", true);
objj_executeFile("CPMenu.j", true);
objj_executeFile("CPResponder.j", true);
objj_executeFile("CPDocumentController.j", true);
objj_executeFile("CPThemeBlend.j", true);
objj_executeFile("CPCibLoading.j", true);
objj_executeFile("CPPlatform.j", true);
var CPMainCibFile = "CPMainCibFile",
    CPMainCibFileHumanFriendly = "Main cib file base name";
CPApp = nil;
CPApplicationWillFinishLaunchingNotification = "CPApplicationWillFinishLaunchingNotification";
CPApplicationDidFinishLaunchingNotification = "CPApplicationDidFinishLaunchingNotification";
CPApplicationWillTerminateNotification = "CPApplicationWillTerminateNotification";
CPTerminateNow = YES;
CPTerminateCancel = NO;
CPTerminateLater = -1;
CPRunStoppedResponse = -1000;
CPRunAbortedResponse = -1001;
CPRunContinuesResponse = -1002;
{var the_class = objj_allocateClassPair(CPResponder, "CPApplication"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_eventListeners"), new objj_ivar("_currentEvent"), new objj_ivar("_windows"), new objj_ivar("_keyWindow"), new objj_ivar("_mainWindow"), new objj_ivar("_mainMenu"), new objj_ivar("_documentController"), new objj_ivar("_currentSession"), new objj_ivar("_delegate"), new objj_ivar("_finishedLaunching"), new objj_ivar("_namedArgs"), new objj_ivar("_args"), new objj_ivar("_fullArgsString"), new objj_ivar("_applicationIconImage"), new objj_ivar("_aboutPanel")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPApplication").super_class }, "init");
    if (self)
    {
        _eventListeners = [];
        _windows = [];
        objj_msgSend(_windows, "addObject:", nil);
        _mainMenu = objj_msgSend(objj_msgSend(CPMenu, "alloc"), "initWithTitle:", "MainMenu");
        objj_msgSend(_mainMenu, "setAutoenablesItems:", NO);
        var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPApplication, "class")),
            newMenuItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "New", sel_getUid("newDocument:"), "N");
        objj_msgSend(newMenuItem, "setImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPApplication/New.png"), CGSizeMake(16.0, 16.0)));
        objj_msgSend(newMenuItem, "setAlternateImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPApplication/NewHighlighted.png"), CGSizeMake(16.0, 16.0)));
        objj_msgSend(_mainMenu, "addItem:", newMenuItem);
        var openMenuItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Open", sel_getUid("openDocument:"), "O");
        objj_msgSend(openMenuItem, "setImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPApplication/Open.png"), CGSizeMake(16.0, 16.0)));
        objj_msgSend(openMenuItem, "setAlternateImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPApplication/OpenHighlighted.png"), CGSizeMake(16.0, 16.0)));
        objj_msgSend(_mainMenu, "addItem:", openMenuItem);
        var saveMenu = objj_msgSend(objj_msgSend(CPMenu, "alloc"), "initWithTitle:", "Save"),
            saveMenuItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Save", sel_getUid("saveDocument:"), nil);
        objj_msgSend(saveMenuItem, "setImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPApplication/Save.png"), CGSizeMake(16.0, 16.0)));
        objj_msgSend(saveMenuItem, "setAlternateImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPApplication/SaveHighlighted.png"), CGSizeMake(16.0, 16.0)));
        objj_msgSend(saveMenu, "addItem:", objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Save", sel_getUid("saveDocument:"), "S"));
        objj_msgSend(saveMenu, "addItem:", objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Save As", sel_getUid("saveDocumentAs:"), nil));
        objj_msgSend(saveMenuItem, "setSubmenu:", saveMenu);
        objj_msgSend(_mainMenu, "addItem:", saveMenuItem);
        var editMenuItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Edit", nil, nil),
            editMenu = objj_msgSend(objj_msgSend(CPMenu, "alloc"), "initWithTitle:", "Edit"),
            undoMenuItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Undo", sel_getUid("undo:"), CPUndoKeyEquivalent),
            redoMenuItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Redo", sel_getUid("redo:"), CPRedoKeyEquivalent);
        objj_msgSend(undoMenuItem, "setKeyEquivalentModifierMask:", CPUndoKeyEquivalentModifierMask);
        objj_msgSend(redoMenuItem, "setKeyEquivalentModifierMask:", CPRedoKeyEquivalentModifierMask);
        objj_msgSend(editMenu, "addItem:", undoMenuItem);
        objj_msgSend(editMenu, "addItem:", redoMenuItem);
        objj_msgSend(editMenu, "addItem:", objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Cut", sel_getUid("cut:"), "X")),
        objj_msgSend(editMenu, "addItem:", objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Copy", sel_getUid("copy:"), "C")),
        objj_msgSend(editMenu, "addItem:", objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Paste", sel_getUid("paste:"), "V"));
        objj_msgSend(editMenuItem, "setSubmenu:", editMenu);
        objj_msgSend(editMenuItem, "setHidden:", YES);
        objj_msgSend(_mainMenu, "addItem:", editMenuItem);
        objj_msgSend(_mainMenu, "addItem:", objj_msgSend(CPMenuItem, "separatorItem"));
    }
    return self;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    if (_delegate == aDelegate)
        return;
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_delegate)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPApplicationWillFinishLaunchingNotification, self);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPApplicationDidFinishLaunchingNotification, self);
    }
    _delegate = aDelegate;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("applicationWillFinishLaunching:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("applicationWillFinishLaunching:"), CPApplicationWillFinishLaunchingNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("applicationDidFinishLaunching:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("applicationDidFinishLaunching:"), CPApplicationDidFinishLaunchingNotification, self);
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("finishLaunching"), function(self, _cmd)
{ with(self)
{
    window.status = " ";
    objj_msgSend(objj_msgSend(CPCursor, "arrowCursor"), "set");
    var bundle = objj_msgSend(CPBundle, "mainBundle"),
        types = objj_msgSend(bundle, "objectForInfoDictionaryKey:", "CPBundleDocumentTypes");
    if (objj_msgSend(types, "count") > 0)
        _documentController = objj_msgSend(CPDocumentController, "sharedDocumentController");
    var delegateClassName = objj_msgSend(bundle, "objectForInfoDictionaryKey:", "CPApplicationDelegateClass");
    if (delegateClassName)
    {
        var delegateClass = objj_getClass(delegateClassName);
        if (delegateClass)
            if (objj_msgSend(_documentController, "class") == delegateClass)
                objj_msgSend(self, "setDelegate:", _documentController);
            else
                objj_msgSend(self, "setDelegate:", objj_msgSend(objj_msgSend(delegateClass, "alloc"), "init"));
    }
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    objj_msgSend(defaultCenter, "postNotificationName:object:", CPApplicationWillFinishLaunchingNotification, self);
    var needsUntitled = !!_documentController,
        URLStrings = window.cpOpeningURLStrings && window.cpOpeningURLStrings(),
        index = 0,
        count = objj_msgSend(URLStrings, "count");
    for (; index < count; ++index)
        needsUntitled = !objj_msgSend(self, "_openURL:", objj_msgSend(CPURL, "URLWithString:", URLStrings[index])) || needsUntitled;
    if (needsUntitled && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("applicationShouldOpenUntitledFile:")))
        needsUntitled = objj_msgSend(_delegate, "applicationShouldOpenUntitledFile:", self);
    if (needsUntitled)
        objj_msgSend(_documentController, "newDocument:", self);
    objj_msgSend(_documentController, "_updateRecentDocumentsMenu");
    objj_msgSend(defaultCenter, "postNotificationName:object:", CPApplicationDidFinishLaunchingNotification, self);
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
    _finishedLaunching = YES;
}
}), new objj_method(sel_getUid("terminate:"), function(self, _cmd, aSender)
{ with(self)
{
    if (!objj_msgSend(CPPlatform, "isBrowser"))
    {
        objj_msgSend(objj_msgSend(CPDocumentController, "sharedDocumentController"), "closeAllDocumentsWithDelegate:didCloseAllSelector:contextInfo:", self, sel_getUid("_documentController:didCloseAll:context:"), nil);
    }
    else
    {
        objj_msgSend(objj_msgSend(objj_msgSend(self, "keyWindow"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
    }
}
}), new objj_method(sel_getUid("setApplicationIconImage:"), function(self, _cmd, anImage)
{ with(self)
{
    _applicationIconImage = anImage;
}
}), new objj_method(sel_getUid("applicationIconImage"), function(self, _cmd)
{ with(self)
{
    if (_applicationIconImage)
        return _applicationIconImage;
    var imagePath = objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "objectForInfoDictionaryKey:", "CPApplicationIcon");
    if (imagePath)
        _applicationIconImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", imagePath);
    return _applicationIconImage;
}
}), new objj_method(sel_getUid("orderFrontStandardAboutPanel:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "orderFrontStandardAboutPanelWithOptions:", nil);
}
}), new objj_method(sel_getUid("orderFrontStandardAboutPanelWithOptions:"), function(self, _cmd, options)
{ with(self)
{
    if (!_aboutPanel)
    {
        var mainInfo = objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "infoDictionary"),
            applicationTitle = objj_msgSend(options, "objectForKey:", "ApplicationName") || objj_msgSend(mainInfo, "objectForKey:", "CPBundleName"),
            applicationIcon = objj_msgSend(options, "objectForKey:", "ApplicationIcon") || objj_msgSend(self, "applicationIconImage"),
            version = objj_msgSend(options, "objectForKey:", "Version") || objj_msgSend(mainInfo, "objectForKey:", "CPBundleVersion"),
            applicationVersion = objj_msgSend(options, "objectForKey:", "ApplicationVersion") || objj_msgSend(mainInfo, "objectForKey:", "CPBundleShortVersionString"),
            copyright = objj_msgSend(options, "objectForKey:", "Copyright") || objj_msgSend(mainInfo, "objectForKey:", "CPHumanReadableCopyright");
        var aboutPanelController = objj_msgSend(objj_msgSend(CPWindowController, "alloc"), "initWithWindowCibName:", "AboutPanel"),
            aboutPanel = objj_msgSend(aboutPanelController, "window"),
            contentView = objj_msgSend(aboutPanel, "contentView"),
            imageView = objj_msgSend(contentView, "viewWithTag:", 1),
            applicationLabel = objj_msgSend(contentView, "viewWithTag:", 2),
            versionLabel = objj_msgSend(contentView, "viewWithTag:", 3),
            copyrightLabel = objj_msgSend(contentView, "viewWithTag:", 4),
            standardPath = objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(self, "class")), "pathForResource:", "standardApplicationIcon.png");
        objj_msgSend(applicationLabel, "setFont:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 14.0));
        objj_msgSend(applicationLabel, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(versionLabel, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(copyrightLabel, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(imageView, "setImage:", applicationIcon || objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", standardPath, CGSizeMake(256, 256)));
        objj_msgSend(applicationLabel, "setStringValue:", applicationTitle || "");
        if (version && applicationVersion)
            objj_msgSend(versionLabel, "setStringValue:", sprintf("Version %@ (%@)", applicationVersion, version));
        else if (applicationVersion || version)
            objj_msgSend(versionLabel, "setStringValue:", sprintf("Version %@", applicationVersion || version));
        else
            objj_msgSend(versionLabel, "setStringValue:", "");
        objj_msgSend(copyrightLabel, "setStringValue:", copyright || "");
        objj_msgSend(aboutPanel, "center");
        _aboutPanel = aboutPanel;
    }
    objj_msgSend(_aboutPanel, "orderFront:", self);
}
}), new objj_method(sel_getUid("_documentController:didCloseAll:context:"), function(self, _cmd, docController, didCloseAll, info)
{ with(self)
{
    if (didCloseAll)
    {
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("applicationShouldTerminate:")))
            objj_msgSend(self, "replyToApplicationShouldTerminate:", objj_msgSend(_delegate, "applicationShouldTerminate:", self));
        else
            objj_msgSend(self, "replyToApplicationShouldTerminate:", YES);
    }
}
}), new objj_method(sel_getUid("replyToApplicationShouldTerminate:"), function(self, _cmd, terminate)
{ with(self)
{
    if (terminate == CPTerminateNow)
    {
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPApplicationWillTerminateNotification, self);
        objj_msgSend(CPPlatform, "terminateApplication");
    }
}
}), new objj_method(sel_getUid("activateIgnoringOtherApps:"), function(self, _cmd, shouldIgnoreOtherApps)
{ with(self)
{
    objj_msgSend(CPPlatform, "activateIgnoringOtherApps:", shouldIgnoreOtherApps);
}
}), new objj_method(sel_getUid("hideOtherApplications:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(CPPlatform, "hideOtherApplications:", self);
}
}), new objj_method(sel_getUid("run"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "finishLaunching");
}
}), new objj_method(sel_getUid("runModalForWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    objj_msgSend(self, "runModalSession:", objj_msgSend(self, "beginModalSessionForWindow:", aWindow));
}
}), new objj_method(sel_getUid("stopModalWithCode:"), function(self, _cmd, aCode)
{ with(self)
{
    if (!_currentSession)
    {
        return;
    }
    _currentSession._state = aCode;
    _currentSession = _currentSession._previous;
        objj_msgSend(self, "_removeRunModalLoop");
}
}), new objj_method(sel_getUid("_removeRunModalLoop"), function(self, _cmd)
{ with(self)
{
    var count = _eventListeners.length;
    while (count--)
        if (_eventListeners[count]._callback === _CPRunModalLoop)
        {
            _eventListeners.splice(count, 1);
            return;
        }
}
}), new objj_method(sel_getUid("stopModal"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "stopModalWithCode:", CPRunStoppedResponse)
}
}), new objj_method(sel_getUid("abortModal"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "stopModalWithCode:", CPRunAbortedResponse);
}
}), new objj_method(sel_getUid("beginModalSessionForWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    return _CPModalSessionMake(aWindow, 0);
}
}), new objj_method(sel_getUid("runModalSession:"), function(self, _cmd, aModalSession)
{ with(self)
{
    aModalSession._previous = _currentSession;
    _currentSession = aModalSession;
    var theWindow = aModalSession._window;
    objj_msgSend(theWindow, "center");
    objj_msgSend(theWindow, "makeKeyAndOrderFront:", self);
    objj_msgSend(CPApp, "setCallback:forNextEventMatchingMask:untilDate:inMode:dequeue:", _CPRunModalLoop, CPAnyEventMask, nil, 0, NO);
}
}), new objj_method(sel_getUid("modalWindow"), function(self, _cmd)
{ with(self)
{
    if (!_currentSession)
        return nil;
    return _currentSession._window;
}
}), new objj_method(sel_getUid("_handleKeyEquivalent:"), function(self, _cmd, anEvent)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "keyWindow"), "performKeyEquivalent:", anEvent) ||
            objj_msgSend(_mainMenu, "performKeyEquivalent:", anEvent);
}
}), new objj_method(sel_getUid("sendEvent:"), function(self, _cmd, anEvent)
{ with(self)
{
    _currentEvent = anEvent;
    var willPropagate = objj_msgSend(objj_msgSend(objj_msgSend(anEvent, "window"), "platformWindow"), "_willPropagateCurrentDOMEvent");
    objj_msgSend(objj_msgSend(objj_msgSend(anEvent, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", NO);
    if (objj_msgSend(anEvent, "_couldBeKeyEquivalent") && objj_msgSend(self, "_handleKeyEquivalent:", anEvent))
    {
        var characters = objj_msgSend(anEvent, "characters"),
            modifierFlags = objj_msgSend(anEvent, "modifierFlags");
        if ((characters == "c" || characters == "x" || characters == "v") && (modifierFlags & CPPlatformActionKeyMask))
            objj_msgSend(objj_msgSend(objj_msgSend(anEvent, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
        return;
    }
    objj_msgSend(objj_msgSend(objj_msgSend(anEvent, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", willPropagate);
    if (_eventListeners.length)
    {
        if (_eventListeners[_eventListeners.length - 1]._mask & (1 << objj_msgSend(anEvent, "type")))
            _eventListeners.pop()._callback(anEvent);
        return;
    }
    objj_msgSend(objj_msgSend(anEvent, "window"), "sendEvent:", anEvent);
}
}), new objj_method(sel_getUid("doCommandBySelector:"), function(self, _cmd, aSelector)
{ with(self)
{
    if (objj_msgSend(_delegate, "respondsToSelector:", aSelector))
        objj_msgSend(_delegate, "performSelector:", aSelector);
    else
        objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPApplication").super_class }, "doCommandBySelector:", aSelector);
}
}), new objj_method(sel_getUid("keyWindow"), function(self, _cmd)
{ with(self)
{
    return _keyWindow;
}
}), new objj_method(sel_getUid("mainWindow"), function(self, _cmd)
{ with(self)
{
    return _mainWindow;
}
}), new objj_method(sel_getUid("windowWithWindowNumber:"), function(self, _cmd, aWindowNumber)
{ with(self)
{
    return _windows[aWindowNumber];
}
}), new objj_method(sel_getUid("windows"), function(self, _cmd)
{ with(self)
{
    return _windows;
}
}), new objj_method(sel_getUid("hide:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(CPPlatform, "hide:", self);
}
}), new objj_method(sel_getUid("mainMenu"), function(self, _cmd)
{ with(self)
{
    return _mainMenu;
}
}), new objj_method(sel_getUid("setMainMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    if (objj_msgSend(aMenu, "_menuName") === "CPMainMenu")
    {
        if (_mainMenu === aMenu)
            return;
        _mainMenu = aMenu;
        if (objj_msgSend(CPPlatform, "supportsNativeMainMenu"))
            window.cpSetMainMenu(_mainMenu);
    }
    else
        objj_msgSend(aMenu, "_setMenuName:", "CPMainMenu");
}
}), new objj_method(sel_getUid("orderFrontColorPanel:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPColorPanel, "sharedColorPanel"), "orderFront:", self);
}
}), new objj_method(sel_getUid("tryToPerform:with:"), function(self, _cmd, anAction, anObject)
{ with(self)
{
    if (!anAction)
        return NO;
    if (objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPApplication").super_class }, "tryToPerform:with:", anAction, anObject))
        return YES;
    if(objj_msgSend(_delegate, "respondsToSelector:", anAction))
    {
        objj_msgSend(_delegate, "performSelector:withObject:", anAction, anObject);
        return YES;
    }
    return NO;
}
}), new objj_method(sel_getUid("sendAction:to:from:"), function(self, _cmd, anAction, aTarget, aSender)
{ with(self)
{
    var target = objj_msgSend(self, "targetForAction:to:from:", anAction, aTarget, aSender);
    if (!target)
        return NO;
    objj_msgSend(target, "performSelector:withObject:", anAction, aSender);
    return YES;
}
}), new objj_method(sel_getUid("targetForAction:to:from:"), function(self, _cmd, anAction, aTarget, aSender)
{ with(self)
{
    if (!anAction)
        return nil;
    if (aTarget)
        return aTarget;
    return objj_msgSend(self, "targetForAction:", anAction);
}
}), new objj_method(sel_getUid("_targetForWindow:action:"), function(self, _cmd, aWindow, anAction)
{ with(self)
{
    var responder = objj_msgSend(aWindow, "firstResponder"),
        checkWindow = YES;
    while (responder)
    {
        if (objj_msgSend(responder, "respondsToSelector:", anAction))
            return responder;
        if (responder == aWindow)
            checkWindow = NO;
        responder = objj_msgSend(responder, "nextResponder");
    }
    if (checkWindow && objj_msgSend(aWindow, "respondsToSelector:", anAction))
        return aWindow;
    var delegate = objj_msgSend(aWindow, "delegate");
    if (objj_msgSend(delegate, "respondsToSelector:", anAction))
        return delegate;
    var windowController = objj_msgSend(aWindow, "windowController");
    if (objj_msgSend(windowController, "respondsToSelector:", anAction))
        return windowController;
    var theDocument = objj_msgSend(windowController, "document");
    if (theDocument != delegate && objj_msgSend(theDocument, "respondsToSelector:", anAction))
        return theDocument;
    return nil;
}
}), new objj_method(sel_getUid("targetForAction:"), function(self, _cmd, anAction)
{ with(self)
{
    if (!anAction)
        return nil;
    var target = objj_msgSend(self, "_targetForWindow:action:", objj_msgSend(self, "keyWindow"), anAction);
    if (target)
        return target;
    target = objj_msgSend(self, "_targetForWindow:action:", objj_msgSend(self, "mainWindow"), anAction);
    if (target)
        return target;
    if (objj_msgSend(self, "respondsToSelector:", anAction))
        return self;
    if (objj_msgSend(_delegate, "respondsToSelector:", anAction))
        return _delegate;
    if (objj_msgSend(_documentController, "respondsToSelector:", anAction))
        return _documentController;
    return nil;
}
}), new objj_method(sel_getUid("setCallback:forNextEventMatchingMask:untilDate:inMode:dequeue:"), function(self, _cmd, aCallback, aMask, anExpiration, aMode, shouldDequeue)
{ with(self)
{
    _eventListeners.push(_CPEventListenerMake(aMask, aCallback));
    if (_eventListeners.length == 3) objj_debug_print_backtrace();
}
}), new objj_method(sel_getUid("setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:"), function(self, _cmd, aTarget, aSelector, aMask, anExpiration, aMode, shouldDequeue)
{ with(self)
{
    _eventListeners.push(_CPEventListenerMake(aMask, function (anEvent) { objj_msgSend(aTarget, aSelector, anEvent); }));
}
}), new objj_method(sel_getUid("currentEvent"), function(self, _cmd)
{ with(self)
{
    return _currentEvent;
}
}), new objj_method(sel_getUid("beginSheet:modalForWindow:modalDelegate:didEndSelector:contextInfo:"), function(self, _cmd, aSheet, aWindow, aModalDelegate, aDidEndSelector, aContextInfo)
{ with(self)
{
    var styleMask = objj_msgSend(aSheet, "styleMask");
    if (!(styleMask & CPDocModalWindowMask))
    {
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, "Currently only CPDocModalWindowMask style mask is supported for attached sheets");
        return;
    }
    objj_msgSend(aWindow, "orderFront:", self);
    objj_msgSend(aWindow, "_attachSheet:modalDelegate:didEndSelector:contextInfo:", aSheet, aModalDelegate, aDidEndSelector, aContextInfo);
}
}), new objj_method(sel_getUid("endSheet:returnCode:"), function(self, _cmd, sheet, returnCode)
{ with(self)
{
    var count = objj_msgSend(_windows, "count");
    while (--count >= 0)
    {
        var aWindow = objj_msgSend(_windows, "objectAtIndex:", count);
        var context = aWindow._sheetContext;
        if (context != nil && context["sheet"] === sheet)
        {
            context["returnCode"] = returnCode;
            objj_msgSend(aWindow, "_detachSheetWindow");
            return;
        }
    }
}
}), new objj_method(sel_getUid("endSheet:"), function(self, _cmd, sheet)
{ with(self)
{
   objj_msgSend(self, "endSheet:returnCode:", sheet, 0);
}
}), new objj_method(sel_getUid("arguments"), function(self, _cmd)
{ with(self)
{
    if(_fullArgsString != window.location.hash)
        objj_msgSend(self, "_reloadArguments");
    return _args;
}
}), new objj_method(sel_getUid("setArguments:"), function(self, _cmd, args)
{ with(self)
{
    if(!args || args.length == 0)
    {
        _args = [];
        window.location.hash = "#";
        return;
    }
    if(objj_msgSend(args, "class") != CPArray)
        args = objj_msgSend(CPArray, "arrayWithObject:", args);
    _args = args;
    var toEncode = objj_msgSend(_args, "copy");
    for(var i=0, count = toEncode.length; i<count; i++)
        toEncode[i] = encodeURIComponent(toEncode[i]);
    var hash = objj_msgSend(toEncode, "componentsJoinedByString:", "/");
    window.location.hash = "#" + hash;
}
}), new objj_method(sel_getUid("_reloadArguments"), function(self, _cmd)
{ with(self)
{
    _fullArgsString = window.location.hash;
    var args = _fullArgsString.replace("#", "").split("/").slice(0);
    for(var i=0, count = args.length; i<count; i++)
        args[i] = decodeURIComponent(args[i]);
    _args = args;
}
}), new objj_method(sel_getUid("namedArguments"), function(self, _cmd)
{ with(self)
{
    return _namedArgs;
}
}), new objj_method(sel_getUid("_openURL:"), function(self, _cmd, aURL)
{ with(self)
{
    if (_delegate && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("application:openFile:")))
    {
        CPLog.warn("application:openFile: is deprecated, use application:openURL: instead.");
        return objj_msgSend(_delegate, "application:openFile:", self, objj_msgSend(aURL, "absoluteString"));
    }
    if (_delegate && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("application:openURL:")))
        return objj_msgSend(_delegate, "application:openURL:", self, aURL);
    return !!objj_msgSend(_documentController, "openDocumentWithContentsOfURL:display:error:", aURL, YES, NULL);
}
}), new objj_method(sel_getUid("_didResignActive"), function(self, _cmd)
{ with(self)
{
    if (self._activeMenu)
        objj_msgSend(self._activeMenu, "cancelTracking");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("sharedApplication"), function(self, _cmd)
{ with(self)
{
    if (!CPApp)
        CPApp = objj_msgSend(objj_msgSend(CPApplication, "alloc"), "init");
    return CPApp;
}
}), new objj_method(sel_getUid("defaultThemeName"), function(self, _cmd)
{ with(self)
{
    return (objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "objectForInfoDictionaryKey:", "CPDefaultTheme") || "Aristo");
}
})]);
}
var _CPModalSessionMake = function(aWindow, aStopCode)
{
    return { _window:aWindow, _state:CPRunContinuesResponse , _previous:nil };
}
var _CPEventListenerMake = function(anEventMask, aCallback)
{
    return { _mask:anEventMask, _callback:aCallback };
}
var _CPRunModalLoop = function(anEvent)
{
    objj_msgSend(CPApp, "setCallback:forNextEventMatchingMask:untilDate:inMode:dequeue:", _CPRunModalLoop, CPAnyEventMask, nil, 0, NO);
    var theWindow = objj_msgSend(anEvent, "window"),
        modalSession = CPApp._currentSession;
    if (theWindow == modalSession._window || objj_msgSend(theWindow, "worksWhenModal"))
        objj_msgSend(theWindow, "sendEvent:", anEvent);
}
CPApplicationMain= function(args, namedArgs)
{
    var mainBundle = objj_msgSend(CPBundle, "mainBundle"),
        principalClass = objj_msgSend(mainBundle, "principalClass");
    if (!principalClass)
        principalClass = objj_msgSend(CPApplication, "class");
    objj_msgSend(principalClass, "sharedApplication");
    if (!args)
    {
        var args = objj_msgSend(CPApp, "arguments");
        if(objj_msgSend(args, "containsObject:", "debug"))
            CPLogRegister(CPLogPopup);
    }
    if (!namedArgs)
    {
        var searchParams = window.location.search.substring(1).split("&");
            namedArgs = objj_msgSend(CPDictionary, "dictionary");
        for(var i=0; i<searchParams.length; i++)
        {
            var index = searchParams[i].indexOf('=');
            if(index == -1)
                objj_msgSend(namedArgs, "setObject:forKey:",  "", searchParams[i]);
            else
                objj_msgSend(namedArgs, "setObject:forKey:",  searchParams[i].substring(index+1),  searchParams[i].substring(0, index));
        }
    }
    CPApp._args = args;
    CPApp._namedArgs = namedArgs;
    objj_msgSend(_CPAppBootstrapper, "performActions");
}
var _CPAppBootstrapperActions = nil;
{var the_class = objj_allocateClassPair(CPObject, "_CPAppBootstrapper"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("actions"), function(self, _cmd)
{ with(self)
{
    return [sel_getUid("bootstrapPlatform"), sel_getUid("loadDefaultTheme"), sel_getUid("loadMainCibFile")];
}
}), new objj_method(sel_getUid("performActions"), function(self, _cmd)
{ with(self)
{
    if (!_CPAppBootstrapperActions)
        _CPAppBootstrapperActions = objj_msgSend(self, "actions");
    while (_CPAppBootstrapperActions.length)
    {
        var action = _CPAppBootstrapperActions.shift();
        if (objj_msgSend(self, action))
            return;
    }
    objj_msgSend(CPApp, "run");
}
}), new objj_method(sel_getUid("bootstrapPlatform"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPPlatform, "bootstrap");
}
}), new objj_method(sel_getUid("loadDefaultTheme"), function(self, _cmd)
{ with(self)
{
    var blend = objj_msgSend(objj_msgSend(CPThemeBlend, "alloc"), "initWithContentsOfURL:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPApplication, "class")), "pathForResource:", objj_msgSend(CPApplication, "defaultThemeName") + ".blend"));
    objj_msgSend(blend, "loadWithDelegate:", self);
    return YES;
}
}), new objj_method(sel_getUid("blendDidFinishLoading:"), function(self, _cmd, aBundle)
{ with(self)
{
    objj_msgSend(CPTheme, "setDefaultTheme:", objj_msgSend(CPTheme, "themeNamed:", objj_msgSend(CPApplication, "defaultThemeName")));
    objj_msgSend(self, "performActions");
}
}), new objj_method(sel_getUid("loadMainCibFile"), function(self, _cmd)
{ with(self)
{
    var mainBundle = objj_msgSend(CPBundle, "mainBundle"),
        mainCibFile = objj_msgSend(mainBundle, "objectForInfoDictionaryKey:", CPMainCibFile) || objj_msgSend(mainBundle, "objectForInfoDictionaryKey:", CPMainCibFileHumanFriendly);
    if (mainCibFile)
    {
        objj_msgSend(mainBundle, "loadCibFile:externalNameTable:loadDelegate:", mainCibFile, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", CPApp, CPCibOwner), self);
        return YES;
    }
    return NO;
}
}), new objj_method(sel_getUid("cibDidFinishLoading:"), function(self, _cmd, aCib)
{ with(self)
{
    objj_msgSend(self, "performActions");
}
}), new objj_method(sel_getUid("reset"), function(self, _cmd)
{ with(self)
{
 _CPAppBootstrapperActions = nil;
}
})]);
}

p;14;CPBezierPath.jt;5324;@STATIC;1.0;I;26;AppKit/CPGraphicsContext.jI;21;Foundation/CPObject.jt;5248;objj_executeFile("AppKit/CPGraphicsContext.j", false);
objj_executeFile("Foundation/CPObject.j", false);
var DefaultLineWidth = 1.0;
{var the_class = objj_allocateClassPair(CPObject, "CPBezierPath"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_path"), new objj_ivar("_lineWidth")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPBezierPath").super_class }, "init"))
    {
        _path = CGPathCreateMutable();
        _lineWidth = objj_msgSend(objj_msgSend(self, "class"), "defaultLineWidth");
    }
    return self;
}
}), new objj_method(sel_getUid("moveToPoint:"), function(self, _cmd, point)
{ with(self)
{
    CGPathMoveToPoint(_path, nil, point.x, point.y);
}
}), new objj_method(sel_getUid("lineToPoint:"), function(self, _cmd, point)
{ with(self)
{
    CGPathAddLineToPoint(_path, nil, point.x, point.y);
}
}), new objj_method(sel_getUid("curveToPoint:controlPoint1:controlPoint2:"), function(self, _cmd, endPoint, controlPoint1, controlPoint2)
{ with(self)
{
    CGPathAddCurveToPoint(_path, nil, controlPoint1.x, controlPoint1.y, controlPoint2.x, controlPoint2.y, endPoint.x, endPoint.y);
}
}), new objj_method(sel_getUid("closePath"), function(self, _cmd)
{ with(self)
{
    CGPathCloseSubpath(_path);
}
}), new objj_method(sel_getUid("stroke"), function(self, _cmd)
{ with(self)
{
    var ctx = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextBeginPath(ctx);
    CGContextAddPath(ctx, _path);
    CGContextSetLineWidth(ctx, objj_msgSend(self, "lineWidth"));
    CGContextClosePath(ctx);
    CGContextStrokePath(ctx);
}
}), new objj_method(sel_getUid("fill"), function(self, _cmd)
{ with(self)
{
    var ctx = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextBeginPath(ctx);
    CGContextAddPath(ctx, _path);
    CGContextSetLineWidth(ctx, objj_msgSend(self, "lineWidth"));
    CGContextClosePath(ctx);
    CGContextFillPath(ctx);
}
}), new objj_method(sel_getUid("lineWidth"), function(self, _cmd)
{ with(self)
{
    return _lineWidth;
}
}), new objj_method(sel_getUid("setLineWidth:"), function(self, _cmd, lineWidth)
{ with(self)
{
    _lineWidth = lineWidth;
}
}), new objj_method(sel_getUid("elementCount"), function(self, _cmd)
{ with(self)
{
    return _path.count;
}
}), new objj_method(sel_getUid("isEmpty"), function(self, _cmd)
{ with(self)
{
    return CGPathIsEmpty(_path);
}
}), new objj_method(sel_getUid("currentPoint"), function(self, _cmd)
{ with(self)
{
    return CGPathGetCurrentPoint(_path);
}
}), new objj_method(sel_getUid("appendBezierPathWithPoints:count:"), function(self, _cmd, points, count)
{ with(self)
{
    CGPathAddLines(_path, nil, points, count);
}
}), new objj_method(sel_getUid("appendBezierPathWithRect:"), function(self, _cmd, rect)
{ with(self)
{
    CGPathAddRect(_path, nil, rect);
}
}), new objj_method(sel_getUid("appendBezierPathWithOvalInRect:"), function(self, _cmd, rect)
{ with(self)
{
    CGPathAddPath(_path, nil, CGPathWithEllipseInRect(rect));
}
}), new objj_method(sel_getUid("appendBezierPathWithRoundedRect:xRadius:yRadius:"), function(self, _cmd, rect, xRadius, yRadius)
{ with(self)
{
    CGPathAddPath(_path, nil, CGPathWithRoundedRectangleInRect(rect, xRadius, yRadius, YES, YES, YES, YES));
}
}), new objj_method(sel_getUid("appendBezierPath:"), function(self, _cmd, other)
{ with(self)
{
    CGPathAddPath(_path, nil, other._path);
}
}), new objj_method(sel_getUid("removeAllPoints"), function(self, _cmd)
{ with(self)
{
    _path = CGPathCreateMutable();
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("bezierPath"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "init");
}
}), new objj_method(sel_getUid("bezierPathWithOvalInRect:"), function(self, _cmd, rect)
{ with(self)
{
    var path = objj_msgSend(self, "bezierPath");
    objj_msgSend(path, "appendBezierPathWithOvalInRect:", rect);
    return path;
}
}), new objj_method(sel_getUid("bezierPathWithRect:"), function(self, _cmd, rect)
{ with(self)
{
    var path = objj_msgSend(self, "bezierPath");
    objj_msgSend(path, "appendBezierPathWithRect:", rect);
    return path;
}
}), new objj_method(sel_getUid("defaultLineWidth"), function(self, _cmd)
{ with(self)
{
    return DefaultLineWidth;
}
}), new objj_method(sel_getUid("setDefaultLineWidth:"), function(self, _cmd, width)
{ with(self)
{
    DefaultLineWidth = width;
}
}), new objj_method(sel_getUid("fillRect:"), function(self, _cmd, aRect)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "bezierPathWithRect:", aRect), "fill");
}
}), new objj_method(sel_getUid("strokeRect:"), function(self, _cmd, aRect)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "bezierPathWithRect:", aRect), "stroke");
}
}), new objj_method(sel_getUid("strokeLineFromPoint:toPoint:"), function(self, _cmd, point1, point2)
{ with(self)
{
    var path = objj_msgSend(self, "bezierPath");
    objj_msgSend(path, "moveToPoint:", point1);
    objj_msgSend(path, "lineToPoint:", point2);
    objj_msgSend(path, "stroke");
}
})]);
}

p;7;CPBox.jt;7743;@STATIC;1.0;i;8;CPView.jt;7712;objj_executeFile("CPView.j", true);
CPNoBorder = 0;
CPLineBorder = 1;
CPBezelBorder = 2;
CPGrooveBorder = 3;
{var the_class = objj_allocateClassPair(CPView, "CPBox"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_borderType"), new objj_ivar("_borderColor"), new objj_ivar("_fillColor"), new objj_ivar("_cornerRadius"), new objj_ivar("_borderWidth"), new objj_ivar("_contentMargin"), new objj_ivar("_contentView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, frameRect)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPBox").super_class }, "initWithFrame:", frameRect);
    if (self)
    {
        _fillColor = objj_msgSend(CPColor, "clearColor");
        _borderColor = objj_msgSend(CPColor, "blackColor");
        _borderWidth = 1.0;
        _contentMargin = CGSizeMake(0.0, 0.0);
        _contentView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", objj_msgSend(self, "bounds"));
        objj_msgSend(self, "addSubview:", _contentView);
    }
    return self;
}
}), new objj_method(sel_getUid("borderRect"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "bounds");
}
}), new objj_method(sel_getUid("borderType"), function(self, _cmd)
{ with(self)
{
    return _borderType;
}
}), new objj_method(sel_getUid("setBorderType:"), function(self, _cmd, value)
{ with(self)
{
    _borderType = value;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("borderColor"), function(self, _cmd)
{ with(self)
{
    return _borderColor;
}
}), new objj_method(sel_getUid("setBorderColor:"), function(self, _cmd, color)
{ with(self)
{
    if (objj_msgSend(color, "isEqual:", _borderColor))
        return;
    _borderColor = color;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("borderWidth"), function(self, _cmd)
{ with(self)
{
    return _borderWidth;
}
}), new objj_method(sel_getUid("setBorderWidth:"), function(self, _cmd, width)
{ with(self)
{
    if (width === _borderWidth)
        return;
    _borderWidth = width;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("cornerRadius"), function(self, _cmd)
{ with(self)
{
    return _cornerRadius;
}
}), new objj_method(sel_getUid("setCornerRadius:"), function(self, _cmd, radius)
{ with(self)
{
    if (radius === _cornerRadius)
        return;
    _cornerRadius = radius;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("fillColor"), function(self, _cmd)
{ with(self)
{
    return _fillColor;
}
}), new objj_method(sel_getUid("setFillColor:"), function(self, _cmd, color)
{ with(self)
{
    if (objj_msgSend(color, "isEqual:", _fillColor))
        return;
    _fillColor = color;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("contentView"), function(self, _cmd)
{ with(self)
{
    return _contentView;
}
}), new objj_method(sel_getUid("setContentView:"), function(self, _cmd, aView)
{ with(self)
{
    if (aView === _contentView)
        return;
    objj_msgSend(aView, "setFrame:", CGRectInset(objj_msgSend(self, "bounds"), _contentMargin.width + _borderWidth, _contentMargin.height + _borderWidth));
    objj_msgSend(self, "replaceSubview:with:", _contentView, aView);
    _contentView = aView;
}
}), new objj_method(sel_getUid("contentViewMargins"), function(self, _cmd)
{ with(self)
{
    return _contentMargin;
}
}), new objj_method(sel_getUid("setContentViewMargins:"), function(self, _cmd, size)
{ with(self)
{
     if(size.width < 0 || size.height < 0)
         objj_msgSend(CPException, "raise:reason:", CPGenericException, "Margins must be positive");
    _contentMargin = CGSizeMakeCopy(size);
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("setFrameFromContentFrame:"), function(self, _cmd, aRect)
{ with(self)
{
    objj_msgSend(self, "setFrame:", CGRectInset(aRect, -(_contentMargin.width + _borderWidth), -(_contentMargin.height + _borderWidth)));
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    var contentFrame = objj_msgSend(_contentView, "frame");
    objj_msgSend(self, "setFrameSize:", CGSizeMake(contentFrame.size.width + _contentMargin.width * 2,
                                  contentFrame.size.height + _contentMargin.height * 2));
    objj_msgSend(_contentView, "setFrameOrigin:", CGPointMake(_contentMargin.width, _contentMargin.height));
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, rect)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        aContext = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        border2 = _borderWidth/2,
        strokeRect = CGRectMake(bounds.origin.x + border2,
                                bounds.origin.y + border2,
                                bounds.size.width - _borderWidth,
                                bounds.size.height - _borderWidth),
        fillRect = CGRectMake(bounds.origin.x + border2,
                              bounds.origin.y + border2,
                              bounds.size.width - _borderWidth,
                              bounds.size.height - _borderWidth);
    CGContextSetFillColor(aContext, objj_msgSend(self, "fillColor"));
    CGContextSetStrokeColor(aContext, objj_msgSend(self, "borderColor"));
    CGContextSetLineWidth(aContext, _borderWidth);
    switch(_borderType)
    {
        case CPLineBorder: CGContextFillRoundedRectangleInRect(aContext, fillRect, _cornerRadius, YES, YES, YES, YES);
                            CGContextStrokeRoundedRectangleInRect(aContext, strokeRect, _cornerRadius, YES, YES, YES, YES);
                            break;
        case CPBezelBorder: CGContextFillRoundedRectangleInRect(aContext, fillRect, _cornerRadius, YES, YES, YES, YES);
                            CGContextSetStrokeColor(aContext, objj_msgSend(CPColor, "colorWithWhite:alpha:", 190.0/255.0, 1.0));
                            CGContextBeginPath(aContext);
                            CGContextMoveToPoint(aContext, strokeRect.origin.x, strokeRect.origin.y);
                            CGContextAddLineToPoint(aContext, CGRectGetMinX(strokeRect), CGRectGetMaxY(strokeRect)),
                            CGContextAddLineToPoint(aContext, CGRectGetMaxX(strokeRect), CGRectGetMaxY(strokeRect)),
                            CGContextAddLineToPoint(aContext, CGRectGetMaxX(strokeRect), CGRectGetMinY(strokeRect)),
                            CGContextStrokePath(aContext);
                            CGContextSetStrokeColor(aContext, objj_msgSend(CPColor, "colorWithWhite:alpha:", 142.0/255.0, 1.0));
                            CGContextBeginPath(aContext);
                            CGContextMoveToPoint(aContext, bounds.origin.x, strokeRect.origin.y);
                            CGContextAddLineToPoint(aContext, CGRectGetMaxX(bounds), CGRectGetMinY(strokeRect));
                            CGContextStrokePath(aContext);
                            break;
        default: break;
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("boxEnclosingView:"), function(self, _cmd, aView)
{ with(self)
{
    var box = objj_msgSend(objj_msgSend(self, "alloc"), "initWithFrame:", CGRectMakeZero()),
        enclosingView = objj_msgSend(aView, "superview");
    objj_msgSend(box, "setFrameFromContentFrame:", objj_msgSend(aView, "frame"));
    objj_msgSend(enclosingView, "replaceSubview:with:", aView, box);
    objj_msgSend(box, "setContentView:", aView);
    return box;
}
})]);
}

p;10;CPButton.jt;20194;@STATIC;1.0;i;21;_CPImageAndTextView.ji;12;CGGeometry.ji;11;CPControl.ji;12;CPCheckBox.ji;9;CPRadio.jt;20085;objj_executeFile("_CPImageAndTextView.j", true);
objj_executeFile("CGGeometry.j", true);
objj_executeFile("CPControl.j", true);
CPRoundedBezelStyle = 1;
CPRegularSquareBezelStyle = 2;
CPThickSquareBezelStyle = 3;
CPThickerSquareBezelStyle = 4;
CPDisclosureBezelStyle = 5;
CPShadowlessSquareBezelStyle = 6;
CPCircularBezelStyle = 7;
CPTexturedSquareBezelStyle = 8;
CPHelpButtonBezelStyle = 9;
CPSmallSquareBezelStyle = 10;
CPTexturedRoundedBezelStyle = 11;
CPRoundRectBezelStyle = 12;
CPRecessedBezelStyle = 13;
CPRoundedDisclosureBezelStyle = 14;
CPHUDBezelStyle = -1;
CPMomentaryLightButton = 0;
CPPushOnPushOffButton = 1;
CPToggleButton = 2;
CPSwitchButton = 3;
CPRadioButton = 4;
CPMomentaryChangeButton = 5;
CPOnOffButton = 6;
CPMomentaryPushInButton = 7;
CPMomentaryPushButton = 0;
CPMomentaryLight = 7;
CPNoButtonMask = 0;
CPContentsButtonMask = 1;
CPPushInButtonMask = 2;
CPGrayButtonMask = 4;
CPBackgroundButtonMask = 8;
CPNoCellMask = CPNoButtonMask;
CPContentsCellMask = CPContentsButtonMask;
CPPushInCellMask = CPPushInButtonMask;
CPChangeGrayCellMask = CPGrayButtonMask;
CPChangeBackgroundCellMask = CPBackgroundButtonMask;
CPButtonStateMixed = CPThemeState("mixed");
{var the_class = objj_allocateClassPair(CPControl, "CPButton"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_allowsMixedState"), new objj_ivar("_title"), new objj_ivar("_alternateTitle"), new objj_ivar("_image"), new objj_ivar("_alternateImage"), new objj_ivar("_showsStateBy"), new objj_ivar("_highlightsBy"), new objj_ivar("_imageDimsWhenDisabled"), new objj_ivar("_bezelStyle"), new objj_ivar("_controlSize")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        objj_msgSend(self, "setValue:forThemeAttribute:", CPCenterTextAlignment, "alignment");
        objj_msgSend(self, "setValue:forThemeAttribute:", CPCenterVerticalTextAlignment, "vertical-alignment");
        objj_msgSend(self, "setValue:forThemeAttribute:", CPImageLeft, "image-position");
        objj_msgSend(self, "setValue:forThemeAttribute:", CPScaleNone, "image-scaling");
        _controlSize = CPRegularControlSize;
        objj_msgSend(self, "setBordered:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("allowsMixedState"), function(self, _cmd)
{ with(self)
{
    return _allowsMixedState;
}
}), new objj_method(sel_getUid("setAllowsMixedState:"), function(self, _cmd, aFlag)
{ with(self)
{
    aFlag = !!aFlag;
    if (_allowsMixedState === aFlag)
        return;
    _allowsMixedState = aFlag;
    if (!_allowsMixedState && objj_msgSend(self, "state") === CPMixedState)
        objj_msgSend(self, "setState:", CPOnState);
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, anObjectValue)
{ with(self)
{
    if (!anObjectValue || anObjectValue === "" || (objj_msgSend(anObjectValue, "intValue") === 0))
        anObjectValue = CPOffState;
    else if (!objj_msgSend(anObjectValue, "isKindOfClass:", objj_msgSend(CPNumber, "class")))
        anObjectValue = CPOnState;
    else if (anObjectValue > CPOnState)
        anObjectValue = CPOnState
    else if (anObjectValue < CPOffState)
        if (objj_msgSend(self, "allowsMixedState"))
            anObjectValue = CPMixedState;
        else
            anObjectValue = CPOnState;
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "setObjectValue:", anObjectValue);
    switch (objj_msgSend(self, "objectValue"))
    {
        case CPMixedState: objj_msgSend(self, "unsetThemeState:", CPThemeStateSelected);
                            objj_msgSend(self, "setThemeState:", CPButtonStateMixed);
                            break;
        case CPOnState: objj_msgSend(self, "unsetThemeState:", CPButtonStateMixed);
                            objj_msgSend(self, "setThemeState:", CPThemeStateSelected);
                            break;
        case CPOffState: objj_msgSend(self, "unsetThemeState:", CPThemeStateSelected | CPButtonStateMixed);
    }
}
}), new objj_method(sel_getUid("nextState"), function(self, _cmd)
{ with(self)
{
   if (objj_msgSend(self, "allowsMixedState"))
   {
      var value = objj_msgSend(self, "state");
      return value - ((value === -1) ? -2 : 1);
   }
    return 1 - objj_msgSend(self, "state");
}
}), new objj_method(sel_getUid("setNextState"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "setState:", objj_msgSend(self, "nextState"));
}
}), new objj_method(sel_getUid("setState:"), function(self, _cmd, aState)
{ with(self)
{
    objj_msgSend(self, "setIntValue:", aState);
}
}), new objj_method(sel_getUid("state"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "intValue");
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    if (_title === aTitle)
        return;
    _title = aTitle;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("title"), function(self, _cmd)
{ with(self)
{
    return _title;
}
}), new objj_method(sel_getUid("setAlternateTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    if (_alternateTitle === aTitle)
        return;
    _alternateTitle = aTitle;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("alternateTitle"), function(self, _cmd)
{ with(self)
{
    return _alternateTitle;
}
}), new objj_method(sel_getUid("setImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_image === anImage)
        return;
    _image = anImage;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("image"), function(self, _cmd)
{ with(self)
{
    return _image;
}
}), new objj_method(sel_getUid("setAlternateImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_alternateImage === anImage)
        return;
    _alternateImage = anImage;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("alternateImage"), function(self, _cmd)
{ with(self)
{
    return _alternateImage;
}
}), new objj_method(sel_getUid("setShowsStateBy:"), function(self, _cmd, aMask)
{ with(self)
{
    if (_showsStateBy === aMask)
        return;
    _showsStateBy = aMask;
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("showsStateBy"), function(self, _cmd)
{ with(self)
{
    return _showsStateBy;
}
}), new objj_method(sel_getUid("setHighlightsBy:"), function(self, _cmd, aMask)
{ with(self)
{
    if (_highlightsBy === aMask)
        return;
    _highlightsBy = aMask;
    if (objj_msgSend(self, "hasThemeState:", CPThemeStateHighlighted))
    {
        objj_msgSend(self, "setNeedsDisplay:", YES);
        objj_msgSend(self, "setNeedsLayout");
    }
}
}), new objj_method(sel_getUid("setButtonType:"), function(self, _cmd, aButtonType)
{ with(self)
{
    switch (aButtonType)
    {
        case CPMomentaryLightButton: objj_msgSend(self, "setHighlightsBy:", CPChangeBackgroundCellMask);
                                        objj_msgSend(self, "setShowsStateBy:", CPNoCellMask);
                                        break;
        case CPMomentaryPushInButton: objj_msgSend(self, "setHighlightsBy:", CPPushInCellMask | CPChangeGrayCellMask);
                                        objj_msgSend(self, "setShowsStateBy:", CPNoCellMask);
                                        break;
        case CPMomentaryChangeButton: objj_msgSend(self, "setHighlightsBy:", CPContentsCellMask);
                                        objj_msgSend(self, "setShowsStateBy:", CPNoCellMask);
                                        break;
        case CPPushOnPushOffButton: objj_msgSend(self, "setHighlightsBy:", CPPushInCellMask | CPChangeGrayCellMask);
                                        objj_msgSend(self, "setShowsStateBy:", CPChangeBackgroundCellMask);
                                        break;
        case CPOnOffButton: objj_msgSend(self, "setHighlightsBy:", CPChangeBackgroundCellMask);
                                        objj_msgSend(self, "setShowsStateBy:", CPChangeBackgroundCellMask);
                                        break;
        case CPToggleButton: objj_msgSend(self, "setHighlightsBy:", CPPushInCellMask | CPContentsCellMask);
                                        objj_msgSend(self, "setShowsStateBy:", CPContentsCellMask);
                                        break;
        case CPSwitchButton: objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "The CPSwitchButton type is not supported in Cappuccino, use the CPCheckBox class instead.");
        case CPRadioButton: objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "The CPRadioButton type is not supported in Cappuccino, use the CPRadio class instead.");
        default: objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "Unknown button type.");
    }
    objj_msgSend(self, "setImageDimsWhenDisabled:", YES);
}
}), new objj_method(sel_getUid("setImageDimsWhenDisabled:"), function(self, _cmd, imageShouldDimWhenDisabled)
{ with(self)
{
    imageShouldDimWhenDisabled = !!imageShouldDimWhenDisabled;
    if (_imageDimsWhenDisabled === imageShouldDimWhenDisabled)
        return;
    _imageDimsWhenDisabled = imageShouldDimWhenDisabled;
    if (_imageDimsWhenDisabled)
    {
        objj_msgSend(self, "setNeedsDisplay:", YES);
        objj_msgSend(self, "setNeedsLayout");
    }
}
}), new objj_method(sel_getUid("imageDimsWhenDisabled"), function(self, _cmd)
{ with(self)
{
    return _imageDimsWhenDisabled;
}
}), new objj_method(sel_getUid("startTrackingAt:"), function(self, _cmd, aPoint)
{ with(self)
{
    objj_msgSend(self, "highlight:", YES);
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "startTrackingAt:", aPoint);
}
}), new objj_method(sel_getUid("stopTracking:at:mouseIsUp:"), function(self, _cmd, lastPoint, aPoint, mouseIsUp)
{ with(self)
{
    objj_msgSend(self, "highlight:", NO);
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "stopTracking:at:mouseIsUp:", lastPoint, aPoint, mouseIsUp);
    if (mouseIsUp && CGRectContainsPoint(objj_msgSend(self, "bounds"), aPoint))
        objj_msgSend(self, "setNextState");
}
}), new objj_method(sel_getUid("contentRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    var contentInset = objj_msgSend(self, "currentValueForThemeAttribute:", "content-inset");
    if (((contentInset).top === 0 && (contentInset).right === 0 && (contentInset).bottom === 0 && (contentInset).left === 0))
        return bounds;
    bounds.origin.x += contentInset.left;
    bounds.origin.y += contentInset.top;
    bounds.size.width -= contentInset.left + contentInset.right;
    bounds.size.height -= contentInset.top + contentInset.bottom;
    return bounds;
}
}), new objj_method(sel_getUid("bezelRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    if (!objj_msgSend(self, "isBordered"))
        return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    var bezelInset = objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-inset");
    if (((bezelInset).top === 0 && (bezelInset).right === 0 && (bezelInset).bottom === 0 && (bezelInset).left === 0))
        return bounds;
    bounds.origin.x += bezelInset.left;
    bounds.origin.y += bezelInset.top;
    bounds.size.width -= bezelInset.left + bezelInset.right;
    bounds.size.height -= bezelInset.top + bezelInset.bottom;
    return bounds;
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    var size = objj_msgSend((objj_msgSend(self, "title") || " "), "sizeWithFont:", objj_msgSend(self, "currentValueForThemeAttribute:", "font")),
        contentInset = objj_msgSend(self, "currentValueForThemeAttribute:", "content-inset"),
        minSize = objj_msgSend(self, "currentValueForThemeAttribute:", "min-size"),
        maxSize = objj_msgSend(self, "currentValueForThemeAttribute:", "max-size");
    size.width = MAX(size.width + contentInset.left + contentInset.right, minSize.width);
    size.height = MAX(size.height + contentInset.top + contentInset.bottom, minSize.height);
    if (maxSize.width >= 0.0)
        size.width = MIN(size.width, maxSize.width);
    if (maxSize.height >= 0.0)
        size.height = MIN(size.height, maxSize.height);
    objj_msgSend(self, "setFrameSize:", size);
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "bezel-view")
        return objj_msgSend(self, "bezelRectForBounds:", objj_msgSend(self, "bounds"));
    else if (aName === "content-view")
        return objj_msgSend(self, "contentRectForBounds:", objj_msgSend(self, "bounds"));
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "rectForEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "bezel-view")
    {
        var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
        objj_msgSend(view, "setHitTests:", NO);
        return view;
    }
    else
        return objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "createEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var bezelView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "bezel-view", CPWindowBelow, "content-view");
    if (bezelView)
        objj_msgSend(bezelView, "setBackgroundColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-color"));
    var contentView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "content-view", CPWindowAbove, "bezel-view");
    if (contentView)
    {
        objj_msgSend(contentView, "setText:", (objj_msgSend(self, "hasThemeState:", CPThemeStateHighlighted) && _alternateTitle) ? _alternateTitle : _title);
        objj_msgSend(contentView, "setImage:", (objj_msgSend(self, "hasThemeState:", CPThemeStateHighlighted) && _alternateImage) ? _alternateImage : _image);
        objj_msgSend(contentView, "setFont:", objj_msgSend(self, "currentValueForThemeAttribute:", "font"));
        objj_msgSend(contentView, "setTextColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "text-color"));
        objj_msgSend(contentView, "setAlignment:", objj_msgSend(self, "currentValueForThemeAttribute:", "alignment"));
        objj_msgSend(contentView, "setVerticalAlignment:", objj_msgSend(self, "currentValueForThemeAttribute:", "vertical-alignment"));
        objj_msgSend(contentView, "setLineBreakMode:", objj_msgSend(self, "currentValueForThemeAttribute:", "line-break-mode"));
        objj_msgSend(contentView, "setTextShadowColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "text-shadow-color"));
        objj_msgSend(contentView, "setTextShadowOffset:", objj_msgSend(self, "currentValueForThemeAttribute:", "text-shadow-offset"));
        objj_msgSend(contentView, "setImagePosition:", objj_msgSend(self, "currentValueForThemeAttribute:", "image-position"));
        objj_msgSend(contentView, "setImageScaling:", objj_msgSend(self, "currentValueForThemeAttribute:", "image-scaling"));
    }
}
}), new objj_method(sel_getUid("setDefaultButton:"), function(self, _cmd, shouldBeDefaultButton)
{ with(self)
{
    if (shouldBeDefaultButton)
        objj_msgSend(self, "setThemeState:", CPThemeStateDefault);
    else
        objj_msgSend(self, "unsetThemeState:", CPThemeStateDefault);
}
}), new objj_method(sel_getUid("setBordered:"), function(self, _cmd, shouldBeBordered)
{ with(self)
{
    if (shouldBeBordered)
        objj_msgSend(self, "setThemeState:", CPThemeStateBordered);
    else
        objj_msgSend(self, "unsetThemeState:", CPThemeStateBordered);
}
}), new objj_method(sel_getUid("isBordered"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "hasThemeState:", CPThemeStateBordered);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("buttonWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    return objj_msgSend(self, "buttonWithTitle:theme:", aTitle, objj_msgSend(CPTheme, "defaultTheme"));
}
}), new objj_method(sel_getUid("buttonWithTitle:theme:"), function(self, _cmd, aTitle, aTheme)
{ with(self)
{
    var button = objj_msgSend(objj_msgSend(self, "alloc"), "init");
    objj_msgSend(button, "setTheme:", aTheme);
    objj_msgSend(button, "setTitle:", aTitle);
    objj_msgSend(button, "sizeToFit");
    return button;
}
}), new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "button";
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [{ top:(0), right:(0), bottom:(0), left:(0) }, { top:(0), right:(0), bottom:(0), left:(0) }, objj_msgSend(CPNull, "null")], ["bezel-inset", "content-inset", "bezel-color"]);
}
})]);
}
{
var the_class = objj_getClass("CPButton")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPButton\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("setBezelStyle:"), function(self, _cmd, aBezelStyle)
{ with(self)
{
}
}), new objj_method(sel_getUid("bezelStyle"), function(self, _cmd)
{ with(self)
{
}
})]);
}
var CPButtonImageKey = "CPButtonImageKey",
    CPButtonAlternateImageKey = "CPButtonAlternateImageKey",
    CPButtonTitleKey = "CPButtonTitleKey",
    CPButtonAlternateTitleKey = "CPButtonAlternateTitleKey",
    CPButtonIsBorderedKey = "CPButtonIsBorderedKey";
{
var the_class = objj_getClass("CPButton")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPButton\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _controlSize = CPRegularControlSize;
        objj_msgSend(self, "setImage:", objj_msgSend(aCoder, "decodeObjectForKey:", CPButtonImageKey));
        objj_msgSend(self, "setAlternateImage:", objj_msgSend(aCoder, "decodeObjectForKey:", CPButtonAlternateImageKey));
        objj_msgSend(self, "setTitle:", objj_msgSend(aCoder, "decodeObjectForKey:", CPButtonTitleKey));
        objj_msgSend(self, "setAlternateTitle:", objj_msgSend(aCoder, "decodeObjectForKey:", CPButtonAlternateTitleKey));
        objj_msgSend(self, "setNeedsLayout");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButton").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _image, CPButtonImageKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _alternateImage, CPButtonAlternateImageKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _title, CPButtonTitleKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _alternateTitle, CPButtonAlternateTitleKey);
}
})]);
}
objj_executeFile("CPCheckBox.j", true);
objj_executeFile("CPRadio.j", true);

p;13;CPButtonBar.jt;2420;@STATIC;1.0;I;15;AppKit/CPView.jt;2381;


objj_executeFile("AppKit/CPView.j", false);




{var the_class = objj_allocateClassPair(CPControl, "CPButtonBar"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButtonBar").super_class }, "initWithFrame:", aFrame);

    if (self)
        objj_msgSend(self, "setNeedsLayout");

    return self;
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "bezel-view")
        return objj_msgSend(self, "bounds");

    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButtonBar").super_class }, "rectForEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "bezel-view")
    {
        var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });

        objj_msgSend(view, "setHitTests:", NO);

        return view;
    }

    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButtonBar").super_class }, "createEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var bezelView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "bezel-view", CPWindowBelow, "");

    if (bezelView)
        objj_msgSend(bezelView, "setBackgroundColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-color"));
}
}), new objj_method(sel_getUid("addSubview:"), function(self, _cmd, aSubview)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPButtonBar").super_class }, "addSubview:", aSubview);

    objj_msgSend(aSubview, "setAutoresizingMask:", CPViewMinXMargin);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "button-bar";
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [objj_msgSend(CPNull, "null")], ["bezel-color"]);
}
})]);
}

p;12;CPCheckBox.jt;1299;@STATIC;1.0;i;10;CPButton.jt;1265;objj_executeFile("CPButton.j", true);
{var the_class = objj_allocateClassPair(CPButton, "CPCheckBox"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCheckBox").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        objj_msgSend(self, "setHighlightsBy:", CPContentsCellMask);
        objj_msgSend(self, "setShowsStateBy:", CPContentsCellMask);
        objj_msgSend(self, "setImagePosition:", CPImageLeft);
        objj_msgSend(self, "setAlignment:", CPLeftTextAlignment);
        objj_msgSend(self, "setBordered:", YES);
    }
    return self;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("checkBoxWithTitle:theme:"), function(self, _cmd, aTitle, aTheme)
{ with(self)
{
    return objj_msgSend(self, "buttonWithTitle:theme:", aTitle, aTheme);
}
}), new objj_method(sel_getUid("checkBoxWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    return objj_msgSend(self, "buttonWithTitle:", aTitle);
}
}), new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "check-box";
}
})]);
}

p;12;CPClipView.jt;5276;@STATIC;1.0;i;8;CPView.jt;5245;objj_executeFile("CPView.j", true);
{var the_class = objj_allocateClassPair(CPView, "CPClipView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_documentView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setDocumentView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_documentView == aView)
        return;
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_documentView)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPViewFrameDidChangeNotification, _documentView);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPViewBoundsDidChangeNotification, _documentView);
        objj_msgSend(_documentView, "removeFromSuperview");
    }
    _documentView = aView;
    if (_documentView)
    {
        objj_msgSend(self, "addSubview:", _documentView);
  objj_msgSend(_documentView, "setPostsFrameChangedNotifications:", YES);
  objj_msgSend(_documentView, "setPostsBoundsChangedNotifications:", YES);
  objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("viewFrameChanged:"), CPViewFrameDidChangeNotification, _documentView);
  objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("viewBoundsChanged:"), CPViewBoundsDidChangeNotification, _documentView);
    }
}
}), new objj_method(sel_getUid("documentView"), function(self, _cmd)
{ with(self)
{
    return _documentView;
}
}), new objj_method(sel_getUid("constrainScrollPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    if (!_documentView)
        return { x:0.0, y:0.0 };
    var documentFrame = objj_msgSend(_documentView, "frame");
    aPoint.x = MAX(0.0, MIN(aPoint.x, MAX((documentFrame.size.width) - (_bounds.size.width), 0.0)));
    aPoint.y = MAX(0.0, MIN(aPoint.y, MAX((documentFrame.size.height) - (_bounds.size.height), 0.0)));
    return aPoint;
}
}), new objj_method(sel_getUid("setBoundsOrigin:"), function(self, _cmd, aPoint)
{ with(self)
{
    if ((_bounds.origin.x == aPoint.x && _bounds.origin.y == aPoint.y))
        return;
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPClipView").super_class }, "setBoundsOrigin:", aPoint);
    var superview = objj_msgSend(self, "superview");
    if(objj_msgSend(superview, "isKindOfClass:", objj_msgSend(CPScrollView, "class")))
        objj_msgSend(superview, "reflectScrolledClipView:", self);
}
}), new objj_method(sel_getUid("scrollToPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    objj_msgSend(self, "setBoundsOrigin:", objj_msgSend(self, "constrainScrollPoint:", aPoint));
}
}), new objj_method(sel_getUid("viewBoundsChanged:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "_constrainScrollPoint");
}
}), new objj_method(sel_getUid("viewFrameChanged:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "_constrainScrollPoint");
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPClipView").super_class }, "resizeSubviewsWithOldSize:", aSize);
    objj_msgSend(self, "_constrainScrollPoint");
}
}), new objj_method(sel_getUid("_constrainScrollPoint"), function(self, _cmd)
{ with(self)
{
    var oldScrollPoint = objj_msgSend(self, "bounds").origin;
    objj_msgSend(self, "scrollToPoint:", oldScrollPoint);
    if (!CGPointEqualToPoint(oldScrollPoint, objj_msgSend(self, "bounds").origin))
        return;
    var superview = objj_msgSend(self, "superview");
    if (objj_msgSend(superview, "isKindOfClass:", objj_msgSend(CPScrollView, "class")))
        objj_msgSend(superview, "reflectScrolledClipView:", self);
}
}), new objj_method(sel_getUid("autoscroll:"), function(self, _cmd, anEvent)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        eventLocation = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
    if (CPRectContainsPoint(bounds, eventLocation))
        return NO;
    var newRect = CGRectMakeZero();
    newRect.origin = eventLocation;
    newRect.size = CPSizeMake(10, 10);
 return objj_msgSend(_documentView, "scrollRectToVisible:", newRect);
}
})]);
}
var CPClipViewDocumentViewKey = "CPScrollViewDocumentView";
{
var the_class = objj_getClass("CPClipView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPClipView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPClipView").super_class }, "initWithCoder:", aCoder))
        objj_msgSend(self, "setDocumentView:", objj_msgSend(aCoder, "decodeObjectForKey:", CPClipViewDocumentViewKey));
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPClipView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _documentView, CPClipViewDocumentViewKey);
}
})]);
}

p;18;CPCollectionView.jt;21091;@STATIC;1.0;I;20;Foundation/CPArray.jI;19;Foundation/CPData.jI;23;Foundation/CPIndexSet.jI;28;Foundation/CPKeyedArchiver.jI;30;Foundation/CPKeyedUnarchiver.ji;8;CPView.ji;22;CPCollectionViewItem.jt;20887;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPData.j", false);
objj_executeFile("Foundation/CPIndexSet.j", false);
objj_executeFile("Foundation/CPKeyedArchiver.j", false);
objj_executeFile("Foundation/CPKeyedUnarchiver.j", false);
objj_executeFile("CPView.j", true);
objj_executeFile("CPCollectionViewItem.j", true);
{var the_class = objj_allocateClassPair(CPView, "CPCollectionView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_content"), new objj_ivar("_items"), new objj_ivar("_itemData"), new objj_ivar("_itemPrototype"), new objj_ivar("_itemForDragging"), new objj_ivar("_cachedItems"), new objj_ivar("_maxNumberOfRows"), new objj_ivar("_maxNumberOfColumns"), new objj_ivar("_minItemSize"), new objj_ivar("_maxItemSize"), new objj_ivar("_backgroundColors"), new objj_ivar("_tileWidth"), new objj_ivar("_isSelectable"), new objj_ivar("_allowsMultipleSelection"), new objj_ivar("_allowsEmptySelection"), new objj_ivar("_selectionIndexes"), new objj_ivar("_itemSize"), new objj_ivar("_horizontalMargin"), new objj_ivar("_verticalMargin"), new objj_ivar("_numberOfRows"), new objj_ivar("_numberOfColumns"), new objj_ivar("_delegate"), new objj_ivar("_mouseDownEvent")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCollectionView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _items = [];
        _content = [];
        _cachedItems = [];
        _itemSize = CGSizeMakeZero();
        _minItemSize = CGSizeMakeZero();
        _maxItemSize = CGSizeMakeZero();
        objj_msgSend(self, "setBackgroundColors:", nil);
        _verticalMargin = 5.0;
        _tileWidth = -1.0;
        _selectionIndexes = objj_msgSend(CPIndexSet, "indexSet");
        _allowsEmptySelection = YES;
        _isSelectable = YES;
    }
    return self;
}
}), new objj_method(sel_getUid("setItemPrototype:"), function(self, _cmd, anItem)
{ with(self)
{
    _cachedItems = [];
    _itemData = nil;
    _itemForDragging = nil;
    _itemPrototype = anItem;
    objj_msgSend(self, "reloadContent");
}
}), new objj_method(sel_getUid("itemPrototype"), function(self, _cmd)
{ with(self)
{
    return _itemPrototype;
}
}), new objj_method(sel_getUid("newItemForRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    var item = nil;
    if (_cachedItems.length)
        item = _cachedItems.pop();
    else
    {
        if (!_itemData)
            if (_itemPrototype)
                _itemData = objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", _itemPrototype);
        item = objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", _itemData);
    }
    objj_msgSend(item, "setRepresentedObject:", anObject);
    objj_msgSend(objj_msgSend(item, "view"), "setFrameSize:", _itemSize);
    return item;
}
}), new objj_method(sel_getUid("acceptsFirstResponder"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("isFirstResponder"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "window"), "firstResponder") === self;
}
}), new objj_method(sel_getUid("setContent:"), function(self, _cmd, anArray)
{ with(self)
{
    if (_content == anArray)
        return;
    _content = anArray;
    objj_msgSend(self, "reloadContent");
}
}), new objj_method(sel_getUid("content"), function(self, _cmd)
{ with(self)
{
    return _content;
}
}), new objj_method(sel_getUid("items"), function(self, _cmd)
{ with(self)
{
    return _items;
}
}), new objj_method(sel_getUid("setSelectable:"), function(self, _cmd, isSelectable)
{ with(self)
{
    if (_isSelectable == isSelectable)
        return;
    _isSelectable = isSelectable;
    if (!_isSelectable)
    {
        var index = CPNotFound;
        while ((index = objj_msgSend(_selectionIndexes, "indexGreaterThanIndex:", index)) != CPNotFound)
            objj_msgSend(_items[index], "setSelected:", NO);
    }
}
}), new objj_method(sel_getUid("isSelectable"), function(self, _cmd)
{ with(self)
{
    return _isSelectable;
}
}), new objj_method(sel_getUid("setAllowsEmptySelection:"), function(self, _cmd, shouldAllowEmptySelection)
{ with(self)
{
    _allowsEmptySelection = shouldAllowEmptySelection;
}
}), new objj_method(sel_getUid("allowsEmptySelection"), function(self, _cmd)
{ with(self)
{
    return _allowsEmptySelection;
}
}), new objj_method(sel_getUid("setAllowsMultipleSelection:"), function(self, _cmd, shouldAllowMultipleSelection)
{ with(self)
{
    _allowsMultipleSelection = shouldAllowMultipleSelection;
}
}), new objj_method(sel_getUid("allowsMultipleSelection"), function(self, _cmd)
{ with(self)
{
    return _allowsMultipleSelection;
}
}), new objj_method(sel_getUid("setSelectionIndexes:"), function(self, _cmd, anIndexSet)
{ with(self)
{
    if (_selectionIndexes == anIndexSet || !_isSelectable)
        return;
    var index = CPNotFound;
    while ((index = objj_msgSend(_selectionIndexes, "indexGreaterThanIndex:", index)) != CPNotFound)
        objj_msgSend(_items[index], "setSelected:", NO);
    _selectionIndexes = anIndexSet;
    var index = CPNotFound;
    while ((index = objj_msgSend(_selectionIndexes, "indexGreaterThanIndex:", index)) != CPNotFound)
        objj_msgSend(_items[index], "setSelected:", YES);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("collectionViewDidChangeSelection:")))
        objj_msgSend(_delegate, "collectionViewDidChangeSelection:", self)
}
}), new objj_method(sel_getUid("selectionIndexes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_selectionIndexes, "copy");
}
}), new objj_method(sel_getUid("reloadContent"), function(self, _cmd)
{ with(self)
{
    var count = _items.length;
    while (count--)
    {
        objj_msgSend(objj_msgSend(_items[count], "view"), "removeFromSuperview");
        objj_msgSend(_items[count], "setSelected:", NO);
        _cachedItems.push(_items[count]);
    }
    _items = [];
    if (!_itemPrototype || !_content)
        return;
    var index = 0;
    count = _content.length;
    for (; index < count; ++index)
    {
        _items.push(objj_msgSend(self, "newItemForRepresentedObject:", _content[index]));
        objj_msgSend(self, "addSubview:", objj_msgSend(_items[index], "view"));
    }
    index = CPNotFound;
    while ((index = objj_msgSend(_selectionIndexes, "indexGreaterThanIndex:", index)) != CPNotFound)
        objj_msgSend(_items[index], "setSelected:", YES);
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    var width = CGRectGetWidth(objj_msgSend(self, "bounds"));
    if (!objj_msgSend(_content, "count") || width == _tileWidth)
        return;
    var itemSize = CGSizeMakeCopy(_minItemSize);
    _numberOfColumns = MAX(1.0, FLOOR(width / itemSize.width));
    if (_maxNumberOfColumns > 0)
        _numberOfColumns = MIN(_maxNumberOfColumns, _numberOfColumns);
    var remaining = width - _numberOfColumns * itemSize.width,
        itemsNeedSizeUpdate = NO;
    if (remaining > 0 && itemSize.width < _maxItemSize.width)
        itemSize.width = MIN(_maxItemSize.width, itemSize.width + FLOOR(remaining / _numberOfColumns));
    if (_maxNumberOfColumns == 1 && itemSize.width < _maxItemSize.width && itemSize.width < width)
        itemSize.width = MIN(_maxItemSize.width, width);
    if (!CGSizeEqualToSize(_itemSize, itemSize))
    {
        _itemSize = itemSize;
        itemsNeedSizeUpdate = YES;
    }
    var index = 0,
        count = _items.length;
    if (_maxNumberOfColumns > 0 && _maxNumberOfRows > 0)
        count = MIN(count, _maxNumberOfColumns * _maxNumberOfRows);
    _numberOfRows = CEIL(count / _numberOfColumns);
    _horizontalMargin = FLOOR((width - _numberOfColumns * itemSize.width) / (_numberOfColumns + 1));
    var x = _horizontalMargin,
        y = -itemSize.height;
    for (; index < count; ++index)
    {
        if (index % _numberOfColumns == 0)
        {
            x = _horizontalMargin;
            y += _verticalMargin + itemSize.height;
        }
        var view = objj_msgSend(_items[index], "view");
        objj_msgSend(view, "setFrameOrigin:", CGPointMake(x, y));
        if (itemsNeedSizeUpdate)
            objj_msgSend(view, "setFrameSize:", _itemSize);
        x += itemSize.width + _horizontalMargin;
    }
    _tileWidth = width;
    objj_msgSend(self, "setFrameSize:", CGSizeMake(width, y + itemSize.height + _verticalMargin));
    _tileWidth = -1.0;
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("setMaxNumberOfRows:"), function(self, _cmd, aMaxNumberOfRows)
{ with(self)
{
    if (_maxNumberOfRows == aMaxNumberOfRows)
        return;
    _maxNumberOfRows = aMaxNumberOfRows;
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("maxNumberOfRows"), function(self, _cmd)
{ with(self)
{
    return _maxNumberOfRows;
}
}), new objj_method(sel_getUid("setMaxNumberOfColumns:"), function(self, _cmd, aMaxNumberOfColumns)
{ with(self)
{
    if (_maxNumberOfColumns == aMaxNumberOfColumns)
        return;
    _maxNumberOfColumns = aMaxNumberOfColumns;
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("maxNumberOfColumns"), function(self, _cmd)
{ with(self)
{
    return _maxNumberOfColumns;
}
}), new objj_method(sel_getUid("numberOfRows"), function(self, _cmd)
{ with(self)
{
    return _numberOfRows;
}
}), new objj_method(sel_getUid("numberOfColumns"), function(self, _cmd)
{ with(self)
{
    return _numberOfColumns;
}
}), new objj_method(sel_getUid("setMinItemSize:"), function(self, _cmd, aSize)
{ with(self)
{
    if (CGSizeEqualToSize(_minItemSize, aSize))
        return;
    _minItemSize = CGSizeMakeCopy(aSize);
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("minItemSize"), function(self, _cmd)
{ with(self)
{
    return _minItemSize;
}
}), new objj_method(sel_getUid("setMaxItemSize:"), function(self, _cmd, aSize)
{ with(self)
{
    if (CGSizeEqualToSize(_maxItemSize, aSize))
        return;
    _maxItemSize = CGSizeMakeCopy(aSize);
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("maxItemSize"), function(self, _cmd)
{ with(self)
{
    return _maxItemSize;
}
}), new objj_method(sel_getUid("setBackgroundColors:"), function(self, _cmd, backgroundColors)
{ with(self)
{
    if (_backgroundColors === backgroundColors)
        return;
    _backgroundColors = backgroundColors;
    if (!_backgroundColors)
        _backgroundColors = objj_msgSend(CPColor, "whiteColor");
    if (objj_msgSend(_backgroundColors, "count") === 1)
        objj_msgSend(self, "setBackgroundColor:", _backgroundColors[0]);
    else
        objj_msgSend(self, "setBackgroundColor:", nil);
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("backgroundColors"), function(self, _cmd)
{ with(self)
{
    return _backgroundColors;
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (objj_msgSend(_selectionIndexes, "count") && objj_msgSend(anEvent, "clickCount") == 2 && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("collectionView:didDoubleClickOnItemAtIndex:")))
        objj_msgSend(_delegate, "collectionView:didDoubleClickOnItemAtIndex:", self, objj_msgSend(_selectionIndexes, "firstIndex"));
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    _mouseDownEvent = anEvent;
    var location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil),
        row = FLOOR(location.y / (_itemSize.height + _verticalMargin)),
        column = FLOOR(location.x / (_itemSize.width + _horizontalMargin)),
        index = row * _numberOfColumns + column;
    if (index >= 0 && index < _items.length)
        objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", index));
    else if (_allowsEmptySelection)
        objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSet"));
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("collectionView:dragTypesForItemsAtIndexes:")))
        return;
    if (!objj_msgSend(_selectionIndexes, "count"))
        return;
    var dragTypes = objj_msgSend(_delegate, "collectionView:dragTypesForItemsAtIndexes:", self, _selectionIndexes);
    objj_msgSend(objj_msgSend(CPPasteboard, "pasteboardWithName:", CPDragPboard), "declareTypes:owner:", dragTypes, self);
    var point = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
    if (!_itemForDragging)
        _itemForDragging = objj_msgSend(self, "newItemForRepresentedObject:", _content[objj_msgSend(_selectionIndexes, "firstIndex")]);
    else
        objj_msgSend(_itemForDragging, "setRepresentedObject:", _content[objj_msgSend(_selectionIndexes, "firstIndex")]);
    var view = objj_msgSend(_itemForDragging, "view");
    objj_msgSend(view, "setFrameSize:", _itemSize);
    objj_msgSend(view, "setAlphaValue:", 0.7);
    objj_msgSend(self, "dragView:at:offset:event:pasteboard:source:slideBack:", view, objj_msgSend(objj_msgSend(_items[objj_msgSend(_selectionIndexes, "firstIndex")], "view"), "frame").origin, CGSizeMakeZero(), _mouseDownEvent, nil, self, YES);
}
}), new objj_method(sel_getUid("pasteboard:provideDataForType:"), function(self, _cmd, aPasteboard, aType)
{ with(self)
{
    objj_msgSend(aPasteboard, "setData:forType:", objj_msgSend(_delegate, "collectionView:dataForItemsAtIndexes:forType:", self, _selectionIndexes, aType), aType);
}
}), new objj_method(sel_getUid("setVerticalMargin:"), function(self, _cmd, aVerticalMargin)
{ with(self)
{
    if (_verticalMargin == aVerticalMargin)
        return;
    _verticalMargin = aVerticalMargin;
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("verticalMargin"), function(self, _cmd)
{ with(self)
{
    return _verticalMargin;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
})]);
}
{
var the_class = objj_getClass("CPCollectionView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPCollectionView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("rectForItemAtIndex:"), function(self, _cmd, index)
{ with(self)
{
    return objj_msgSend(objj_msgSend(_items[index], "view"), "frame");
}
}), new objj_method(sel_getUid("rectForItemsAtIndexes:"), function(self, _cmd, indexSet)
{ with(self)
{
    var indexArray = [],
        rect = nil;
    objj_msgSend(indexSet, "getIndexes:maxCount:inIndexRange:", indexArray, -1, nil);
    for (var i = 0, count = indexArray.length; i < count; ++i)
    {
        var index = indexArray[i];
        if (rect == nil)
            rect = objj_msgSend(self, "rectForItemAtIndex:", index);
        else
            rect = CGRectUnion(rect, objj_msgSend(self, "rectForItemAtIndex:", index));
    }
    return rect;
}
}), new objj_method(sel_getUid("_scrollToSelection"), function(self, _cmd)
{ with(self)
{
    var rect = objj_msgSend(self, "rectForItemsAtIndexes:", objj_msgSend(self, "selectionIndexes"));
    if (rect)
        objj_msgSend(self, "scrollRectToVisible:", rect);
}
}), new objj_method(sel_getUid("moveLeft:"), function(self, _cmd, sender)
{ with(self)
{
    var index = objj_msgSend(objj_msgSend(self, "selectionIndexes"), "firstIndex");
    if (index === CPNotFound)
        index = objj_msgSend(objj_msgSend(self, "items"), "count");
    index = MAX(index - 1, 0);
    objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", index));
    objj_msgSend(self, "_scrollToSelection");
}
}), new objj_method(sel_getUid("moveRight:"), function(self, _cmd, sender)
{ with(self)
{
    var index = MIN(objj_msgSend(objj_msgSend(self, "selectionIndexes"), "firstIndex") + 1, objj_msgSend(objj_msgSend(self, "items"), "count")-1);
    objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", index));
    objj_msgSend(self, "_scrollToSelection");
}
}), new objj_method(sel_getUid("moveDown:"), function(self, _cmd, sender)
{ with(self)
{
    var index = MIN(objj_msgSend(objj_msgSend(self, "selectionIndexes"), "firstIndex") + objj_msgSend(self, "numberOfColumns"), objj_msgSend(objj_msgSend(self, "items"), "count")-1);
    objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", index));
    objj_msgSend(self, "_scrollToSelection");
}
}), new objj_method(sel_getUid("moveUp:"), function(self, _cmd, sender)
{ with(self)
{
    var index = objj_msgSend(objj_msgSend(self, "selectionIndexes"), "firstIndex");
    if (index == CPNotFound)
        index = objj_msgSend(objj_msgSend(self, "items"), "count");
    index = MAX(0, index - objj_msgSend(self, "numberOfColumns"));
    objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", index));
    objj_msgSend(self, "_scrollToSelection");
}
}), new objj_method(sel_getUid("deleteBackwards:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(objj_msgSend(self, "delegate"), "respondsToSelector:", sel_getUid("collectionView:shouldDeleteItemsAtIndexes:")))
    {
        objj_msgSend(objj_msgSend(self, "delegate"), "collectionView:shouldDeleteItemsAtIndexes:", self, objj_msgSend(self, "selectionIndexes"));
        var index = objj_msgSend(objj_msgSend(self, "selectionIndexes"), "firstIndex");
        if (index > objj_msgSend(objj_msgSend(self, "content"), "count")-1)
            objj_msgSend(self, "setSelectionIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", objj_msgSend(objj_msgSend(self, "content"), "count")-1));
        objj_msgSend(self, "_scrollToSelection");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
}
}), new objj_method(sel_getUid("keyDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "interpretKeyEvents:", [anEvent]);
}
})]);
}
var CPCollectionViewMinItemSizeKey = "CPCollectionViewMinItemSizeKey",
    CPCollectionViewMaxItemSizeKey = "CPCollectionViewMaxItemSizeKey",
    CPCollectionViewVerticalMarginKey = "CPCollectionViewVerticalMarginKey",
    CPCollectionViewSelectableKey = "CPCollectionViewSelectableKey",
    CPCollectionViewBackgroundColorsKey = "CPCollectionViewBackgroundColorsKey";
{
var the_class = objj_getClass("CPCollectionView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPCollectionView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCollectionView").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _items = [];
        _content = [];
        _cachedItems = [];
        _itemSize = CGSizeMakeZero();
        _minItemSize = objj_msgSend(aCoder, "decodeSizeForKey:", CPCollectionViewMinItemSizeKey) || CGSizeMakeZero();
        _maxItemSize = objj_msgSend(aCoder, "decodeSizeForKey:", CPCollectionViewMaxItemSizeKey) || CGSizeMakeZero();
        _verticalMargin = objj_msgSend(aCoder, "decodeFloatForKey:", CPCollectionViewVerticalMarginKey);
        _isSelectable = objj_msgSend(aCoder, "decodeBoolForKey:", CPCollectionViewSelectableKey);
        objj_msgSend(self, "setBackgroundColors:", objj_msgSend(aCoder, "decodeObjectForKey:", CPCollectionViewBackgroundColorsKey));
        _tileWidth = -1.0;
        _selectionIndexes = objj_msgSend(CPIndexSet, "indexSet");
        _allowsEmptySelection = YES;
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCollectionView").super_class }, "encodeWithCoder:", aCoder);
    if (!CGSizeEqualToSize(_minItemSize, CGSizeMakeZero()))
      objj_msgSend(aCoder, "encodeSize:forKey:", _minItemSize, CPCollectionViewMinItemSizeKey);
    if (!CGSizeEqualToSize(_maxItemSize, CGSizeMakeZero()))
      objj_msgSend(aCoder, "encodeSize:forKey:", _maxItemSize, CPCollectionViewMaxItemSizeKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isSelectable, CPCollectionViewSelectableKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _verticalMargin, CPCollectionViewVerticalMarginKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _backgroundColors, CPCollectionViewBackgroundColorsKey);
}
})]);
}

p;22;CPCollectionViewItem.jt;1478;@STATIC;1.0;i;18;CPViewController.jt;1436;objj_executeFile("CPViewController.j", true);
{var the_class = objj_allocateClassPair(CPViewController, "CPCollectionViewItem"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_isSelected")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCollectionViewItem").super_class }, "setRepresentedObject:", anObject);
    var view = objj_msgSend(self, "view");
    if (objj_msgSend(view, "respondsToSelector:", sel_getUid("setRepresentedObject:")))
        objj_msgSend(view, "setRepresentedObject:", objj_msgSend(self, "representedObject"));
}
}), new objj_method(sel_getUid("setSelected:"), function(self, _cmd, shouldBeSelected)
{ with(self)
{
    shouldBeSelected = !!shouldBeSelected;
    if (_isSelected === shouldBeSelected)
        return;
    _isSelected = shouldBeSelected;
    var view = objj_msgSend(self, "view");
    if (objj_msgSend(view, "respondsToSelector:", sel_getUid("setSelected:")))
        objj_msgSend(view, "setSelected:", objj_msgSend(self, "isSelected"));
}
}), new objj_method(sel_getUid("isSelected"), function(self, _cmd)
{ with(self)
{
    return _isSelected;
}
}), new objj_method(sel_getUid("collectionView"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_view, "superview");
}
})]);
}

p;9;CPColor.jt;20960;@STATIC;1.0;I;21;Foundation/CPObject.ji;9;CGColor.ji;17;CPCompatibility.ji;9;CPImage.jt;20866;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("CGColor.j", true);
objj_executeFile("CPCompatibility.j", true);
objj_executeFile("CPImage.j", true);
var _redComponent = 0,
    _greenComponent = 1,
    _blueComponent = 2,
    _alphaCompnent = 3;
var _hueComponent = 0,
    _saturationComponent = 1,
    _brightnessComponent = 2;
var cachedBlackColor,
    cachedRedColor,
    cachedGreenColor,
    cachedBlueColor,
    cachedYellowColor,
    cachedGrayColor,
    cachedLightGrayColor,
    cachedDarkGrayColor,
    cachedWhiteColor,
    cachedBrownColor,
    cachedCyanColor,
    cachedMagentaColor,
    cachedOrangeColor,
    cachedPurpleColor,
    cachedShadowColor,
    cachedClearColor;
{var the_class = objj_allocateClassPair(CPObject, "CPColor"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_components"), new objj_ivar("_patternImage"), new objj_ivar("_cssString")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_initWithCSSString:"), function(self, _cmd, aString)
{ with(self)
{
    if(aString.indexOf("rgb") == CPNotFound)
        return nil;
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColor").super_class }, "init");
    var startingIndex = aString.indexOf("(");
    var parts = aString.substring(startingIndex+1).split(',');
    _components = [
        parseInt(parts[0], 10) / 255.0,
        parseInt(parts[1], 10) / 255.0,
        parseInt(parts[2], 10) / 255.0,
        parts[3] ? parseInt(parts[3], 10) / 255.0 : 1.0
    ]
    _cssString = aString;
    return self;
}
}), new objj_method(sel_getUid("_initWithRGBA:"), function(self, _cmd, components)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColor").super_class }, "init");
    if (self)
    {
        _components = components;
  if (!CPFeatureIsCompatible(CPCSSRGBAFeature) && _components[3] != 1.0 && window.Base64 && window.CRC32)
  {
   var bytes = [0x89,0x50,0x4e,0x47,0xd,0xa,0x1a,0xa,0x0,0x0,0x0,0xd,0x49,0x48,0x44,0x52,0x0,0x0,0x0,0x1,0x0,0x0,0x0,0x1,0x8,0x3,0x0,0x0,0x0,0x28,0xcb,0x34,0xbb,0x0,0x0,0x3,0x0,0x50,0x4c,0x54,0x45,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x17,0x89,0x99,0x55,0x0,0x0,0x0,0x1,0x74,0x52,0x4e,0x53,0x0,0x40,0xe6,0xd8,0x66,0x0,0x0,0x0,0x10,0x49,0x44,0x41,0x54,0x78,0xda,0x62,0x60,0x0,0x0,0x0,0x0,0xff,0xff,0x3,0x0,0x0,0x2,0x0,0x1,0x24,0x7f,0x24,0xf1,0x0,0x0,0x0,0x0,0x49,0x45,0x4e,0x44,0xae,0x42,0x60,0x82,0xff];
   var r_off = 41;
   var g_off = 42;
   var b_off = 43;
   var a_off = 821;
   var plte_crc_off = 809;
   var trns_crc_off = 822;
   var plte_type_off = 37;
   var trns_type_off = 817;
   bytes[r_off] = Math.round(_components[0]*255);
   bytes[g_off] = Math.round(_components[1]*255);
   bytes[b_off] = Math.round(_components[2]*255);
   bytes[a_off] = Math.round(_components[3]*255);
   var new_plte_crc = integerToBytes(CRC32.getCRC(bytes, plte_type_off, 4+768), 4);
   var new_trns_crc = integerToBytes(CRC32.getCRC(bytes, trns_type_off, 4+1), 4);
   for (var i = 0; i < 4; i++)
   {
    bytes[plte_crc_off+i] = new_plte_crc[i];
    bytes[trns_crc_off+i] = new_trns_crc[i];
   }
   var base64image = Base64.encode(bytes);
   _cssString = "url(\"data:image/png;base64," + base64image + "\")";
  }
  else
  {
         var hasAlpha = CPFeatureIsCompatible(CPCSSRGBAFeature) && _components[3] != 1.0;
         _cssString = (hasAlpha ? "rgba(" : "rgb(") +
             parseInt(_components[0] * 255.0) + ", " +
             parseInt(_components[1] * 255.0) + ", " +
             parseInt(_components[2] * 255.0) +
             (hasAlpha ? (", " + _components[3]) : "") + ")";
  }
    }
    return self;
}
}), new objj_method(sel_getUid("_initWithPatternImage:"), function(self, _cmd, anImage)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColor").super_class }, "init");
    if (self)
    {
        _patternImage = anImage;
        _cssString = "url(\"" + objj_msgSend(_patternImage, "filename") + "\")";
    }
    return self;
}
}), new objj_method(sel_getUid("patternImage"), function(self, _cmd)
{ with(self)
{
    return _patternImage;
}
}), new objj_method(sel_getUid("alphaComponent"), function(self, _cmd)
{ with(self)
{
    return _components[3];
}
}), new objj_method(sel_getUid("blueComponent"), function(self, _cmd)
{ with(self)
{
    return _components[2];
}
}), new objj_method(sel_getUid("greenComponent"), function(self, _cmd)
{ with(self)
{
    return _components[1];
}
}), new objj_method(sel_getUid("redComponent"), function(self, _cmd)
{ with(self)
{
    return _components[0];
}
}), new objj_method(sel_getUid("components"), function(self, _cmd)
{ with(self)
{
    return _components;
}
}), new objj_method(sel_getUid("colorWithAlphaComponent:"), function(self, _cmd, anAlphaComponent)
{ with(self)
{
    var components = _components.slice();
    components[components.length - 1] = anAlphaComponent;
    return objj_msgSend(objj_msgSend(objj_msgSend(self, "class"), "alloc"), "_initWithRGBA:", components);
}
}), new objj_method(sel_getUid("hsbComponents"), function(self, _cmd)
{ with(self)
{
    var red = ROUND(_components[_redComponent] * 255.0),
        green = ROUND(_components[_greenComponent] * 255.0),
        blue = ROUND(_components[_blueComponent] * 255.0);
    var max = MAX(red, green, blue),
        min = MIN(red, green, blue),
        delta = max - min;
    var brightness = max / 255.0,
        saturation = (max != 0) ? delta / max : 0;
    var hue;
    if(saturation == 0)
        hue = 0;
    else
    {
        var rr = (max - red) / delta;
        var gr = (max - green) / delta;
        var br = (max - blue) / delta;
        if (red == max)
            hue = br - gr;
        else if (green == max)
            hue = 2 + rr - br;
        else
            hue = 4 + gr - rr;
        hue /= 6;
        if (hue < 0)
            hue++;
    }
    return [
        ROUND(hue * 360.0),
        ROUND(saturation * 100.0),
        ROUND(brightness * 100.0)
    ];
}
}), new objj_method(sel_getUid("cssString"), function(self, _cmd)
{ with(self)
{
    return _cssString;
}
}), new objj_method(sel_getUid("hexString"), function(self, _cmd)
{ with(self)
{
    return rgbToHex(objj_msgSend(self, "redComponent"), objj_msgSend(self, "greenComponent"), objj_msgSend(self, "blueComponent"))
}
}), new objj_method(sel_getUid("isEqual:"), function(self, _cmd, aColor)
{ with(self)
{
    if (!aColor)
        return NO;
    if (aColor === self)
        return YES;
    return objj_msgSend(aColor, "isKindOfClass:", CPColor) && objj_msgSend(aColor, "cssString") === objj_msgSend(self, "cssString");
}
}), new objj_method(sel_getUid("description"), function(self, _cmd)
{ with(self)
{
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColor").super_class }, "description")+" "+objj_msgSend(self, "cssString");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("colorWithRed:green:blue:alpha:"), function(self, _cmd, red, green, blue, alpha)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [red, green, blue, alpha]);
}
}), new objj_method(sel_getUid("colorWithCalibratedRed:green:blue:alpha:"), function(self, _cmd, red, green, blue, alpha)
{ with(self)
{
    return objj_msgSend(self, "colorWithRed:green:blue:alpha:", red, green, blue, alpha);
}
}), new objj_method(sel_getUid("colorWithWhite:alpha:"), function(self, _cmd, white, alpha)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [white, white, white, alpha]);
}
}), new objj_method(sel_getUid("colorWithCalibratedWhite:alpha:"), function(self, _cmd, white, alpha)
{ with(self)
{
    return objj_msgSend(self, "colorWithWhite:alpha:", white, alpha);
}
}), new objj_method(sel_getUid("colorWithHue:saturation:brightness:"), function(self, _cmd, hue, saturation, brightness)
{ with(self)
{
    return objj_msgSend(self, "colorWithHue:saturation:brightness:alpha:", hue, saturation, brightness, 1.0);
}
}), new objj_method(sel_getUid("colorWithHue:saturation:brightness:alpha:"), function(self, _cmd, hue, saturation, brightness, alpha)
{ with(self)
{
    if(saturation === 0.0)
        return objj_msgSend(CPColor, "colorWithCalibratedWhite:alpha:", brightness / 100.0, alpha);
    var f = hue % 60,
        p = (brightness * (100 - saturation)) / 10000,
        q = (brightness * (6000 - saturation * f)) / 600000,
        t = (brightness * (6000 - saturation * (60 -f))) / 600000,
        b = brightness / 100.0;
    switch(FLOOR(hue / 60))
    {
        case 0: return objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  b,  t,  p,  alpha);
        case 1: return objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  q,  b,  p,  alpha);
        case 2: return objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  p,  b,  t,  alpha);
        case 3: return objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  p,  q,  b,  alpha);
        case 4: return objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  t,  p,  b,  alpha);
        case 5: return objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  b,  p,  q,  alpha);
    }
}
}), new objj_method(sel_getUid("colorWithHexString:"), function(self, _cmd, hex)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:",  hexToRGB(hex));
}
}), new objj_method(sel_getUid("blackColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedBlackColor)
        cachedBlackColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.0, 0.0, 0.0, 1.0]);
    return cachedBlackColor;
}
}), new objj_method(sel_getUid("blueColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedBlueColor)
        cachedBlueColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.0, 0.0, 1.0, 1.0]);
    return cachedBlueColor;
}
}), new objj_method(sel_getUid("darkGrayColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedDarkGrayColor)
        cachedDarkGrayColor = objj_msgSend(CPColor, "colorWithCalibratedWhite:alpha:", 1.0 / 3.0, 1.0);
    return cachedDarkGrayColor;
}
}), new objj_method(sel_getUid("grayColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedGrayColor)
        cachedGrayColor = objj_msgSend(CPColor, "colorWithCalibratedWhite:alpha:", 0.5,  1.0);
    return cachedGrayColor;
}
}), new objj_method(sel_getUid("greenColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedGreenColor)
        cachedGreenColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.0, 1.0, 0.0, 1.0]);
    return cachedGreenColor;
}
}), new objj_method(sel_getUid("lightGrayColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedLightGrayColor)
        cachedLightGrayColor = objj_msgSend(CPColor, "colorWithCalibratedWhite:alpha:", 2.0 / 3.0, 1.0);
    return cachedLightGrayColor;
}
}), new objj_method(sel_getUid("redColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedRedColor)
        cachedRedColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [1.0, 0.0, 0.0, 1.0]);
    return cachedRedColor;
}
}), new objj_method(sel_getUid("whiteColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedWhiteColor)
        cachedWhiteColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [1.0, 1.0, 1.0, 1.0]);
    return cachedWhiteColor;
}
}), new objj_method(sel_getUid("yellowColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedYellowColor)
        cachedYellowColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [1.0, 1.0, 0.0, 1.0]);
    return cachedYellowColor;
}
}), new objj_method(sel_getUid("brownColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedBrownColor)
        cachedBrownColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.6, 0.4, 0.2, 1.0]);
    return cachedBrownColor;
}
}), new objj_method(sel_getUid("cyanColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedCyanColor)
        cachedCyanColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.0, 1.0, 1.0, 1.0]);
    return cachedCyanColor;
}
}), new objj_method(sel_getUid("magentaColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedMagentaColor)
        cachedMagentaColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [1.0, 0.0, 1.0, 1.0]);
    return cachedMagentaColor;
}
}), new objj_method(sel_getUid("orangeColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedOrangeColor)
        cachedOrangeColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [1.0, 0.5, 0.0, 1.0]);
    return cachedOrangeColor;
}
}), new objj_method(sel_getUid("purpleColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedPurpleColor)
        cachedPurpleColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.5, 0.0, 0.5, 1.0]);
    return cachedPurpleColor;
}
}), new objj_method(sel_getUid("shadowColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedShadowColor)
        cachedShadowColor = objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.0, 0.0, 0.0, 1.0 / 3.0]);
    return cachedShadowColor;
}
}), new objj_method(sel_getUid("clearColor"), function(self, _cmd)
{ with(self)
{
    if (!cachedClearColor)
        cachedClearColor = objj_msgSend(self, "colorWithCalibratedWhite:alpha:", 0.0, 0.0);
    return cachedClearColor;
}
}), new objj_method(sel_getUid("alternateSelectedControlColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.22, 0.46, 0.84, 1.0]);
}
}), new objj_method(sel_getUid("secondarySelectedControlColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithRGBA:", [0.83, 0.83, 0.83, 1.0]);
}
}), new objj_method(sel_getUid("colorWithPatternImage:"), function(self, _cmd, anImage)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithPatternImage:", anImage);
}
}), new objj_method(sel_getUid("colorWithCSSString:"), function(self, _cmd, aString)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPColor, "alloc"), "_initWithCSSString:",  aString);
}
})]);
}
{
var the_class = objj_getClass("CPColor")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPColor\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("set"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "setFill");
    objj_msgSend(self, "setStroke");
}
}), new objj_method(sel_getUid("setFill"), function(self, _cmd)
{ with(self)
{
    var ctx = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextSetFillColor(ctx, self);
}
}), new objj_method(sel_getUid("setStroke"), function(self, _cmd)
{ with(self)
{
    var ctx = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextSetStrokeColor(ctx, self);
}
})]);
}
{
var the_class = objj_getClass("CPColor")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPColor\"");
var meta_class = the_class.isa;class_addMethods(meta_class, [new objj_method(sel_getUid("randomColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPColor, "colorWithRed:green:blue:alpha:", RAND(), RAND(), RAND(), 1.0);
}
})]);
}
var CPColorComponentsKey = "CPColorComponentsKey",
    CPColorPatternImageKey = "CPColorPatternImageKey";
{
var the_class = objj_getClass("CPColor")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPColor\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (objj_msgSend(aCoder, "containsValueForKey:", CPColorPatternImageKey))
        return objj_msgSend(self, "_initWithPatternImage:", objj_msgSend(aCoder, "decodeObjectForKey:", CPColorPatternImageKey));
    return objj_msgSend(self, "_initWithRGBA:", objj_msgSend(aCoder, "decodeObjectForKey:", CPColorComponentsKey));
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (_patternImage)
        objj_msgSend(aCoder, "encodeObject:forKey:", _patternImage, CPColorPatternImageKey);
    else
        objj_msgSend(aCoder, "encodeObject:forKey:", _components, CPColorComponentsKey);
}
})]);
}
var hexCharacters = "0123456789ABCDEF";
var hexToRGB, integerToBytes, rgbToHex, byteToHex;
hexToRGB= function(hex)
{
    if ( hex.length == 3 )
        hex = hex.charAt(0) + hex.charAt(0) + hex.charAt(1) + hex.charAt(1) + hex.charAt(2) + hex.charAt(2);
    if(hex.length != 6)
        return null;
    hex = hex.toUpperCase();
    for(var i=0; i<hex.length; i++)
        if(hexCharacters.indexOf(hex.charAt(i)) == -1)
            return null;
    var red = (hexCharacters.indexOf(hex.charAt(0)) * 16 + hexCharacters.indexOf(hex.charAt(1))) / 255.0;
    var green = (hexCharacters.indexOf(hex.charAt(2)) * 16 + hexCharacters.indexOf(hex.charAt(3))) / 255.0;
    var blue = (hexCharacters.indexOf(hex.charAt(4)) * 16 + hexCharacters.indexOf(hex.charAt(5))) / 255.0;
    return [red, green, blue, 1.0];
}
integerToBytes= function(integer, length) {
 if (!length)
  length = (integer == 0) ? 1 : Math.round((Math.log(integer)/Math.log(2))/8+0.5);
 var bytes = new Array(length);
 for (var i = length-1; i >= 0; i--) {
  bytes[i] = integer & 255;
  integer = integer >> 8
 }
 return bytes;
}
rgbToHex= function(r,g,b) {
    return byteToHex(r) + byteToHex(g) + byteToHex(b);
}
byteToHex= function(n) {
    if (!n || isNaN(n)) return "00";
    n = ROUND(MIN(255,MAX(0,256*n)));
    return hexCharacters.charAt((n - n % 16) / 16) +
            hexCharacters.charAt(n % 16);
}

p;14;CPColorPanel.jt;21228;@STATIC;1.0;i;10;CPButton.ji;10;CPCookie.ji;9;CPPanel.ji;8;CPView.ji;15;CPColorPicker.ji;21;CPSliderColorPicker.jt;21107;objj_executeFile("CPButton.j", true);
objj_executeFile("CPCookie.j", true);
objj_executeFile("CPPanel.j", true);
objj_executeFile("CPView.j", true);
CPColorPanelColorDidChangeNotification = "CPColorPanelColorDidChangeNotification";
var PREVIEW_HEIGHT = 20.0,
    TOOLBAR_HEIGHT = 32.0,
    SWATCH_HEIGHT = 14.0,
    ICON_WIDTH = 32.0,
    ICON_PADDING = 12.0;
var SharedColorPanel = nil,
    ColorPickerClasses = [];
CPWheelColorPickerMode = 1;
CPSliderColorPickerMode = 2;
CPColorPickerViewWidth = 265,
CPColorPickerViewHeight = 370;
{var the_class = objj_allocateClassPair(CPPanel, "CPColorPanel"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_toolbar"), new objj_ivar("_swatchView"), new objj_ivar("_previewView"), new objj_ivar("_opacitySlider"), new objj_ivar("_colorPickers"), new objj_ivar("_currentView"), new objj_ivar("_activePicker"), new objj_ivar("_color"), new objj_ivar("_target"), new objj_ivar("_action"), new objj_ivar("_mode")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorPanel").super_class }, "initWithContentRect:styleMask:", CGRectMake(500.0, 50.0, 219.0, 370.0), (CPTitledWindowMask | CPClosableWindowMask | CPResizableWindowMask));
    if (self)
    {
        objj_msgSend(objj_msgSend(self, "contentView"), "setBackgroundColor:", objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.95, 1.0));
        objj_msgSend(self, "setTitle:", "Color Panel");
        objj_msgSend(self, "setLevel:", CPFloatingWindowLevel);
        objj_msgSend(self, "setFloatingPanel:", YES);
        objj_msgSend(self, "setBecomesKeyOnlyIfNeeded:", YES);
        objj_msgSend(self, "setMinSize:", CGSizeMake(219.0, 342.0));
        objj_msgSend(self, "setMaxSize:", CGSizeMake(323.0, 537.0));
    }
    return self;
}
}), new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    _color = aColor;
    objj_msgSend(_previewView, "setBackgroundColor:",  _color);
    objj_msgSend(CPApp, "sendAction:to:from:", sel_getUid("changeColor:"), nil, self);
    if (_target && _action)
        objj_msgSend(CPApp, "sendAction:to:from:", _action, _target, self);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPColorPanelColorDidChangeNotification, self);
    objj_msgSend(_activePicker, "setColor:", _color);
    objj_msgSend(_opacitySlider, "setFloatValue:", objj_msgSend(_color, "alphaComponent"));
}
}), new objj_method(sel_getUid("setColor:updatePicker:"), function(self, _cmd, aColor, bool)
{ with(self)
{
    objj_msgSend(self, "setColor:", aColor);
    if (bool)
        objj_msgSend(_activePicker, "setColor:", _color);
}
}), new objj_method(sel_getUid("color"), function(self, _cmd)
{ with(self)
{
    return _color;
}
}), new objj_method(sel_getUid("opacity"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_opacitySlider, "floatValue");
}
}), new objj_method(sel_getUid("setTarget:"), function(self, _cmd, aTarget)
{ with(self)
{
    _target = aTarget;
}
}), new objj_method(sel_getUid("target"), function(self, _cmd)
{ with(self)
{
    return _target;
}
}), new objj_method(sel_getUid("setAction:"), function(self, _cmd, anAction)
{ with(self)
{
    _action = anAction;
}
}), new objj_method(sel_getUid("action"), function(self, _cmd)
{ with(self)
{
    return _action;
}
}), new objj_method(sel_getUid("setMode:"), function(self, _cmd, mode)
{ with(self)
{
    _mode = mode;
}
}), new objj_method(sel_getUid("_setPicker:"), function(self, _cmd, sender)
{ with(self)
{
    var picker = _colorPickers[objj_msgSend(sender, "tag")],
        view = objj_msgSend(picker, "provideNewView:", NO);
    if (!view)
        view = objj_msgSend(picker, "provideNewView:", YES);
    if (view == _currentView)
        return;
    if (_currentView)
        objj_msgSend(view, "setFrame:", objj_msgSend(_currentView, "frame"));
    else
    {
        var height = (TOOLBAR_HEIGHT+10+PREVIEW_HEIGHT+5+SWATCH_HEIGHT+32),
            bounds = objj_msgSend(objj_msgSend(self, "contentView"), "bounds");
        objj_msgSend(view, "setFrameSize:",  CPSizeMake(bounds.size.width - 10, bounds.size.height - height));
        objj_msgSend(view, "setFrameOrigin:",  CPPointMake(5, height));
    }
    objj_msgSend(_currentView, "removeFromSuperview");
    objj_msgSend(objj_msgSend(self, "contentView"), "addSubview:", view);
    _currentView = view;
    _activePicker = picker;
    objj_msgSend(picker, "setColor:", objj_msgSend(self, "color"));
}
}), new objj_method(sel_getUid("mode"), function(self, _cmd)
{ with(self)
{
    return _mode;
}
}), new objj_method(sel_getUid("orderFront:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "_loadContentsIfNecessary");
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorPanel").super_class }, "orderFront:", aSender);
}
}), new objj_method(sel_getUid("_loadContentsIfNecessary"), function(self, _cmd)
{ with(self)
{
    if (_toolbar)
        return;
    if (!_color)
        _color = objj_msgSend(CPColor, "whiteColor");
    _colorPickers = [];
    var count = objj_msgSend(ColorPickerClasses, "count");
    for (var i=0; i<count; i++)
    {
        var currentPickerClass = ColorPickerClasses[i],
            currentPicker = objj_msgSend(objj_msgSend(currentPickerClass, "alloc"), "initWithPickerMask:colorPanel:", 0, self);
        _colorPickers.push(currentPicker);
    }
    var contentView = objj_msgSend(self, "contentView"),
        bounds = objj_msgSend(contentView, "bounds");
    _toolbar = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0, 6, CGRectGetWidth(bounds), TOOLBAR_HEIGHT));
    objj_msgSend(_toolbar, "setAutoresizingMask:",  CPViewWidthSizable);
    var totalToolbarWidth = count * ICON_WIDTH + (count - 1) * ICON_PADDING,
        leftOffset = (CGRectGetWidth(bounds) - totalToolbarWidth) / 2.0,
        buttonForLater = nil;
    for (var i=0; i<count; i++)
    {
        var image = objj_msgSend(_colorPickers[i], "provideNewButtonImage"),
            highlightImage = objj_msgSend(_colorPickers[i], "provideNewAlternateButtonImage"),
            button = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CGRectMake(leftOffset + i*(ICON_WIDTH+ICON_PADDING), 0, ICON_WIDTH, ICON_WIDTH));
        objj_msgSend(button, "setTag:", i);
        objj_msgSend(button, "setTarget:", self);
        objj_msgSend(button, "setAction:", sel_getUid("_setPicker:"));
        objj_msgSend(button, "setBordered:", NO);
        objj_msgSend(button, "setAutoresizingMask:", CPViewMinXMargin|CPViewMaxXMargin);
        objj_msgSend(button, "setImage:", image);
        objj_msgSend(button, "setAlternateImage:", highlightImage);
        objj_msgSend(_toolbar, "addSubview:", button);
        if (!buttonForLater)
            buttonForLater = button;
    }
    var previewBox = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(76, TOOLBAR_HEIGHT + 10, CGRectGetWidth(bounds) - 86, PREVIEW_HEIGHT));
    _previewView = objj_msgSend(objj_msgSend(_CPColorPanelPreview, "alloc"), "initWithFrame:", CGRectInset(objj_msgSend(previewBox, "bounds"), 2.0, 2.0));
    objj_msgSend(_previewView, "setColorPanel:", self);
    objj_msgSend(_previewView, "setAutoresizingMask:", CPViewWidthSizable);
    objj_msgSend(previewBox, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.8, 1.0));
    objj_msgSend(previewBox, "setAutoresizingMask:", CPViewWidthSizable);
    objj_msgSend(previewBox, "addSubview:", _previewView);
    var _previewLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(10, TOOLBAR_HEIGHT + 10, 60, 15));
    objj_msgSend(_previewLabel, "setStringValue:",  "Preview:");
    objj_msgSend(_previewLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    objj_msgSend(_previewLabel, "setAlignment:", CPRightTextAlignment);
    var swatchBox = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(76, TOOLBAR_HEIGHT + 10 + PREVIEW_HEIGHT + 5, CGRectGetWidth(bounds) - 86, SWATCH_HEIGHT + 2.0));
    objj_msgSend(swatchBox, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.8, 1.0));
    objj_msgSend(swatchBox, "setAutoresizingMask:", CPViewWidthSizable);
    _swatchView = objj_msgSend(objj_msgSend(_CPColorPanelSwatches, "alloc"), "initWithFrame:", CGRectInset(objj_msgSend(swatchBox, "bounds"), 1.0, 1.0));
    objj_msgSend(_swatchView, "setColorPanel:",  self);
    objj_msgSend(_swatchView, "setAutoresizingMask:",  CPViewWidthSizable);
    objj_msgSend(swatchBox, "addSubview:", _swatchView);
    var _swatchLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(10, TOOLBAR_HEIGHT + 8 + PREVIEW_HEIGHT + 6, 60, 15));
    objj_msgSend(_swatchLabel, "setStringValue:",  "Swatches:");
    objj_msgSend(_swatchLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    objj_msgSend(_swatchLabel, "setAlignment:", CPRightTextAlignment);
    var opacityLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(10, TOOLBAR_HEIGHT + PREVIEW_HEIGHT + 35, 60, 20));
    objj_msgSend(opacityLabel, "setStringValue:",  "Opacity:");
    objj_msgSend(opacityLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    objj_msgSend(opacityLabel, "setAlignment:", CPRightTextAlignment);
    _opacitySlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:", CGRectMake(76, TOOLBAR_HEIGHT + PREVIEW_HEIGHT + 34, CGRectGetWidth(bounds) - 86, 20.0));
    objj_msgSend(_opacitySlider, "setMinValue:", 0.0);
    objj_msgSend(_opacitySlider, "setMaxValue:", 1.0);
    objj_msgSend(_opacitySlider, "setTarget:", self);
    objj_msgSend(_opacitySlider, "setAction:", sel_getUid("setOpacity:"));
    objj_msgSend(contentView, "addSubview:", _toolbar);
    objj_msgSend(contentView, "addSubview:", previewBox);
    objj_msgSend(contentView, "addSubview:", _previewLabel);
    objj_msgSend(contentView, "addSubview:", swatchBox);
    objj_msgSend(contentView, "addSubview:", _swatchLabel);
    objj_msgSend(contentView, "addSubview:", opacityLabel);
    objj_msgSend(contentView, "addSubview:", _opacitySlider);
    _target = nil;
    _action = nil;
    _activePicker = nil;
    objj_msgSend(_previewView, "setBackgroundColor:",  _color);
    if (buttonForLater)
        objj_msgSend(self, "_setPicker:", buttonForLater);
}
}), new objj_method(sel_getUid("setOpacity:"), function(self, _cmd, sender)
{ with(self)
{
    var components = objj_msgSend(objj_msgSend(self, "color"), "components"),
        alpha = objj_msgSend(sender, "floatValue");
    objj_msgSend(self, "setColor:updatePicker:", objj_msgSend(_color, "colorWithAlphaComponent:", alpha), YES);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("provideColorPickerClass:"), function(self, _cmd, aColorPickerSubclass)
{ with(self)
{
    ColorPickerClasses.push(aColorPickerSubclass);
}
}), new objj_method(sel_getUid("sharedColorPanel"), function(self, _cmd)
{ with(self)
{
    if (!SharedColorPanel)
        SharedColorPanel = objj_msgSend(objj_msgSend(CPColorPanel, "alloc"), "init");
    return SharedColorPanel;
}
}), new objj_method(sel_getUid("setPickerMode:"), function(self, _cmd, mode)
{ with(self)
{
    var panel = objj_msgSend(CPColorPanel, "sharedColorPanel");
    objj_msgSend(panel, "setMode:",  mode);
}
})]);
}
CPColorDragType = "CPColorDragType";
var CPColorPanelSwatchesCookie = "CPColorPanelSwatchesCookie";
{var the_class = objj_allocateClassPair(CPView, "_CPColorPanelSwatches"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_swatches"), new objj_ivar("_dragColor"), new objj_ivar("_colorPanel"), new objj_ivar("_swatchCookie")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPColorPanelSwatches").super_class }, "initWithFrame:", aFrame);
    objj_msgSend(self, "setBackgroundColor:",  objj_msgSend(CPColor, "grayColor"));
    objj_msgSend(self, "registerForDraggedTypes:", objj_msgSend(CPArray, "arrayWithObjects:", CPColorDragType));
    var whiteColor = objj_msgSend(CPColor, "whiteColor");
    _swatchCookie = objj_msgSend(objj_msgSend(CPCookie, "alloc"), "initWithName:",  CPColorPanelSwatchesCookie);
    var colorList = objj_msgSend(self, "startingColorList");
    _swatches = [];
    for(var i=0; i < 50; i++)
    {
        var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(13*i+1, 1, 12, 12)),
            fillView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectInset(objj_msgSend(view, "bounds"), 1.0, 1.0));
        objj_msgSend(view, "setBackgroundColor:", whiteColor);
        objj_msgSend(fillView, "setBackgroundColor:",  (i < colorList.length) ? colorList[i] : whiteColor);
        objj_msgSend(view, "addSubview:", fillView);
        objj_msgSend(self, "addSubview:",  view);
        _swatches.push(view);
    }
    return self;
}
}), new objj_method(sel_getUid("isOpaque"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("startingColorList"), function(self, _cmd)
{ with(self)
{
    var cookieValue = objj_msgSend(_swatchCookie, "value");
    if(cookieValue == "")
    {
        return [
            objj_msgSend(CPColor, "blackColor"),
            objj_msgSend(CPColor, "darkGrayColor"),
            objj_msgSend(CPColor, "grayColor"),
            objj_msgSend(CPColor, "lightGrayColor"),
            objj_msgSend(CPColor, "whiteColor"),
            objj_msgSend(CPColor, "redColor"),
            objj_msgSend(CPColor, "greenColor"),
            objj_msgSend(CPColor, "blueColor"),
            objj_msgSend(CPColor, "yellowColor")
        ];
    }
    var cookieValue = eval(cookieValue);
    var result = [];
    for(var i=0; i<cookieValue.length; i++)
        result.push(objj_msgSend(CPColor, "colorWithHexString:",  cookieValue[i]));
    return result;
}
}), new objj_method(sel_getUid("saveColorList"), function(self, _cmd)
{ with(self)
{
    var result = [];
    for(var i=0; i<_swatches.length; i++)
        result.push(objj_msgSend(objj_msgSend(objj_msgSend(_swatches[i], "subviews")[0], "backgroundColor"), "hexString"));
    var future = new Date();
    future.setYear(2019);
    objj_msgSend(_swatchCookie, "setValue:expires:domain:",  JSON.stringify(result), future,  nil);
}
}), new objj_method(sel_getUid("setColorPanel:"), function(self, _cmd, panel)
{ with(self)
{
    _colorPanel = panel;
}
}), new objj_method(sel_getUid("colorPanel"), function(self, _cmd)
{ with(self)
{
    return _colorPanel;
}
}), new objj_method(sel_getUid("colorAtIndex:"), function(self, _cmd, index)
{ with(self)
{
    return objj_msgSend(objj_msgSend(_swatches[index], "subviews")[0], "backgroundColor");
}
}), new objj_method(sel_getUid("setColor:atIndex:"), function(self, _cmd, aColor, index)
{ with(self)
{
    objj_msgSend(objj_msgSend(_swatches[index], "subviews")[0], "setBackgroundColor:", aColor);
    objj_msgSend(self, "saveColorList");
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    var point = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil),
        bounds = objj_msgSend(self, "bounds");
    if(!CGRectContainsPoint(bounds, point) || point.x > objj_msgSend(self, "bounds").size.width - 1 || point.x < 1)
        return NO;
    objj_msgSend(_colorPanel, "setColor:updatePicker:",  objj_msgSend(self, "colorAtIndex:", FLOOR(point.x / 13)),  YES);
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    var point = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
     if(point.x > objj_msgSend(self, "bounds").size.width - 1 || point.x < 1)
        return NO;
    objj_msgSend(objj_msgSend(CPPasteboard, "pasteboardWithName:", CPDragPboard), "declareTypes:owner:", objj_msgSend(CPArray, "arrayWithObject:", CPColorDragType), self);
    var swatch = _swatches[FLOOR(point.x / 13)];
    _dragColor = objj_msgSend(objj_msgSend(swatch, "subviews")[0], "backgroundColor");
    var bounds = CPRectCreateCopy(objj_msgSend(swatch, "bounds"));
    var dragView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  bounds);
        dragFillView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectInset(bounds, 1.0, 1.0));
    objj_msgSend(dragView, "setBackgroundColor:", objj_msgSend(CPColor, "blackColor"));
    objj_msgSend(dragFillView, "setBackgroundColor:", _dragColor);
    objj_msgSend(dragView, "addSubview:", dragFillView);
    objj_msgSend(self, "dragView:at:offset:event:pasteboard:source:slideBack:",  dragView,  CPPointMake(point.x - bounds.size.width / 2.0, point.y - bounds.size.height / 2.0),  CPPointMake(0.0, 0.0),  anEvent,  nil,  self,  YES);
}
}), new objj_method(sel_getUid("pasteboard:provideDataForType:"), function(self, _cmd, aPasteboard, aType)
{ with(self)
{
    if(aType == CPColorDragType)
        objj_msgSend(aPasteboard, "setData:forType:", objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", _dragColor), aType);
}
}), new objj_method(sel_getUid("performDragOperation:"), function(self, _cmd, aSender)
{ with(self)
{
    var location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(aSender, "draggingLocation"), nil),
        pasteboard = objj_msgSend(aSender, "draggingPasteboard"),
        swatch = nil;
    if(!objj_msgSend(pasteboard, "availableTypeFromArray:", [CPColorDragType]) || location.x > objj_msgSend(self, "bounds").size.width - 1 || location.x < 1)
        return NO;
    objj_msgSend(self, "setColor:atIndex:", objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", objj_msgSend(pasteboard, "dataForType:", CPColorDragType)),  FLOOR(location.x / 13));
}
})]);
}
{var the_class = objj_allocateClassPair(CPView, "_CPColorPanelPreview"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_colorPanel")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPColorPanelPreview").super_class }, "initWithFrame:", aFrame);
    objj_msgSend(self, "registerForDraggedTypes:", objj_msgSend(CPArray, "arrayWithObjects:", CPColorDragType));
    return self;
}
}), new objj_method(sel_getUid("setColorPanel:"), function(self, _cmd, aPanel)
{ with(self)
{
    _colorPanel = aPanel;
}
}), new objj_method(sel_getUid("colorPanel"), function(self, _cmd)
{ with(self)
{
    return _colorPanel;
}
}), new objj_method(sel_getUid("performDragOperation:"), function(self, _cmd, aSender)
{ with(self)
{
    var pasteboard = objj_msgSend(aSender, "draggingPasteboard");
    if(!objj_msgSend(pasteboard, "availableTypeFromArray:", [CPColorDragType]))
        return NO;
    var color = objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", objj_msgSend(pasteboard, "dataForType:", CPColorDragType));
    objj_msgSend(_colorPanel, "setColor:updatePicker:", color, YES);
}
}), new objj_method(sel_getUid("isOpaque"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    var point = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
    objj_msgSend(objj_msgSend(CPPasteboard, "pasteboardWithName:", CPDragPboard), "declareTypes:owner:", [CPColorDragType], self);
    var bounds = CPRectMake(0, 0, 15, 15);
    var dragView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  bounds);
        dragFillView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectInset(bounds, 1.0, 1.0));
    objj_msgSend(dragView, "setBackgroundColor:", objj_msgSend(CPColor, "blackColor"));
    objj_msgSend(dragFillView, "setBackgroundColor:", objj_msgSend(self, "backgroundColor"));
    objj_msgSend(dragView, "addSubview:", dragFillView);
    objj_msgSend(self, "dragView:at:offset:event:pasteboard:source:slideBack:",  dragView,  CPPointMake(point.x - bounds.size.width / 2.0, point.y - bounds.size.height / 2.0),  CPPointMake(0.0, 0.0),  anEvent,  nil,  self,  YES);
}
}), new objj_method(sel_getUid("pasteboard:provideDataForType:"), function(self, _cmd, aPasteboard, aType)
{ with(self)
{
    if(aType == CPColorDragType)
        objj_msgSend(aPasteboard, "setData:forType:", objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", objj_msgSend(self, "backgroundColor")), aType);
}
})]);
}
objj_executeFile("CPColorPicker.j", true);
objj_executeFile("CPSliderColorPicker.j", true);
objj_msgSend(CPColorPanel, "provideColorPickerClass:", CPColorWheelColorPicker);
objj_msgSend(CPColorPanel, "provideColorPickerClass:", CPSliderColorPicker);

p;15;CPColorPicker.jt;12064;@STATIC;1.0;I;21;Foundation/CPObject.ji;14;CPColorPanel.jt;11999;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("CPColorPanel.j", true);
{var the_class = objj_allocateClassPair(CPObject, "CPColorPicker"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_panel"), new objj_ivar("_mask")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithPickerMask:colorPanel:"), function(self, _cmd, aMask, aPanel)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorPicker").super_class }, "init");
    _panel = aPanel;
    _mask = aMask;
    return self;
}
}), new objj_method(sel_getUid("colorPanel"), function(self, _cmd)
{ with(self)
{
    return _panel;
}
}), new objj_method(sel_getUid("provideNewButtonImage"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("setMode:"), function(self, _cmd, mode)
{ with(self)
{
    return;
}
}), new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    return;
}
})]);
}
{var the_class = objj_allocateClassPair(CPColorPicker, "CPColorWheelColorPicker"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_pickerView"), new objj_ivar("_brightnessSlider"), new objj_ivar("_hueSaturationView"), new objj_ivar("_cachedColor")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithPickerMask:colorPanel:"), function(self, _cmd, mask, owningColorPanel)
{ with(self)
{
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorWheelColorPicker").super_class }, "initWithPickerMask:colorPanel:", mask,  owningColorPanel);
}
}), new objj_method(sel_getUid("initView"), function(self, _cmd)
{ with(self)
{
    aFrame = CPRectMake(0, 0, CPColorPickerViewWidth, CPColorPickerViewHeight);
    _pickerView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", aFrame);
    objj_msgSend(_pickerView, "setAutoresizingMask:", CPViewWidthSizable|CPViewHeightSizable);
    _brightnessSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:", CGRectMake(0, (aFrame.size.height - 34), aFrame.size.width, 15));
    objj_msgSend(_brightnessSlider, "setValue:forThemeAttribute:", 15.0, "track-width");
    objj_msgSend(_brightnessSlider, "setValue:forThemeAttribute:", objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPColorPicker, "class")), "pathForResource:", "brightness_bar.png"))), "track-color");
    objj_msgSend(_brightnessSlider, "setMinValue:", 0.0);
    objj_msgSend(_brightnessSlider, "setMaxValue:", 100.0);
    objj_msgSend(_brightnessSlider, "setFloatValue:", 100.0);
    objj_msgSend(_brightnessSlider, "setTarget:", self);
    objj_msgSend(_brightnessSlider, "setAction:", sel_getUid("brightnessSliderDidChange:"));
    objj_msgSend(_brightnessSlider, "setAutoresizingMask:", CPViewWidthSizable | CPViewMinYMargin);
    _hueSaturationView = objj_msgSend(objj_msgSend(__CPColorWheel, "alloc"), "initWithFrame:",  CPRectMake(0, 0, aFrame.size.width, aFrame.size.height - 38));
    objj_msgSend(_hueSaturationView, "setDelegate:",  self);
    objj_msgSend(_hueSaturationView, "setAutoresizingMask:",  (CPViewWidthSizable | CPViewHeightSizable));
    objj_msgSend(_pickerView, "addSubview:", _hueSaturationView);
    objj_msgSend(_pickerView, "addSubview:", _brightnessSlider);
}
}), new objj_method(sel_getUid("brightnessSliderDidChange:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "updateColor");
}
}), new objj_method(sel_getUid("colorWheelDidChange:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "updateColor");
}
}), new objj_method(sel_getUid("updateColor"), function(self, _cmd)
{ with(self)
{
    var hue = objj_msgSend(_hueSaturationView, "angle"),
        saturation = objj_msgSend(_hueSaturationView, "distance"),
        brightness = objj_msgSend(_brightnessSlider, "floatValue");
    objj_msgSend(_hueSaturationView, "setWheelBrightness:", brightness / 100.0);
    objj_msgSend(_brightnessSlider, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithHue:saturation:brightness:", hue, saturation, 100));
    var colorPanel = objj_msgSend(self, "colorPanel"),
        opacity = objj_msgSend(colorPanel, "opacity");
    _cachedColor = objj_msgSend(CPColor, "colorWithHue:saturation:brightness:alpha:", hue, saturation, brightness, opacity);
    objj_msgSend(objj_msgSend(self, "colorPanel"), "setColor:", _cachedColor);
}
}), new objj_method(sel_getUid("supportsMode:"), function(self, _cmd, mode)
{ with(self)
{
    return (mode == CPWheelColorPickerMode) ? YES : NO;
}
}), new objj_method(sel_getUid("currentMode"), function(self, _cmd)
{ with(self)
{
    return CPWheelColorPickerMode;
}
}), new objj_method(sel_getUid("provideNewView:"), function(self, _cmd, initialRequest)
{ with(self)
{
    if (initialRequest)
        objj_msgSend(self, "initView");
    return _pickerView;
}
}), new objj_method(sel_getUid("setColor:"), function(self, _cmd, newColor)
{ with(self)
{
    if (objj_msgSend(newColor, "isEqual:", _cachedColor))
        return;
    var hsb = objj_msgSend(newColor, "hsbComponents");
    objj_msgSend(_hueSaturationView, "setPositionToColor:", newColor);
    objj_msgSend(_brightnessSlider, "setFloatValue:", hsb[2]);
    objj_msgSend(_hueSaturationView, "setWheelBrightness:", hsb[2] / 100.0);
    objj_msgSend(_brightnessSlider, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithHue:saturation:brightness:", hsb[0], hsb[1], 100));
}
}), new objj_method(sel_getUid("provideNewButtonImage"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", CPColorPicker), "pathForResource:", "wheel_button.png"), CGSizeMake(32, 32));
}
}), new objj_method(sel_getUid("provideNewAlternateButtonImage"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", CPColorPicker), "pathForResource:", "wheel_button_h.png"), CGSizeMake(32, 32));
}
})]);
}
{var the_class = objj_allocateClassPair(CPView, "__CPColorWheel"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_wheelImage"), new objj_ivar("_blackWheelImage"), new objj_ivar("_crosshair"), new objj_ivar("_delegate"), new objj_ivar("_angle"), new objj_ivar("_distance"), new objj_ivar("_radius")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("__CPColorWheel").super_class }, "initWithFrame:", aFrame);
    var path = objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", CPColorPicker), "pathForResource:", "wheel.png");
    _wheelImage = new Image();
    _wheelImage.src = path;
    _wheelImage.style.position = "absolute";
    path = objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", CPColorPicker), "pathForResource:", "wheel_black.png");
    _blackWheelImage = new Image();
    _blackWheelImage.src = path;
    _blackWheelImage.style.opacity = "0";
    _blackWheelImage.style.filter = "alpha(opacity=0)"
    _blackWheelImage.style.position = "absolute";
    _DOMElement.appendChild(_wheelImage);
    _DOMElement.appendChild(_blackWheelImage);
    objj_msgSend(self, "setWheelSize:", aFrame.size);
    _crosshair = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CPRectMake(_radius - 2, _radius - 2, 4, 4));
    objj_msgSend(_crosshair, "setBackgroundColor:", objj_msgSend(CPColor, "blackColor"));
    var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectInset(objj_msgSend(_crosshair, "bounds"), 1.0, 1.0));
    objj_msgSend(view, "setBackgroundColor:", objj_msgSend(CPColor, "whiteColor"));
    objj_msgSend(_crosshair, "addSubview:", view);
    objj_msgSend(self, "addSubview:", _crosshair);
    return self;
}
}), new objj_method(sel_getUid("setWheelBrightness:"), function(self, _cmd, brightness)
{ with(self)
{
    _blackWheelImage.style.opacity = 1.0 - brightness;
    _blackWheelImage.style.filter = "alpha(opacity=" + (1.0 - brightness)*100 + ")"
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("__CPColorWheel").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "setWheelSize:", aSize);
}
}), new objj_method(sel_getUid("setWheelSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var min = MIN(aSize.width, aSize.height);
    _blackWheelImage.style.width = min;
    _blackWheelImage.style.height = min;
    _blackWheelImage.width = min;
    _blackWheelImage.height = min;
    _blackWheelImage.style.top = (aSize.height - min) / 2.0 + "px";
    _blackWheelImage.style.left = (aSize.width - min) / 2.0 + "px";
    _wheelImage.style.width = min;
    _wheelImage.style.height = min;
    _wheelImage.width = min;
    _wheelImage.height = min;
    _wheelImage.style.top = (aSize.height - min) / 2.0 + "px";
    _wheelImage.style.left = (aSize.width - min) / 2.0 + "px";
    _radius = min / 2.0;
    objj_msgSend(self, "setAngle:distance:", objj_msgSend(self, "degreesToRadians:", _angle), (_distance / 100.0) * _radius);
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("angle"), function(self, _cmd)
{ with(self)
{
    return _angle;
}
}), new objj_method(sel_getUid("distance"), function(self, _cmd)
{ with(self)
{
    return _distance;
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "reposition:", anEvent);
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "reposition:", anEvent);
}
}), new objj_method(sel_getUid("reposition:"), function(self, _cmd, anEvent)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
    var midX = CGRectGetMidX(bounds);
    var midY = CGRectGetMidY(bounds);
    var distance = MIN(SQRT((location.x - midX)*(location.x - midX) + (location.y - midY)*(location.y - midY)), _radius);
    var angle = ATAN2(location.y - midY, location.x - midX);
    objj_msgSend(self, "setAngle:distance:", angle, distance);
    objj_msgSend(_delegate, "colorWheelDidChange:", self);
}
}), new objj_method(sel_getUid("setAngle:distance:"), function(self, _cmd, angle, distance)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds");
    var midX = CGRectGetMidX(bounds);
    var midY = CGRectGetMidY(bounds);
    _angle = objj_msgSend(self, "radiansToDegrees:", angle);
    _distance = (distance / _radius) * 100.0;
    objj_msgSend(_crosshair, "setFrameOrigin:", CPPointMake(COS(angle) * distance + midX - 2.0, SIN(angle) * distance + midY - 2.0));
}
}), new objj_method(sel_getUid("setPositionToColor:"), function(self, _cmd, aColor)
{ with(self)
{
    var hsb = objj_msgSend(aColor, "hsbComponents"),
        bounds = objj_msgSend(self, "bounds");
    var angle = objj_msgSend(self, "degreesToRadians:", hsb[0]),
        distance = (hsb[1] / 100.0) * _radius;
    objj_msgSend(self, "setAngle:distance:", angle, distance);
}
}), new objj_method(sel_getUid("radiansToDegrees:"), function(self, _cmd, radians)
{ with(self)
{
    return ((-radians / PI) * 180 + 360) % 360;
}
}), new objj_method(sel_getUid("degreesToRadians:"), function(self, _cmd, degrees)
{ with(self)
{
    return -(((degrees - 360) / 180) * PI);
}
})]);
}

p;13;CPColorWell.jt;7511;@STATIC;1.0;I;21;Foundation/CPString.ji;8;CPView.ji;9;CPColor.ji;14;CPColorPanel.jt;7422;objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPView.j", true);
objj_executeFile("CPColor.j", true);
objj_executeFile("CPColorPanel.j", true);
var _CPColorWellDidBecomeExclusiveNotification = "_CPColorWellDidBecomeExclusiveNotification";
{var the_class = objj_allocateClassPair(CPControl, "CPColorWell"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_active"), new objj_ivar("_bordered"), new objj_ivar("_color"), new objj_ivar("_wellView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorWell").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _active = NO;
        _bordered = YES;
        _color = objj_msgSend(CPColor, "whiteColor");
        objj_msgSend(self, "drawBezelWithHighlight:", NO);
        objj_msgSend(self, "drawWellInside:", CGRectInset(objj_msgSend(self, "bounds"), 3.0, 3.0));
        objj_msgSend(self, "_registerForNotifications");
    }
    return self;
}
}), new objj_method(sel_getUid("_registerForNotifications"), function(self, _cmd)
{ with(self)
{
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("colorWellDidBecomeExclusive:"), _CPColorWellDidBecomeExclusiveNotification, nil);
    objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("colorPanelWillClose:"), CPWindowWillCloseNotification, objj_msgSend(CPColorPanel, "sharedColorPanel"));
}
}), new objj_method(sel_getUid("isBordered"), function(self, _cmd)
{ with(self)
{
    return _bordered;
}
}), new objj_method(sel_getUid("setBordered:"), function(self, _cmd, bordered)
{ with(self)
{
    if (_bordered == bordered)
        return;
    _bordered = bordered;
    objj_msgSend(self, "drawWellInside:", CGRectInset(objj_msgSend(self, "bounds"), 3.0, 3.0));
}
}), new objj_method(sel_getUid("color"), function(self, _cmd)
{ with(self)
{
    return _color;
}
}), new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_color == aColor)
        return;
    _color = aColor;
    objj_msgSend(self, "drawWellInside:", CGRectInset(objj_msgSend(self, "bounds"), 3.0, 3.0));
}
}), new objj_method(sel_getUid("takeColorFrom:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "setColor:", objj_msgSend(aSender, "color"));
}
}), new objj_method(sel_getUid("activate:"), function(self, _cmd, shouldBeExclusive)
{ with(self)
{
    if (shouldBeExclusive)
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", _CPColorWellDidBecomeExclusiveNotification, self);
    if (objj_msgSend(self, "isActive"))
        return;
    _active = YES;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "addObserver:selector:name:object:", self, sel_getUid("colorPanelDidChangeColor:"), CPColorPanelColorDidChangeNotification, objj_msgSend(CPColorPanel, "sharedColorPanel"));
}
}), new objj_method(sel_getUid("deactivate"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(self, "isActive"))
        return;
    _active = NO;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "removeObserver:name:object:", self, CPColorPanelColorDidChangeNotification, objj_msgSend(CPColorPanel, "sharedColorPanel"));
}
}), new objj_method(sel_getUid("isActive"), function(self, _cmd)
{ with(self)
{
    return _active;
}
}), new objj_method(sel_getUid("drawBezelWithHighlight:"), function(self, _cmd, shouldHighlight)
{ with(self)
{
}
}), new objj_method(sel_getUid("drawWellInside:"), function(self, _cmd, aRect)
{ with(self)
{
    if (!_wellView)
    {
        _wellView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", aRect);
        objj_msgSend(_wellView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
        objj_msgSend(self, "addSubview:", _wellView);
    }
    else
        objj_msgSend(_wellView, "setFrame:", aRect);
    objj_msgSend(_wellView, "setBackgroundColor:", _color);
}
}), new objj_method(sel_getUid("colorPanelDidChangeColor:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "takeColorFrom:", objj_msgSend(aNotification, "object"));
    objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
}
}), new objj_method(sel_getUid("colorWellDidBecomeExclusive:"), function(self, _cmd, aNotification)
{ with(self)
{
    if (self != objj_msgSend(aNotification, "object"))
        objj_msgSend(self, "deactivate");
}
}), new objj_method(sel_getUid("colorPanelWillClose:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "deactivate");
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "drawBezelWithHighlight:", YES);
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "drawBezelWithHighlight:", CGRectContainsPoint(objj_msgSend(self, "bounds"), objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil)));
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "drawBezelWithHighlight:", NO);
    if (!CGRectContainsPoint(objj_msgSend(self, "bounds"), objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil)))
        return;
    objj_msgSend(self, "activate:", YES);
    var colorPanel = objj_msgSend(CPColorPanel, "sharedColorPanel");
    objj_msgSend(colorPanel, "setColor:", _color);
    objj_msgSend(colorPanel, "orderFront:", self);
}
})]);
}
var CPColorWellColorKey = "CPColorWellColorKey",
    CPColorWellBorderedKey = "CPColorWellBorderedKey";
{
var the_class = objj_getClass("CPColorWell")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPColorWell\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorWell").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _active = NO;
        _bordered = objj_msgSend(aCoder, "decodeObjectForKey:", CPColorWellBorderedKey);
        _color = objj_msgSend(aCoder, "decodeObjectForKey:", CPColorWellColorKey);
        objj_msgSend(self, "drawBezelWithHighlight:", NO);
        objj_msgSend(self, "drawWellInside:", CGRectInset(objj_msgSend(self, "bounds"), 3.0, 3.0));
        objj_msgSend(self, "_registerForNotifications");
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    var actualSubviews = _subviews;
    _subviews = objj_msgSend(_subviews, "copy");
    objj_msgSend(_subviews, "removeObjectIdenticalTo:", _wellView);
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPColorWell").super_class }, "encodeWithCoder:", aCoder);
    _subviews = actualSubviews;
    objj_msgSend(aCoder, "encodeObject:forKey:", _color, CPColorWellColorKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _bordered, CPColorWellBorderedKey);
}
})]);
}

p;17;CPCompatibility.jt;5422;@STATIC;1.0;i;9;CPEvent.ji;12;CPPlatform.jt;5373;objj_executeFile("CPEvent.j", true);
objj_executeFile("CPPlatform.j", true);
CPUnknownBrowserEngine = 0;
CPGeckoBrowserEngine = 1;
CPInternetExplorerBrowserEngine = 2;
CPKHTMLBrowserEngine = 3;
CPOperaBrowserEngine = 4;
CPWebKitBrowserEngine = 5;
CPMacOperatingSystem = 0;
CPWindowsOperatingSystem = 1;
CPOtherOperatingSystem = 2;
CPCSSRGBAFeature = 1 << 5;
CPHTMLCanvasFeature = 1 << 6;
CPHTMLContentEditableFeature = 1 << 7;
CPHTMLDragAndDropFeature = 1 << 8;
CPJavascriptInnerTextFeature = 1 << 9;
CPJavascriptTextContentFeature = 1 << 10;
CPJavascriptClipboardEventsFeature = 1 << 11;
CPJavascriptClipboardAccessFeature = 1 << 12;
CPJavaScriptCanvasDrawFeature = 1 << 13;
CPJavaScriptCanvasTransformFeature = 1 << 14;
CPVMLFeature = 1 << 15;
CPJavascriptRemedialKeySupport = 1 << 16;
CPJavaScriptShadowFeature = 1 << 20;
CPJavaScriptNegativeMouseWheelValues = 1 << 22;
CPJavaScriptMouseWheelValues_8_15 = 1 << 23
CPOpacityRequiresFilterFeature = 1 << 24;
CPInputTypeCanBeChangedFeature = 1 << 25;
CPHTML5DragAndDropSourceYOffBy1 = 1 << 26;
var USER_AGENT = "",
    PLATFORM_ENGINE = CPUnknownBrowserEngine,
    PLATFORM_FEATURES = 0;
PLATFORM_FEATURES |= CPInputTypeCanBeChangedFeature;
if (typeof window != "undfined" && typeof window.navigator != "undefined")
    USER_AGENT = window.navigator.userAgent;
if (window.opera)
{
    PLATFORM_ENGINE = CPOperaBrowserEngine;
    PLATFORM_FEATURES |= CPJavaScriptCanvasDrawFeature;
}
else if (window.attachEvent)
{
    PLATFORM_ENGINE = CPInternetExplorerBrowserEngine;
    PLATFORM_FEATURES |= CPVMLFeature;
    PLATFORM_FEATURES |= CPJavascriptRemedialKeySupport;
    PLATFORM_FEATURES |= CPJavaScriptShadowFeature;
    PLATFORM_FEATURES |= CPOpacityRequiresFilterFeature;
    PLATFORM_FEATURES &= ~CPInputTypeCanBeChangedFeature;
}
else if (USER_AGENT.indexOf("AppleWebKit/") != -1)
{
    PLATFORM_ENGINE = CPWebKitBrowserEngine;
    PLATFORM_FEATURES |= CPCSSRGBAFeature;
    PLATFORM_FEATURES |= CPHTMLContentEditableFeature;
    if (USER_AGENT.indexOf("Chrome") === -1)
        PLATFORM_FEATURES |= CPHTMLDragAndDropFeature;
    PLATFORM_FEATURES |= CPJavascriptClipboardEventsFeature;
    PLATFORM_FEATURES |= CPJavascriptClipboardAccessFeature;
    PLATFORM_FEATURES |= CPJavaScriptShadowFeature;
    var versionStart = USER_AGENT.indexOf("AppleWebKit/") + "AppleWebKit/".length,
        versionEnd = USER_AGENT.indexOf(" ", versionStart),
        versionString = USER_AGENT.substring(versionStart, versionEnd),
        versionDivision = versionString.indexOf('.'),
        majorVersion = parseInt(versionString.substring(0, versionDivision)),
        minorVersion = parseInt(versionString.substr(versionDivision + 1));
    if((USER_AGENT.indexOf("Safari") !== CPNotFound && (majorVersion > 525 || (majorVersion === 525 && minorVersion > 14))) || USER_AGENT.indexOf("Chrome") !== CPNotFound)
        PLATFORM_FEATURES |= CPJavascriptRemedialKeySupport;
    if (!objj_msgSend(CPPlatform, "isBrowser"))
        PLATFORM_FEATURES |= CPJavascriptRemedialKeySupport;
    if (majorVersion < 532 || (majorVersion === 532 && minorVersion < 6))
        PLATFORM_FEATURES |= CPHTML5DragAndDropSourceYOffBy1;
}
else if (USER_AGENT.indexOf("KHTML") != -1)
{
    PLATFORM_ENGINE = CPKHTMLBrowserEngine;
}
else if (USER_AGENT.indexOf("Gecko") !== -1)
{
    PLATFORM_ENGINE = CPGeckoBrowserEngine;
    PLATFORM_FEATURES |= CPJavaScriptCanvasDrawFeature;
    var index = USER_AGENT.indexOf("Firefox"),
        version = (index === -1) ? 2.0 : parseFloat(USER_AGENT.substring(index + "Firefox".length + 1));
    if (version >= 3.0)
        PLATFORM_FEATURES |= CPCSSRGBAFeature;
    if (version < 3.0)
        PLATFORM_FEATURES |= CPJavaScriptMouseWheelValues_8_15;
}
if (typeof document != "undefined")
{
    var canvasElement = document.createElement("canvas");
    if (canvasElement && canvasElement.getContext)
    {
        PLATFORM_FEATURES |= CPHTMLCanvasFeature;
        var context = document.createElement("canvas").getContext("2d");
        if (context && context.setTransform && context.transform)
            PLATFORM_FEATURES |= CPJavaScriptCanvasTransformFeature;
    }
    var DOMElement = document.createElement("div");
    if (DOMElement.innerText != undefined)
        PLATFORM_FEATURES |= CPJavascriptInnerTextFeature;
    else if (DOMElement.textContent != undefined)
        PLATFORM_FEATURES |= CPJavascriptTextContentFeature;
}
CPFeatureIsCompatible= function(aFeature)
{
    return PLATFORM_FEATURES & aFeature;
}
CPBrowserIsEngine= function(anEngine)
{
    return PLATFORM_ENGINE === anEngine;
}
CPBrowserIsOperatingSystem= function(anOperatingSystem)
{
    return OPERATING_SYSTEM === anOperatingSystem;
}
OPERATING_SYSTEM = CPOtherOperatingSystem;
if (USER_AGENT.indexOf("Mac") !== -1)
{
    OPERATING_SYSTEM = CPMacOperatingSystem;
    CPPlatformActionKeyMask = CPCommandKeyMask;
    CPUndoKeyEquivalent = "Z";
    CPRedoKeyEquivalent = "Z";
    CPUndoKeyEquivalentModifierMask = CPCommandKeyMask;
    CPRedoKeyEquivalentModifierMask = CPCommandKeyMask | CPShiftKeyMask;
}
else
{
    if (USER_AGENT.indexOf("Windows") !== -1)
        OPERATING_SYSTEM = CPWindowsOperatingSystem;
    CPPlatformActionKeyMask = CPControlKeyMask;
    CPUndoKeyEquivalent = "Z";
    CPRedoKeyEquivalent = "Y";
    CPUndoKeyEquivalentModifierMask = CPControlKeyMask;
    CPRedoKeyEquivalentModifierMask = CPControlKeyMask;
}

p;11;CPControl.jt;22584;@STATIC;1.0;i;8;CPFont.ji;10;CPShadow.ji;8;CPView.jt;22525;objj_executeFile("CPFont.j", true);
objj_executeFile("CPShadow.j", true);
objj_executeFile("CPView.j", true);
CPLeftTextAlignment = 0;
CPRightTextAlignment = 1;
CPCenterTextAlignment = 2;
CPJustifiedTextAlignment = 3;
CPNaturalTextAlignment = 4;
CPRegularControlSize = 0;
CPSmallControlSize = 1;
CPMiniControlSize = 2;
CPLineBreakByWordWrapping = 0;
CPLineBreakByCharWrapping = 1;
CPLineBreakByClipping = 2;
CPLineBreakByTruncatingHead = 3;
CPLineBreakByTruncatingTail = 4;
CPLineBreakByTruncatingMiddle = 5;
CPTopVerticalTextAlignment = 1,
CPCenterVerticalTextAlignment = 2,
CPBottomVerticalTextAlignment = 3;
CPScaleProportionally = 0;
CPScaleToFit = 1;
CPScaleNone = 2;
CPNoImage = 0;
CPImageOnly = 1;
CPImageLeft = 2;
CPImageRight = 3;
CPImageBelow = 4;
CPImageAbove = 5;
CPImageOverlaps = 6;
CPOnState = 1;
CPOffState = 0;
CPMixedState = -1;
CPControlNormalBackgroundColor = "CPControlNormalBackgroundColor";
CPControlSelectedBackgroundColor = "CPControlSelectedBackgroundColor";
CPControlHighlightedBackgroundColor = "CPControlHighlightedBackgroundColor";
CPControlDisabledBackgroundColor = "CPControlDisabledBackgroundColor";
CPControlTextDidBeginEditingNotification = "CPControlTextDidBeginEditingNotification";
CPControlTextDidChangeNotification = "CPControlTextDidChangeNotification";
CPControlTextDidEndEditingNotification = "CPControlTextDidEndEditingNotification";
var CPControlBlackColor = objj_msgSend(CPColor, "blackColor");
{var the_class = objj_allocateClassPair(CPView, "CPControl"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_value"), new objj_ivar("_target"), new objj_ivar("_action"), new objj_ivar("_sendActionOn"), new objj_ivar("_sendsActionOnEndEditing"), new objj_ivar("_continuousTracking"), new objj_ivar("_trackingWasWithinFrame"), new objj_ivar("_trackingMouseDownFlags"), new objj_ivar("_previousTrackingLocation"), new objj_ivar("_toolTip")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("sendsActionOnEndEditing"), function(self, _cmd)
{ with(self)
{
return _sendsActionOnEndEditing;
}
}),
new objj_method(sel_getUid("setSendsActionOnEndEditing:"), function(self, _cmd, newValue)
{ with(self)
{
_sendsActionOnEndEditing = newValue;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPControl").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _sendActionOn = CPLeftMouseUpMask;
        _trackingMouseDownFlags = 0;
    }
    return self;
}
}), new objj_method(sel_getUid("setAction:"), function(self, _cmd, anAction)
{ with(self)
{
    _action = anAction;
}
}), new objj_method(sel_getUid("action"), function(self, _cmd)
{ with(self)
{
    return _action;
}
}), new objj_method(sel_getUid("setTarget:"), function(self, _cmd, aTarget)
{ with(self)
{
    _target = aTarget;
}
}), new objj_method(sel_getUid("target"), function(self, _cmd)
{ with(self)
{
    return _target;
}
}), new objj_method(sel_getUid("sendAction:to:"), function(self, _cmd, anAction, anObject)
{ with(self)
{
    objj_msgSend(CPApp, "sendAction:to:from:", anAction, anObject, self);
}
}), new objj_method(sel_getUid("sendActionOn:"), function(self, _cmd, mask)
{ with(self)
{
    var previousMask = _sendActionOn;
    _sendActionOn = mask;
    return previousMask;
}
}), new objj_method(sel_getUid("isContinuous"), function(self, _cmd)
{ with(self)
{
    return (_sendActionOn & CPPeriodicMask) !== 0;
}
}), new objj_method(sel_getUid("setContinuous:"), function(self, _cmd, flag)
{ with(self)
{
    if (flag)
        _sendActionOn |= CPPeriodicMask;
    else
        _sendActionOn &= ~CPPeriodicMask;
}
}), new objj_method(sel_getUid("tracksMouseOutsideOfFrame"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("trackMouse:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type"),
        currentLocation = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
        isWithinFrame = objj_msgSend(self, "tracksMouseOutsideOfFrame") || CGRectContainsPoint(objj_msgSend(self, "bounds"), currentLocation);
    if (type === CPLeftMouseUp)
    {
        objj_msgSend(self, "stopTracking:at:mouseIsUp:", _previousTrackingLocation, currentLocation, YES);
        _trackingMouseDownFlags = 0;
    }
    else
    {
        if (type === CPLeftMouseDown)
        {
            _trackingMouseDownFlags = objj_msgSend(anEvent, "modifierFlags");
            _continuousTracking = objj_msgSend(self, "startTrackingAt:", currentLocation);
        }
        else if (type === CPLeftMouseDragged)
        {
            if (isWithinFrame)
            {
                if (!_trackingWasWithinFrame)
                    _continuousTracking = objj_msgSend(self, "startTrackingAt:", currentLocation);
                else if (_continuousTracking)
                    _continuousTracking = objj_msgSend(self, "continueTracking:at:", _previousTrackingLocation, currentLocation);
            }
            else
                objj_msgSend(self, "stopTracking:at:mouseIsUp:", _previousTrackingLocation, currentLocation, NO);
        }
        objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackMouse:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
    }
    if ((_sendActionOn & (1 << type)) && isWithinFrame)
        objj_msgSend(self, "sendAction:to:", _action, _target);
    _trackingWasWithinFrame = isWithinFrame;
    _previousTrackingLocation = currentLocation;
}
}), new objj_method(sel_getUid("setState:"), function(self, _cmd, state)
{ with(self)
{
}
}), new objj_method(sel_getUid("nextState"), function(self, _cmd)
{ with(self)
{
    return 0;
}
}), new objj_method(sel_getUid("performClick:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "highlight:", YES);
    objj_msgSend(self, "setState:", objj_msgSend(self, "nextState"));
    objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
    objj_msgSend(CPTimer, "scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:", 0.1, self, sel_getUid("unhighlightButtonTimerDidFinish:"), nil, NO);
}
}), new objj_method(sel_getUid("unhighlightButtonTimerDidFinish:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "highlight:", NO);
}
}), new objj_method(sel_getUid("mouseDownFlags"), function(self, _cmd)
{ with(self)
{
    return _trackingMouseDownFlags;
}
}), new objj_method(sel_getUid("startTrackingAt:"), function(self, _cmd, aPoint)
{ with(self)
{
    objj_msgSend(self, "highlight:", YES);
    return (_sendActionOn & CPPeriodicMask) || (_sendActionOn & CPLeftMouseDraggedMask);
}
}), new objj_method(sel_getUid("continueTracking:at:"), function(self, _cmd, lastPoint, aPoint)
{ with(self)
{
    return (_sendActionOn & CPPeriodicMask) || (_sendActionOn & CPLeftMouseDraggedMask);
}
}), new objj_method(sel_getUid("stopTracking:at:mouseIsUp:"), function(self, _cmd, lastPoint, aPoint, mouseIsUp)
{ with(self)
{
    objj_msgSend(self, "highlight:", NO);
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(self, "isEnabled"))
        return;
    objj_msgSend(self, "trackMouse:", anEvent);
}
}), new objj_method(sel_getUid("objectValue"), function(self, _cmd)
{ with(self)
{
    return _value;
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, anObject)
{ with(self)
{
    _value = anObject;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("floatValue"), function(self, _cmd)
{ with(self)
{
    var floatValue = parseFloat(_value, 10);
    return isNaN(floatValue) ? 0.0 : floatValue;
}
}), new objj_method(sel_getUid("setFloatValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", aValue);
}
}), new objj_method(sel_getUid("doubleValue"), function(self, _cmd)
{ with(self)
{
    var doubleValue = parseFloat(_value, 10);
    return isNaN(doubleValue) ? 0.0 : doubleValue;
}
}), new objj_method(sel_getUid("setDoubleValue:"), function(self, _cmd, anObject)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", anObject);
}
}), new objj_method(sel_getUid("intValue"), function(self, _cmd)
{ with(self)
{
    var intValue = parseInt(_value, 10);
    return isNaN(intValue) ? 0.0 : intValue;
}
}), new objj_method(sel_getUid("setIntValue:"), function(self, _cmd, anObject)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", anObject);
}
}), new objj_method(sel_getUid("integerValue"), function(self, _cmd)
{ with(self)
{
    var intValue = parseInt(_value, 10);
    return isNaN(intValue) ? 0.0 : intValue;
}
}), new objj_method(sel_getUid("setIntegerValue:"), function(self, _cmd, anObject)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", anObject);
}
}), new objj_method(sel_getUid("stringValue"), function(self, _cmd)
{ with(self)
{
    return (_value === undefined || _value === nil) ? "" : String(_value);
}
}), new objj_method(sel_getUid("setStringValue:"), function(self, _cmd, anObject)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", anObject);
}
}), new objj_method(sel_getUid("takeDoubleValueFrom:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(sender, "respondsToSelector:", sel_getUid("doubleValue")))
        objj_msgSend(self, "setDoubleValue:", objj_msgSend(sender, "doubleValue"));
}
}), new objj_method(sel_getUid("takeFloatValueFrom:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(sender, "respondsToSelector:", sel_getUid("floatValue")))
        objj_msgSend(self, "setFloatValue:", objj_msgSend(sender, "floatValue"));
}
}), new objj_method(sel_getUid("takeIntegerValueFrom:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(sender, "respondsToSelector:", sel_getUid("integerValue")))
        objj_msgSend(self, "setIntegerValue:", objj_msgSend(sender, "integerValue"));
}
}), new objj_method(sel_getUid("takeIntValueFrom:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(sender, "respondsToSelector:", sel_getUid("intValue")))
        objj_msgSend(self, "setIntValue:", objj_msgSend(sender, "intValue"));
}
}), new objj_method(sel_getUid("takeObjectValueFrom:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(sender, "respondsToSelector:", sel_getUid("objectValue")))
        objj_msgSend(self, "setObjectValue:", objj_msgSend(sender, "objectValue"));
}
}), new objj_method(sel_getUid("takeStringValueFrom:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(sender, "respondsToSelector:", sel_getUid("stringValue")))
        objj_msgSend(self, "setStringValue:", objj_msgSend(sender, "stringValue"));
}
}), new objj_method(sel_getUid("textDidBeginEditing:"), function(self, _cmd, note)
{ with(self)
{
    if(objj_msgSend(note, "object") != self)
        return;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPControlTextDidBeginEditingNotification, self, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", objj_msgSend(note, "object"), "CPFieldEditor"));
}
}), new objj_method(sel_getUid("textDidChange:"), function(self, _cmd, note)
{ with(self)
{
    if(objj_msgSend(note, "object") != self)
        return;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPControlTextDidChangeNotification, self, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", objj_msgSend(note, "object"), "CPFieldEditor"));
}
}), new objj_method(sel_getUid("textDidEndEditing:"), function(self, _cmd, note)
{ with(self)
{
    if(objj_msgSend(note, "object") != self)
        return;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPControlTextDidEndEditingNotification, self, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", objj_msgSend(note, "object"), "CPFieldEditor"));
}
}), new objj_method(sel_getUid("setAlignment:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "alignment");}
}), new objj_method(sel_getUid("alignment"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "alignment");}
}), new objj_method(sel_getUid("setVerticalAlignment:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "vertical-alignment");}
}), new objj_method(sel_getUid("verticalAlignment"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "vertical-alignment");}
}), new objj_method(sel_getUid("setLineBreakMode:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "line-break-mode");}
}), new objj_method(sel_getUid("lineBreakMode"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "line-break-mode");}
}), new objj_method(sel_getUid("setTextColor:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "text-color");}
}), new objj_method(sel_getUid("textColor"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "text-color");}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "font");}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "font");}
}), new objj_method(sel_getUid("setTextShadowColor:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "text-shadow-color");}
}), new objj_method(sel_getUid("textShadowColor"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "text-shadow-color");}
}), new objj_method(sel_getUid("setTextShadowOffset:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "text-shadow-offset");}
}), new objj_method(sel_getUid("textShadowOffset"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "text-shadow-offset");}
}), new objj_method(sel_getUid("setImagePosition:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "image-position");}
}), new objj_method(sel_getUid("imagePosition"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "image-position");}
}), new objj_method(sel_getUid("setImageScaling:"), function(self, _cmd, aValue)
{ with(self)
{objj_msgSend(self, "setValue:forThemeAttribute:", aValue, "image-scaling");}
}), new objj_method(sel_getUid("imageScaling"), function(self, _cmd)
{ with(self)
{return objj_msgSend(self, "valueForThemeAttribute:", "image-scaling");}
}), new objj_method(sel_getUid("setEnabled:"), function(self, _cmd, isEnabled)
{ with(self)
{
    if (isEnabled)
        objj_msgSend(self, "unsetThemeState:", CPThemeStateDisabled);
    else
        objj_msgSend(self, "setThemeState:", CPThemeStateDisabled);
}
}), new objj_method(sel_getUid("isEnabled"), function(self, _cmd)
{ with(self)
{
    return !objj_msgSend(self, "hasThemeState:", CPThemeStateDisabled);
}
}), new objj_method(sel_getUid("highlight:"), function(self, _cmd, shouldHighlight)
{ with(self)
{
    objj_msgSend(self, "setHighlighted:", shouldHighlight);
}
}), new objj_method(sel_getUid("setHighlighted:"), function(self, _cmd, isHighlighted)
{ with(self)
{
    if (isHighlighted)
        objj_msgSend(self, "setThemeState:", CPThemeStateHighlighted);
    else
        objj_msgSend(self, "unsetThemeState:", CPThemeStateHighlighted);
}
}), new objj_method(sel_getUid("isHighlighted"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "hasThemeState:", CPThemeStateHighlighted);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [CPLeftTextAlignment,
                                                CPTopVerticalTextAlignment,
                                                CPLineBreakByClipping,
                                                objj_msgSend(CPColor, "blackColor"),
                                                objj_msgSend(CPFont, "systemFontOfSize:", 12.0),
                                                objj_msgSend(CPNull, "null"),
                                                { width:0.0, height:0.0 },
                                                CPImageLeft,
                                                CPScaleToFit,
                                                { width:0.0, height:0.0 },
                                                { width:-1.0, height:-1.0 }], ["alignment",
                                                "vertical-alignment",
                                                "line-break-mode",
                                                "text-color",
                                                "font",
                                                "text-shadow-color",
                                                "text-shadow-offset",
                                                "image-position",
                                                "image-scaling",
                                                "min-size",
                                                "max-size"]);
}
})]);
}
var CPControlValueKey = "CPControlValueKey",
    CPControlControlStateKey = "CPControlControlStateKey",
    CPControlIsEnabledKey = "CPControlIsEnabledKey",
    CPControlTargetKey = "CPControlTargetKey",
    CPControlActionKey = "CPControlActionKey",
    CPControlSendActionOnKey = "CPControlSendActionOnKey",
    CPControlSendsActionOnEndEditingKey = "CPControlSendsActionOnEndEditingKey";
var __Deprecated__CPImageViewImageKey = "CPImageViewImageKey";
{
var the_class = objj_getClass("CPControl")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPControl\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPControl").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        objj_msgSend(self, "setObjectValue:", objj_msgSend(aCoder, "decodeObjectForKey:", CPControlValueKey));
        objj_msgSend(self, "setTarget:", objj_msgSend(aCoder, "decodeObjectForKey:", CPControlTargetKey));
        objj_msgSend(self, "setAction:", objj_msgSend(aCoder, "decodeObjectForKey:", CPControlActionKey));
        objj_msgSend(self, "sendActionOn:", objj_msgSend(aCoder, "decodeIntForKey:", CPControlSendActionOnKey));
        objj_msgSend(self, "setSendsActionOnEndEditing:", objj_msgSend(aCoder, "decodeBoolForKey:", CPControlSendsActionOnEndEditingKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPControl").super_class }, "encodeWithCoder:", aCoder);
    if (_sendsActionOnEndEditing)
        objj_msgSend(aCoder, "encodeBool:forKey:", _sendsActionOnEndEditing, CPControlSendsActionOnEndEditingKey);
    if (_value !== nil)
        objj_msgSend(aCoder, "encodeObject:forKey:", _value, CPControlValueKey);
    if (_target !== nil)
        objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _target, CPControlTargetKey);
    if (_action !== NULL)
        objj_msgSend(aCoder, "encodeObject:forKey:", _action, CPControlActionKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _sendActionOn, CPControlSendActionOnKey);
}
})]);
}
var _CPControlSizeIdentifiers = [],
    _CPControlCachedColorWithPatternImages = {},
    _CPControlCachedThreePartImagePattern = {};
_CPControlSizeIdentifiers[CPRegularControlSize] = "Regular";
_CPControlSizeIdentifiers[CPSmallControlSize] = "Small";
_CPControlSizeIdentifiers[CPMiniControlSize] = "Mini";
_CPControlIdentifierForControlSize= function(aControlSize)
{
    return _CPControlSizeIdentifiers[aControlSize];
}
_CPControlColorWithPatternImage= function(sizes, aClassName)
{
    var index = 1,
        count = arguments.length,
        identifier = "";
    for (; index < count; ++index)
        identifier += arguments[index];
    var color = _CPControlCachedColorWithPatternImages[identifier];
    if (!color)
    {
        var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPControl, "class"));
        color = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", aClassName + "/" + identifier + ".png"), sizes[identifier]));
        _CPControlCachedColorWithPatternImages[identifier] = color;
    }
    return color;
}
_CPControlThreePartImagePattern= function(isVertical, sizes, aClassName)
{
    var index = 2,
        count = arguments.length,
        identifier = "";
    for (; index < count; ++index)
        identifier += arguments[index];
    var color = _CPControlCachedThreePartImagePattern[identifier];
    if (!color)
    {
        var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPControl, "class")),
            path = aClassName + "/" + identifier;
        sizes = sizes[identifier];
        color = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPThreePartImage, "alloc"), "initWithImageSlices:isVertical:", [
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", path + "0.png"), sizes[0]),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", path + "1.png"), sizes[1]),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", path + "2.png"), sizes[2])
                ], isVertical));
        _CPControlCachedThreePartImagePattern[identifier] = color;
    }
    return color;
}

p;10;CPCookie.jt;1787;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.jt;1716;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPCookie"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_cookieName"), new objj_ivar("_cookieValue"), new objj_ivar("_expires")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithName:"), function(self, _cmd, aName)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCookie").super_class }, "init");
    _cookieName = aName;
    _cookieValue = objj_msgSend(self, "_readCookieValue");
    return self;
}
}), new objj_method(sel_getUid("value"), function(self, _cmd)
{ with(self)
{
    return _cookieValue;
}
}), new objj_method(sel_getUid("name"), function(self, _cmd)
{ with(self)
{
    return _cookieName;
}
}), new objj_method(sel_getUid("expires"), function(self, _cmd)
{ with(self)
{
    return _expires;
}
}), new objj_method(sel_getUid("setValue:expires:domain:"), function(self, _cmd, value, date, domain)
{ with(self)
{
    if(date)
        var expires = "; expires="+date.toGMTString();
    else
        var expires = "";
    if(domain)
        domain = "; domain="+domain;
    else
        domain = "";
 document.cookie = _cookieName+"="+value+expires+"; path=/"+domain;
}
}), new objj_method(sel_getUid("_readCookieValue"), function(self, _cmd)
{ with(self)
{
 var nameEQ = _cookieName + "=";
 var ca = document.cookie.split(';');
 for(var i=0;i < ca.length;i++) {
  var c = ca[i];
  while (c.charAt(0)==' ') c = c.substring(1,c.length);
  if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
 }
 return "";
}
})]);
}

p;10;CPCursor.jt;9082;@STATIC;1.0;t;9063;var currentCursor = nil,
    cursorStack = [],
    cursors = {},
    cursorURLFormat = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPCursor"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_cssString"), new objj_ivar("_isSetOnMouseEntered"), new objj_ivar("_isSetOnMouseExited")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isSetOnMouseEntered"), function(self, _cmd)
{ with(self)
{
return _isSetOnMouseEntered;
}
}),
new objj_method(sel_getUid("setOnMouseEntered:"), function(self, _cmd, newValue)
{ with(self)
{
_isSetOnMouseEntered = newValue;
}
}),
new objj_method(sel_getUid("isSetOnMouseExited"), function(self, _cmd)
{ with(self)
{
return _isSetOnMouseExited;
}
}),
new objj_method(sel_getUid("setOnMouseExited:"), function(self, _cmd, newValue)
{ with(self)
{
_isSetOnMouseExited = newValue;
}
}), new objj_method(sel_getUid("initWithCSSString:"), function(self, _cmd, aString)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCursor").super_class }, "init"))
        _cssString = aString;
    return self;
}
}), new objj_method(sel_getUid("_cssString"), function(self, _cmd)
{ with(self)
{
    return _cssString;
}
}), new objj_method(sel_getUid("initWithImage:hotSpot:"), function(self, _cmd, image, hotSpot)
{ with(self)
{
    return objj_msgSend(self, "initWithCSSString:", "url(" + objj_msgSend(image, "filename") + ")");
}
}), new objj_method(sel_getUid("mouseEntered:"), function(self, _cmd, event)
{ with(self)
{
}
}), new objj_method(sel_getUid("mouseExited:"), function(self, _cmd, event)
{ with(self)
{
}
}), new objj_method(sel_getUid("set"), function(self, _cmd)
{ with(self)
{
    currentCursor = self;
    objj_msgSend(objj_msgSend(self, "class"), "_setCursorCSS:", _cssString);
}
}), new objj_method(sel_getUid("push"), function(self, _cmd)
{ with(self)
{
    currentCursor = cursorStack.push(self);
}
}), new objj_method(sel_getUid("pop"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(CPCursor, "pop");
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, coder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCursor").super_class }, "init"))
        _cssString = objj_msgSend(coder, "decodeObjectForKey:", "CPCursorNameKey");
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, coder)
{ with(self)
{
    objj_msgSend(coder, "encodeObject:forKey:", _cssString, "CPCursorNameKey");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("currentCursor"), function(self, _cmd)
{ with(self)
{
    return currentCursor;
}
}), new objj_method(sel_getUid("cursorWithCSSString:"), function(self, _cmd, cssString)
{ with(self)
{
    var cursor = cursors[cssString];
    if (typeof cursor == 'undefined')
    {
        cursor = objj_msgSend(objj_msgSend(CPCursor, "alloc"), "initWithCSSString:", cssString);
        cursors[cssString] = cursor;
    }
    return cursor;
}
}), new objj_method(sel_getUid("cursorWithImageNamed:"), function(self, _cmd, imageName)
{ with(self)
{
    if (!cursorURLFormat)
    {
        cursorURLFormat = "url(" + objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", self), "resourcePath") + "/CPCursor/%@.cur)";
        if (CPBrowserIsEngine(CPGeckoBrowserEngine))
            cursorURLFormat += ", default";
    }
    var url = objj_msgSend(CPString, "stringWithFormat:", cursorURLFormat, imageName);
    return objj_msgSend(objj_msgSend(CPCursor, "alloc"), "initWithCSSString:", url);
}
}), new objj_method(sel_getUid("arrowCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "default");
}
}), new objj_method(sel_getUid("crosshairCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "crosshair");
}
}), new objj_method(sel_getUid("IBeamCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "text");
}
}), new objj_method(sel_getUid("pointingHandCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "pointer");
}
}), new objj_method(sel_getUid("resizeDownCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "s-resize");
}
}), new objj_method(sel_getUid("resizeUpCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "n-resize");
}
}), new objj_method(sel_getUid("resizeLeftCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "w-resize");
}
}), new objj_method(sel_getUid("resizeRightCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "e-resize");
}
}), new objj_method(sel_getUid("resizeLeftRightCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "col-resize");
}
}), new objj_method(sel_getUid("resizeUpDownCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "row-resize");
}
}), new objj_method(sel_getUid("operationNotAllowedCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "not-allowed");
}
}), new objj_method(sel_getUid("dragCopyCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "copy");
}
}), new objj_method(sel_getUid("dragLinkCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "alias");
}
}), new objj_method(sel_getUid("contextualMenuCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
    return objj_msgSend(CPCursor, "cursorWithCSSString:", "context-menu");
}
}), new objj_method(sel_getUid("openHandCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPWebKitBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithCSSString:", "-webkit-grab");
    else if (CPBrowserIsEngine(CPGeckoBrowserEngine) || CPBrowserIsEngine(CPOperaBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithCSSString:", "move");
    return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
}
}), new objj_method(sel_getUid("closedHandCursor"), function(self, _cmd)
{ with(self)
{
    if (CPBrowserIsEngine(CPWebKitBrowserEngine))
        return objj_msgSend(CPCursor, "cursorWithCSSString:", "-webkit-grabbing");
    return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
}
}), new objj_method(sel_getUid("disappearingItemCursor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPCursor, "cursorWithImageNamed:", CPStringFromSelector(_cmd));
}
}), new objj_method(sel_getUid("hide"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_setCursorCSS:", "none");
}
}), new objj_method(sel_getUid("unhide"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_setCursorCSS:", objj_msgSend(currentCursor, "_cssString"))
}
}), new objj_method(sel_getUid("setHiddenUntilMouseMoves:"), function(self, _cmd, flag)
{ with(self)
{
    if (flag)
        objj_msgSend(CPCursor, "hide");
    else
        objj_msgSend(CPCursor, "unhide");
}
}), new objj_method(sel_getUid("_setCursorCSS:"), function(self, _cmd, aString)
{ with(self)
{
    objj_msgSend(CPPlatformWindow, "primaryPlatformWindow")._DOMBodyElement.style.cursor = aString;
    var platformWindows = objj_msgSend(objj_msgSend(CPPlatformWindow, "visiblePlatformWindows"), "allObjects");
    for (var i = 0, count = objj_msgSend(platformWindows, "count"); i < count; i++)
        platformWindows[i]._DOMBodyElement.style.cursor = aString;
}
}), new objj_method(sel_getUid("pop"), function(self, _cmd)
{ with(self)
{
    if (cursorStack.length > 1)
    {
        cursorStack.pop();
        currentCursor = cursorStack[cursorStack.length - 1];
    }
}
})]);
}

p;12;CPDocument.jt;24293;@STATIC;1.0;I;21;Foundation/CPString.jI;20;Foundation/CPArray.ji;13;CPResponder.ji;13;CPSavePanel.ji;18;CPViewController.ji;20;CPWindowController.jt;24138;objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("CPResponder.j", true);
objj_executeFile("CPSavePanel.j", true);
objj_executeFile("CPViewController.j", true);
objj_executeFile("CPWindowController.j", true);
CPSaveOperation = 0;
CPSaveAsOperation = 1;
CPSaveToOperation = 2;
CPAutosaveOperation = 3;
CPChangeDone = 0;
CPChangeUndone = 1;
CPChangeCleared = 2;
CPChangeReadOtherContents = 3;
CPChangeAutosaved = 4;
CPDocumentWillSaveNotification = "CPDocumentWillSaveNotification";
CPDocumentDidSaveNotification = "CPDocumentDidSaveNotification";
CPDocumentDidFailToSaveNotification = "CPDocumentDidFailToSaveNotification";
var CPDocumentUntitledCount = 0;
{var the_class = objj_allocateClassPair(CPResponder, "CPDocument"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_window"), new objj_ivar("_view"), new objj_ivar("_viewControllersForWindowControllers"), new objj_ivar("_fileURL"), new objj_ivar("_fileType"), new objj_ivar("_windowControllers"), new objj_ivar("_untitledDocumentIndex"), new objj_ivar("_hasUndoManager"), new objj_ivar("_undoManager"), new objj_ivar("_changeCount"), new objj_ivar("_readConnection"), new objj_ivar("_writeRequest"), new objj_ivar("_canCloseAlert")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPDocument").super_class }, "init");
    if (self)
    {
        _windowControllers = [];
        _viewControllersForWindowControllers = objj_msgSend(CPDictionary, "dictionary");
        _hasUndoManager = YES;
        _changeCount = 0;
        objj_msgSend(self, "setNextResponder:", CPApp);
    }
    return self;
}
}), new objj_method(sel_getUid("initWithType:error:"), function(self, _cmd, aType, anError)
{ with(self)
{
    self = objj_msgSend(self, "init");
    if (self)
        objj_msgSend(self, "setFileType:", aType);
    return self;
}
}), new objj_method(sel_getUid("initWithContentsOfURL:ofType:delegate:didReadSelector:contextInfo:"), function(self, _cmd, anAbsoluteURL, aType, aDelegate, aDidReadSelector, aContextInfo)
{ with(self)
{
    self = objj_msgSend(self, "init");
    if (self)
    {
        objj_msgSend(self, "setFileURL:", anAbsoluteURL);
        objj_msgSend(self, "setFileType:", aType);
        objj_msgSend(self, "readFromURL:ofType:delegate:didReadSelector:contextInfo:", anAbsoluteURL, aType, aDelegate, aDidReadSelector, aContextInfo);
    }
    return self;
}
}), new objj_method(sel_getUid("initForURL:withContentsOfURL:ofType:delegate:didReadSelector:contextInfo:"), function(self, _cmd, anAbsoluteURL, absoluteContentsURL, aType, aDelegate, aDidReadSelector, aContextInfo)
{ with(self)
{
    self = objj_msgSend(self, "init");
    if (self)
    {
        objj_msgSend(self, "setFileURL:", anAbsoluteURL);
        objj_msgSend(self, "setFileType:", aType);
        objj_msgSend(self, "readFromURL:ofType:delegate:didReadSelector:contextInfo:", absoluteContentsURL, aType, aDelegate, aDidReadSelector, aContextInfo);
    }
    return self;
}
}), new objj_method(sel_getUid("dataOfType:error:"), function(self, _cmd, aType, anError)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "dataOfType:error: must be overridden by the document subclass.");
}
}), new objj_method(sel_getUid("readFromData:ofType:error:"), function(self, _cmd, aData, aType, anError)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "readFromData:ofType: must be overridden by the document subclass.");
}
}), new objj_method(sel_getUid("viewControllerWillLoadCib:"), function(self, _cmd, aViewController)
{ with(self)
{
}
}), new objj_method(sel_getUid("viewControllerDidLoadCib:"), function(self, _cmd, aViewController)
{ with(self)
{
}
}), new objj_method(sel_getUid("firstEligibleExistingWindowController"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("makeWindowControllers"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "makeViewAndWindowControllers");
}
}), new objj_method(sel_getUid("makeViewAndWindowControllers"), function(self, _cmd)
{ with(self)
{
    var viewCibName = objj_msgSend(self, "viewCibName"),
        viewController = nil,
        windowController = nil;
    if (objj_msgSend(viewCibName, "length"))
        viewController = objj_msgSend(objj_msgSend(CPViewController, "alloc"), "initWithCibName:bundle:owner:", viewCibName, nil, self);
    if (viewController)
        windowController = objj_msgSend(self, "firstEligibleExistingWindowController");
    if (!windowController)
    {
        var windowCibName = objj_msgSend(self, "windowCibName");
        if (objj_msgSend(windowCibName, "length"))
            windowController = objj_msgSend(objj_msgSend(CPWindowController, "alloc"), "initWithWindowCibName:owner:", windowCibName, self);
        else if (viewController)
        {
            var view = objj_msgSend(viewController, "view"),
                viewFrame = objj_msgSend(view, "frame");
            viewFrame.origin = CGPointMake(50, 50);
            var theWindow = objj_msgSend(objj_msgSend(CPWindow, "alloc"), "initWithContentRect:styleMask:", viewFrame, CPTitledWindowMask | CPClosableWindowMask | CPMiniaturizableWindowMask | CPResizableWindowMask);
            windowController = objj_msgSend(objj_msgSend(CPWindowController, "alloc"), "initWithWindow:", theWindow);
        }
    }
    if (windowController && viewController)
        objj_msgSend(windowController, "setSupportsMultipleDocuments:", YES);
    if (windowController)
        objj_msgSend(self, "addWindowController:", windowController);
    if (viewController)
        objj_msgSend(self, "addViewController:forWindowController:", viewController, windowController);
}
}), new objj_method(sel_getUid("windowControllers"), function(self, _cmd)
{ with(self)
{
    return _windowControllers;
}
}), new objj_method(sel_getUid("addWindowController:"), function(self, _cmd, aWindowController)
{ with(self)
{
    objj_msgSend(_windowControllers, "addObject:", aWindowController);
    if (objj_msgSend(aWindowController, "document") !== self)
        objj_msgSend(aWindowController, "setDocument:", self);
}
}), new objj_method(sel_getUid("removeWindowController:"), function(self, _cmd, aWindowController)
{ with(self)
{
    if (aWindowController)
        objj_msgSend(_windowControllers, "removeObject:", aWindowController);
    if (objj_msgSend(aWindowController, "document") === self)
        objj_msgSend(aWindowController, "setDocument:", nil);
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return _view;
}
}), new objj_method(sel_getUid("viewControllers"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_viewControllersForWindowControllers, "allValues");
}
}), new objj_method(sel_getUid("addViewController:forWindowController:"), function(self, _cmd, aViewController, aWindowController)
{ with(self)
{
    objj_msgSend(_viewControllersForWindowControllers, "setObject:forKey:", aViewController, objj_msgSend(aWindowController, "UID"));
    if (objj_msgSend(aWindowController, "document") === self)
        objj_msgSend(aWindowController, "setViewController:", aViewController);
}
}), new objj_method(sel_getUid("removeViewController:"), function(self, _cmd, aViewController)
{ with(self)
{
    objj_msgSend(_viewControllersForWindowControllers, "removeObject:", aViewController);
}
}), new objj_method(sel_getUid("viewControllerForWindowController:"), function(self, _cmd, aWindowController)
{ with(self)
{
    return objj_msgSend(_viewControllersForWindowControllers, "objectForKey:", objj_msgSend(aWindowController, "UID"));
}
}), new objj_method(sel_getUid("showWindows"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_windowControllers, "makeObjectsPerformSelector:withObject:", sel_getUid("setDocument:"), self);
    objj_msgSend(_windowControllers, "makeObjectsPerformSelector:withObject:", sel_getUid("showWindow:"), self);
}
}), new objj_method(sel_getUid("displayName"), function(self, _cmd)
{ with(self)
{
    if (_fileURL)
        return objj_msgSend(_fileURL, "lastPathComponent");
    if (!_untitledDocumentIndex)
        _untitledDocumentIndex = ++CPDocumentUntitledCount;
 if (_untitledDocumentIndex == 1)
    return "Untitled";
 return "Untitled " + _untitledDocumentIndex;
}
}), new objj_method(sel_getUid("viewCibName"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("windowCibName"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("windowControllerDidLoadCib:"), function(self, _cmd, aWindowController)
{ with(self)
{
}
}), new objj_method(sel_getUid("windowControllerWillLoadCib:"), function(self, _cmd, aWindowController)
{ with(self)
{
}
}), new objj_method(sel_getUid("readFromURL:ofType:delegate:didReadSelector:contextInfo:"), function(self, _cmd, anAbsoluteURL, aType, aDelegate, aDidReadSelector, aContextInfo)
{ with(self)
{
    objj_msgSend(_readConnection, "cancel");
    _readConnection = objj_msgSend(CPURLConnection, "connectionWithRequest:delegate:", objj_msgSend(CPURLRequest, "requestWithURL:", anAbsoluteURL), self);
    _readConnection.session = _CPReadSessionMake(aType, aDelegate, aDidReadSelector, aContextInfo);
}
}), new objj_method(sel_getUid("fileURL"), function(self, _cmd)
{ with(self)
{
    return _fileURL;
}
}), new objj_method(sel_getUid("setFileURL:"), function(self, _cmd, aFileURL)
{ with(self)
{
    if (_fileURL === aFileURL)
        return;
    _fileURL = aFileURL;
    objj_msgSend(_windowControllers, "makeObjectsPerformSelector:", sel_getUid("synchronizeWindowTitleWithDocumentName"));
}
}), new objj_method(sel_getUid("saveToURL:ofType:forSaveOperation:delegate:didSaveSelector:contextInfo:"), function(self, _cmd, anAbsoluteURL, aTypeName, aSaveOperation, aDelegate, aDidSaveSelector, aContextInfo)
{ with(self)
{
    var data = objj_msgSend(self, "dataOfType:error:", objj_msgSend(self, "fileType"), nil),
        oldChangeCount = _changeCount;
    _writeRequest = objj_msgSend(CPURLRequest, "requestWithURL:", anAbsoluteURL);
    if (objj_msgSend(CPPlatform, "isBrowser"))
        objj_msgSend(_writeRequest, "setHTTPMethod:", "POST");
    else
        objj_msgSend(_writeRequest, "setHTTPMethod:", "PUT");
    objj_msgSend(_writeRequest, "setHTTPBody:", objj_msgSend(data, "encodedString"));
    objj_msgSend(_writeRequest, "setValue:forHTTPHeaderField:", "close", "Connection");
    if (aSaveOperation == CPSaveOperation)
        objj_msgSend(_writeRequest, "setValue:forHTTPHeaderField:", "true", "x-cappuccino-overwrite");
    if (aSaveOperation != CPSaveToOperation)
        objj_msgSend(self, "updateChangeCount:", CPChangeCleared);
    var connection = objj_msgSend(CPURLConnection, "connectionWithRequest:delegate:", _writeRequest, self);
    connection.session = _CPSaveSessionMake(anAbsoluteURL, aSaveOperation, oldChangeCount, aDelegate, aDidSaveSelector, aContextInfo, connection);
}
}), new objj_method(sel_getUid("connection:didReceiveResponse:"), function(self, _cmd, aConnection, aResponse)
{ with(self)
{
    if (!objj_msgSend(aResponse, "isKindOfClass:", objj_msgSend(CPHTTPURLResponse, "class")))
        return;
    var statusCode = objj_msgSend(aResponse, "statusCode");
    if (statusCode === 200)
        return;
    var session = aConnection.session;
    if (aConnection == _readConnection)
    {
        objj_msgSend(aConnection, "cancel");
        alert("There was an error retrieving the document.");
        objj_msgSend(session.delegate, session.didReadSelector, self, NO, session.contextInfo);
    }
    else
    {
        if (statusCode == 409)
        {
            objj_msgSend(aConnection, "cancel");
            if (confirm("There already exists a file with that name, would you like to overwrite it?"))
            {
                objj_msgSend(_writeRequest, "setValue:forHTTPHeaderField:", "true", "x-cappuccino-overwrite");
                objj_msgSend(aConnection, "start");
            }
            else
            {
                if (session.saveOperation != CPSaveToOperation)
                {
                    _changeCount += session.changeCount;
                    objj_msgSend(_windowControllers, "makeObjectsPerformSelector:withObject:", sel_getUid("setDocumentEdited:"), objj_msgSend(self, "isDocumentEdited"));
                }
                _writeRequest = nil;
                objj_msgSend(session.delegate, session.didSaveSelector, self, NO, session.contextInfo);
                objj_msgSend(self, "_sendDocumentSavedNotification:", NO);
            }
        }
    }
}
}), new objj_method(sel_getUid("connection:didReceiveData:"), function(self, _cmd, aConnection, aData)
{ with(self)
{
    var session = aConnection.session;
    if (aConnection == _readConnection)
    {
        objj_msgSend(self, "readFromData:ofType:error:", objj_msgSend(CPData, "dataWithEncodedString:", aData), session.fileType, nil);
        objj_msgSend(session.delegate, session.didReadSelector, self, YES, session.contextInfo);
    }
    else
    {
        if (session.saveOperation != CPSaveToOperation)
            objj_msgSend(self, "setFileURL:", session.absoluteURL);
        _writeRequest = nil;
        objj_msgSend(session.delegate, session.didSaveSelector, self, YES, session.contextInfo);
        objj_msgSend(self, "_sendDocumentSavedNotification:", YES);
    }
}
}), new objj_method(sel_getUid("connection:didFailWithError:"), function(self, _cmd, aConnection, anError)
{ with(self)
{
    var session = aConnection.session;
    if (_readConnection == aConnection)
        objj_msgSend(session.delegate, session.didReadSelector, self, NO, session.contextInfo);
    else
    {
        if (session.saveOperation != CPSaveToOperation)
        {
            _changeCount += session.changeCount;
            objj_msgSend(_windowControllers, "makeObjectsPerformSelector:withObject:", sel_getUid("setDocumentEdited:"), objj_msgSend(self, "isDocumentEdited"));
        }
        _writeRequest = nil;
        alert("There was an error saving the document.");
        objj_msgSend(session.delegate, session.didSaveSelector, self, NO, session.contextInfo);
        objj_msgSend(self, "_sendDocumentSavedNotification:", NO);
    }
}
}), new objj_method(sel_getUid("connectionDidFinishLoading:"), function(self, _cmd, aConnection)
{ with(self)
{
    if (_readConnection == aConnection)
        _readConnection = nil;
}
}), new objj_method(sel_getUid("isDocumentEdited"), function(self, _cmd)
{ with(self)
{
    return _changeCount != 0;
}
}), new objj_method(sel_getUid("updateChangeCount:"), function(self, _cmd, aChangeType)
{ with(self)
{
    if (aChangeType == CPChangeDone)
        ++_changeCount;
    else if (aChangeType == CPChangeUndone)
        --_changeCount;
    else if (aChangeType == CPChangeCleared)
        _changeCount = 0;
    objj_msgSend(_windowControllers, "makeObjectsPerformSelector:withObject:", sel_getUid("setDocumentEdited:"), objj_msgSend(self, "isDocumentEdited"));
}
}), new objj_method(sel_getUid("setFileType:"), function(self, _cmd, aType)
{ with(self)
{
    _fileType = aType;
}
}), new objj_method(sel_getUid("fileType"), function(self, _cmd)
{ with(self)
{
    return _fileType;
}
}), new objj_method(sel_getUid("hasUndoManager"), function(self, _cmd)
{ with(self)
{
    return _hasUndoManager;
}
}), new objj_method(sel_getUid("setHasUndoManager:"), function(self, _cmd, aFlag)
{ with(self)
{
    if (_hasUndoManager == aFlag)
        return;
    _hasUndoManager = aFlag;
    if (!_hasUndoManager)
        objj_msgSend(self, "setUndoManager:", nil);
}
}), new objj_method(sel_getUid("_undoManagerWillCloseGroup:"), function(self, _cmd, aNotification)
{ with(self)
{
    var undoManager = objj_msgSend(aNotification, "object");
    if (objj_msgSend(undoManager, "isUndoing") || objj_msgSend(undoManager, "isRedoing"))
        return;
    objj_msgSend(self, "updateChangeCount:", CPChangeDone);
}
}), new objj_method(sel_getUid("_undoManagerDidUndoChange:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "updateChangeCount:", CPChangeUndone);
}
}), new objj_method(sel_getUid("_undoManagerDidRedoChange:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "updateChangeCount:", CPChangeDone);
}
}), new objj_method(sel_getUid("setUndoManager:"), function(self, _cmd, anUndoManager)
{ with(self)
{
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_undoManager)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPUndoManagerDidUndoChangeNotification, _undoManager);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPUndoManagerDidRedoChangeNotification, _undoManager);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPUndoManagerWillCloseUndoGroupNotification, _undoManager);
    }
    _undoManager = anUndoManager;
    if (_undoManager)
    {
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("_undoManagerDidUndoChange:"), CPUndoManagerDidUndoChangeNotification, _undoManager);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("_undoManagerDidRedoChange:"), CPUndoManagerDidRedoChangeNotification, _undoManager);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("_undoManagerWillCloseGroup:"), CPUndoManagerWillCloseUndoGroupNotification, _undoManager);
    }
}
}), new objj_method(sel_getUid("undoManager"), function(self, _cmd)
{ with(self)
{
    if (_hasUndoManager && !_undoManager)
        objj_msgSend(self, "setUndoManager:", objj_msgSend(objj_msgSend(CPUndoManager, "alloc"), "init"));
    return _undoManager;
}
}), new objj_method(sel_getUid("windowWillReturnUndoManager:"), function(self, _cmd, aWindow)
{ with(self)
{
    return objj_msgSend(self, "undoManager");
}
}), new objj_method(sel_getUid("saveDocument:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "saveDocumentWithDelegate:didSaveSelector:contextInfo:", nil, nil, nil);
}
}), new objj_method(sel_getUid("saveDocumentWithDelegate:didSaveSelector:contextInfo:"), function(self, _cmd, delegate, didSaveSelector, contextInfo)
{ with(self)
{
    if (_fileURL)
    {
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPDocumentWillSaveNotification, self);
        objj_msgSend(self, "saveToURL:ofType:forSaveOperation:delegate:didSaveSelector:contextInfo:", _fileURL, objj_msgSend(self, "fileType"), CPSaveOperation, delegate, didSaveSelector, contextInfo);
    }
    else
        objj_msgSend(self, "_saveDocumentAsWithDelegate:didSaveSelector:contextInfo:", delegate, didSaveSelector, contextInfo);
}
}), new objj_method(sel_getUid("saveDocumentAs:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "_saveDocumentAsWithDelegate:didSaveSelector:contextInfo:", nil, nil, nil);
}
}), new objj_method(sel_getUid("_saveDocumentAsWithDelegate:didSaveSelector:contextInfo:"), function(self, _cmd, delegate, didSaveSelector, contextInfo)
{ with(self)
{
    var savePanel = objj_msgSend(CPSavePanel, "savePanel"),
        response = objj_msgSend(savePanel, "runModal");
    if (!response)
        return;
    var saveURL = objj_msgSend(savePanel, "URL");
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPDocumentWillSaveNotification, self);
    objj_msgSend(self, "saveToURL:ofType:forSaveOperation:delegate:didSaveSelector:contextInfo:", saveURL, objj_msgSend(self, "fileType"), CPSaveAsOperation, delegate, didSaveSelector, contextInfo);
}
}), new objj_method(sel_getUid("_sendDocumentSavedNotification:"), function(self, _cmd, didSave)
{ with(self)
{
    if (didSave)
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPDocumentDidSaveNotification, self);
    else
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPDocumentDidFailToSaveNotification, self);
}
})]);
}
{
var the_class = objj_getClass("CPDocument")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPDocument\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("close"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_windowControllers, "makeObjectsPerformSelector:withObject:", sel_getUid("removeDocumentAndCloseIfNecessary:"), self);
    objj_msgSend(objj_msgSend(CPDocumentController, "sharedDocumentController"), "removeDocument:", self);
}
}), new objj_method(sel_getUid("shouldCloseWindowController:delegate:shouldCloseSelector:contextInfo:"), function(self, _cmd, controller, delegate, selector, info)
{ with(self)
{
    if (objj_msgSend(controller, "shouldCloseDocument") || (objj_msgSend(_windowControllers, "count") < 2 && objj_msgSend(_windowControllers, "indexOfObject:", controller) !== CPNotFound))
        objj_msgSend(self, "canCloseDocumentWithDelegate:shouldCloseSelector:contextInfo:", self, sel_getUid("_document:shouldClose:context:"), {delegate:delegate, selector:selector, context:info});
    else if (objj_msgSend(delegate, "respondsToSelector:", selector))
        objj_msgSend(delegate, selector, self, YES, info);
}
}), new objj_method(sel_getUid("_document:shouldClose:context:"), function(self, _cmd, aDocument, shouldClose, context)
{ with(self)
{
    if (aDocument === self && shouldClose)
        objj_msgSend(self, "close");
    objj_msgSend(context.delegate, context.selector, aDocument, shouldClose, context.context);
}
}), new objj_method(sel_getUid("canCloseDocumentWithDelegate:shouldCloseSelector:contextInfo:"), function(self, _cmd, aDelegate, aSelector, context)
{ with(self)
{
    if (!objj_msgSend(self, "isDocumentEdited"))
        return objj_msgSend(aDelegate, "respondsToSelector:", aSelector) && objj_msgSend(aDelegate, aSelector, self, YES, context);
    _canCloseAlert = objj_msgSend(objj_msgSend(CPAlert, "alloc"), "init");
    objj_msgSend(_canCloseAlert, "setDelegate:", self);
    objj_msgSend(_canCloseAlert, "setAlertStyle:", CPWarningAlertStyle);
    objj_msgSend(_canCloseAlert, "setTitle:", "Unsaved Document");
    objj_msgSend(_canCloseAlert, "setMessageText:", sprintf("Do you want to save the changes you've made to the document \"%@\"?",
                                        objj_msgSend(self, "displayName") || objj_msgSend(self, "fileName")));
    objj_msgSend(_canCloseAlert, "addButtonWithTitle:", "Save");
    objj_msgSend(_canCloseAlert, "addButtonWithTitle:", "Cancel");
    objj_msgSend(_canCloseAlert, "addButtonWithTitle:", "Don't Save");
    _canCloseAlert._context = {delegate:aDelegate, selector:aSelector, context:context};
    objj_msgSend(_canCloseAlert, "runModal");
}
}), new objj_method(sel_getUid("alertDidEnd:returnCode:"), function(self, _cmd, alert, returnCode)
{ with(self)
{
    if (alert !== _canCloseAlert)
        return;
    var delegate = alert._context.delegate,
        selector = alert._context.selector,
        context = alert._context.context;
    if (returnCode === 0)
        objj_msgSend(self, "saveDocumentWithDelegate:didSaveSelector:contextInfo:", delegate, selector, context);
    else
        objj_msgSend(delegate, selector, self, returnCode === 2, context);
    _canCloseAlert = nil;
}
})]);
}
var _CPReadSessionMake = function(aType, aDelegate, aDidReadSelector, aContextInfo)
{
    return { fileType:aType, delegate:aDelegate, didReadSelector:aDidReadSelector, contextInfo:aContextInfo };
}
var _CPSaveSessionMake = function(anAbsoluteURL, aSaveOperation, aChangeCount, aDelegate, aDidSaveSelector, aContextInfo, aConnection)
{
    return { absoluteURL:anAbsoluteURL, saveOperation:aSaveOperation, changeCount:aChangeCount, delegate:aDelegate, didSaveSelector:aDidSaveSelector, contextInfo:aContextInfo, connection:aConnection };
}

p;22;CPDocumentController.jt;12742;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPBundle.ji;12;CPDocument.ji;13;CPOpenPanel.jt;12635;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPBundle.j", false);
objj_executeFile("CPDocument.j", true);
objj_executeFile("CPOpenPanel.j", true);;
var CPSharedDocumentController = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPDocumentController"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_documents"), new objj_ivar("_documentTypes")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPDocumentController").super_class }, "init");
    if (self)
    {
        _documents = objj_msgSend(objj_msgSend(CPArray, "alloc"), "init");
        if (!CPSharedDocumentController)
            CPSharedDocumentController = self;
        _documentTypes = objj_msgSend(objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "infoDictionary"), "objectForKey:", "CPBundleDocumentTypes");
    }
    return self;
}
}), new objj_method(sel_getUid("documentForURL:"), function(self, _cmd, aURL)
{ with(self)
{
    var index = 0,
        count = objj_msgSend(_documents, "count");
 for (; index < count; ++index)
    {
        var theDocument = _documents[index];
  if (objj_msgSend(objj_msgSend(theDocument, "fileURL"), "isEqual:", aURL))
   return theDocument;
    }
 return nil;
}
}), new objj_method(sel_getUid("openUntitledDocumentOfType:display:"), function(self, _cmd, aType, shouldDisplay)
{ with(self)
{
    var theDocument = objj_msgSend(self, "makeUntitledDocumentOfType:error:", aType, nil);
    if (theDocument)
        objj_msgSend(self, "addDocument:", theDocument);
    if (shouldDisplay)
    {
        objj_msgSend(theDocument, "makeWindowControllers");
        objj_msgSend(theDocument, "showWindows");
    }
    return theDocument;
}
}), new objj_method(sel_getUid("makeUntitledDocumentOfType:error:"), function(self, _cmd, aType, anError)
{ with(self)
{
    return objj_msgSend(objj_msgSend(objj_msgSend(self, "documentClassForType:", aType), "alloc"), "initWithType:error:", aType, anError);
}
}), new objj_method(sel_getUid("openDocumentWithContentsOfURL:display:error:"), function(self, _cmd, anAbsoluteURL, shouldDisplay, anError)
{ with(self)
{
    var result = objj_msgSend(self, "documentForURL:", anAbsoluteURL);
    if (!result)
    {
        var type = objj_msgSend(self, "typeForContentsOfURL:error:", anAbsoluteURL, anError);
        result = objj_msgSend(self, "makeDocumentWithContentsOfURL:ofType:delegate:didReadSelector:contextInfo:", anAbsoluteURL, type, self, sel_getUid("document:didRead:contextInfo:"), objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", shouldDisplay, "shouldDisplay"));
        objj_msgSend(self, "addDocument:", result);
        if (result)
            objj_msgSend(self, "noteNewRecentDocument:", result);
    }
    else if (shouldDisplay)
        objj_msgSend(result, "showWindows");
    return result;
}
}), new objj_method(sel_getUid("reopenDocumentForURL:withContentsOfURL:error:"), function(self, _cmd, anAbsoluteURL, absoluteContentsURL, anError)
{ with(self)
{
    return objj_msgSend(self, "makeDocumentForURL:withContentsOfURL:ofType:delegate:didReadSelector:contextInfo:", anAbsoluteURL, absoluteContentsURL, objj_msgSend(objj_msgSend(_documentTypes, "objectAtIndex:", 0), "objectForKey:", "CPBundleTypeName"), self, sel_getUid("document:didRead:contextInfo:"), nil);
}
}), new objj_method(sel_getUid("makeDocumentWithContentsOfURL:ofType:delegate:didReadSelector:contextInfo:"), function(self, _cmd, anAbsoluteURL, aType, aDelegate, aSelector, aContextInfo)
{ with(self)
{
    return objj_msgSend(objj_msgSend(objj_msgSend(self, "documentClassForType:", aType), "alloc"), "initWithContentsOfURL:ofType:delegate:didReadSelector:contextInfo:", anAbsoluteURL, aType, aDelegate, aSelector, aContextInfo);
}
}), new objj_method(sel_getUid("makeDocumentForURL:withContentsOfURL:ofType:delegate:didReadSelector:contextInfo:"), function(self, _cmd, anAbsoluteURL, absoluteContentsURL, aType, aDelegate, aSelector, aContextInfo)
{ with(self)
{
    return objj_msgSend(objj_msgSend(objj_msgSend(self, "documentClassForType:", aType), "alloc"), "initForURL:withContentsOfURL:ofType:delegate:didReadSelector:contextInfo:", anAbsoluteURL, absoluteContentsURL, aType, aDelegate, aSelector, aContextInfo);
}
}), new objj_method(sel_getUid("document:didRead:contextInfo:"), function(self, _cmd, aDocument, didRead, aContextInfo)
{ with(self)
{
    if (!didRead)
        return;
    objj_msgSend(aDocument, "makeWindowControllers");
    if (objj_msgSend(aContextInfo, "objectForKey:", "shouldDisplay"))
        objj_msgSend(aDocument, "showWindows");
}
}), new objj_method(sel_getUid("newDocument:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "openUntitledDocumentOfType:display:", objj_msgSend(objj_msgSend(_documentTypes, "objectAtIndex:", 0), "objectForKey:", "CPBundleTypeName"), YES);
}
}), new objj_method(sel_getUid("openDocument:"), function(self, _cmd, aSender)
{ with(self)
{
    var openPanel = objj_msgSend(CPOpenPanel, "openPanel");
    objj_msgSend(openPanel, "runModal");
    var URLs = objj_msgSend(openPanel, "URLs"),
        index = 0,
        count = objj_msgSend(URLs, "count");
    for (; index < count; ++index)
        objj_msgSend(self, "openDocumentWithContentsOfURL:display:error:", objj_msgSend(CPURL, "URLWithString:", URLs[index]), YES, nil);
}
}), new objj_method(sel_getUid("documents"), function(self, _cmd)
{ with(self)
{
    return _documents;
}
}), new objj_method(sel_getUid("addDocument:"), function(self, _cmd, aDocument)
{ with(self)
{
    objj_msgSend(_documents, "addObject:", aDocument);
}
}), new objj_method(sel_getUid("removeDocument:"), function(self, _cmd, aDocument)
{ with(self)
{
    objj_msgSend(_documents, "removeObjectIdenticalTo:", aDocument);
}
}), new objj_method(sel_getUid("defaultType"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_documentTypes[0], "objectForKey:", "CPBundleTypeName");
}
}), new objj_method(sel_getUid("typeForContentsOfURL:error:"), function(self, _cmd, anAbsoluteURL, outError)
{ with(self)
{
    var index = 0,
        count = _documentTypes.length,
        extension = objj_msgSend(objj_msgSend(anAbsoluteURL, "pathExtension"), "lowercaseString"),
        starType = nil;
    for (; index < count; ++index)
    {
        var documentType = _documentTypes[index],
            extensions = objj_msgSend(documentType, "objectForKey:", "CFBundleTypeExtensions"),
            extensionIndex = 0,
            extensionCount = extensions.length;
        for (; extensionIndex < extensionCount; ++extensionIndex)
        {
            var thisExtension = objj_msgSend(extensions[extensionIndex], "lowercaseString");
            if (thisExtension === extension)
                return objj_msgSend(documentType, "objectForKey:", "CPBundleTypeName");
            if (thisExtension === "****")
                starType = objj_msgSend(documentType, "objectForKey:", "CPBundleTypeName");
        }
    }
    return starType || objj_msgSend(self, "defaultType");
}
}), new objj_method(sel_getUid("_infoForType:"), function(self, _cmd, aType)
{ with(self)
{
    var i = 0,
        count = objj_msgSend(_documentTypes, "count");
    for (;i < count; ++i)
    {
        var documentType = _documentTypes[i];
        if (objj_msgSend(documentType, "objectForKey:", "CPBundleTypeName") == aType)
            return documentType;
    }
    return nil;
}
}), new objj_method(sel_getUid("documentClassForType:"), function(self, _cmd, aType)
{ with(self)
{
    var className = objj_msgSend(objj_msgSend(self, "_infoForType:", aType), "objectForKey:", "CPDocumentClass");
    return className ? CPClassFromString(className) : nil;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("sharedDocumentController"), function(self, _cmd)
{ with(self)
{
    if (!CPSharedDocumentController)
        objj_msgSend(objj_msgSend(self, "alloc"), "init");
    return CPSharedDocumentController;
}
})]);
}
{
var the_class = objj_getClass("CPDocumentController")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPDocumentController\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("closeAllDocumentsWithDelegate:didCloseAllSelector:contextInfo:"), function(self, _cmd, aDelegate, didCloseSelector, info)
{ with(self)
{
    var context = {
        delegate: aDelegate,
        selector: didCloseSelector,
        context: info
    };
    objj_msgSend(self, "_closeDocumentsStartingWith:shouldClose:context:", nil, YES, context);
}
}), new objj_method(sel_getUid("_closeDocumentsStartingWith:shouldClose:context:"), function(self, _cmd, aDocument, shouldClose, context)
{ with(self)
{
    if (shouldClose)
    {
        objj_msgSend(aDocument, "close");
        if (objj_msgSend(objj_msgSend(self, "documents"), "count") > 0)
        {
            objj_msgSend(objj_msgSend(objj_msgSend(self, "documents"), "lastObject"), "canCloseDocumentWithDelegate:shouldCloseSelector:contextInfo:", self, sel_getUid("_closeDocumentsStartingWith:shouldClose:context:"), context);
            return;
        }
    }
    if (objj_msgSend(context.delegate, "respondsToSelector:", context.selector))
        objj_msgSend(context.delegate, context.selector, self, objj_msgSend(objj_msgSend(self, "documents"), "count") === 0, context.context);
}
})]);
}
{
var the_class = objj_getClass("CPDocumentController")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPDocumentController\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("recentDocumentURLs"), function(self, _cmd)
{ with(self)
{
    if (typeof window["cpRecentDocumentURLs"] === 'function')
        return window.cpRecentDocumentURLs();
    return [];
}
}), new objj_method(sel_getUid("clearRecentDocuments:"), function(self, _cmd, sender)
{ with(self)
{
    if (typeof window["cpClearRecentDocuments"] === 'function')
        window.cpClearRecentDocuments();
   objj_msgSend(self, "_updateRecentDocumentsMenu");
}
}), new objj_method(sel_getUid("noteNewRecentDocument:"), function(self, _cmd, aDocument)
{ with(self)
{
    objj_msgSend(self, "noteNewRecentDocumentURL:", objj_msgSend(objj_msgSend(aDocument, "fileURL"), "absoluteString"));
}
}), new objj_method(sel_getUid("noteNewRecentDocumentURL:"), function(self, _cmd, aURL)
{ with(self)
{
    if (typeof window["cpNoteNewRecentDocumentPath"] === 'function')
        window.cpNoteNewRecentDocumentPath(aURL);
   objj_msgSend(self, "_updateRecentDocumentsMenu");
}
}), new objj_method(sel_getUid("_removeAllRecentDocumentsFromMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    var items = objj_msgSend(aMenu, "itemArray"),
        count = objj_msgSend(items, "count");
    while (count--)
    {
        var item = items[count];
        if (objj_msgSend(item, "action") === sel_getUid("_openRecentDocument:"))
            objj_msgSend(aMenu, "removeItemAtIndex:", count);
    }
}
}), new objj_method(sel_getUid("_updateRecentDocumentsMenu"), function(self, _cmd)
{ with(self)
{
    var menu = objj_msgSend(objj_msgSend(CPApp, "mainMenu"), "_menuWithName:", "_CPRecentDocumentsMenu"),
        recentDocuments = objj_msgSend(self, "recentDocumentURLs"),
        menuItems = objj_msgSend(menu, "itemArray"),
        documentCount = objj_msgSend(recentDocuments, "count"),
        menuItemCount = objj_msgSend(menuItems, "count");
    objj_msgSend(self, "_removeAllRecentDocumentsFromMenu:", menu);
    if (menuItemCount)
    {
        if (!documentCount)
        {
            if (objj_msgSend(menuItems[0], "isSeparatorItem"))
                objj_msgSend(menu, "removeItemAtIndex:", 0);
        }
        else
        {
            if (!objj_msgSend(menuItems[0], "isSeparatorItem"))
                objj_msgSend(menu, "insertItem:atIndex:", objj_msgSend(CPMenuItem, "separatorItem"), 0);
        }
    }
    while (documentCount--)
    {
        var path = recentDocuments[documentCount],
            item = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", objj_msgSend(path, "lastPathComponent"), sel_getUid("_openRecentDocument:"), nil);
        objj_msgSend(item, "setTag:", path);
        objj_msgSend(menu, "insertItem:atIndex:", item, 0);
    }
}
}), new objj_method(sel_getUid("_openRecentDocument:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "openDocumentWithContentsOfURL:display:error:", objj_msgSend(sender, "tag"), YES, nil);
}
})]);
}

p;14;CPDragServer.jt;15811;@STATIC;1.0;I;15;AppKit/CPView.jI;16;AppKit/CPEvent.jI;21;AppKit/CPPasteboard.jI;20;AppKit/CPImageView.jt;15699;objj_executeFile("AppKit/CPView.j", false);
objj_executeFile("AppKit/CPEvent.j", false);
objj_executeFile("AppKit/CPPasteboard.j", false);
objj_executeFile("AppKit/CPImageView.j", false);
CPDragOperationNone = 0,
CPDragOperationCopy = 1 << 1,
CPDragOperationLink = 1 << 1,
CPDragOperationGeneric = 1 << 2,
CPDragOperationPrivate = 1 << 3,
CPDragOperationMove = 1 << 4,
CPDragOperationDelete = 1 << 5,
CPDragOperationEvery = -1;
var CPDragServerPreviousEvent = nil,
CPDragServerAutoscrollInterval = nil;
var CPSharedDragServer = nil;
var CPDragServerSource = nil;
var CPDragServerDraggingInfo = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPDraggingInfo"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("draggingPasteboard"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        return objj_msgSend(_CPDOMDataTransferPasteboard, "DOMDataTransferPasteboard");
    return objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggingPasteboard");
}
}), new objj_method(sel_getUid("draggingSource"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggingSource");
}
}), new objj_method(sel_getUid("draggingLocation"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggingLocation");
}
}), new objj_method(sel_getUid("draggingDestinationWindow"), function(self, _cmd)
{ with(self)
{
    return (objj_msgSend(objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggingDestination"), "isKindOfClass:", objj_msgSend(CPWindow, "class")) ? objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggingDestination") : objj_msgSend(objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggingDestination"), "window"));
}
}), new objj_method(sel_getUid("draggedImage"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "draggedView"), "image");
}
}), new objj_method(sel_getUid("draggedImageLocation"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "draggedViewLocation");
}
}), new objj_method(sel_getUid("draggedView"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "draggedView");
}
}), new objj_method(sel_getUid("draggedViewLocation"), function(self, _cmd)
{ with(self)
{
    var dragServer = objj_msgSend(CPDragServer, "sharedDragServer");
    return objj_msgSend((objj_msgSend(objj_msgSend(dragServer, "draggingDestination"), "isKindOfClass:", objj_msgSend(CPWindow, "class")) ? objj_msgSend(dragServer, "draggingDestination") : objj_msgSend(objj_msgSend(dragServer, "draggingDestination"), "window")), "convertPlatformWindowToBase:", objj_msgSend(objj_msgSend(dragServer, "draggedView"), "frame").origin);
}
})]);
}
var CPDraggingSource_draggedImage_movedTo_ = 1 << 0,
    CPDraggingSource_draggedImage_endAt_operation_ = 1 << 1,
    CPDraggingSource_draggedView_movedTo_ = 1 << 2,
    CPDraggingSource_draggedView_endedAt_operation_ = 1 << 3;
{var the_class = objj_allocateClassPair(CPObject, "CPDragServer"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_isDragging"), new objj_ivar("_draggedWindow"), new objj_ivar("_draggedView"), new objj_ivar("_imageView"), new objj_ivar("_isDraggingImage"), new objj_ivar("_draggingOffset"), new objj_ivar("_draggingPasteboard"), new objj_ivar("_draggingSource"), new objj_ivar("_implementedDraggingSourceMethods"), new objj_ivar("_draggingLocation"), new objj_ivar("_draggingDestination")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isDragging"), function(self, _cmd)
{ with(self)
{
return _isDragging;
}
}),
new objj_method(sel_getUid("draggedWindow"), function(self, _cmd)
{ with(self)
{
return _draggedWindow;
}
}),
new objj_method(sel_getUid("draggedView"), function(self, _cmd)
{ with(self)
{
return _draggedView;
}
}),
new objj_method(sel_getUid("draggingOffset"), function(self, _cmd)
{ with(self)
{
return _draggingOffset;
}
}),
new objj_method(sel_getUid("draggingPasteboard"), function(self, _cmd)
{ with(self)
{
return _draggingPasteboard;
}
}),
new objj_method(sel_getUid("draggingSource"), function(self, _cmd)
{ with(self)
{
return _draggingSource;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPDragServer").super_class }, "init");
    if (self)
    {
        _draggedWindow = objj_msgSend(objj_msgSend(CPWindow, "alloc"), "initWithContentRect:styleMask:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } }, CPBorderlessWindowMask);
        objj_msgSend(_draggedWindow, "setLevel:", CPDraggingWindowLevel);
    }
    return self;
}
}), new objj_method(sel_getUid("draggingDestination"), function(self, _cmd)
{ with(self)
{
    return _draggingDestination;
}
}), new objj_method(sel_getUid("draggingLocation"), function(self, _cmd)
{ with(self)
{
    return _draggingLocation
}
}), new objj_method(sel_getUid("draggingStartedInPlatformWindow:globalLocation:"), function(self, _cmd, aPlatformWindow, aLocation)
{ with(self)
{
    if (_isDraggingImage)
    {
        if (objj_msgSend(_draggingSource, "respondsToSelector:", sel_getUid("draggedImage:beganAt:")))
            objj_msgSend(_draggingSource, "draggedImage:beganAt:", objj_msgSend(_draggedView, "image"), aLocation);
    }
    else
    {
        if (objj_msgSend(_draggingSource, "respondsToSelector:", sel_getUid("draggedView:beganAt:")))
            objj_msgSend(_draggingSource, "draggedView:beganAt:", _draggedView, aLocation);
    }
    if (!objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        objj_msgSend(_draggedWindow, "orderFront:", self);
}
}), new objj_method(sel_getUid("draggingSourceUpdatedWithGlobalLocation:"), function(self, _cmd, aGlobalLocation)
{ with(self)
{
    if (!objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        objj_msgSend(_draggedWindow, "setFrameOrigin:", { x:aGlobalLocation.x - _draggingOffset.width, y:aGlobalLocation.y - _draggingOffset.height });
    if (_implementedDraggingSourceMethods & CPDraggingSource_draggedImage_movedTo_)
        objj_msgSend(_draggingSource, "draggedImage:movedTo:", objj_msgSend(_draggedView, "image"), aGlobalLocation);
    else if (_implementedDraggingSourceMethods & CPDraggingSource_draggedView_movedTo_)
        objj_msgSend(_draggingSource, "draggedView:movedTo:", _draggedView, aGlobalLocation);
}
}), new objj_method(sel_getUid("draggingUpdatedInPlatformWindow:location:"), function(self, _cmd, aPlatformWindow, aLocation)
{ with(self)
{
    var dragOperation = CPDragOperationCopy;
    var draggingDestination = objj_msgSend(aPlatformWindow, "_dragHitTest:pasteboard:", aLocation, objj_msgSend(CPDragServerDraggingInfo, "draggingPasteboard"));
    if (draggingDestination)
        _draggingLocation = objj_msgSend((objj_msgSend(draggingDestination, "isKindOfClass:", objj_msgSend(CPWindow, "class")) ? draggingDestination : objj_msgSend(draggingDestination, "window")), "convertPlatformWindowToBase:", aLocation);
    if(draggingDestination !== _draggingDestination)
    {
        if (_draggingDestination && objj_msgSend(_draggingDestination, "respondsToSelector:", sel_getUid("draggingExited:")))
            objj_msgSend(_draggingDestination, "draggingExited:", CPDragServerDraggingInfo);
        _draggingDestination = draggingDestination;
        if (_draggingDestination && objj_msgSend(_draggingDestination, "respondsToSelector:", sel_getUid("draggingEntered:")))
            dragOperation = objj_msgSend(_draggingDestination, "draggingEntered:", CPDragServerDraggingInfo);
    }
    else if (_draggingDestination && objj_msgSend(_draggingDestination, "respondsToSelector:", sel_getUid("draggingUpdated:")))
        dragOperation = objj_msgSend(_draggingDestination, "draggingUpdated:", CPDragServerDraggingInfo);
    if (!_draggingDestination)
        dragOperation = CPDragOperationNone;
    return dragOperation;
}
}), new objj_method(sel_getUid("draggingEndedInPlatformWindow:globalLocation:operation:"), function(self, _cmd, aPlatformWindow, aLocation, anOperation)
{ with(self)
{
    objj_msgSend(_draggedView, "removeFromSuperview");
    if (!objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        objj_msgSend(_draggedWindow, "orderOut:", self);
    if (_implementedDraggingSourceMethods & CPDraggingSource_draggedImage_endAt_operation_)
        objj_msgSend(_draggingSource, "draggedImage:endedAt:operation:", objj_msgSend(_draggedView, "image"), aLocation, anOperation);
    else if (_implementedDraggingSourceMethods & CPDraggingSource_draggedView_endedAt_operation_)
        objj_msgSend(_draggingSource, "draggedView:endedAt:operation:", _draggedView, aLocation, anOperation);
    _isDragging = NO;
}
}), new objj_method(sel_getUid("performDragOperationInPlatformWindow:"), function(self, _cmd, aPlatformWindow)
{ with(self)
{
    if (_draggingDestination &&
        (!objj_msgSend(_draggingDestination, "respondsToSelector:", sel_getUid("prepareForDragOperation:")) || objj_msgSend(_draggingDestination, "prepareForDragOperation:", CPDragServerDraggingInfo)) &&
        (!objj_msgSend(_draggingDestination, "respondsToSelector:", sel_getUid("performDragOperation:")) || objj_msgSend(_draggingDestination, "performDragOperation:", CPDragServerDraggingInfo)) &&
        objj_msgSend(_draggingDestination, "respondsToSelector:", sel_getUid("concludeDragOperation:")))
        objj_msgSend(_draggingDestination, "concludeDragOperation:", CPDragServerDraggingInfo);
}
}), new objj_method(sel_getUid("dragView:fromWindow:at:offset:event:pasteboard:source:slideBack:"), function(self, _cmd, aView, aWindow, viewLocation, mouseOffset, mouseDownEvent, aPasteboard, aSourceObject, slideBack)
{ with(self)
{
    _isDragging = YES;
    _draggedView = aView;
    _draggingPasteboard = aPasteboard || objj_msgSend(CPPasteboard, "pasteboardWithName:", CPDragPboard);
    _draggingSource = aSourceObject;
    _draggingDestination = nil;
    var mouseDownWindow = objj_msgSend(mouseDownEvent, "window"),
        mouseDownEventLocation = objj_msgSend(mouseDownEvent, "locationInWindow");
    if (mouseDownEventLocation)
    {
        if (mouseDownWindow)
            mouseDownEventLocation = objj_msgSend(mouseDownWindow, "convertBaseToGlobal:", mouseDownEventLocation);
        _draggingOffset = { width:mouseDownEventLocation.x - viewLocation.x, height:mouseDownEventLocation.y - viewLocation.y };
    }
    else
        _draggingOffset = { width:0.0, height:0.0 };
    if (objj_msgSend(CPPlatform, "isBrowser"))
        objj_msgSend(_draggedWindow, "setPlatformWindow:", objj_msgSend(aWindow, "platformWindow"));
    objj_msgSend(aView, "setFrameOrigin:", { x:0.0, y:0.0 });
    var mouseLocation = objj_msgSend(CPEvent, "mouseLocation");
    objj_msgSend(_draggedWindow, "setFrameOrigin:", { x:mouseLocation.x - _draggingOffset.width, y:mouseLocation.y - _draggingOffset.height });
    objj_msgSend(_draggedWindow, "setFrameSize:", objj_msgSend(aView, "frame").size);
    objj_msgSend(objj_msgSend(_draggedWindow, "contentView"), "addSubview:", aView);
    _implementedDraggingSourceMethods = 0;
    if (_draggedView === _imageView)
    {
        if (objj_msgSend(_draggingSource, "respondsToSelector:", sel_getUid("draggedImage:movedTo:")))
            _implementedDraggingSourceMethods |= CPDraggingSource_draggedImage_movedTo_;
        if (objj_msgSend(_draggingSource, "respondsToSelector:", sel_getUid("draggedImage:endAt:operation:")))
            _implementedDraggingSourceMethods |= CPDraggingSource_draggedImage_endAt_operation_;
    }
    else
    {
        if (objj_msgSend(_draggingSource, "respondsToSelector:", sel_getUid("draggedView:movedTo:")))
            _implementedDraggingSourceMethods |= CPDraggingSource_draggedView_movedTo_;
        if (objj_msgSend(_draggingSource, "respondsToSelector:", sel_getUid("draggedView:endedAt:operation:")))
            _implementedDraggingSourceMethods |= CPDraggingSource_draggedView_endedAt_operation_;
    }
    if (!objj_msgSend(CPPlatform, "supportsDragAndDrop"))
    {
        objj_msgSend(self, "draggingStartedInPlatformWindow:globalLocation:", objj_msgSend(aWindow, "platformWindow"), mouseLocation);
        objj_msgSend(self, "trackDragging:", mouseDownEvent);
    }
}
}), new objj_method(sel_getUid("dragImage:fromWindow:at:offset:event:pasteboard:source:slideBack:"), function(self, _cmd, anImage, aWindow, imageLocation, mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack)
{ with(self)
{
    _isDraggingImage = YES;
    var imageSize = objj_msgSend(anImage, "size");
    if (!_imageView)
        _imageView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:imageSize.width, height:imageSize.height } });
    objj_msgSend(_imageView, "setImage:", anImage);
    objj_msgSend(self, "dragView:fromWindow:at:offset:event:pasteboard:source:slideBack:", _imageView, aWindow, imageLocation, mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack);
}
}), new objj_method(sel_getUid("trackDragging:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type"),
        platformWindow = objj_msgSend(_draggedWindow, "platformWindow"),
        platformWindowLocation = objj_msgSend(objj_msgSend(anEvent, "window"), "convertBaseToPlatformWindow:", objj_msgSend(anEvent, "locationInWindow"));
    if (type === CPLeftMouseUp)
    {
        objj_msgSend(self, "performDragOperationInPlatformWindow:", platformWindow);
        objj_msgSend(self, "draggingEndedInPlatformWindow:globalLocation:operation:", platformWindow, platformWindowLocation, CPDragOperationNone);
        return;
    }
    objj_msgSend(self, "draggingSourceUpdatedWithGlobalLocation:", platformWindowLocation);
    objj_msgSend(self, "draggingUpdatedInPlatformWindow:location:", platformWindow, platformWindowLocation);
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackDragging:"), CPMouseMovedMask | CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, 0, NO);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self !== objj_msgSend(CPDragServer, "class"))
        return;
    CPDragServerDraggingInfo = objj_msgSend(objj_msgSend(CPDraggingInfo, "alloc"), "init");
}
}), new objj_method(sel_getUid("sharedDragServer"), function(self, _cmd)
{ with(self)
{
    if (!CPSharedDragServer)
        CPSharedDragServer = objj_msgSend(objj_msgSend(CPDragServer, "alloc"), "init");
    return CPSharedDragServer;
}
})]);
}
{
var the_class = objj_getClass("CPWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("_dragHitTest:pasteboard:"), function(self, _cmd, aPoint, aPasteboard)
{ with(self)
{
    if (!_inclusiveRegisteredDraggedTypes)
        return nil;
    var adjustedPoint = objj_msgSend(self, "convertPlatformWindowToBase:", aPoint),
        hitView = objj_msgSend(_windowView, "hitTest:", adjustedPoint);
    while (hitView && !objj_msgSend(aPasteboard, "availableTypeFromArray:", objj_msgSend(hitView, "registeredDraggedTypes")))
        hitView = objj_msgSend(hitView, "superview");
    if (hitView)
        return hitView;
    if (objj_msgSend(aPasteboard, "availableTypeFromArray:", objj_msgSend(self, "registeredDraggedTypes")))
        return self;
    return nil;
}
})]);
}

p;9;CPEvent.jt;11678;@STATIC;1.0;I;21;Foundation/CPObject.jt;11632;objj_executeFile("Foundation/CPObject.j", false);
CPLeftMouseDown = 1;
CPLeftMouseUp = 2;
CPRightMouseDown = 3;
CPRightMouseUp = 4;
CPMouseMoved = 5;
CPLeftMouseDragged = 6;
CPRightMouseDragged = 7;
CPMouseEntered = 8;
CPMouseExited = 9;
CPKeyDown = 10;
CPKeyUp = 11;
CPFlagsChanged = 12;
CPAppKitDefined = 13;
CPSystemDefined = 14;
CPApplicationDefined = 15;
CPPeriodic = 16;
CPCursorUpdate = 17;
CPScrollWheel = 22;
CPOtherMouseDown = 25;
CPOtherMouseUp = 26;
CPOtherMouseDragged = 27;
CPTouchStart = 28;
CPTouchMove = 29;
CPTouchEnd = 30;
CPTouchCancel = 31;
CPAlphaShiftKeyMask = 1 << 16;
CPShiftKeyMask = 1 << 17;
CPControlKeyMask = 1 << 18;
CPAlternateKeyMask = 1 << 19;
CPCommandKeyMask = 1 << 20;
CPNumericPadKeyMask = 1 << 21;
CPHelpKeyMask = 1 << 22;
CPFunctionKeyMask = 1 << 23;
CPDeviceIndependentModifierFlagsMask = 0xffff0000;
CPLeftMouseDownMask = 1 << CPLeftMouseDown;
CPLeftMouseUpMask = 1 << CPLeftMouseUp;
CPRightMouseDownMask = 1 << CPRightMouseDown;
CPRightMouseUpMask = 1 << CPRightMouseUp;
CPOtherMouseDownMask = 1 << CPOtherMouseDown;
CPOtherMouseUpMask = 1 << CPOtherMouseUp;
CPMouseMovedMask = 1 << CPMouseMoved;
CPLeftMouseDraggedMask = 1 << CPLeftMouseDragged;
CPRightMouseDraggedMask = 1 << CPRightMouseDragged;
CPOtherMouseDragged = 1 << CPOtherMouseDragged;
CPMouseEnteredMask = 1 << CPMouseEntered;
CPMouseExitedMask = 1 << CPMouseExited;
CPCursorUpdateMask = 1 << CPCursorUpdate;
CPKeyDownMask = 1 << CPKeyDown;
CPKeyUpMask = 1 << CPKeyUp;
CPFlagsChangedMask = 1 << CPFlagsChanged;
CPAppKitDefinedMask = 1 << CPAppKitDefined;
CPSystemDefinedMask = 1 << CPSystemDefined;
CPApplicationDefinedMask = 1 << CPApplicationDefined;
CPPeriodicMask = 1 << CPPeriodic;
CPScrollWheelMask = 1 << CPScrollWheel;
CPAnyEventMask = 0xffffffff;
CPDOMEventDoubleClick = "dblclick",
CPDOMEventMouseDown = "mousedown",
CPDOMEventMouseUp = "mouseup",
CPDOMEventMouseMoved = "mousemove",
CPDOMEventMouseDragged = "mousedrag",
CPDOMEventKeyUp = "keyup",
CPDOMEventKeyDown = "keydown",
CPDOMEventKeyPress = "keypress";
CPDOMEventCopy = "copy";
CPDOMEventPaste = "paste";
CPDOMEventScrollWheel = "mousewheel";
CPDOMEventTouchStart = "touchstart";
CPDOMEventTouchMove = "touchmove";
CPDOMEventTouchEnd = "touchend";
CPDOMEventTouchCancel = "touchcancel";
var _CPEventPeriodicEventPeriod = 0,
    _CPEventPeriodicEventTimer = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPEvent"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_type"), new objj_ivar("_location"), new objj_ivar("_modifierFlags"), new objj_ivar("_timestamp"), new objj_ivar("_context"), new objj_ivar("_eventNumber"), new objj_ivar("_clickCount"), new objj_ivar("_pressure"), new objj_ivar("_window"), new objj_ivar("_windowNumber"), new objj_ivar("_characters"), new objj_ivar("_isARepeat"), new objj_ivar("_keyCode"), new objj_ivar("_DOMEvent"), new objj_ivar("_deltaX"), new objj_ivar("_deltaY"), new objj_ivar("_deltaZ")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_initMouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:"), function(self, _cmd, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, anEventNumber, aClickCount, aPressure)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPEvent").super_class }, "init");
    if (self)
    {
        _type = anEventType;
        _location = CPPointCreateCopy(aPoint);
        _modifierFlags = modifierFlags;
        _timestamp = aTimestamp;
        _context = aGraphicsContext;
        _eventNumber = anEventNumber;
        _clickCount = aClickCount;
        _pressure = aPressure;
        _window = objj_msgSend(CPApp, "windowWithWindowNumber:", aWindowNumber);
    }
    return self;
}
}), new objj_method(sel_getUid("_initKeyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:"), function(self, _cmd, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, characters, unmodCharacters, isARepeat, code)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPEvent").super_class }, "init");
    if (self)
    {
        _type = anEventType;
        _location = CPPointCreateCopy(aPoint);
        _modifierFlags = modifierFlags;
        _timestamp = aTimestamp;
        _context = aGraphicsContext;
        _characters = characters;
        _charactersIgnoringModifiers = unmodCharacters;
        _isARepeat = isARepeat;
        _keyCode = code;
        _windowNumber = aWindowNumber;
    }
    return self;
}
}), new objj_method(sel_getUid("_initOtherEventWithType:location:modifierFlags:timestamp:windowNumber:context:subtype:data1:data2:"), function(self, _cmd, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, aSubtype, aData1, aData2)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPEvent").super_class }, "init");
    if (self)
    {
        _type = anEventType;
        _location = CPPointCreateCopy(aPoint);
        _modifierFlags = modifierFlags;
        _timestamp = aTimestamp;
        _context = aGraphicsContext;
        _subtype = aSubtype;
        _data1 = aData1;
        _data2 = aData2;
    }
    return self;
}
}), new objj_method(sel_getUid("locationInWindow"), function(self, _cmd)
{ with(self)
{
    return { x:_location.x, y:_location.y };
}
}), new objj_method(sel_getUid("globalLocation"), function(self, _cmd)
{ with(self)
{
    var theWindow = objj_msgSend(self, "window"),
        location = objj_msgSend(self, "locationInWindow");
    if (theWindow)
        return objj_msgSend(theWindow, "convertBaseToGlobal:", location);
    return location;
}
}), new objj_method(sel_getUid("modifierFlags"), function(self, _cmd)
{ with(self)
{
    return _modifierFlags;
}
}), new objj_method(sel_getUid("timestamp"), function(self, _cmd)
{ with(self)
{
    return _timestamp;
}
}), new objj_method(sel_getUid("type"), function(self, _cmd)
{ with(self)
{
    return _type;
}
}), new objj_method(sel_getUid("window"), function(self, _cmd)
{ with(self)
{
    if (!_window)
        _window = objj_msgSend(CPApp, "windowWithWindowNumber:", _windowNumber);
    return _window;
}
}), new objj_method(sel_getUid("windowNumber"), function(self, _cmd)
{ with(self)
{
    return _windowNumber;
}
}), new objj_method(sel_getUid("buttonNumber"), function(self, _cmd)
{ with(self)
{
    return _buttonNumber;
}
}), new objj_method(sel_getUid("clickCount"), function(self, _cmd)
{ with(self)
{
    return _clickCount;
}
}), new objj_method(sel_getUid("characters"), function(self, _cmd)
{ with(self)
{
    return _characters;
}
}), new objj_method(sel_getUid("charactersIgnoringModifiers"), function(self, _cmd)
{ with(self)
{
    return _charactersIgnoringModifiers;
}
}), new objj_method(sel_getUid("isARepeat"), function(self, _cmd)
{ with(self)
{
    return _isARepeat;
}
}), new objj_method(sel_getUid("keyCode"), function(self, _cmd)
{ with(self)
{
    return _keyCode;
}
}), new objj_method(sel_getUid("pressure"), function(self, _cmd)
{ with(self)
{
    return _pressure;
}
}), new objj_method(sel_getUid("_DOMEvent"), function(self, _cmd)
{ with(self)
{
    return _DOMEvent;
}
}), new objj_method(sel_getUid("deltaX"), function(self, _cmd)
{ with(self)
{
    return _deltaX;
}
}), new objj_method(sel_getUid("deltaY"), function(self, _cmd)
{ with(self)
{
    return _deltaY;
}
}), new objj_method(sel_getUid("deltaZ"), function(self, _cmd)
{ with(self)
{
    return _deltaZ;
}
}), new objj_method(sel_getUid("_couldBeKeyEquivalent"), function(self, _cmd)
{ with(self)
{
    return _type === CPKeyDown &&
            _modifierFlags & (CPCommandKeyMask | CPControlKeyMask) &&
            objj_msgSend(_characters, "length") > 0;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("keyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:"), function(self, _cmd, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, characters, unmodCharacters, repeatKey, code)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "_initKeyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:", anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, characters, unmodCharacters, repeatKey, code);
}
}), new objj_method(sel_getUid("mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:"), function(self, _cmd, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, anEventNumber, aClickCount, aPressure)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "_initMouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, anEventNumber, aClickCount, aPressure);
}
}), new objj_method(sel_getUid("otherEventWithType:location:modifierFlags:timestamp:windowNumber:context:subtype:data1:data2:"), function(self, _cmd, anEventType, aLocation, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, aSubtype, aData1, aData2)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "_initOtherEventWithType:location:modifierFlags:timestamp:windowNumber:context:subtype:data1:data2:", anEventType, aLocation, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, aSubtype, aData1, aData2);
}
}), new objj_method(sel_getUid("mouseLocation"), function(self, _cmd)
{ with(self)
{
    var event = objj_msgSend(CPApp, "currentEvent"),
        eventWindow = objj_msgSend(event, "window");
    if (eventWindow)
        return objj_msgSend(eventWindow, "convertBaseToGlobal:", objj_msgSend(event, "locationInWindow"));
    return objj_msgSend(event, "locationInWindow");
}
}), new objj_method(sel_getUid("startPeriodicEventsAfterDelay:withPeriod:"), function(self, _cmd, aDelay, aPeriod)
{ with(self)
{
    _CPEventPeriodicEventPeriod = aPeriod;
    _CPEventPeriodicEventTimer = window.setTimeout(function() { _CPEventPeriodicEventTimer = window.setInterval(_CPEventFirePeriodEvent, aPeriod * 1000.0); }, aDelay * 1000.0);
}
}), new objj_method(sel_getUid("stopPeriodicEvents"), function(self, _cmd)
{ with(self)
{
    if (_CPEventPeriodicEventTimer === nil)
        return;
    window.clearTimeout(_CPEventPeriodicEventTimer);
    _CPEventPeriodicEventTimer = nil;
}
})]);
}
_CPEventFirePeriodEvent= function()
{
    objj_msgSend(CPApp, "sendEvent:", objj_msgSend(CPEvent, "otherEventWithType:location:modifierFlags:timestamp:windowNumber:context:subtype:data1:data2:", CPPeriodic, { x:0.0, y:0.0 }, 0, 0, 0, nil, 0, 0, 0));
}
var CPEventClass = objj_msgSend(CPEvent, "class");
_CPEventFromNativeMouseEvent= function(aNativeEvent, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, anEventNumber, aClickCount, aPressure)
{
    aNativeEvent.isa = CPEventClass;
    aNativeEvent._type = anEventType;
    aNativeEvent._location = aPoint;
    aNativeEvent._modifierFlags = modifierFlags;
    aNativeEvent._timestamp = aTimestamp;
    aNativeEvent._windowNumber = aWindowNumber;
    aNativeEvent._window = nil;
    aNativeEvent._context = aGraphicsContext;
    aNativeEvent._eventNumber = anEventNumber;
    aNativeEvent._clickCount = aClickCount;
    aNativeEvent._pressure = aPressure;
    return aNativeEvent;
}

p;14;CPFlashMovie.jt;1559;@STATIC;1.0;I;21;Foundation/CPObject.jt;1514;objj_executeFile("Foundation/CPObject.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPFlashMovie"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_filename")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFile:"), function(self, _cmd, aFilename)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPFlashMovie").super_class }, "init");
    if (self)
        _filename = aFilename;
    return self;
}
}), new objj_method(sel_getUid("filename"), function(self, _cmd)
{ with(self)
{
    return _filename;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("flashMovieWithFile:"), function(self, _cmd, aFilename)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithFile:", aFilename);
}
})]);
}
var CPFlashMovieFilenameKey = "CPFlashMovieFilenameKey";
{
var the_class = objj_getClass("CPFlashMovie")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPFlashMovie\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    _filename = objj_msgSend(aCoder, "decodeObjectForKey:", CPFlashMovieFilenameKey);
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _filename, CPFlashMovieFilenameKey);
}
})]);
}

p;13;CPFlashView.jt;6032;@STATIC;1.0;i;14;CPFlashMovie.ji;8;CPView.jt;5982;objj_executeFile("CPFlashMovie.j", true);
objj_executeFile("CPView.j", true);
var IEFlashCLSID = "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000";
{var the_class = objj_allocateClassPair(CPView, "CPFlashView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_flashMovie"), new objj_ivar("_params"), new objj_ivar("_paramElements"), new objj_ivar("_DOMParamElement"), new objj_ivar("_DOMObjectElement"), new objj_ivar("_DOMInnerObjectElement")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPFlashView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        if (!CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
        {
            _DOMObjectElement = document.createElement("object");
            _DOMObjectElement.width = "100%";
            _DOMObjectElement.height = "100%";
            _DOMObjectElement.style.top = "0px";
            _DOMObjectElement.style.left = "0px";
            _DOMObjectElement.type = "application/x-shockwave-flash";
            _DOMObjectElement.setAttribute("classid", IEFlashCLSID);
            _DOMParamElement = document.createElement("param");
            _DOMParamElement.name = "movie";
            _DOMInnerObjectElement = document.createElement("object");
            _DOMInnerObjectElement.width = "100%";
            _DOMInnerObjectElement.height = "100%";
            _DOMObjectElement.appendChild(_DOMParamElement);
            _DOMObjectElement.appendChild(_DOMInnerObjectElement);
            _DOMElement.appendChild(_DOMObjectElement);
        }
        else
            objj_msgSend(self, "_rebuildIEObjects");
    }
    return self;
}
}), new objj_method(sel_getUid("setFlashMovie:"), function(self, _cmd, aFlashMovie)
{ with(self)
{
    if (_flashMovie == aFlashMovie)
        return;
    _flashMovie = aFlashMovie;
    if (!CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
    {
        _DOMParamElement.value = objj_msgSend(aFlashMovie, "filename");
        _DOMInnerObjectElement.data = objj_msgSend(aFlashMovie, "filename");
    }
    else
        objj_msgSend(self, "_rebuildIEObjects");
}
}), new objj_method(sel_getUid("flashMovie"), function(self, _cmd)
{ with(self)
{
    return _flashMovie;
}
}), new objj_method(sel_getUid("setFlashVars:"), function(self, _cmd, aDictionary)
{ with(self)
{
    var varString = "",
        enumerator = objj_msgSend(aDictionary, "keyEnumerator");
    var key;
    while (key = objj_msgSend(enumerator, "nextObject"))
        varString = objj_msgSend(varString, "stringByAppendingFormat:", "&%@=%@", key, objj_msgSend(aDictionary, "objectForKey:", key));
    if (!_params)
        _params = objj_msgSend(CPDictionary, "dictionary");
    objj_msgSend(_params, "setObject:forKey:", varString, "flashvars");
    objj_msgSend(self, "setParameters:", _params);
}
}), new objj_method(sel_getUid("flashVars"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_params, "objectForKey:", "flashvars");
}
}), new objj_method(sel_getUid("setParameters:"), function(self, _cmd, aDictionary)
{ with(self)
{
    if (_paramElements && !CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
    {
        var elements = objj_msgSend(_paramElements, "allValues"),
            count = objj_msgSend(elements, "count");
        for (var i = 0; i < count; i++)
            _DOMObjectElement.removeChild(objj_msgSend(elements, "objectAtIndex:", i));
    }
    _params = aDictionary;
    if (!CPBrowserIsEngine(CPInternetExplorerBrowserEngine))
    {
        _paramElements = objj_msgSend(CPDictionary, "dictionary");
        var enumerator = objj_msgSend(_params, "keyEnumerator"),
            key;
        while (key = objj_msgSend(enumerator, "nextObject") && _DOMObjectElement)
        {
            var param = document.createElement("param");
            param.name = key;
            param.value = objj_msgSend(_params, "objectForKey:", key);
            _DOMObjectElement.appendChild(param);
            objj_msgSend(_paramElements, "setObject:forKey:", param, key);
        }
    }
    else
        objj_msgSend(self, "_rebuildIEObjects");
}
}), new objj_method(sel_getUid("parameters"), function(self, _cmd)
{ with(self)
{
    return _params;
}
}), new objj_method(sel_getUid("_rebuildIEObjects"), function(self, _cmd)
{ with(self)
{
    _DOMElement.innerHTML = "";
    if (!objj_msgSend(_flashMovie, "filename"))
        return;
    var paramString = objj_msgSend(CPString, "stringWithFormat:", "<param name='movie' value='%@' />", objj_msgSend(_flashMovie, "filename")),
        paramEnumerator = objj_msgSend(_params, "keyEnumerator"),
        key;
    while (key = objj_msgSend(paramEnumerator, "nextObject"))
        paramString = objj_msgSend(paramString, "stringByAppendingFormat:", "<param name='%@' value='%@' />", key, objj_msgSend(_params, "objectForKey:", key));
    _DOMObjectElement = document.createElement("object");
    _DOMElement.appendChild(_DOMObjectElement);
    _DOMObjectElement.outerHTML = objj_msgSend(CPString, "stringWithFormat:", "<object classid=%@ width=%@ height=%@>%@</object>", IEFlashCLSID, CGRectGetWidth(objj_msgSend(self, "bounds")), CGRectGetHeight(objj_msgSend(self, "bounds")), paramString);
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
}
})]);
}

p;8;CPFont.jt;3987;@STATIC;1.0;t;3968;var _CPFonts = {},
    _CPFontSystemFontFace = "Arial, sans-serif",
    _CPWrapRegExp = new RegExp("\\s*,\\s*", "g");
{var the_class = objj_allocateClassPair(CPObject, "CPFont"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_name"), new objj_ivar("_size"), new objj_ivar("_isBold"), new objj_ivar("_cssString")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_initWithName:size:bold:"), function(self, _cmd, aName, aSize, isBold)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPFont").super_class }, "init");
    if (self)
    {
        _name = aName;
        _size = aSize;
        _isBold = isBold;
        _cssString = (_isBold ? "bold " : "") + ROUND(_size) + "px " + ((_name === _CPFontSystemFontFace) ? _name : ("\"" + _name.replace(_CPWrapRegExp, '", "') + "\", " + _CPFontSystemFontFace));
        _CPFonts[_cssString] = self;
    }
    return self;
}
}), new objj_method(sel_getUid("size"), function(self, _cmd)
{ with(self)
{
    return _size;
}
}), new objj_method(sel_getUid("cssString"), function(self, _cmd)
{ with(self)
{
    return _cssString;
}
}), new objj_method(sel_getUid("familyName"), function(self, _cmd)
{ with(self)
{
    return _name;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("fontWithName:size:"), function(self, _cmd, aName, aSize)
{ with(self)
{
    return _CPFonts[(NO ? "bold " : "") + ROUND(aSize) + "px " + ((aName === _CPFontSystemFontFace) ? aName : ("\"" + aName.replace(_CPWrapRegExp, '", "') + "\", " + _CPFontSystemFontFace))] || objj_msgSend(objj_msgSend(CPFont, "alloc"), "_initWithName:size:bold:", aName, aSize, NO);
}
}), new objj_method(sel_getUid("boldFontWithName:size:"), function(self, _cmd, aName, aSize)
{ with(self)
{
    return _CPFonts[(YES ? "bold " : "") + ROUND(aSize) + "px " + ((aName === _CPFontSystemFontFace) ? aName : ("\"" + aName.replace(_CPWrapRegExp, '", "') + "\", " + _CPFontSystemFontFace))] || objj_msgSend(objj_msgSend(CPFont, "alloc"), "_initWithName:size:bold:", aName, aSize, YES);
}
}), new objj_method(sel_getUid("systemFontOfSize:"), function(self, _cmd, aSize)
{ with(self)
{
    return _CPFonts[(NO ? "bold " : "") + ROUND(aSize) + "px " + ((_CPFontSystemFontFace === _CPFontSystemFontFace) ? _CPFontSystemFontFace : ("\"" + _CPFontSystemFontFace.replace(_CPWrapRegExp, '", "') + "\", " + _CPFontSystemFontFace))] || objj_msgSend(objj_msgSend(CPFont, "alloc"), "_initWithName:size:bold:", _CPFontSystemFontFace, aSize, NO);
}
}), new objj_method(sel_getUid("boldSystemFontOfSize:"), function(self, _cmd, aSize)
{ with(self)
{
    return _CPFonts[(YES ? "bold " : "") + ROUND(aSize) + "px " + ((_CPFontSystemFontFace === _CPFontSystemFontFace) ? _CPFontSystemFontFace : ("\"" + _CPFontSystemFontFace.replace(_CPWrapRegExp, '", "') + "\", " + _CPFontSystemFontFace))] || objj_msgSend(objj_msgSend(CPFont, "alloc"), "_initWithName:size:bold:", _CPFontSystemFontFace, aSize, YES);
}
})]);
}
var CPFontNameKey = "CPFontNameKey",
    CPFontSizeKey = "CPFontSizeKey",
    CPFontIsBoldKey = "CPFontIsBoldKey";
{
var the_class = objj_getClass("CPFont")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPFont\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    return objj_msgSend(self, "_initWithName:size:bold:", objj_msgSend(aCoder, "decodeObjectForKey:", CPFontNameKey), objj_msgSend(aCoder, "decodeFloatForKey:", CPFontSizeKey), objj_msgSend(aCoder, "decodeBoolForKey:", CPFontIsBoldKey));
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _name, CPFontNameKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _size, CPFontSizeKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isBold, CPFontIsBoldKey);
}
})]);
}

p;15;CPFontManager.jt;4763;@STATIC;1.0;I;21;Foundation/CPObject.jI;15;AppKit/CPFont.jt;4698;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("AppKit/CPFont.j", false);
var CPSharedFontManager = nil,
    CPFontManagerFactory = Nil;
{var the_class = objj_allocateClassPair(CPObject, "CPFontManager"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_availableFonts")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("availableFonts"), function(self, _cmd)
{ with(self)
{
    if (!_availableFonts)
    {
        _CPFontDetectSpan = document.createElement("span");
        _CPFontDetectSpan.fontSize = "24px";
        _CPFontDetectSpan.appendChild(document.createTextNode("mmmmmmmmmml"));
        var div = document.createElement("div");
        div.style.position = "absolute";
        div.style.top = "-1000px";
        div.appendChild(_CPFontDetectSpan);
        document.getElementsByTagName("body")[0].appendChild(div);
    _CPFontDetectReferenceFonts = _CPFontDetectPickTwoDifferentFonts(["monospace", "serif", "sans-serif", "cursive"]);
        _availableFonts = [];
        for (var i = 0; i < _CPFontDetectAllFonts.length; i++) {
            var available = _CPFontDetectFontAvailable(_CPFontDetectAllFonts[i]);
      if (available)
                _availableFonts.push(_CPFontDetectAllFonts[i]);
        }
    }
    return _availableFonts;
}
}), new objj_method(sel_getUid("fontWithNameIsAvailable:"), function(self, _cmd, aFontName)
{ with(self)
{
    return _CPFontDetectFontAvailable(aFontName);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("sharedFontManager"), function(self, _cmd)
{ with(self)
{
    if (!CPSharedFontManager)
        CPSharedFontManager = objj_msgSend(objj_msgSend(CPFontManagerFactory, "alloc"), "init");
    return CPSharedFontManager;
}
}), new objj_method(sel_getUid("setFontManagerFactory:"), function(self, _cmd, aClass)
{ with(self)
{
    CPFontManagerFactory = aClass;
}
})]);
}
var _CPFontDetectSpan,
    _CPFontDetectReferenceFonts,
    _CPFontDetectAllFonts = [
        "American Typewriter",
        "Apple Chancery","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS",
        "Big Caslon","Bitstream Vera Sans","Bitstream Vera Sans Mono","Bitstream Vera Serif",
        "Brush Script MT",
        "Cambria",
        "Caslon","Castellar","Cataneo BT","Centaur","Century Gothic","Century Schoolbook","Century Schoolbook L",
        "Comic Sans", "Comic Sans MS","Consolas","Constantia","Cooper Black","Copperplate","Copperplate Gothic Bold","Copperplate Gothic Light","Corbel","Courier","Courier New",
        "Futura",
        "Geneva","Georgia","Georgia Ref", "Geeza Pro", "Gigi","Gill Sans","Gill Sans MT","Gill Sans MT Condensed","Gill Sans MT Ext Condensed Bold","Gill Sans Ultra Bold","Gill Sans Ultra Bold Condensed",
        "Helvetica","Helvetica Narrow","Helvetica Neue","Herculanum","High Tower Text","Highlight LET","Hoefler Text","Impact","Imprint MT Shadow",
        "Lucida","Lucida Bright","Lucida Calligraphy","Lucida Console","Lucida Fax","Lucida Grande","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode",
        "Marker Felt",
        "Microsoft Sans Serif","Milano LET","Minion Web","MisterEarl BT","Mistral","Monaco","Monotype Corsiva","Monotype.com","New Century Schoolbook","New York","News Gothic MT",
        "Papyrus",
        "Tahoma","Techno","Tempus Sans ITC","Terminal","Textile","Times","Times New Roman","Tiranti Solid LET","Trebuchet MS",
        "Verdana","Verdana Ref",
        "Zapfino"];
var _CPFontDetectFontAvailable = function(font) {
 for (var i = 0; i < _CPFontDetectReferenceFonts.length; i++)
  if (_CPFontDetectCompareFonts(_CPFontDetectReferenceFonts[i], font))
   return true;
 return false;
}
var _CPFontDetectCache = {};
var _CPFontDetectCompareFonts = function(fontA, fontB) {
    var a;
    if (_CPFontDetectCache[fontA]) {
        a = _CPFontDetectCache[fontA];
    } else {
     _CPFontDetectSpan.style.fontFamily = '"' + fontA + '"';
        _CPFontDetectCache[fontA] = a = { w: _CPFontDetectSpan.offsetWidth, h: _CPFontDetectSpan.offsetHeight };
    }
 _CPFontDetectSpan.style.fontFamily= '"' + fontB + '", "' + fontA + '"';
 var bWidth = _CPFontDetectSpan.offsetWidth;
 var bHeight = _CPFontDetectSpan.offsetHeight;
 return (a.w != bWidth || a.h != bHeight);
}
var _CPFontDetectPickTwoDifferentFonts = function(candidates) {
 for (var i = 0; i < candidates.length; i++)
  for (var j = 0; j < i; j++)
   if (_CPFontDetectCompareFonts(candidates[i], candidates[j]))
    return [candidates[i], candidates[j]];
 return [candidates[0]];
}
objj_msgSend(CPFontManager, "setFontManagerFactory:", objj_msgSend(CPFontManager, "class"));

p;12;CPGeometry.jt;5522;@STATIC;1.0;i;12;CGGeometry.jt;5486;objj_executeFile("CGGeometry.j", true);
CPMinXEdge = 0;
CPMinYEdge = 1;
CPMaxXEdge = 2;
CPMaxYEdge = 3;
CPMakePoint = CGPointMake;
CPMakeSize = CGSizeMake;
CPMakeRect = CGRectMake;
CPPointCreateCopy= function(aPoint)
{
    return { x: aPoint.x, y: aPoint.y };
}
CPPointMake= function(x, y)
{
    return { x: x, y: y };
}
CPRectInset= function(aRect, dX, dY)
{
    return CPRectMake( aRect.origin.x + dX, aRect.origin.y + dY,
                        aRect.size.width - 2 * dX, aRect.size.height - 2*dY);
}
CPRectIntegral= function(aRect)
{
    alert("CPRectIntegral unimplemented");
}
CPRectIntersection= function(lhsRect, rhsRect)
{
    var intersection = CPRectMake(
        Math.max(CPRectGetMinX(lhsRect), CPRectGetMinX(rhsRect)),
        Math.max(CPRectGetMinY(lhsRect), CPRectGetMinY(rhsRect)),
        0, 0);
    intersection.size.width = Math.min(CPRectGetMaxX(lhsRect), CPRectGetMaxX(rhsRect)) - CPRectGetMinX(intersection);
    intersection.size.height = Math.min(CPRectGetMaxY(lhsRect), CPRectGetMaxY(rhsRect)) - CPRectGetMinY(intersection);
    return CPRectIsEmpty(intersection) ? CPRectMakeZero() : intersection;
}
CPRectCreateCopy= function(aRect)
{
    return { origin: CPPointCreateCopy(aRect.origin), size: CPSizeCreateCopy(aRect.size) };
}
CPRectMake= function(x, y, width, height)
{
    return { origin: CPPointMake(x, y), size: CPSizeMake(width, height) };
}
CPRectOffset= function(aRect, dX, dY)
{
    return CPRectMake(aRect.origin.x + dX, aRect.origin.y + dY, aRect.size.width, aRect.size.height);
}
CPRectStandardize= function(aRect)
{
    var width = CPRectGetWidth(aRect),
        height = CPRectGetHeight(aRect),
        standardized = CPRectCreateCopy(aRect);
    if (width < 0.0)
    {
        standardized.origin.x += width;
        standardized.size.width = -width;
    }
    if (height < 0.0)
    {
        standardized.origin.y += height;
        standardized.size.height = -height;
    }
    return standardized;
}
CPRectUnion= function(lhsRect, rhsRect)
{
    var minX = Math.min(CPRectGetMinX(lhsRect), CPRectGetMinX(rhsRect)),
        minY = Math.min(CPRectGetMinY(lhsRect), CPRectGetMinY(rhsRect)),
        maxX = Math.max(CPRectGetMaxX(lhsRect), CPRectGetMaxX(rhsRect)),
        maxY = Math.max(CPRectGetMaxY(lhsRect), CPRectGetMaxY(rhsRect));
    return CPRectMake(minX, minY, maxX - minX, maxY - minY);
}
CPSizeCreateCopy= function(aSize)
{
    return { width: aSize.width, height: aSize.height };
}
CPSizeMake= function(width, height)
{
    return { width: width, height: height };
}
CPRectContainsPoint= function(aRect, aPoint)
{
    return aPoint.x >= CPRectGetMinX(aRect) &&
            aPoint.y >= CPRectGetMinY(aRect) &&
      aPoint.x < CPRectGetMaxX(aRect) &&
      aPoint.y < CPRectGetMaxY(aRect);
}
CPRectContainsRect= function(possibleOuter, possibleInner)
{
    return CGRectContainsRect(possibleOuter, possibleInner);
}
CPPointEqualToPoint= function(lhsPoint, rhsPoint)
{
    return lhsPoint.x == rhsPoint.x && lhsPoint.y == rhsPoint.y;
}
CPRectEqualToRect= function(lhsRect, rhsRect)
{
    return CPPointEqualToPoint(lhsRect.origin, rhsRect.origin) &&
            CPSizeEqualToSize(lhsRect.size, rhsRect.size);
}
CPRectGetHeight= function(aRect)
{
    return aRect.size.height;
}
CPRectGetMaxX= function(aRect)
{
    return aRect.origin.x + aRect.size.width;
}
CPRectGetMaxY= function(aRect)
{
    return aRect.origin.y + aRect.size.height;
}
CPRectGetMidX= function(aRect)
{
    return aRect.origin.x + (aRect.size.width) / 2.0;
}
CPRectGetMidY= function(aRect)
{
    return aRect.origin.y + (aRect.size.height) / 2.0;
}
CPRectGetMinX= function(aRect)
{
    return aRect.origin.x;
}
CPRectGetMinY= function(aRect)
{
    return aRect.origin.y;
}
CPRectGetWidth= function(aRect)
{
    return aRect.size.width;
}
CPRectIntersectsRect= function(lhsRect, rhsRect)
{
    return !CPRectIsEmpty(CPRectIntersection(lhsRect, rhsRect));
}
CPRectIsEmpty= function(aRect)
{
    return aRect.size.width <= 0.0 || aRect.size.height <= 0.0;
}
CPRectIsNull= function(aRect)
{
    return aRect.size.width <= 0.0 || aRect.size.height <= 0.0;
}
CPSizeEqualToSize= function(lhsSize, rhsSize)
{
    return lhsSize.width == rhsSize.width && lhsSize.height == rhsSize.height;
}
CPStringFromPoint= function(aPoint)
{
    return "{" + aPoint.x + ", " + aPoint.y + "}";
}
CPStringFromSize= function(aSize)
{
    return "{" + aSize.width + ", " + aSize.height + "}";
}
CPStringFromRect= function(aRect)
{
    return "{" + CPStringFromPoint(aRect.origin) + ", " + CPStringFromSize(aRect.size) + "}";
}
CPPointFromString= function(aString)
{
    var comma = aString.indexOf(',');
    return { x:parseFloat(aString.substr(1, comma - 1), 10), y:parseFloat(aString.substring(comma + 1, aString.length), 10) };
}
CPSizeFromString= function(aString)
{
    var comma = aString.indexOf(',');
    return { width:parseFloat(aString.substr(1, comma - 1), 10), height:parseFloat(aString.substring(comma + 1, aString.length), 10) };
}
CPRectFromString= function(aString)
{
    var comma = aString.indexOf(',', aString.indexOf(',') + 1);
    return { origin:CPPointFromString(aString.substr(1, comma - 1)), size:CPSizeFromString(aString.substring(comma + 2, aString.length)) };
}
CPPointFromEvent= function(anEvent)
{
    return CPPointMake(anEvent.clientX, anEvent.clientY, 0);
}
CPSizeMakeZero= function()
{
    return CPSizeMake(0, 0);
}
CPRectMakeZero= function()
{
    return CPRectMake(0, 0, 0, 0);
}
CPPointMakeZero= function()
{
    return CPPointMake(0, 0, 0);
}

p;19;CPGraphicsContext.jt;1229;@STATIC;1.0;t;1210;var CPGraphicsContextCurrent = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPGraphicsContext"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_graphicsPort")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithGraphicsPort:"), function(self, _cmd, aGraphicsPort)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPGraphicsContext").super_class }, "init");
    if (self)
        _graphicsPort = aGraphicsPort;
    return self;
}
}), new objj_method(sel_getUid("graphicsPort"), function(self, _cmd)
{ with(self)
{
    return _graphicsPort;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("currentContext"), function(self, _cmd)
{ with(self)
{
    return CPGraphicsContextCurrent;
}
}), new objj_method(sel_getUid("setCurrentContext:"), function(self, _cmd, aGraphicsContext)
{ with(self)
{
    CPGraphicsContextCurrent = aGraphicsContext;
}
}), new objj_method(sel_getUid("graphicsContextWithGraphicsPort:flipped:"), function(self, _cmd, aContext, aFlag)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithGraphicsPort:", aContext);
}
})]);
}

p;9;CPImage.jt;12506;@STATIC;1.0;I;21;Foundation/CPBundle.jI;33;Foundation/CPNotificationCenter.jI;21;Foundation/CPObject.jI;22;Foundation/CPRunLoop.jI;21;Foundation/CPString.ji;12;CPGeometry.jt;12326;objj_executeFile("Foundation/CPBundle.j", false);
objj_executeFile("Foundation/CPNotificationCenter.j", false);
objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPRunLoop.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPGeometry.j", true);
CPImageLoadStatusInitialized = 0;
CPImageLoadStatusLoading = 1;
CPImageLoadStatusCompleted = 2;
CPImageLoadStatusCancelled = 3;
CPImageLoadStatusInvalidData = 4;
CPImageLoadStatusUnexpectedEOF = 5;
CPImageLoadStatusReadError = 6;
CPImageDidLoadNotification = "CPImageDidLoadNotification";
CPImageNameColorPanel = "CPImageNameColorPanel";
CPImageNameColorPanelHighlighted = "CPImageNameColorPanelHighlighted";
var imagesForNames = { },
    AppKitImageForNames = { };
AppKitImageForNames[CPImageNameColorPanel] = CGSizeMake(26.0, 29.0);
AppKitImageForNames[CPImageNameColorPanelHighlighted] = CGSizeMake(26.0, 29.0);
CPImageInBundle= function(aFilename, aSize, aBundle)
{
    if (!aBundle)
        aBundle = objj_msgSend(CPBundle, "mainBundle");
    if (aSize)
        return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(aBundle, "pathForResource:", aFilename), aSize);
    return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", objj_msgSend(aBundle, "pathForResource:", aFilename));
}
CPAppKitImage= function(aFilename, aSize)
{
    return CPImageInBundle(aFilename, aSize, objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPView, "class")));
}
{var the_class = objj_allocateClassPair(CPObject, "CPImage"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_size"), new objj_ivar("_filename"), new objj_ivar("_name"), new objj_ivar("_delegate"), new objj_ivar("_loadStatus"), new objj_ivar("_image")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initByReferencingFile:size:", "", CGSizeMake(-1, -1));
}
}), new objj_method(sel_getUid("initByReferencingFile:size:"), function(self, _cmd, aFilename, aSize)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPImage").super_class }, "init");
    if (self)
    {
        _size = CPSizeCreateCopy(aSize);
        _filename = aFilename;
        _loadStatus = CPImageLoadStatusInitialized;
    }
    return self;
}
}), new objj_method(sel_getUid("initWithContentsOfFile:size:"), function(self, _cmd, aFilename, aSize)
{ with(self)
{
    self = objj_msgSend(self, "initByReferencingFile:size:", aFilename, aSize);
    if (self)
        objj_msgSend(self, "load");
    return self;
}
}), new objj_method(sel_getUid("initWithContentsOfFile:"), function(self, _cmd, aFilename)
{ with(self)
{
    self = objj_msgSend(self, "initByReferencingFile:size:", aFilename, CGSizeMake(-1, -1));
    if (self)
        objj_msgSend(self, "load");
    return self;
}
}), new objj_method(sel_getUid("filename"), function(self, _cmd)
{ with(self)
{
    return _filename;
}
}), new objj_method(sel_getUid("setSize:"), function(self, _cmd, aSize)
{ with(self)
{
    _size = CGSizeMakeCopy(aSize);
}
}), new objj_method(sel_getUid("size"), function(self, _cmd)
{ with(self)
{
    return _size;
}
}), new objj_method(sel_getUid("setName:"), function(self, _cmd, aName)
{ with(self)
{
    if (_name === aName)
        return;
    if (imagesForNames[aName] === self)
        imagesForNames[aName] = nil;
    _name = aName;
    imagesForNames[aName] = self;
}
}), new objj_method(sel_getUid("name"), function(self, _cmd)
{ with(self)
{
    return _name;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("loadStatus"), function(self, _cmd)
{ with(self)
{
    return _loadStatus;
}
}), new objj_method(sel_getUid("load"), function(self, _cmd)
{ with(self)
{
    if (_loadStatus == CPImageLoadStatusLoading || _loadStatus == CPImageLoadStatusCompleted)
        return;
    _loadStatus = CPImageLoadStatusLoading;
    _image = new Image();
    var isSynchronous = YES;
    _image.onload = function ()
        {
            if (isSynchronous)
                window.setTimeout(function() { objj_msgSend(self, "_imageDidLoad"); }, 0);
            else
            {
                objj_msgSend(self, "_imageDidLoad");
                objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
            }
            objj_msgSend(self, "_derefFromImage");
        }
    _image.onerror = function ()
        {
            if (isSynchronous)
                window.setTimeout(function() { objj_msgSend(self, "_imageDidError"); }, 0);
            else
            {
                objj_msgSend(self, "_imageDidError");
                objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
            }
            objj_msgSend(self, "_derefFromImage");
        }
    _image.onabort = function ()
        {
            if (isSynchronous)
                window.setTimeout(function() { objj_msgSend(self, "_imageDidAbort"); }, 0);
            else
            {
                objj_msgSend(self, "_imageDidAbort");
                objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
            }
            objj_msgSend(self, "_derefFromImage");
        }
    _image.src = _filename;
    window.setTimeout(function() { isSynchronous = NO; }, 0);
}
}), new objj_method(sel_getUid("isThreePartImage"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("isNinePartImage"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("_derefFromImage"), function(self, _cmd)
{ with(self)
{
    _image.onload = null;
    _image.onerror = null;
    _image.onabort = null;
}
}), new objj_method(sel_getUid("_imageDidLoad"), function(self, _cmd)
{ with(self)
{
    _loadStatus = CPImageLoadStatusCompleted;
    if (!_size || (_size.width == -1 && _size.height == -1))
        _size = CGSizeMake(_image.width, _image.height);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPImageDidLoadNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("imageDidLoad:")))
        objj_msgSend(_delegate, "imageDidLoad:", self);
}
}), new objj_method(sel_getUid("_imageDidError"), function(self, _cmd)
{ with(self)
{
    _loadStatus = CPImageLoadStatusReadError;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("imageDidError:")))
        objj_msgSend(_delegate, "imageDidError:", self);
}
}), new objj_method(sel_getUid("_imageDidAbort"), function(self, _cmd)
{ with(self)
{
    _loadStatus = CPImageLoadStatusCancelled;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("imageDidAbort:")))
        objj_msgSend(_delegate, "imageDidAbort:", self);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("imageNamed:"), function(self, _cmd, aName)
{ with(self)
{
    var image = imagesForNames[aName];
    if (image)
        return image;
    var imageOrSize = AppKitImageForNames[aName];
    if (!imageOrSize.isa)
    {
        imageOrSize = CPAppKitImage("CPImage/" + aName + ".png", imageOrSize);
        objj_msgSend(imageOrSize, "setName:", aName);
        AppKitImageForNames[aName] = imageOrSize;
    }
    return imageOrSize;
}
})]);
}
{
var the_class = objj_getClass("CPImage")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPImage\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    return objj_msgSend(self, "initWithContentsOfFile:size:", objj_msgSend(aCoder, "decodeObjectForKey:", "CPFilename"), objj_msgSend(aCoder, "decodeSizeForKey:", "CPSize"));
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _filename, "CPFilename");
    objj_msgSend(aCoder, "encodeSize:forKey:", _size, "CPSize");
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "CPThreePartImage"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_imageSlices"), new objj_ivar("_isVertical")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithImageSlices:isVertical:"), function(self, _cmd, imageSlices, isVertical)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPThreePartImage").super_class }, "init");
    if (self)
    {
        _imageSlices = imageSlices;
        _isVertical = isVertical;
    }
    return self;
}
}), new objj_method(sel_getUid("filename"), function(self, _cmd)
{ with(self)
{
    return "";
}
}), new objj_method(sel_getUid("imageSlices"), function(self, _cmd)
{ with(self)
{
    return _imageSlices;
}
}), new objj_method(sel_getUid("isVertical"), function(self, _cmd)
{ with(self)
{
    return _isVertical;
}
}), new objj_method(sel_getUid("isThreePartImage"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("isNinePartImage"), function(self, _cmd)
{ with(self)
{
    return NO;
}
})]);
}
var CPThreePartImageImageSlicesKey = "CPThreePartImageImageSlicesKey",
    CPThreePartImageIsVerticalKey = "CPThreePartImageIsVerticalKey";
{
var the_class = objj_getClass("CPThreePartImage")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPThreePartImage\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPThreePartImage").super_class }, "init");
    if (self)
    {
        _imageSlices = objj_msgSend(aCoder, "decodeObjectForKey:", CPThreePartImageImageSlicesKey);
        _isVertical = objj_msgSend(aCoder, "decodeBoolForKey:", CPThreePartImageIsVerticalKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _imageSlices, CPThreePartImageImageSlicesKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isVertical, CPThreePartImageIsVerticalKey);
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "CPNinePartImage"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_imageSlices")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithImageSlices:"), function(self, _cmd, imageSlices)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPNinePartImage").super_class }, "init");
    if (self)
        _imageSlices = imageSlices;
    return self;
}
}), new objj_method(sel_getUid("filename"), function(self, _cmd)
{ with(self)
{
    return "";
}
}), new objj_method(sel_getUid("imageSlices"), function(self, _cmd)
{ with(self)
{
    return _imageSlices;
}
}), new objj_method(sel_getUid("isThreePartImage"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("isNinePartImage"), function(self, _cmd)
{ with(self)
{
    return YES;
}
})]);
}
var CPNinePartImageImageSlicesKey = "CPNinePartImageImageSlicesKey";
{
var the_class = objj_getClass("CPNinePartImage")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPNinePartImage\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPNinePartImage").super_class }, "init");
    if (self)
        _imageSlices = objj_msgSend(aCoder, "decodeObjectForKey:", CPNinePartImageImageSlicesKey);
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _imageSlices, CPNinePartImageImageSlicesKey);
}
})]);
}

p;13;CPImageView.jt;11370;@STATIC;1.0;I;33;Foundation/CPNotificationCenter.ji;11;CPControl.ji;9;CPImage.ji;14;CPShadowView.jt;11264;objj_executeFile("Foundation/CPNotificationCenter.j", false);
objj_executeFile("CPControl.j", true);
objj_executeFile("CPImage.j", true);
objj_executeFile("CPShadowView.j", true);
CPScaleProportionally = 0;
CPScaleToFit = 1;
CPScaleNone = 2;
var CPImageViewShadowBackgroundColor = nil;
var LEFT_SHADOW_INSET = 3.0,
    RIGHT_SHADOW_INSET = 3.0,
    TOP_SHADOW_INSET = 3.0,
    BOTTOM_SHADOW_INSET = 5.0,
    VERTICAL_SHADOW_INSET = TOP_SHADOW_INSET + BOTTOM_SHADOW_INSET,
    HORIZONTAL_SHADOW_INSET = LEFT_SHADOW_INSET + RIGHT_SHADOW_INSET;
{var the_class = objj_allocateClassPair(CPControl, "CPImageView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_DOMImageElement"), new objj_ivar("_hasShadow"), new objj_ivar("_shadowView"), new objj_ivar("_isEditable"), new objj_ivar("_imageRect")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPImageView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _DOMImageElement = document.createElement("img");
        _DOMImageElement.style.position = "absolute";
        _DOMImageElement.style.left = "0px";
        _DOMImageElement.style.top = "0px";
        if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        {
            _DOMImageElement.setAttribute("draggable", "true");
            _DOMImageElement.style["-khtml-user-drag"] = "element";
        }
        _DOMElement.appendChild(_DOMImageElement);
        _DOMImageElement.style.visibility = "hidden";
    }
    return self;
}
}), new objj_method(sel_getUid("image"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "objectValue");
}
}), new objj_method(sel_getUid("setImage:"), function(self, _cmd, anImage)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", anImage);
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, anImage)
{ with(self)
{
    var oldImage = objj_msgSend(self, "objectValue");
    if (oldImage === anImage)
        return;
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPImageView").super_class }, "setObjectValue:", anImage);
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (oldImage)
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPImageDidLoadNotification, oldImage);
    var newImage = objj_msgSend(self, "objectValue");
    _DOMImageElement.src = newImage ? objj_msgSend(newImage, "filename") : "";
    var size = objj_msgSend(newImage, "size");
    if (size && size.width === -1 && size.height === -1)
    {
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("imageDidLoad:"), CPImageDidLoadNotification, newImage);
        _DOMImageElement.width = 0;
        _DOMImageElement.height = 0;
        objj_msgSend(_shadowView, "setHidden:", YES);
    }
    else
    {
        objj_msgSend(self, "hideOrDisplayContents");
        objj_msgSend(self, "setNeedsLayout");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
}
}), new objj_method(sel_getUid("imageDidLoad:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "hideOrDisplayContents");
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("hasShadow"), function(self, _cmd)
{ with(self)
{
    return _hasShadow;
}
}), new objj_method(sel_getUid("setHasShadow:"), function(self, _cmd, shouldHaveShadow)
{ with(self)
{
    if (_hasShadow == shouldHaveShadow)
        return;
    _hasShadow = shouldHaveShadow;
    if (_hasShadow)
    {
        _shadowView = objj_msgSend(objj_msgSend(CPShadowView, "alloc"), "initWithFrame:", objj_msgSend(self, "bounds"));
        objj_msgSend(self, "addSubview:", _shadowView);
        objj_msgSend(self, "setNeedsLayout");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
    else
    {
        objj_msgSend(_shadowView, "removeFromSuperview");
        _shadowView = nil;
    }
    objj_msgSend(self, "hideOrDisplayContents");
}
}), new objj_method(sel_getUid("setImageScaling:"), function(self, _cmd, anImageScaling)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPImageView").super_class }, "setImageScaling:", anImageScaling);
    if (objj_msgSend(self, "currentValueForThemeAttribute:", "image-scaling") === CPScaleToFit)
    {
        if (NULL) var ____p = _CGPointApplyAffineTransform(CGPointMake(0.0, 0.0), NULL); else var ____p = { x:0.0, y:0.0 }; _DOMImageElement.style.left = ROUND(____p.x) + "px";_DOMImageElement.style.top = ROUND(____p.y) + "px";;
    }
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("hideOrDisplayContents"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(self, "image"))
    {
        _DOMImageElement.style.visibility = "hidden";
        objj_msgSend(_shadowView, "setHidden:", YES);
    }
    else
    {
        _DOMImageElement.style.visibility = "visible";
        objj_msgSend(_shadowView, "setHidden:", NO);
    }
}
}), new objj_method(sel_getUid("imageRect"), function(self, _cmd)
{ with(self)
{
    return _imageRect;
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(self, "image"))
        return;
    var bounds = objj_msgSend(self, "bounds"),
        image = objj_msgSend(self, "image"),
        imageScaling = objj_msgSend(self, "currentValueForThemeAttribute:", "image-scaling"),
        x = 0.0,
        y = 0.0,
        insetWidth = (_hasShadow ? HORIZONTAL_SHADOW_INSET : 0.0),
        insetHeight = (_hasShadow ? VERTICAL_SHADOW_INSET : 0.0),
        boundsWidth = (bounds.size.width),
        boundsHeight = (bounds.size.height),
        width = boundsWidth - insetWidth,
        height = boundsHeight - insetHeight;
    if (imageScaling === CPScaleToFit)
    {
        _DOMImageElement.width = ROUND(width);
        _DOMImageElement.height = ROUND(height);
    }
    else
    {
        var size = objj_msgSend(image, "size");
        if (size.width == -1 && size.height == -1)
            return;
        if (imageScaling === CPScaleProportionally)
        {
            if (width >= size.width && height >= size.height)
            {
                width = size.width;
                height = size.height;
            }
            else
            {
                var imageRatio = size.width / size.height,
                    viewRatio = width / height;
                if (viewRatio > imageRatio)
                    width = height * imageRatio;
                else
                    height = width / imageRatio;
            }
            _DOMImageElement.width = ROUND(width);
            _DOMImageElement.height = ROUND(height);
        }
        else
        {
            width = size.width;
            height = size.height;
        }
        if (imageScaling == CPScaleNone)
        {
            _DOMImageElement.width = ROUND(size.width);
            _DOMImageElement.height = ROUND(size.height);
        }
        var x = (boundsWidth - width) / 2.0,
            y = (boundsHeight - height) / 2.0;
        if (NULL) var ____p = _CGPointApplyAffineTransform(CGPointMake(x, y), NULL); else var ____p = { x:x, y:y }; _DOMImageElement.style.left = ROUND(____p.x) + "px";_DOMImageElement.style.top = ROUND(____p.y) + "px";;
    }
    _imageRect = { origin: { x:x, y:y }, size: { width:width, height:height } };
    if (_hasShadow)
        objj_msgSend(_shadowView, "setFrame:", { origin: { x:x - LEFT_SHADOW_INSET, y:y - TOP_SHADOW_INSET }, size: { width:width + insetWidth, height:height + insetHeight } });
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "nextResponder"), "mouseDown:", anEvent);
}
}), new objj_method(sel_getUid("setEditable:"), function(self, _cmd, shouldBeEditable)
{ with(self)
{
    if (_isEditable === shouldBeEditable)
        return;
    _isEditable = shouldBeEditable;
    if (_isEditable)
        objj_msgSend(self, "registerForDraggedTypes:", [CPImagesPboardType]);
    else
    {
        var draggedTypes = objj_msgSend(self, "registeredDraggedTypes");
        objj_msgSend(self, "unregisterDraggedTypes");
        objj_msgSend(draggedTypes, "removeObjectIdenticalTo:", CPImagesPboardType);
        objj_msgSend(self, "registerForDraggedTypes:", draggedTypes);
    }
}
}), new objj_method(sel_getUid("isEditable"), function(self, _cmd)
{ with(self)
{
    return _isEditable;
}
}), new objj_method(sel_getUid("performDragOperation:"), function(self, _cmd, aSender)
{ with(self)
{
    var images = objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", objj_msgSend(objj_msgSend(aSender, "draggingPasteboard"), "dataForType:", CPImagesPboardType));
    if (objj_msgSend(images, "count"))
        objj_msgSend(self, "setImage:", images[0]);
}
})]);
}
var CPImageViewImageKey = "CPImageViewImageKey",
    CPImageViewImageScalingKey = "CPImageViewImageScalingKey",
    CPImageViewHasShadowKey = "CPImageViewHasShadowKey",
    CPImageViewIsEditableKey = "CPImageViewIsEditableKey";
{
var the_class = objj_getClass("CPImageView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPImageView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    _DOMImageElement = document.createElement("img");
    _DOMImageElement.style.position = "absolute";
    _DOMImageElement.style.left = "0px";
    _DOMImageElement.style.top = "0px";
    _DOMImageElement.style.visibility = "hidden";
    if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
    {
        _DOMImageElement.setAttribute("draggable", "true");
        _DOMImageElement.style["-khtml-user-drag"] = "element";
    }
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPImageView").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _DOMElement.appendChild(_DOMImageElement);
        objj_msgSend(self, "setHasShadow:", objj_msgSend(aCoder, "decodeBoolForKey:", CPImageViewHasShadowKey));
        if (objj_msgSend(aCoder, "decodeBoolForKey:", CPImageViewIsEditableKey) || NO)
            objj_msgSend(self, "setEditable:", YES);
        objj_msgSend(self, "setNeedsLayout");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (_shadowView)
    {
        var actualSubviews = _subviews;
        _subviews = objj_msgSend(_subviews, "copy");
        objj_msgSend(_subviews, "removeObjectIdenticalTo:", _shadowView);
    }
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPImageView").super_class }, "encodeWithCoder:", aCoder);
    if (_shadowView)
        _subviews = actualSubviews;
    objj_msgSend(aCoder, "encodeBool:forKey:", _hasShadow, CPImageViewHasShadowKey);
    if (_isEditable)
        objj_msgSend(aCoder, "encodeBool:forKey:", _isEditable, CPImageViewIsEditableKey);
}
})]);
}

p;13;CPOpenPanel.jt;2504;@STATIC;1.0;I;16;AppKit/CPPanel.jt;2464;


objj_executeFile("AppKit/CPPanel.j", false);


{var the_class = objj_allocateClassPair(CPPanel, "CPOpenPanel"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_canChooseFiles"), new objj_ivar("_canChooseDirectories"), new objj_ivar("_allowsMultipleSelection"), new objj_ivar("_directoryURL"), new objj_ivar("_URLs")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("canChooseFiles"), function(self, _cmd)
{ with(self)
{
return _canChooseFiles;
}
}),
new objj_method(sel_getUid("setCanChooseFiles:"), function(self, _cmd, newValue)
{ with(self)
{
_canChooseFiles = newValue;
}
}),
new objj_method(sel_getUid("canChooseDirectories"), function(self, _cmd)
{ with(self)
{
return _canChooseDirectories;
}
}),
new objj_method(sel_getUid("setCanChooseDirectories:"), function(self, _cmd, newValue)
{ with(self)
{
_canChooseDirectories = newValue;
}
}),
new objj_method(sel_getUid("allowsMultipleSelection"), function(self, _cmd)
{ with(self)
{
return _allowsMultipleSelection;
}
}),
new objj_method(sel_getUid("setAllowsMultipleSelection:"), function(self, _cmd, newValue)
{ with(self)
{
_allowsMultipleSelection = newValue;
}
}),
new objj_method(sel_getUid("directoryURL"), function(self, _cmd)
{ with(self)
{
return _directoryURL;
}
}),
new objj_method(sel_getUid("setDirectoryURL:"), function(self, _cmd, newValue)
{ with(self)
{
_directoryURL = newValue;
}
}), new objj_method(sel_getUid("runModal"), function(self, _cmd)
{ with(self)
{
    if (typeof window["cpOpenPanel"] === "function")
    {

        objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);

        var options = { directoryURL: objj_msgSend(self, "directoryURL"),
                        canChooseFiles: objj_msgSend(self, "canChooseFiles"),
                        canChooseDirectories: objj_msgSend(self, "canChooseDirectories"),
                        allowsMultipleSelection: objj_msgSend(self, "allowsMultipleSelection") };

        var result = window.cpOpenPanel(options);

        _URLs = result.URLs;

        return result.button;
    }

    throw "-runModal is unimplemented.";
}
}), new objj_method(sel_getUid("URLs"), function(self, _cmd)
{ with(self)
{
    return _URLs;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("openPanel"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPOpenPanel, "alloc"), "init");
}
})]);
}

p;15;CPOutlineView.jt;28341;@STATIC;1.0;i;15;CPTableColumn.ji;13;CPTableView.jt;28283;objj_executeFile("CPTableColumn.j", true);
objj_executeFile("CPTableView.j", true);
CPOutlineViewColumnDidMoveNotification = "CPOutlineViewColumnDidMoveNotification";
CPOutlineViewColumnDidResizeNotification = "CPOutlineViewColumnDidResizeNotification";
CPOutlineViewItemDidCollapseNotification = "CPOutlineViewItemDidCollapseNotification";
CPOutlineViewItemDidExpandNotification = "CPOutlineViewItemDidExpandNotification";
CPOutlineViewItemWillCollapseNotification = "CPOutlineViewItemWillCollapseNotification";
CPOutlineViewItemWillExpandNotification = "CPOutlineViewItemWillExpandNotification";
CPOutlineViewSelectionDidChangeNotification = "CPOutlineViewSelectionDidChangeNotification";
CPOutlineViewSelectionIsChangingNotification = "CPOutlineViewSelectionIsChangingNotification";
var CPOutlineViewDataSource_outlineView_setObjectValue_forTableColumn_byItem_ = 1 << 1,
    CPOutlineViewDataSource_outlineView_shouldDeferDisplayingChildrenOfItem_ = 1 << 2,
    CPOutlineViewDataSource_outlineView_acceptDrop_item_childIndex_ = 1 << 3,
    CPOutlineViewDataSource_outlineView_validateDrop_proposedItem_proposedChildIndex_ = 1 << 4,
    CPOutlineViewDataSource_outlineView_validateDrop_proposedRow_proposedDropOperation_ = 1 << 5,
    CPOutlineViewDataSource_outlineView_namesOfPromisedFilesDroppedAtDestination_forDraggedItems_ = 1 << 6,
    CPOutlineViewDataSource_outlineView_itemForPersistentObject_ = 1 << 7,
    CPOutlineViewDataSource_outlineView_persistentObjectForItem_ = 1 << 8,
    CPOutlineViewDataSource_outlineView_writeItems_toPasteboard_ = 1 << 9,
    CPOutlineViewDataSource_outlineView_sortDescriptorsDidChange_ = 1 << 10;
{var the_class = objj_allocateClassPair(CPTableView, "CPOutlineView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_outlineViewDataSource"), new objj_ivar("_outlineViewDelegate"), new objj_ivar("_outlineTableColumn"), new objj_ivar("_indentationPerLevel"), new objj_ivar("_indentationMarkerFollowsDataView"), new objj_ivar("_implementedOutlineViewDataSourceMethods"), new objj_ivar("_rootItemInfo"), new objj_ivar("_itemsForRows"), new objj_ivar("_itemInfosForItems"), new objj_ivar("_disclosureControlPrototype"), new objj_ivar("_disclosureControlsForRows"), new objj_ivar("_disclosureControlData"), new objj_ivar("_disclosureControlQueue")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _selectionHighlightStyle = CPTableViewSelectionHighlightStyleSourceList;
        _rootItemInfo = { isExpanded:YES, isExpandable:NO, level:-1, row:-1, children:[], weight:0 };
        _itemsForRows = [];
        _itemInfosForItems = { };
        _disclosureControlsForRows = [];
        objj_msgSend(self, "setIndentationPerLevel:", 16.0);
        objj_msgSend(self, "setIndentationMarkerFollowsDataView:", YES);
        objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "setDataSource:", objj_msgSend(objj_msgSend(_CPOutlineViewTableViewDataSource, "alloc"), "initWithOutlineView:", self));
        objj_msgSend(self, "setDisclosureControlPrototype:", objj_msgSend(objj_msgSend(CPDisclosureButton, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 10.0, 10.0)));
    }
    return self;
}
}), new objj_method(sel_getUid("setDataSource:"), function(self, _cmd, aDataSource)
{ with(self)
{
    if (_outlineViewDataSource === aDataSource)
        return;
    if (!objj_msgSend(aDataSource, "respondsToSelector:", sel_getUid("outlineView:child:ofItem:")))
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, "Data source must implement 'outlineView:child:ofItem:'");
    if (!objj_msgSend(aDataSource, "respondsToSelector:", sel_getUid("outlineView:isItemExpandable:")))
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, "Data source must implement 'outlineView:isItemExpandable:'");
    if (!objj_msgSend(aDataSource, "respondsToSelector:", sel_getUid("outlineView:numberOfChildrenOfItem:")))
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, "Data source must implement 'outlineView:numberOfChildrenOfItem:'");
    if (!objj_msgSend(aDataSource, "respondsToSelector:", sel_getUid("outlineView:objectValueForTableColumn:byItem:")))
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, "Data source must implement 'outlineView:objectValueForTableColumn:byItem:'");
    _outlineViewDataSource = aDataSource;
    _implementedOutlineViewDataSourceMethods = 0;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:setObjectValue:forTableColumn:byItem:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_setObjectValue_forTableColumn_byItem_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:shouldDeferDisplayingChildrenOfItem:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_shouldDeferDisplayingChildrenOfItem_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:acceptDrop:item:childIndex:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_acceptDrop_item_childIndex_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:validateDrop:proposedItem:proposedChildIndex:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_validateDrop_proposedItem_proposedChildIndex_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:validateDrop:proposedRow:proposedDropOperation:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_validateDrop_proposedRow_proposedDropOperation_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:namesOfPromisedFilesDroppedAtDestination:forDraggedItems:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_namesOfPromisedFilesDroppedAtDestination_forDraggedItems_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:itemForPersistentObject:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_itemForPersistentObject_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:persistentObjectForItem:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_persistentObjectForItem_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:writeItems:toPasteboard:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_writeItems_toPasteboard_;
    if (objj_msgSend(_outlineViewDataSource, "respondsToSelector:", sel_getUid("outlineView:sortDescriptorsDidChange:")))
        _implementedOutlineViewDataSourceMethods |= CPOutlineViewDataSource_outlineView_sortDescriptorsDidChange_;
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("dataSource"), function(self, _cmd)
{ with(self)
{
    return _outlineViewDataSource;
}
}), new objj_method(sel_getUid("isExpandable:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return YES;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return NO;
    return itemInfo.isExpandable;
}
}), new objj_method(sel_getUid("isItemExpanded:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return YES;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return NO;
    return itemInfo.isExpanded;
}
}), new objj_method(sel_getUid("expandItem:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return;
    if (itemInfo.isExpanded)
        return;
    itemInfo.isExpanded = YES;
    objj_msgSend(self, "reloadItem:reloadChildren:", anItem, YES);
}
}), new objj_method(sel_getUid("collapseItem:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return;
    if (!itemInfo.isExpanded)
        return;
    itemInfo.isExpanded = NO;
    objj_msgSend(self, "reloadItem:reloadChildren:", anItem, YES);
}
}), new objj_method(sel_getUid("reloadItem:"), function(self, _cmd, anItem)
{ with(self)
{
    objj_msgSend(self, "reloadItem:reloadChildren:", anItem, NO);
}
}), new objj_method(sel_getUid("reloadItem:reloadChildren:"), function(self, _cmd, anItem, shouldReloadChildren)
{ with(self)
{
    if (!!shouldReloadChildren || !anItem)
        _loadItemInfoForItem(self, anItem);
    else
        _reloadItem(self, anItem);
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "reloadData");
}
}), new objj_method(sel_getUid("itemAtRow:"), function(self, _cmd, aRow)
{ with(self)
{
    return _itemsForRows[aRow] || nil;
}
}), new objj_method(sel_getUid("rowForItem:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return _rootItemInfo.row;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return CPNotFound;
    return itemInfo.row;
}
}), new objj_method(sel_getUid("setOutlineTableColumn:"), function(self, _cmd, aTableColumn)
{ with(self)
{
    if (_outlineTableColumn === aTableColumn)
        return;
    _outlineTableColumn = aTableColumn;
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("outlineTableColumn"), function(self, _cmd)
{ with(self)
{
    return _outlineTableColumn;
}
}), new objj_method(sel_getUid("levelForItem:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return _rootItemInfo.level;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return CPNotFound;
    return itemInfo.level;
}
}), new objj_method(sel_getUid("levelForRow:"), function(self, _cmd, aRow)
{ with(self)
{
    return objj_msgSend(self, "levelForItem:", objj_msgSend(self, "itemAtRow:", aRow));
}
}), new objj_method(sel_getUid("setIndentationPerLevel:"), function(self, _cmd, anIndentationWidth)
{ with(self)
{
    if (_indentationPerLevel === anIndentationWidth)
        return;
    _indentationPerLevel = anIndentationWidth;
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("indentationPerLevel"), function(self, _cmd)
{ with(self)
{
    return _indentationPerLevel;
}
}), new objj_method(sel_getUid("setIndentationMarkerFollowsDataView:"), function(self, _cmd, indentationMarkerShouldFollowDataView)
{ with(self)
{
    if (_indentationMarkerFollowsDataView === indentationMarkerShouldFollowDataView)
        return;
    _indentationMarkerFollowsDataView = indentationMarkerShouldFollowDataView;
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("indentationMarkerFollowsDataView"), function(self, _cmd)
{ with(self)
{
    return _indentationMarkerFollowsDataView;
}
}), new objj_method(sel_getUid("parentForItem:"), function(self, _cmd, anItem)
{ with(self)
{
    if (!anItem)
        return nil;
    var itemInfo = _itemInfosForItems[objj_msgSend(anItem, "UID")];
    if (!itemInfo)
        return nil;
    return itemInfo.parent;
}
}), new objj_method(sel_getUid("frameOfOutlineDataViewAtColumn:row:"), function(self, _cmd, aColumn, aRow)
{ with(self)
{
    var frame = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "frameOfDataViewAtColumn:row:", aColumn, aRow),
        indentationWidth = (objj_msgSend(self, "levelForRow:", aRow) + 1) * objj_msgSend(self, "indentationPerLevel");
    frame.origin.x += indentationWidth;
    frame.size.width -= indentationWidth;
    return frame;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    if (_outlineViewDelegate === aDelegate)
        return;
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_outlineViewDelegate)
    {
        if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewColumnDidMove:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _outlineViewDelegate, CPOutlineViewColumnDidMoveNotification, self);
        if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewColumnDidResize:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _outlineViewDelegate, CPOutlineViewColumnDidResizeNotification, self);
        if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewSelectionDidChange:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _outlineViewDelegate, CPOutlineViewSelectionDidChangeNotification, self);
        if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewSelectionIsChanging:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _outlineViewDelegate, CPOutlineViewSelectionIsChangingNotification, self);
    }
    _outlineViewDelegate = aDelegate;
    if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewColumnDidMove:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _outlineViewDelegate, sel_getUid("outlineViewColumnDidMove:"), CPOutlineViewColumnDidMoveNotification, self);
    if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewColumnDidResize:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _outlineViewDelegate, sel_getUid("outlineViewColumnDidMove:"), CPOutlineViewColumnDidResizeNotification, self);
    if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewSelectionDidChange:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _outlineViewDelegate, sel_getUid("outlineViewSelectionDidChange:"), CPOutlineViewSelectionDidChangeNotification, self);
    if (objj_msgSend(_outlineViewDelegate, "respondsToSelector:", sel_getUid("outlineViewSelectionIsChanging:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _outlineViewDelegate, sel_getUid("outlineViewSelectionIsChanging:"), CPOutlineViewSelectionIsChangingNotification, self);
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _outlineViewDelegate;
}
}), new objj_method(sel_getUid("setDisclosureControlPrototype:"), function(self, _cmd, aControl)
{ with(self)
{
    _disclosureControlPrototype = aControl;
    _disclosureControlData = nil;
    _disclosureControlQueue = [];
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("reloadData"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "reloadItem:reloadChildren:", nil, YES);
}
}), new objj_method(sel_getUid("frameOfDataViewAtColumn:row:"), function(self, _cmd, aColumn, aRow)
{ with(self)
{
    var tableColumn = objj_msgSend(self, "tableColumns")[aColumn];
    if (tableColumn === _outlineTableColumn)
        return objj_msgSend(self, "frameOfOutlineDataViewAtColumn:row:", aColumn, aRow);
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "frameOfDataViewAtColumn:row:", aColumn, aRow);
}
}), new objj_method(sel_getUid("_loadDataViewsInRows:columns:"), function(self, _cmd, rows, columns)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "_loadDataViewsInRows:columns:", rows, columns);
    var outlineColumn = objj_msgSend(objj_msgSend(self, "tableColumns"), "indexOfObjectIdenticalTo:", objj_msgSend(self, "outlineTableColumn"));
    if (!objj_msgSend(columns, "containsIndex:", outlineColumn))
        return;
    var rowArray = [];
    objj_msgSend(rows, "getIndexes:maxCount:inIndexRange:", rowArray, -1, nil);
    var rowIndex = 0,
        rowsCount = rowArray.length;
    for (; rowIndex < rowsCount; ++rowIndex)
    {
        var row = rowArray[rowIndex],
            item = _itemsForRows[row],
            isExpandable = objj_msgSend(self, "isExpandable:", item);
       if (!isExpandable)
            continue;
        var control = objj_msgSend(self, "_dequeueDisclosureControl"),
            frame = objj_msgSend(control, "frame"),
            dataViewFrame = objj_msgSend(self, "frameOfDataViewAtColumn:row:", outlineColumn, row);
        frame.origin.x = _indentationMarkerFollowsDataView ? (dataViewFrame.origin.x) - (frame.size.width) : 0.0;
        frame.origin.y = (dataViewFrame.origin.y);
        frame.size.height = (dataViewFrame.size.height);
        _disclosureControlsForRows[row] = control;
        objj_msgSend(control, "setState:", objj_msgSend(self, "isItemExpanded:", item) ? CPOnState : CPOffState);
        objj_msgSend(control, "setFrame:", frame);
        objj_msgSend(self, "addSubview:", control);
    }
}
}), new objj_method(sel_getUid("_unloadDataViewsInRows:columns:"), function(self, _cmd, rows, columns)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPOutlineView").super_class }, "_unloadDataViewsInRows:columns:", rows, columns);
    var outlineColumn = objj_msgSend(objj_msgSend(self, "tableColumns"), "indexOfObjectIdenticalTo:", objj_msgSend(self, "outlineTableColumn"));
    if (!objj_msgSend(columns, "containsIndex:", outlineColumn))
        return;
    var rowArray = [];
    objj_msgSend(rows, "getIndexes:maxCount:inIndexRange:", rowArray, -1, nil);
    var rowIndex = 0,
        rowsCount = rowArray.length;
    for (; rowIndex < rowsCount; ++rowIndex)
    {
        var row = rowArray[rowIndex],
            control = _disclosureControlsForRows[row];
        if (!control)
            continue;
        objj_msgSend(control, "removeFromSuperview");
        objj_msgSend(self, "_enqueueDisclosureControl:", control);
        _disclosureControlsForRows[row] = nil;
    }
}
}), new objj_method(sel_getUid("_toggleFromDisclosureControl:"), function(self, _cmd, aControl)
{ with(self)
{
    var controlFrame = objj_msgSend(aControl, "frame"),
        item = objj_msgSend(self, "itemAtRow:", objj_msgSend(self, "rowAtPoint:", { x:(controlFrame.origin.x), y:(controlFrame.origin.y + (controlFrame.size.height) / 2.0) }));
    if (objj_msgSend(self, "isItemExpanded:", item))
        objj_msgSend(self, "collapseItem:", item);
    else
        objj_msgSend(self, "expandItem:", item);
}
}), new objj_method(sel_getUid("_enqueueDisclosureControl:"), function(self, _cmd, aControl)
{ with(self)
{
    _disclosureControlQueue.push(aControl);
}
}), new objj_method(sel_getUid("_dequeueDisclosureControl"), function(self, _cmd)
{ with(self)
{
    if (_disclosureControlQueue.length)
        return _disclosureControlQueue.pop();
    if (!_disclosureControlData)
        if (!_disclosureControlPrototype)
            return nil;
        else
            _disclosureControlData = objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", _disclosureControlPrototype);
    var disclosureControl = objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", _disclosureControlData);
    objj_msgSend(disclosureControl, "setTarget:", self);
    objj_msgSend(disclosureControl, "setAction:", sel_getUid("_toggleFromDisclosureControl:"));
    return disclosureControl;
}
}), new objj_method(sel_getUid("_noteSelectionIsChanging"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPOutlineViewSelectionIsChangingNotification, self, nil);
}
}), new objj_method(sel_getUid("_noteSelectionDidChange"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPOutlineViewSelectionDidChangeNotification, self, nil);
}
})]);
}
var _reloadItem = function( anOutlineView, anItem)
{
    if (!anItem)
        return;
    with(anOutlineView)
    {
        var itemInfosForItems = _itemInfosForItems,
            dataSource = _outlineViewDataSource,
            itemUID = objj_msgSend(anItem, "UID"),
            itemInfo = itemInfosForItems[itemUID];
        if (!itemInfo)
            return [];
        var parent = itemInfo.parent,
            parentItemInfo = parent ? itemInfosForItems[objj_msgSend(parent, "UID")] : _rootItemInfo,
            parentChildren = parentItemInfo.children,
            index = objj_msgSend(parentChildren, "indexOfObjectIdenticalTo:", anItem),
            newItem = objj_msgSend(dataSource, "outlineView:child:ofItem:", anOutlineView, index, parent);
        if (anItem !== newItem)
        {
            itemInfosForItems[objj_msgSend(anItem, "UID")] = nil;
            itemInfosForItems[objj_msgSend(newItem, "UID")] = itemInfo;
            parentChildren[index] = newItem;
            _itemsForRows[itemInfo.row] = newItem;
        }
        itemInfo.isExpandable = objj_msgSend(dataSource, "outlineView:isItemExpandable:", anOutlineView, newItem);
        itemInfo.isExpanded = itemInfo.isExpandable && itemInfo.isExpanded;
    }
}
var _loadItemInfoForItem = function( anOutlineView, anItem, isIntermediate)
{
    with(anOutlineView)
    {
        var itemInfosForItems = _itemInfosForItems,
            dataSource = _outlineViewDataSource;
        if (!anItem)
            var itemInfo = _rootItemInfo;
        else
        {
            var itemUID = objj_msgSend(anItem, "UID"),
                itemInfo = itemInfosForItems[itemUID];
            if (!itemInfo)
                return [];
            itemInfo.isExpandable = objj_msgSend(dataSource, "outlineView:isItemExpandable:", anOutlineView, anItem);
            if (!itemInfo.isExpandable && itemInfo.isExpanded)
            {
                itemInfo.isExpanded = NO;
                itemInfo.children = [];
            }
        }
        var weight = itemInfo.weight,
            descendants = anItem ? [anItem] : [];
        if (itemInfo.isExpanded && (!(_implementedOutlineViewDataSourceMethods & CPOutlineViewDataSource_outlineView_shouldDeferDisplayingChildrenOfItem_) ||
            !objj_msgSend(dataSource, "outlineView:shouldDeferDisplayingChildrenOfItem:", anOutlineView, anItem)))
        {
            var index = 0,
                count = objj_msgSend(dataSource, "outlineView:numberOfChildrenOfItem:", anOutlineView, anItem),
                level = itemInfo.level + 1;
            itemInfo.children = [];
            for (; index < count; ++index)
            {
                var childItem = objj_msgSend(dataSource, "outlineView:child:ofItem:", anOutlineView, index, anItem),
                    childItemInfo = itemInfosForItems[objj_msgSend(childItem, "UID")];
                if (!childItemInfo)
                {
                    childItemInfo = { isExpanded:NO, isExpandable:NO, children:[], weight:1 };
                    itemInfosForItems[objj_msgSend(childItem, "UID")] = childItemInfo;
                }
                itemInfo.children[index] = childItem;
                var childDescendants = _loadItemInfoForItem(anOutlineView, childItem, YES);
                childItemInfo.parent = anItem;
                childItemInfo.level = level;
                descendants = descendants.concat(childDescendants);
            }
        }
        itemInfo.weight = descendants.length;
        if (!isIntermediate)
        {
            var index = MAX(itemInfo.row, 0),
                itemsForRows = _itemsForRows;
            descendants.unshift(index, weight);
            itemsForRows.splice.apply(itemsForRows, descendants);
            var count = itemsForRows.length;
            for (; index < count; ++index)
                itemInfosForItems[objj_msgSend(itemsForRows[index], "UID")].row = index;
            var deltaWeight = itemInfo.weight - weight;
            if (deltaWeight !== 0)
            {
                var parent = itemInfo.parent;
                while (parent)
                {
                    var parentItemInfo = itemInfosForItems[objj_msgSend(parent, "UID")];
                    parentItemInfo.weight += deltaWeight;
                    parent = parentItemInfo.parent;
                }
                if (anItem)
                    _rootItemInfo.weight += deltaWeight;
            }
        }
    }
    return descendants;
}
{var the_class = objj_allocateClassPair(CPObject, "_CPOutlineViewTableViewDataSource"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_outlineView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithOutlineView:"), function(self, _cmd, anOutlineView)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPOutlineViewTableViewDataSource").super_class }, "init");
    if (self)
        _outlineView = anOutlineView;
    return self;
}
}), new objj_method(sel_getUid("numberOfRowsInTableView:"), function(self, _cmd, anOutlineView)
{ with(self)
{
    return _outlineView._itemsForRows.length;
}
}), new objj_method(sel_getUid("tableView:objectValueForTableColumn:row:"), function(self, _cmd, aTableView, aTableColumn, aRow)
{ with(self)
{
    return objj_msgSend(_outlineView._outlineViewDataSource, "outlineView:objectValueForTableColumn:byItem:", _outlineView, aTableColumn, _outlineView._itemsForRows[aRow]);
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "_CPOutlineViewTableViewDelegate"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_outlineView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithOutlineView:"), function(self, _cmd, anOutlineView)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPOutlineViewTableViewDelegate").super_class }, "init");
    if (self)
        _outlineView = anOutlineView;
    return self;
}
})]);
}
{var the_class = objj_allocateClassPair(CPButton, "CPDisclosureButton"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_angle")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPDisclosureButton").super_class }, "initWithFrame:", aFrame);
    if (self)
        objj_msgSend(self, "setBordered:", NO);
    return self;
}
}), new objj_method(sel_getUid("setState:"), function(self, _cmd, aState)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPDisclosureButton").super_class }, "setState:", aState);
    if (objj_msgSend(self, "state") === CPOnState)
        _angle = 0.0;
    else
        _angle = -PI_2;
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextBeginPath(context);
    CGContextTranslateCTM(context, (bounds.size.width) / 2.0, (bounds.size.height) / 2.0);
    CGContextRotateCTM(context, _angle);
    CGContextTranslateCTM(context, -(bounds.size.width) / 2.0, -(bounds.size.height) / 2.0);
    CGContextTranslateCTM(context, FLOOR(((bounds.size.width) - 9.0) / 2.0), FLOOR(((bounds.size.height) - 8.0) / 2.0));
    CGContextMoveToPoint(context, 0.0, 0.0);
    CGContextAddLineToPoint(context, 9.0, 0.0);
    CGContextAddLineToPoint(context, 4.5, 8.0);
    CGContextAddLineToPoint(context, 0.0, 0.0);
    CGContextClosePath(context);
    CGContextSetFillColor(context, (objj_msgSend(self, "themeState") & CPThemeState("highlighted")) ? objj_msgSend(CPColor, "blackColor") : objj_msgSend(CPColor, "grayColor"));
    CGContextFillPath(context);
}
})]);
}

p;9;CPPanel.jt;1463;@STATIC;1.0;i;10;CPWindow.jt;1429;objj_executeFile("CPWindow.j", true);
CPOKButton = 1;
CPCancelButton = 0;
CPDocModalWindowMask = 1 << 6;
{var the_class = objj_allocateClassPair(CPWindow, "CPPanel"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_becomesKeyOnlyIfNeeded"), new objj_ivar("_worksWhenModal")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isFloatingPanel"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "level") == CPFloatingWindowLevel;
}
}), new objj_method(sel_getUid("setFloatingPanel:"), function(self, _cmd, isFloatingPanel)
{ with(self)
{
    objj_msgSend(self, "setLevel:", isFloatingPanel ? CPFloatingWindowLevel : CPNormalWindowLevel);
}
}), new objj_method(sel_getUid("becomesKeyOnlyIfNeeded"), function(self, _cmd)
{ with(self)
{
    return _becomesKeyOnlyIfNeeded;
}
}), new objj_method(sel_getUid("setBecomesKeyOnlyIfNeeded:"), function(self, _cmd, shouldBecomeKeyOnlyIfNeeded)
{ with(self)
{
    _becomesKeyOnlyIfNeeded = shouldBecomeKeyOnlyIfNeeded
}
}), new objj_method(sel_getUid("worksWhenModal"), function(self, _cmd)
{ with(self)
{
    return _worksWhenModal;
}
}), new objj_method(sel_getUid("setWorksWhenModal:"), function(self, _cmd, shouldWorkWhenModal)
{ with(self)
{
    _worksWhenModal = shouldWorkWhenModal;
}
}), new objj_method(sel_getUid("canBecomeMainWindow"), function(self, _cmd)
{ with(self)
{
    return NO;
}
})]);
}

p;14;CPPasteboard.jt;10518;@STATIC;1.0;I;21;Foundation/CPObject.jI;20;Foundation/CPArray.jI;25;Foundation/CPDictionary.jI;40;Foundation/CPPropertyListSerialization.jt;10372;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPDictionary.j", false);
objj_executeFile("Foundation/CPPropertyListSerialization.j", false);
CPGeneralPboard = "CPGeneralPboard";
CPFontPboard = "CPFontPboard";
CPRulerPboard = "CPRulerPboard";
CPFindPboard = "CPFindPboard";
CPDragPboard = "CPDragPboard";
CPColorPboardType = "CPColorPboardType";
CPFilenamesPboardType = "CPFilenamesPboardType";
CPFontPboardType = "CPFontPboardType";
CPHTMLPboardType = "CPHTMLPboardType";
CPStringPboardType = "CPStringPboardType";
CPURLPboardType = "CPURLPboardType";
CPImagesPboardType = "CPImagesPboardType";
CPVideosPboardType = "CPVideosPboardType";
UTF8PboardType = "public.utf8-plain-text";
CPImagePboardType = "CPImagePboardType";
var CPPasteboards = nil,
    supportsNativePasteboard = NO;
{var the_class = objj_allocateClassPair(CPObject, "CPPasteboard"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_types"), new objj_ivar("_owners"), new objj_ivar("_provided"), new objj_ivar("_changeCount"), new objj_ivar("_stateUID"), new objj_ivar("_nativePasteboard")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_initWithName:"), function(self, _cmd, aName)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPasteboard").super_class }, "init");
    if (self)
    {
        _name = aName;
        _types = [];
        _owners = objj_msgSend(CPDictionary, "dictionary");
        _provided = objj_msgSend(CPDictionary, "dictionary");
        _changeCount = 0;
        if (supportsNativePasteboard)
        {
            _nativePasteboard = window.cpPasteboardWithName(aName);
            objj_msgSend(self, "_synchronizePasteboard");
        }
    }
    return self;
}
}), new objj_method(sel_getUid("addTypes:owner:"), function(self, _cmd, types, anOwner)
{ with(self)
{
    var i = 0,
        count = types.length;
    for (; i < count; ++i)
    {
        var type = types[i];
        if(!objj_msgSend(_owners, "objectForKey:", type))
        {
            objj_msgSend(_types, "addObject:", type);
            objj_msgSend(_provided, "removeObjectForKey:", type);
        }
        objj_msgSend(_owners, "setObject:forKey:", anOwner, type);
    }
    if (_nativePasteboard)
    {
        var nativeTypes = objj_msgSend(types, "copy");
        if (objj_msgSend(types, "containsObject:", CPStringPboardType))
            nativeTypes.push(UTF8PboardType);
        _nativePasteboard.addTypes_(nativeTypes);
    }
    return ++_changeCount;
}
}), new objj_method(sel_getUid("declareTypes:owner:"), function(self, _cmd, types, anOwner)
{ with(self)
{
    objj_msgSend(self, "_declareTypes:owner:updateNativePasteboard:", types, anOwner, YES);
}
}), new objj_method(sel_getUid("_declareTypes:owner:updateNativePasteboard:"), function(self, _cmd, types, anOwner, shouldUpdate)
{ with(self)
{
    objj_msgSend(_types, "setArray:", types);
    _owners = objj_msgSend(CPDictionary, "dictionary");
    _provided = objj_msgSend(CPDictionary, "dictionary");
    var count = _types.length;
    while (count--)
        objj_msgSend(_owners, "setObject:forKey:", anOwner, _types[count]);
    if (_nativePasteboard && shouldUpdate)
    {
        var nativeTypes = objj_msgSend(types, "copy");
        if (objj_msgSend(types, "containsObject:", CPStringPboardType))
            nativeTypes.push(UTF8PboardType);
        _nativePasteboard.declareTypes_(nativeTypes);
        _changeCount = _nativePasteboard.changeCount();
    }
    return ++_changeCount;
}
}), new objj_method(sel_getUid("setData:forType:"), function(self, _cmd, aData, aType)
{ with(self)
{
    objj_msgSend(_provided, "setObject:forKey:", aData, aType);
    if (aType === CPStringPboardType)
        objj_msgSend(self, "setData:forType:", aData, UTF8PboardType);
    return YES;
}
}), new objj_method(sel_getUid("setPropertyList:forType:"), function(self, _cmd, aPropertyList, aType)
{ with(self)
{
    return objj_msgSend(self, "setData:forType:", objj_msgSend(CPPropertyListSerialization, "dataFromPropertyList:format:", aPropertyList, CPPropertyList280NorthFormat_v1_0), aType);
}
}), new objj_method(sel_getUid("setString:forType:"), function(self, _cmd, aString, aType)
{ with(self)
{
    objj_msgSend(self, "setPropertyList:forType:", aString, aType);
}
}), new objj_method(sel_getUid("availableTypeFromArray:"), function(self, _cmd, anArray)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "types"), "firstObjectCommonWithArray:", anArray);
}
}), new objj_method(sel_getUid("types"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_synchronizePasteboard");
    return _types;
}
}), new objj_method(sel_getUid("changeCount"), function(self, _cmd)
{ with(self)
{
    return _changeCount;
}
}), new objj_method(sel_getUid("dataForType:"), function(self, _cmd, aType)
{ with(self)
{
    var data = objj_msgSend(_provided, "objectForKey:", aType);
    if (data)
        return data;
    var owner = objj_msgSend(_owners, "objectForKey:", aType);
    if (owner)
    {
        objj_msgSend(owner, "pasteboard:provideDataForType:", self, aType);
        return objj_msgSend(_provided, "objectForKey:", aType);
    }
    if (aType === CPStringPboardType)
        return objj_msgSend(self, "dataForType:", UTF8PboardType);
    return nil;
}
}), new objj_method(sel_getUid("_synchronizePasteboard"), function(self, _cmd)
{ with(self)
{
    if (_nativePasteboard && _nativePasteboard.changeCount() > _changeCount)
    {
        var nativeTypes = objj_msgSend(_nativePasteboard.types(), "copy");
        if (objj_msgSend(nativeTypes, "containsObject:", UTF8PboardType))
            nativeTypes.push(CPStringPboardType);
        objj_msgSend(self, "_declareTypes:owner:updateNativePasteboard:", nativeTypes, self, NO);
        _changeCount = _nativePasteboard.changeCount();
    }
}
}), new objj_method(sel_getUid("pasteboard:provideDataForType:"), function(self, _cmd, aPasteboard, aType)
{ with(self)
{
    if (aType === CPStringPboardType)
    {
        var string = _nativePasteboard.stringForType_(UTF8PboardType);
        objj_msgSend(self, "setString:forType:", string, CPStringPboardType);
        objj_msgSend(self, "setString:forType:", string, UTF8PboardType);
    }
    else
        objj_msgSend(self, "setString:forType:", _nativePasteboard.stringForType_(aType), aType);
}
}), new objj_method(sel_getUid("propertyListForType:"), function(self, _cmd, aType)
{ with(self)
{
    var data = objj_msgSend(self, "dataForType:", aType);
    if (data)
        return objj_msgSend(CPPropertyListSerialization, "propertyListFromData:format:", data, CPPropertyList280NorthFormat_v1_0);
    return nil;
}
}), new objj_method(sel_getUid("stringForType:"), function(self, _cmd, aType)
{ with(self)
{
    return objj_msgSend(self, "propertyListForType:", aType);
}
}), new objj_method(sel_getUid("_generateStateUID"), function(self, _cmd)
{ with(self)
{
    var bits = 32;
    _stateUID = "";
    while (bits--)
        _stateUID += FLOOR(RAND() * 16.0).toString(16).toUpperCase();
    return _stateUID;
}
}), new objj_method(sel_getUid("_stateUID"), function(self, _cmd)
{ with(self)
{
    return _stateUID;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPPasteboard, "class"))
        return;
    objj_msgSend(self, "setVersion:", 1.0);
    CPPasteboards = objj_msgSend(CPDictionary, "dictionary");
    if (typeof window.cpPasteboardWithName !== "undefined")
        supportsNativePasteboard = YES;
}
}), new objj_method(sel_getUid("generalPasteboard"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPPasteboard, "pasteboardWithName:", CPGeneralPboard);
}
}), new objj_method(sel_getUid("pasteboardWithName:"), function(self, _cmd, aName)
{ with(self)
{
    var pasteboard = objj_msgSend(CPPasteboards, "objectForKey:", aName);
    if (pasteboard)
        return pasteboard;
    pasteboard = objj_msgSend(objj_msgSend(CPPasteboard, "alloc"), "_initWithName:", aName);
    objj_msgSend(CPPasteboards, "setObject:forKey:", pasteboard, aName);
    return pasteboard;
}
})]);
}
var DOMDataTransferPasteboard = nil;
{var the_class = objj_allocateClassPair(CPPasteboard, "_CPDOMDataTransferPasteboard"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_dataTransfer")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_setDataTransfer:"), function(self, _cmd, aDataTransfer)
{ with(self)
{
    _dataTransfer = aDataTransfer;
}
}), new objj_method(sel_getUid("_setPasteboard:"), function(self, _cmd, aPasteboard)
{ with(self)
{
    _dataTransfer.clearData();
    var types = objj_msgSend(aPasteboard, "types"),
        count = types.length;
    while (count--)
    {
        var type = types[count];
        if (type === CPStringPboardType)
            _dataTransfer.setData(type, objj_msgSend(aPasteboard, "stringForType:", type));
        else
            _dataTransfer.setData(type, objj_msgSend(objj_msgSend(aPasteboard, "dataForType:", type), "encodedString"));
    }
}
}), new objj_method(sel_getUid("types"), function(self, _cmd)
{ with(self)
{
    return Array.prototype.slice.apply(_dataTransfer.types);
}
}), new objj_method(sel_getUid("dataForType:"), function(self, _cmd, aType)
{ with(self)
{
    var dataString = _dataTransfer.getData(aType);
    if (aType === CPStringPboardType)
        return objj_msgSend(CPData, "dataFromPropertyList:format:", dataString, kCFPropertyList280NorthFormat_v1_0);
    return objj_msgSend(CPData, "dataWithEncodedString:", dataString);
}
}), new objj_method(sel_getUid("propertyListForType:"), function(self, _cmd, aType)
{ with(self)
{
    if (aType === CPStringPboardType)
        return _dataTransfer.getData(aType);
    return objj_msgSend(CPPropertyListSerialization, "propertyListFromData:format:", objj_msgSend(self, "dataForType:", aType), CPPropertyListUnknownFormat);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("DOMDataTransferPasteboard"), function(self, _cmd)
{ with(self)
{
    if (!DOMDataTransferPasteboard)
        DOMDataTransferPasteboard = objj_msgSend(objj_msgSend(_CPDOMDataTransferPasteboard, "alloc"), "init");
    return DOMDataTransferPasteboard;
}
})]);
}

p;15;CPPopUpButton.jt;16282;@STATIC;1.0;i;10;CPButton.ji;12;CPGeometry.ji;8;CPMenu.ji;12;CPMenuItem.jt;16201;objj_executeFile("CPButton.j", true);
objj_executeFile("CPGeometry.j", true);
objj_executeFile("CPMenu.j", true);
objj_executeFile("CPMenuItem.j", true);
var VISIBLE_MARGIN = 7.0;
CPPopUpButtonStatePullsDown = CPThemeState("pulls-down");
{var the_class = objj_allocateClassPair(CPButton, "CPPopUpButton"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_selectedIndex"), new objj_ivar("_preferredEdge"), new objj_ivar("_menu")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:pullsDown:"), function(self, _cmd, aFrame, shouldPullDown)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPopUpButton").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _selectedIndex = CPNotFound;
        _preferredEdge = CPMaxYEdge;
        objj_msgSend(self, "setValue:forThemeAttribute:", CPImageLeft, "image-position");
        objj_msgSend(self, "setValue:forThemeAttribute:", CPLeftTextAlignment, "alignment");
        objj_msgSend(self, "setValue:forThemeAttribute:", CPLineBreakByTruncatingTail, "line-break-mode");
        objj_msgSend(self, "setMenu:", objj_msgSend(objj_msgSend(CPMenu, "alloc"), "initWithTitle:", ""));
        objj_msgSend(self, "setPullsDown:", shouldPullDown);
    }
    return self;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    return objj_msgSend(self, "initWithFrame:pullsDown:", aFrame, NO);
}
}), new objj_method(sel_getUid("setPullsDown:"), function(self, _cmd, shouldPullDown)
{ with(self)
{
    if (shouldPullDown)
        var changed = objj_msgSend(self, "setThemeState:", CPPopUpButtonStatePullsDown);
    else
        var changed = objj_msgSend(self, "unsetThemeState:", CPPopUpButtonStatePullsDown);
    if (!changed)
        return;
    var items = objj_msgSend(_menu, "itemArray");
    if (objj_msgSend(items, "count") <= 0)
        return;
    objj_msgSend(items[0], "setHidden:", objj_msgSend(self, "pullsDown"));
    objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("pullsDown"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "hasThemeState:", CPPopUpButtonStatePullsDown);
}
}), new objj_method(sel_getUid("addItem:"), function(self, _cmd, anItem)
{ with(self)
{
    objj_msgSend(_menu, "addItem:", anItem);
}
}), new objj_method(sel_getUid("addItemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    objj_msgSend(_menu, "addItemWithTitle:action:keyEquivalent:", aTitle, NULL, nil);
}
}), new objj_method(sel_getUid("addItemsWithTitles:"), function(self, _cmd, titles)
{ with(self)
{
    var index = 0,
        count = objj_msgSend(titles, "count");
    for (; index < count; ++index)
        objj_msgSend(self, "addItemWithTitle:", titles[index]);
}
}), new objj_method(sel_getUid("insertItemWithTitle:atIndex:"), function(self, _cmd, aTitle, anIndex)
{ with(self)
{
    var items = objj_msgSend(self, "itemArray"),
        count = objj_msgSend(items, "count");
    while (count--)
        if (objj_msgSend(items[count], "title") == aTitle)
            objj_msgSend(self, "removeItemAtIndex:", count);
    objj_msgSend(_menu, "insertItemWithTitle:action:keyEquivalent:atIndex:", aTitle, NULL, nil, anIndex);
}
}), new objj_method(sel_getUid("removeAllItems"), function(self, _cmd)
{ with(self)
{
    var count = objj_msgSend(_menu, "numberOfItems");
    while (count--)
        objj_msgSend(_menu, "removeItemAtIndex:", 0);
}
}), new objj_method(sel_getUid("removeItemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    objj_msgSend(self, "removeItemAtIndex:", objj_msgSend(self, "indexOfItemWithTitle:", aTitle));
    objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("removeItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    objj_msgSend(_menu, "removeItemAtIndex:", anIndex);
    objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("selectedItem"), function(self, _cmd)
{ with(self)
{
    if (_selectedIndex < 0 || _selectedIndex > objj_msgSend(self, "numberOfItems") - 1)
        return nil;
    return objj_msgSend(_menu, "itemAtIndex:", _selectedIndex);
}
}), new objj_method(sel_getUid("titleOfSelectedItem"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "selectedItem"), "title");
}
}), new objj_method(sel_getUid("indexOfSelectedItem"), function(self, _cmd)
{ with(self)
{
    return _selectedIndex;
}
}), new objj_method(sel_getUid("objectValue"), function(self, _cmd)
{ with(self)
{
    return _selectedIndex;
}
}), new objj_method(sel_getUid("selectItem:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    objj_msgSend(self, "selectItemAtIndex:", objj_msgSend(self, "indexOfItem:", aMenuItem));
}
}), new objj_method(sel_getUid("selectItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    if (_selectedIndex == anIndex)
        return;
    if (_selectedIndex >= 0 && !objj_msgSend(self, "pullsDown"))
        objj_msgSend(objj_msgSend(self, "selectedItem"), "setState:", CPOffState);
    _selectedIndex = anIndex;
    if (_selectedIndex >= 0 && !objj_msgSend(self, "pullsDown"))
        objj_msgSend(objj_msgSend(self, "selectedItem"), "setState:", CPOnState);
    objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("selectItemWithTag:"), function(self, _cmd, aTag)
{ with(self)
{
    objj_msgSend(self, "selectItemAtIndex:", objj_msgSend(self, "indexOfItemWithTag:", aTag));
}
}), new objj_method(sel_getUid("selectItemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    objj_msgSend(self, "selectItemAtIndex:", objj_msgSend(self, "indexOfItemWithTitle:", aTitle));
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSend(self, "selectItemAtIndex:", objj_msgSend(aValue, "intValue"));
}
}), new objj_method(sel_getUid("menu"), function(self, _cmd)
{ with(self)
{
    return _menu;
}
}), new objj_method(sel_getUid("setMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    if (_menu === aMenu)
        return;
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_menu)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPMenuDidAddItemNotification, _menu);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPMenuDidChangeItemNotification, _menu);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPMenuDidRemoveItemNotification, _menu);
    }
    _menu = aMenu;
    if (_menu)
    {
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("menuDidAddItem:"), CPMenuDidAddItemNotification, _menu);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("menuDidChangeItem:"), CPMenuDidChangeItemNotification, _menu);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("menuDidRemoveItem:"), CPMenuDidRemoveItemNotification, _menu);
    }
    objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("numberOfItems"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_menu, "numberOfItems");
}
}), new objj_method(sel_getUid("itemArray"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_menu, "itemArray");
}
}), new objj_method(sel_getUid("itemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(_menu, "itemAtIndex:", anIndex);
}
}), new objj_method(sel_getUid("itemTitleAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(objj_msgSend(_menu, "itemAtIndex:", anIndex), "title");
}
}), new objj_method(sel_getUid("itemTitles"), function(self, _cmd)
{ with(self)
{
    var titles = [],
        items = objj_msgSend(self, "itemArray"),
        index = 0,
        count = objj_msgSend(items, "count");
    for (; index < count; ++index)
        items.push(objj_msgSend(items[index], "title"));
}
}), new objj_method(sel_getUid("itemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    return objj_msgSend(_menu, "itemAtIndex:", objj_msgSend(_menu, "indexOfItemWithTitle:", aTitle));
}
}), new objj_method(sel_getUid("lastItem"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(_menu, "itemArray"), "lastObject");
}
}), new objj_method(sel_getUid("indexOfItem:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    return objj_msgSend(_menu, "indexOfItem:", aMenuItem);
}
}), new objj_method(sel_getUid("indexOfItemWithTag:"), function(self, _cmd, aTag)
{ with(self)
{
    return objj_msgSend(_menu, "indexOfItemWithTag:", aTag);
}
}), new objj_method(sel_getUid("indexOfItemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    return objj_msgSend(_menu, "indexOfItemWithTitle:", aTitle);
}
}), new objj_method(sel_getUid("indexOfItemWithRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    return objj_msgSend(_menu, "indexOfItemWithRepresentedObject:", anObject);
}
}), new objj_method(sel_getUid("indexOfItemWithTarget:action:"), function(self, _cmd, aTarget, anAction)
{ with(self)
{
    return objj_msgSend(_menu, "indexOfItemWithTarget:action:", aTarget, anAction);
}
}), new objj_method(sel_getUid("preferredEdge"), function(self, _cmd)
{ with(self)
{
    return _preferredEdge;
}
}), new objj_method(sel_getUid("setPreferredEdge:"), function(self, _cmd, aRectEdge)
{ with(self)
{
    _preferredEdge = aRectEdge;
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    if (objj_msgSend(self, "title") === aTitle)
        return;
    if (objj_msgSend(self, "pullsDown"))
    {
        var items = objj_msgSend(_menu, "itemArray");
        if (objj_msgSend(items, "count") <= 0)
            objj_msgSend(self, "addItemWithTitle:", aTitle);
        else
        {
            objj_msgSend(items[0], "setTitle:", aTitle);
            objj_msgSend(self, "synchronizeTitleAndSelectedItem");
        }
    }
    else
    {
        var index = objj_msgSend(self, "indexOfItemWithTitle:", aTitle);
        if (index < 0)
        {
            objj_msgSend(self, "addItemWithTitle:", aTitle);
            index = objj_msgSend(self, "numberOfItems") - 1;
        }
        objj_msgSend(self, "selectItemAtIndex:", index);
    }
}
}), new objj_method(sel_getUid("setImage:"), function(self, _cmd, anImage)
{ with(self)
{
}
}), new objj_method(sel_getUid("synchronizeTitleAndSelectedItem"), function(self, _cmd)
{ with(self)
{
    var item = nil;
    if (objj_msgSend(self, "pullsDown"))
    {
        var items = objj_msgSend(_menu, "itemArray");
        if (objj_msgSend(items, "count") > 0)
            item = items[0];
    }
    else
        item = objj_msgSend(self, "selectedItem");
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPopUpButton").super_class }, "setImage:", objj_msgSend(item, "image"));
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPopUpButton").super_class }, "setTitle:", objj_msgSend(item, "title"));
}
}), new objj_method(sel_getUid("menuDidAddItem:"), function(self, _cmd, aNotification)
{ with(self)
{
    var index = objj_msgSend(objj_msgSend(aNotification, "userInfo"), "objectForKey:", "CPMenuItemIndex");
    if (_selectedIndex < 0)
        objj_msgSend(self, "selectItemAtIndex:", 0);
    else if (index == _selectedIndex)
        objj_msgSend(self, "synchronizeTitleAndSelectedItem");
    else if (index < _selectedIndex)
        ++_selectedIndex;
    if (index == 0 && objj_msgSend(self, "pullsDown"))
    {
        var items = objj_msgSend(_menu, "itemArray");
        objj_msgSend(items[0], "setHidden:", YES);
        if (items.length > 0)
            objj_msgSend(items[1], "setHidden:", NO);
    }
    var item = objj_msgSend(_menu, "itemArray")[index],
        action = objj_msgSend(item, "action");
    if (!action || (action === sel_getUid("_popUpItemAction:")))
    {
        objj_msgSend(item, "setTarget:", self);
        objj_msgSend(item, "setAction:", sel_getUid("_popUpItemAction:"));
    }
}
}), new objj_method(sel_getUid("menuDidChangeItem:"), function(self, _cmd, aNotification)
{ with(self)
{
    var index = objj_msgSend(objj_msgSend(aNotification, "userInfo"), "objectForKey:", "CPMenuItemIndex");
    if (objj_msgSend(self, "pullsDown") && index != 0)
        return;
    if (!objj_msgSend(self, "pullsDown") && index != _selectedIndex)
        return;
    objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("menuDidRemoveItem:"), function(self, _cmd, aNotification)
{ with(self)
{
    var numberOfItems = objj_msgSend(self, "numberOfItems");
    if (numberOfItems <= _selectedIndex && numberOfItems > 0)
        objj_msgSend(self, "selectItemAtIndex:", numberOfItems - 1);
    else
        objj_msgSend(self, "synchronizeTitleAndSelectedItem");
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(self, "isEnabled") || !objj_msgSend(self, "numberOfItems"))
        return;
    objj_msgSend(self, "highlight:", YES);
    var menu = objj_msgSend(self, "menu"),
        bounds = objj_msgSend(self, "bounds"),
        minimumWidth = CGRectGetWidth(bounds);
    objj_msgSend(menu, "setFont:", objj_msgSend(self, "font"));
    if (objj_msgSend(self, "pullsDown"))
    {
        var positionedItem = nil,
            location = CGPointMake(0.0, CGRectGetMaxY(bounds));
    }
    else
    {
        var contentRect = objj_msgSend(self, "contentRectForBounds:", bounds),
            positionedItem = objj_msgSend(self, "selectedItem"),
            standardLeftMargin = objj_msgSend(_CPMenuWindow, "_standardLeftMargin") + objj_msgSend(_CPMenuItemStandardView, "_standardLeftMargin"),
            location = CGPointMake(CGRectGetMinX(contentRect) - standardLeftMargin, 0.0);
        minimumWidth += standardLeftMargin;
    }
    objj_msgSend(menu, "setMinimumWidth:", minimumWidth);
    objj_msgSend(menu, "_popUpMenuPositioningItem:atLocation:topY:bottomY:inView:callback:", positionedItem, location, CGRectGetMinY(bounds), CGRectGetMaxY(bounds), self, function(aMenu)
        {
            objj_msgSend(self, "highlight:", NO);
            var highlightedItem = objj_msgSend(aMenu, "highlightedItem");
            if (objj_msgSend(highlightedItem, "_isSelectable"))
                objj_msgSend(self, "selectItem:", highlightedItem);
        });
}
}), new objj_method(sel_getUid("_popUpItemAction:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "popup-button";
}
})]);
}
var CPPopUpButtonMenuKey = "CPPopUpButtonMenuKey",
    CPPopUpButtonSelectedIndexKey = "CPPopUpButtonSelectedIndexKey",
    CPPopUpButtonPullsDownKey = "CPPopUpButtonPullsDownKey";
{
var the_class = objj_getClass("CPPopUpButton")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPPopUpButton\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPopUpButton").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _selectedIndex = -1;
        objj_msgSend(self, "setMenu:", objj_msgSend(aCoder, "decodeObjectForKey:", CPPopUpButtonMenuKey));
        objj_msgSend(self, "selectItemAtIndex:", objj_msgSend(aCoder, "decodeObjectForKey:", CPPopUpButtonSelectedIndexKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPopUpButton").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _menu, CPPopUpButtonMenuKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _selectedIndex, CPPopUpButtonSelectedIndexKey);
}
})]);
}

p;21;CPProgressIndicator.jt;11455;@STATIC;1.0;I;19;AppKit/CGGeometry.jI;20;AppKit/CPImageView.jI;15;AppKit/CPView.jt;11366;objj_executeFile("AppKit/CGGeometry.j", false);
objj_executeFile("AppKit/CPImageView.j", false);
objj_executeFile("AppKit/CPView.j", false);
CPProgressIndicatorBarStyle = 0;
CPProgressIndicatorSpinningStyle = 1;
CPProgressIndicatorHUDBarStyle = 2;
var CPProgressIndicatorSpinningStyleColors = nil,
    CPProgressIndicatorClassName = nil,
    CPProgressIndicatorStyleIdentifiers = nil,
    CPProgressIndicatorStyleSizes = nil;
{var the_class = objj_allocateClassPair(CPView, "CPProgressIndicator"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_minValue"), new objj_ivar("_maxValue"), new objj_ivar("_doubleValue"), new objj_ivar("_controlSize"), new objj_ivar("_isIndeterminate"), new objj_ivar("_style"), new objj_ivar("_isAnimating"), new objj_ivar("_isDisplayedWhenStoppedSet"), new objj_ivar("_isDisplayedWhenStopped"), new objj_ivar("_barView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPProgressIndicator").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _minValue = 0.0;
        _maxValue = 100.0;
        _doubleValue = 0.0;
        _style = CPProgressIndicatorBarStyle;
        _isDisplayedWhenStoppedSet = NO;
        _controlSize = CPRegularControlSize;
        objj_msgSend(self, "updateBackgroundColor");
        objj_msgSend(self, "drawBar");
    }
    return self;
}
}), new objj_method(sel_getUid("setUsesThreadedAnimation:"), function(self, _cmd, aFlag)
{ with(self)
{
}
}), new objj_method(sel_getUid("startAnimation:"), function(self, _cmd, aSender)
{ with(self)
{
    _isAnimating = YES;
    objj_msgSend(self, "_hideOrDisplay");
}
}), new objj_method(sel_getUid("stopAnimation:"), function(self, _cmd, aSender)
{ with(self)
{
    _isAnimating = NO;
    objj_msgSend(self, "_hideOrDisplay");
}
}), new objj_method(sel_getUid("usesThreadedAnimation"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("incrementBy:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSend(self, "setDoubleValue:", _doubleValue + aValue);
}
}), new objj_method(sel_getUid("setDoubleValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _doubleValue = MIN(MAX(aValue, _minValue), _maxValue);
    objj_msgSend(self, "drawBar");
}
}), new objj_method(sel_getUid("doubleValue"), function(self, _cmd)
{ with(self)
{
    return _doubleValue;
}
}), new objj_method(sel_getUid("setMinValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _minValue = aValue;
}
}), new objj_method(sel_getUid("minValue"), function(self, _cmd)
{ with(self)
{
    return _minValue;
}
}), new objj_method(sel_getUid("setMaxValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _maxValue = aValue;
}
}), new objj_method(sel_getUid("maxValue"), function(self, _cmd)
{ with(self)
{
    return _maxValue;
}
}), new objj_method(sel_getUid("setControlSize:"), function(self, _cmd, aControlSize)
{ with(self)
{
    if (_controlSize == aControlSize)
        return;
    _controlSize = aControlSize;
    objj_msgSend(self, "updateBackgroundColor");
}
}), new objj_method(sel_getUid("controlSize"), function(self, _cmd)
{ with(self)
{
    return _controlSize;
}
}), new objj_method(sel_getUid("setControlTint:"), function(self, _cmd, aControlTint)
{ with(self)
{
}
}), new objj_method(sel_getUid("controlTint"), function(self, _cmd)
{ with(self)
{
    return 0;
}
}), new objj_method(sel_getUid("setBezeled:"), function(self, _cmd, isBezeled)
{ with(self)
{
}
}), new objj_method(sel_getUid("isBezeled"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("setIndeterminate:"), function(self, _cmd, isIndeterminate)
{ with(self)
{
    if (_isIndeterminate == isIndeterminate)
        return;
    _isIndeterminate = isIndeterminate;
    objj_msgSend(self, "updateBackgroundColor");
}
}), new objj_method(sel_getUid("isIndeterminate"), function(self, _cmd)
{ with(self)
{
    return _isIndeterminate;
}
}), new objj_method(sel_getUid("setStyle:"), function(self, _cmd, aStyle)
{ with(self)
{
    if (_style == aStyle)
        return;
    _style = aStyle;
    objj_msgSend(self, "updateBackgroundColor");
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    if (_style == CPProgressIndicatorSpinningStyle)
        objj_msgSend(self, "setFrameSize:", objj_msgSend(objj_msgSend(CPProgressIndicatorSpinningStyleColors[_controlSize], "patternImage"), "size"));
    else
        objj_msgSend(self, "setFrameSize:", CGSizeMake(CGRectGetWidth(objj_msgSend(self, "frame")), CPProgressIndicatorStyleSizes[
            CPProgressIndicatorClassName + "BezelBorder" + CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorBarStyle] +
            _CPControlIdentifierForControlSize(_controlSize)][0].height));
}
}), new objj_method(sel_getUid("setDisplayedWhenStopped:"), function(self, _cmd, isDisplayedWhenStopped)
{ with(self)
{
    if (_isDisplayedWhenStoppedSet && _isDisplayedWhenStopped == isDisplayedWhenStopped)
        return;
    _isDisplayedWhenStoppedSet = YES;
    _isDisplayedWhenStopped = isDisplayedWhenStopped;
    objj_msgSend(self, "_hideOrDisplay");
}
}), new objj_method(sel_getUid("isDisplayedWhenStopped"), function(self, _cmd)
{ with(self)
{
    if (_isDisplayedWhenStoppedSet)
        return _isDisplayedWhenStopped;
    if (_style == CPProgressIndicatorBarStyle || _style == CPProgressIndicatorHUDBarStyle)
        return YES;
    return NO;
}
}), new objj_method(sel_getUid("_hideOrDisplay"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "setHidden:", !_isAnimating && !objj_msgSend(self, "isDisplayedWhenStopped"));
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPProgressIndicator").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "drawBar");
}
}), new objj_method(sel_getUid("drawBar"), function(self, _cmd)
{ with(self)
{
    if (_style == CPProgressIndicatorSpinningStyle)
        return;
    if (!_barView)
    {
        _barView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 0.0, 16.0));
        objj_msgSend(self, "addSubview:", _barView);
    }
    objj_msgSend(_barView, "setBackgroundColor:", _CPControlThreePartImagePattern(
        NO,
        CPProgressIndicatorStyleSizes,
        CPProgressIndicatorClassName,
        "Bar",
        CPProgressIndicatorStyleIdentifiers[_style],
        _CPControlIdentifierForControlSize(_controlSize)));
    var width = CGRectGetWidth(objj_msgSend(self, "bounds")),
        barWidth = width * ((_doubleValue - _minValue) / (_maxValue - _minValue));
    if (barWidth > 0.0 && barWidth < 4.0)
        barWidth = 4.0;
    objj_msgSend(_barView, "setFrameSize:", CGSizeMake(barWidth, 16.0));
}
}), new objj_method(sel_getUid("updateBackgroundColor"), function(self, _cmd)
{ with(self)
{
    if (YES)
    {
        if (_style == CPProgressIndicatorSpinningStyle)
        {
            objj_msgSend(_barView, "removeFromSuperview");
            _barView = nil;
            objj_msgSend(self, "setBackgroundColor:", CPProgressIndicatorSpinningStyleColors[_controlSize]);
        }
        else
        {
            objj_msgSend(self, "setBackgroundColor:", _CPControlThreePartImagePattern(
                NO,
                CPProgressIndicatorStyleSizes,
                CPProgressIndicatorClassName,
                "BezelBorder",
                CPProgressIndicatorStyleIdentifiers[_style],
                _CPControlIdentifierForControlSize(_controlSize)));
            objj_msgSend(self, "drawBar");
        }
    }
    else
        objj_msgSend(self, "setBackgroundColor:", nil);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPProgressIndicator, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    CPProgressIndicatorSpinningStyleColors = [];
    CPProgressIndicatorSpinningStyleColors[CPMiniControlSize] = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", 
        objj_msgSend(bundle, "pathForResource:", "CPProgressIndicator/CPProgressIndicatorSpinningStyleRegular.gif"), CGSizeMake(64.0, 64.0)));
    CPProgressIndicatorSpinningStyleColors[CPSmallControlSize] = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", 
        objj_msgSend(bundle, "pathForResource:", "CPProgressIndicator/CPProgressIndicatorSpinningStyleRegular.gif"), CGSizeMake(64.0, 64.0)));
    CPProgressIndicatorSpinningStyleColors[CPRegularControlSize] = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", 
        objj_msgSend(bundle, "pathForResource:", "CPProgressIndicator/CPProgressIndicatorSpinningStyleRegular.gif"), CGSizeMake(64.0, 64.0)));
    CPProgressIndicatorBezelBorderViewPool = [];
    var start = CPProgressIndicatorBarStyle,
        end = CPProgressIndicatorHUDBarStyle;
    for (; start <= end; ++start)
    {
        CPProgressIndicatorBezelBorderViewPool[start] = [];
        CPProgressIndicatorBezelBorderViewPool[start][CPMiniControlSize] = [];
        CPProgressIndicatorBezelBorderViewPool[start][CPSmallControlSize] = [];
        CPProgressIndicatorBezelBorderViewPool[start][CPRegularControlSize] = [];
    }
    CPProgressIndicatorClassName = objj_msgSend(self, "className");
    CPProgressIndicatorStyleIdentifiers = [];
    CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorBarStyle] = "Bar";
    CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorSpinningStyle] = "Spinny";
    CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorHUDBarStyle] = "HUDBar";
    var regularIdentifier = _CPControlIdentifierForControlSize(CPRegularControlSize),
        smallIdentifier = _CPControlIdentifierForControlSize(CPSmallControlSize),
        miniIdentifier = _CPControlIdentifierForControlSize(CPMiniControlSize);
    CPProgressIndicatorStyleSizes = [];
    var prefixes = [
        CPProgressIndicatorClassName + "BezelBorder" + CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorBarStyle],
        CPProgressIndicatorClassName + "Bar" + CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorBarStyle],
        CPProgressIndicatorClassName + "BezelBorder" + CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorHUDBarStyle],
        CPProgressIndicatorClassName + "Bar" + CPProgressIndicatorStyleIdentifiers[CPProgressIndicatorHUDBarStyle]
    ];
    for (var i = 0, count = prefixes.length; i<count; i++)
    {
        var prefix = prefixes[i];
        CPProgressIndicatorStyleSizes[prefix + regularIdentifier] = [{ width:3.0, height:16.0 }, { width:1.0, height:16.0 }, { width:3.0, height:16.0 }];
        CPProgressIndicatorStyleSizes[prefix + smallIdentifier] = [{ width:3.0, height:16.0 }, { width:1.0, height:16.0 }, { width:3.0, height:16.0 }];
        CPProgressIndicatorStyleSizes[prefix + miniIdentifier] = [{ width:3.0, height:16.0 }, { width:1.0, height:16.0 }, { width:3.0, height:16.0 }];
    }
}
})]);
}

p;9;CPRadio.jt;6832;@STATIC;1.0;I;21;Foundation/CPObject.jI;18;Foundation/CPSet.ji;10;CPButton.jt;6749;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPSet.j", false);
objj_executeFile("CPButton.j", true);
{var the_class = objj_allocateClassPair(CPButton, "CPRadio"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_radioGroup")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:radioGroup:"), function(self, _cmd, aFrame, aRadioGroup)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPRadio").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        objj_msgSend(self, "setRadioGroup:", aRadioGroup);
        objj_msgSend(self, "setHighlightsBy:", CPContentsCellMask);
        objj_msgSend(self, "setShowsStateBy:", CPContentsCellMask);
        objj_msgSend(self, "setImagePosition:", CPImageLeft);
        objj_msgSend(self, "setAlignment:", CPLeftTextAlignment);
        objj_msgSend(self, "setBordered:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    return objj_msgSend(self, "initWithFrame:radioGroup:", aFrame, objj_msgSend(CPRadioGroup, "new"));
}
}), new objj_method(sel_getUid("nextState"), function(self, _cmd)
{ with(self)
{
    return CPOnState;
}
}), new objj_method(sel_getUid("setRadioGroup:"), function(self, _cmd, aRadioGroup)
{ with(self)
{
    if (_radioGroup === aRadioGroup)
        return;
    objj_msgSend(_radioGroup, "_removeRadio:", self);
    _radioGroup = aRadioGroup;
    objj_msgSend(_radioGroup, "_addRadio:", self);
}
}), new objj_method(sel_getUid("radioGroup"), function(self, _cmd)
{ with(self)
{
    return _radioGroup;
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPRadio").super_class }, "setObjectValue:", aValue);
    if (objj_msgSend(self, "state") === CPOnState)
        objj_msgSend(_radioGroup, "_setSelectedRadio:", self);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("radioWithTitle:theme:"), function(self, _cmd, aTitle, aTheme)
{ with(self)
{
    return objj_msgSend(self, "buttonWithTitle:theme:", aTitle, aTheme);
}
}), new objj_method(sel_getUid("radioWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    return objj_msgSend(self, "buttonWithTitle:", aTitle);
}
}), new objj_method(sel_getUid("standardButtonWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    var button = objj_msgSend(objj_msgSend(CPRadio, "alloc"), "init");
    objj_msgSend(button, "setTitle:", aTitle);
    return button;
}
}), new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "radio";
}
})]);
}
var CPRadioRadioGroupKey = "CPRadioRadioGroupKey";
{
var the_class = objj_getClass("CPRadio")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPRadio\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPRadio").super_class }, "initWithCoder:", aCoder);
    if (self)
        _radioGroup = objj_msgSend(aCoder, "decodeObjectForKey:", CPRadioRadioGroupKey);
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPRadio").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _radioGroup, CPRadioRadioGroupKey);
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "CPRadioGroup"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_radios"), new objj_ivar("_selectedRadio"), new objj_ivar("_target"), new objj_ivar("_action")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("target"), function(self, _cmd)
{ with(self)
{
return _target;
}
}),
new objj_method(sel_getUid("setTarget:"), function(self, _cmd, newValue)
{ with(self)
{
_target = newValue;
}
}),
new objj_method(sel_getUid("action"), function(self, _cmd)
{ with(self)
{
return _action;
}
}),
new objj_method(sel_getUid("setAction:"), function(self, _cmd, newValue)
{ with(self)
{
_action = newValue;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPRadioGroup").super_class }, "init");
    if (self)
    {
        _radios = objj_msgSend(CPSet, "set");
        _selectedRadio = nil;
    }
    return self;
}
}), new objj_method(sel_getUid("_addRadio:"), function(self, _cmd, aRadio)
{ with(self)
{
    objj_msgSend(_radios, "addObject:", aRadio);
    if (objj_msgSend(aRadio, "state") === CPOnState)
        objj_msgSend(self, "_setSelectedRadio:", aRadio);
}
}), new objj_method(sel_getUid("_removeRadio:"), function(self, _cmd, aRadio)
{ with(self)
{
    if (_selectedRadio === aRadio)
        _selectedRadio = nil;
    objj_msgSend(_radios, "removeObject:", aRadio);
}
}), new objj_method(sel_getUid("_setSelectedRadio:"), function(self, _cmd, aRadio)
{ with(self)
{
    if (_selectedRadio === aRadio)
        return;
    objj_msgSend(_selectedRadio, "setState:", CPOffState);
    _selectedRadio = aRadio;
    objj_msgSend(CPApp, "sendAction:to:from:", _action, _target, self);
}
}), new objj_method(sel_getUid("selectedRadio"), function(self, _cmd)
{ with(self)
{
    return _selectedRadio;
}
}), new objj_method(sel_getUid("radios"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_radios, "allObjects");
}
})]);
}
var CPRadioGroupRadiosKey = "CPRadioGroupRadiosKey",
    CPRadioGroupSelectedRadioKey = "CPRadioGroupSelectedRadioKey";
{
var the_class = objj_getClass("CPRadioGroup")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPRadioGroup\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPRadioGroup").super_class }, "init");
    if (self)
    {
        _radios = objj_msgSend(aCoder, "decodeObjectForKey:", CPRadioGroupRadiosKey);
        _selectedRadio = objj_msgSend(aCoder, "decodeObjectForKey:", CPRadioGroupSelectedRadioKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _radios, CPRadioGroupRadiosKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _selectedRadio, CPRadioGroupSelectedRadioKey);
}
})]);
}

p;13;CPResponder.jt;7467;@STATIC;1.0;I;21;Foundation/CPObject.jt;7422;objj_executeFile("Foundation/CPObject.j", false);
CPDeleteKeyCode = 8;
CPTabKeyCode = 9;
CPReturnKeyCode = 13;
CPEscapeKeyCode = 27;
CPSpaceKeyCode = 32;
CPLeftArrowKeyCode = 37;
CPUpArrowKeyCode = 38;
CPRightArrowKeyCode = 39;
CPDownArrowKeyCode = 40;
{var the_class = objj_allocateClassPair(CPObject, "CPResponder"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menu"), new objj_ivar("_nextResponder")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("acceptsFirstResponder"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("becomeFirstResponder"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("resignFirstResponder"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("setNextResponder:"), function(self, _cmd, aResponder)
{ with(self)
{
    _nextResponder = aResponder;
}
}), new objj_method(sel_getUid("nextResponder"), function(self, _cmd)
{ with(self)
{
    return _nextResponder;
}
}), new objj_method(sel_getUid("interpretKeyEvents:"), function(self, _cmd, events)
{ with(self)
{
    var index = 0,
        count = objj_msgSend(events, "count");
    for (; index < count; ++index)
    {
        var event = events[index];
        switch(objj_msgSend(event, "keyCode"))
        {
            case CPLeftArrowKeyCode: objj_msgSend(self, "doCommandBySelector:", sel_getUid("moveLeft:"));
                                        break;
            case CPRightArrowKeyCode: objj_msgSend(self, "doCommandBySelector:", sel_getUid("moveRight:"));
                                        break;
            case CPUpArrowKeyCode: objj_msgSend(self, "doCommandBySelector:", sel_getUid("moveUp:"));
                                        break;
            case CPDownArrowKeyCode: objj_msgSend(self, "doCommandBySelector:", sel_getUid("moveDown:"));
                                        break;
            case CPDeleteKeyCode: objj_msgSend(self, "doCommandBySelector:", sel_getUid("deleteBackward:"));
                                        break;
            case CPReturnKeyCode:
            case 3: objj_msgSend(self, "doCommandBySelector:", sel_getUid("insertLineBreak:"));
                                        break;
            case CPEscapeKeyCode: objj_msgSend(self, "doCommandBySelector:", sel_getUid("cancel:"));
                                        break;
            case CPTabKeyCode: var shift = objj_msgSend(event, "modifierFlags") & CPShiftKeyMask;
                                        if (!shift)
                                            objj_msgSend(self, "doCommandBySelector:", sel_getUid("insertTab:"));
                                        else
                                            objj_msgSend(self, "doCommandBySelector:", sel_getUid("insertBackTab:"));
                                        break;
            default: objj_msgSend(self, "insertText:", objj_msgSend(event, "characters"));
        }
    }
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("mouseMoved:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("mouseEntered:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("mouseExited:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("scrollWheel:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("keyDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("keyUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(_nextResponder, "performSelector:withObject:", _cmd, anEvent);
}
}), new objj_method(sel_getUid("performKeyEquivalent:"), function(self, _cmd, anEvent)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("insertLineBreak:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "insertNewline:", aSender);
}
}), new objj_method(sel_getUid("insertNewline:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "nextResponder"), "insertNewline:", aSender);
}
}), new objj_method(sel_getUid("cancel:"), function(self, _cmd, sender)
{ with(self)
{
}
}), new objj_method(sel_getUid("insertTab:"), function(self, _cmd, sender)
{ with(self)
{
}
}), new objj_method(sel_getUid("insertBackTab:"), function(self, _cmd, sender)
{ with(self)
{
}
}), new objj_method(sel_getUid("insertText:"), function(self, _cmd, aString)
{ with(self)
{
}
}), new objj_method(sel_getUid("doCommandBySelector:"), function(self, _cmd, aSelector)
{ with(self)
{
    if (objj_msgSend(self, "respondsToSelector:", aSelector))
        objj_msgSend(self, "performSelector:", aSelector);
    else
        objj_msgSend(_nextResponder, "doCommandBySelector:", aSelector);
}
}), new objj_method(sel_getUid("tryToPerform:with:"), function(self, _cmd, aSelector, anObject)
{ with(self)
{
    if(objj_msgSend(self, "respondsToSelector:", aSelector))
    {
        objj_msgSend(self, "performSelector:withObject:", aSelector, anObject);
        return YES;
    }
    return objj_msgSend(_nextResponder, "tryToPerform:with:", aSelector, anObject);
}
}), new objj_method(sel_getUid("setMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    _menu = aMenu;
}
}), new objj_method(sel_getUid("menu"), function(self, _cmd)
{ with(self)
{
    return _menu;
}
}), new objj_method(sel_getUid("undoManager"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_nextResponder, "performSelector:", _cmd);
}
}), new objj_method(sel_getUid("noResponderFor:"), function(self, _cmd, anEventSelector)
{ with(self)
{
}
})]);
}
var CPResponderNextResponderKey = "CPResponderNextResponderKey";
{
var the_class = objj_getClass("CPResponder")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPResponder\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPResponder").super_class }, "init");
    if (self)
        _nextResponder = objj_msgSend(aCoder, "decodeObjectForKey:", CPResponderNextResponderKey);
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (_nextResponder !== nil)
        objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _nextResponder, CPResponderNextResponderKey);
}
})]);
}

p;13;CPSavePanel.jt;3369;@STATIC;1.0;I;16;AppKit/CPPanel.jt;3329;


objj_executeFile("AppKit/CPPanel.j", false);


{var the_class = objj_allocateClassPair(CPPanel, "CPSavePanel"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_URL"), new objj_ivar("_isExtensionHidden"), new objj_ivar("_canSelectHiddenExtension"), new objj_ivar("_allowsOtherFileTypes"), new objj_ivar("_canCreateDirectories"), new objj_ivar("_allowedFileTypes")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isExtensionHidden"), function(self, _cmd)
{ with(self)
{
return _isExtensionHidden;
}
}),
new objj_method(sel_getUid("setExtensionHidden:"), function(self, _cmd, newValue)
{ with(self)
{
_isExtensionHidden = newValue;
}
}),
new objj_method(sel_getUid("canSelectHiddenExtension"), function(self, _cmd)
{ with(self)
{
return _canSelectHiddenExtension;
}
}),
new objj_method(sel_getUid("setCanSelectHiddenExtension:"), function(self, _cmd, newValue)
{ with(self)
{
_canSelectHiddenExtension = newValue;
}
}),
new objj_method(sel_getUid("allowsOtherFileTypes"), function(self, _cmd)
{ with(self)
{
return _allowsOtherFileTypes;
}
}),
new objj_method(sel_getUid("setAllowsOtherFileTypes:"), function(self, _cmd, newValue)
{ with(self)
{
_allowsOtherFileTypes = newValue;
}
}),
new objj_method(sel_getUid("canCreateDirectories"), function(self, _cmd)
{ with(self)
{
return _canCreateDirectories;
}
}),
new objj_method(sel_getUid("setCanCreateDirectories:"), function(self, _cmd, newValue)
{ with(self)
{
_canCreateDirectories = newValue;
}
}),
new objj_method(sel_getUid("allowedFileTypes"), function(self, _cmd)
{ with(self)
{
return _allowedFileTypes;
}
}),
new objj_method(sel_getUid("setAllowedFileTypes:"), function(self, _cmd, newValue)
{ with(self)
{
_allowedFileTypes = newValue;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSavePanel").super_class }, "init"))
    {
        _canCreateDirectories = YES;
    }

    return self;
}
}), new objj_method(sel_getUid("runModal"), function(self, _cmd)
{ with(self)
{

    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);

    if (typeof window["cpSavePanel"] === "function")
    {
        var resultObject = window.cpSavePanel({
                isExtensionHidden: _isExtensionHidden,
                canSelectHiddenExtension: _canSelectHiddenExtension,
                allowsOtherFileTypes: _allowsOtherFileTypes,
                canCreateDirectories: _canCreateDirectories,
                allowedFileTypes: _allowedFileTypes
            }),
            result = resultObject.button;

        _URL = result ? objj_msgSend(CPURL, "URLWithString:", resultObject.URL) : nil;
    }
    else
    {

        var documentName = window.prompt("Document Name:"),
            result = documentName !== null;

        _URL = result ? objj_msgSend(objj_msgSend(self, "class"), "proposedFileURLWithDocumentName:", documentName) : nil;
    }

    return result;
}
}), new objj_method(sel_getUid("URL"), function(self, _cmd)
{ with(self)
{
    return _URL;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("savePanel"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPSavePanel, "alloc"), "init");
}
})]);
}

p;10;CPScreen.jt;502;@STATIC;1.0;I;21;Foundation/CPObject.jt;458;


objj_executeFile("Foundation/CPObject.j", false);




{var the_class = objj_allocateClassPair(CPObject, "CPScreen"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("visibleFrame"), function(self, _cmd)
{ with(self)
{
    return { origin: { x:window.screen.availLeft, y:window.screen.availTop }, size: { width:window.screen.availWidth, height:window.screen.availHeight } };
}
})]);
}

p;12;CPScroller.jt;22694;@STATIC;1.0;i;11;CPControl.jt;22658;objj_executeFile("CPControl.j", true);
CPScrollerNoPart = 0;
CPScrollerDecrementPage = 1;
CPScrollerKnob = 2;
CPScrollerIncrementPage = 3;
CPScrollerDecrementLine = 4;
CPScrollerIncrementLine = 5;
CPScrollerKnobSlot = 6;
CPScrollerIncrementArrow = 0;
CPScrollerDecrementArrow = 1;
CPNoScrollerParts = 0;
CPOnlyScrollerArrows = 1;
CPAllScrollerParts = 2;
var PARTS_ARRANGEMENT = [CPScrollerKnobSlot, CPScrollerDecrementLine, CPScrollerIncrementLine, CPScrollerKnob],
    NAMES_FOR_PARTS = {},
    PARTS_FOR_NAMES = {};
NAMES_FOR_PARTS[CPScrollerDecrementLine] = "decrement-line";
NAMES_FOR_PARTS[CPScrollerIncrementLine] = "increment-line";
NAMES_FOR_PARTS[CPScrollerKnobSlot] = "knob-slot";
NAMES_FOR_PARTS[CPScrollerKnob] = "knob";
{var the_class = objj_allocateClassPair(CPControl, "CPScroller"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_controlSize"), new objj_ivar("_usableParts"), new objj_ivar("_partRects"), new objj_ivar("_isVertical"), new objj_ivar("_knobProportion"), new objj_ivar("_hitPart"), new objj_ivar("_trackingPart"), new objj_ivar("_trackingFloatValue"), new objj_ivar("_trackingStartPoint")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isVertical"), function(self, _cmd)
{ with(self)
{
return _isVertical;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScroller").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _controlSize = CPRegularControlSize;
        _partRects = [];
        objj_msgSend(self, "setFloatValue:", 0.0);
        objj_msgSend(self, "setKnobProportion:", 1.0);
        _hitPart = CPScrollerNoPart;
        objj_msgSend(self, "_calculateIsVertical");
    }
    return self;
}
}), new objj_method(sel_getUid("setControlSize:"), function(self, _cmd, aControlSize)
{ with(self)
{
    if (_controlSize == aControlSize)
        return;
    _controlSize = aControlSize;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("controlSize"), function(self, _cmd)
{ with(self)
{
    return _controlSize;
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScroller").super_class }, "setObjectValue:", MIN(1.0, MAX(0.0, +aValue)));
}
}), new objj_method(sel_getUid("setKnobProportion:"), function(self, _cmd, aProportion)
{ with(self)
{
    _knobProportion = MIN(1.0, MAX(0.0001, aProportion));
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("knobProportion"), function(self, _cmd)
{ with(self)
{
    return _knobProportion;
}
}), new objj_method(sel_getUid("currentValueForThemeAttribute:"), function(self, _cmd, anAttributeName)
{ with(self)
{
    var themeState = _themeState;
    if (NAMES_FOR_PARTS[_hitPart] + "-color" !== anAttributeName)
        themeState &= ~CPThemeStateHighlighted;
    return objj_msgSend(self, "valueForThemeAttribute:inState:", anAttributeName, themeState);
}
}), new objj_method(sel_getUid("rectForPart:"), function(self, _cmd, aPart)
{ with(self)
{
    if (aPart == CPScrollerNoPart)
        return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    return _partRects[aPart];
}
}), new objj_method(sel_getUid("testPart:"), function(self, _cmd, aPoint)
{ with(self)
{
    aPoint = objj_msgSend(self, "convertPoint:fromView:", aPoint, nil);
    if (CGRectContainsPoint(objj_msgSend(self, "rectForPart:", CPScrollerKnob), aPoint))
        return CPScrollerKnob;
    if (CGRectContainsPoint(objj_msgSend(self, "rectForPart:", CPScrollerDecrementPage), aPoint))
        return CPScrollerDecrementPage;
    if (CGRectContainsPoint(objj_msgSend(self, "rectForPart:", CPScrollerIncrementPage), aPoint))
        return CPScrollerIncrementPage;
    if (CGRectContainsPoint(objj_msgSend(self, "rectForPart:", CPScrollerDecrementLine), aPoint))
        return CPScrollerDecrementLine;
    if (CGRectContainsPoint(objj_msgSend(self, "rectForPart:", CPScrollerIncrementLine), aPoint))
        return CPScrollerIncrementLine;
    if (CGRectContainsPoint(objj_msgSend(self, "rectForPart:", CPScrollerKnobSlot), aPoint))
        return CPScrollerKnobSlot;
    return CPScrollerNoPart;
}
}), new objj_method(sel_getUid("checkSpaceForParts"), function(self, _cmd)
{ with(self)
{
 var bounds = objj_msgSend(self, "bounds");
    if (_knobProportion === 1.0)
    {
        _usableParts = CPNoScrollerParts;
        _partRects[CPScrollerDecrementPage] = CGRectMakeZero();
        _partRects[CPScrollerKnob] = CGRectMakeZero();
        _partRects[CPScrollerIncrementPage] = CGRectMakeZero();
        _partRects[CPScrollerDecrementLine] = CGRectMakeZero();
        _partRects[CPScrollerIncrementLine] = CGRectMakeZero();
        _partRects[CPScrollerKnobSlot] = CGRectMakeCopy(bounds);
        return;
    }
    _usableParts = CPAllScrollerParts;
    var knobInset = objj_msgSend(self, "currentValueForThemeAttribute:", "knob-inset"),
        trackInset = objj_msgSend(self, "currentValueForThemeAttribute:", "track-inset"),
        width = (bounds.size.width),
        height = (bounds.size.height);
    if (objj_msgSend(self, "isVertical"))
    {
        var decrementLineSize = objj_msgSend(self, "currentValueForThemeAttribute:", "decrement-line-size"),
            incrementLineSize = objj_msgSend(self, "currentValueForThemeAttribute:", "increment-line-size"),
            effectiveDecrementLineHeight = decrementLineSize.height + trackInset.top,
            effectiveIncrementLineHeight = incrementLineSize.height + trackInset.bottom,
            slotHeight = height - effectiveDecrementLineHeight - effectiveIncrementLineHeight,
            minimumKnobLength = objj_msgSend(self, "currentValueForThemeAttribute:", "minimum-knob-length"),
            knobWidth = width - knobInset.left - knobInset.right,
            knobHeight = MAX(minimumKnobLength, (slotHeight * _knobProportion)),
            knobLocation = effectiveDecrementLineHeight + (slotHeight - knobHeight) * objj_msgSend(self, "floatValue");
        _partRects[CPScrollerDecrementPage] = { origin: { x:0.0, y:effectiveDecrementLineHeight }, size: { width:width, height:knobLocation - effectiveDecrementLineHeight } };
        _partRects[CPScrollerKnob] = { origin: { x:knobInset.left, y:knobLocation }, size: { width:knobWidth, height:knobHeight } };
        _partRects[CPScrollerIncrementPage] = { origin: { x:0.0, y:knobLocation + knobHeight }, size: { width:width, height:height - (knobLocation + knobHeight) - effectiveIncrementLineHeight } };
        _partRects[CPScrollerKnobSlot] = { origin: { x:trackInset.left, y:effectiveDecrementLineHeight }, size: { width:width - trackInset.left - trackInset.right, height:slotHeight } };
        _partRects[CPScrollerDecrementLine] = { origin: { x:0.0, y:0.0 }, size: { width:decrementLineSize.width, height:decrementLineSize.height } };
        _partRects[CPScrollerIncrementLine] = { origin: { x:0.0, y:height - incrementLineSize.height }, size: { width:incrementLineSize.width, height:incrementLineSize.height } };
        if(height < knobHeight + decrementLineSize.height + incrementLineSize.height + trackInset.top + trackInset.bottom)
            _partRects[CPScrollerKnob] = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
        if(height < decrementLineSize.height + incrementLineSize.height - 2)
        {
            _partRects[CPScrollerIncrementLine] = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
            _partRects[CPScrollerDecrementLine] = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
            _partRects[CPScrollerKnobSlot] = { origin: { x:trackInset.left, y:0 }, size: { width:width - trackInset.left - trackInset.right, height:height } };
        }
}
    else
    {
        var decrementLineSize = objj_msgSend(self, "currentValueForThemeAttribute:", "decrement-line-size"),
            incrementLineSize = objj_msgSend(self, "currentValueForThemeAttribute:", "increment-line-size"),
            effectiveDecrementLineWidth = decrementLineSize.width + trackInset.left,
            effectiveIncrementLineWidth = incrementLineSize.width + trackInset.right;
            slotWidth = width - effectiveDecrementLineWidth - effectiveIncrementLineWidth,
            minimumKnobLength = objj_msgSend(self, "currentValueForThemeAttribute:", "minimum-knob-length"),
            knobWidth = MAX(minimumKnobLength, (slotWidth * _knobProportion)),
            knobHeight = height - knobInset.top - knobInset.bottom,
            knobLocation = effectiveDecrementLineWidth + (slotWidth - knobWidth) * objj_msgSend(self, "floatValue");
        _partRects[CPScrollerDecrementPage] = { origin: { x:effectiveDecrementLineWidth, y:0.0 }, size: { width:knobLocation - effectiveDecrementLineWidth, height:height } };
        _partRects[CPScrollerKnob] = { origin: { x:knobLocation, y:knobInset.top }, size: { width:knobWidth, height:knobHeight } };
        _partRects[CPScrollerIncrementPage] = { origin: { x:knobLocation + knobWidth, y:0.0 }, size: { width:width - (knobLocation + knobWidth) - effectiveIncrementLineWidth, height:height } };
        _partRects[CPScrollerKnobSlot] = { origin: { x:effectiveDecrementLineWidth, y:trackInset.top }, size: { width:slotWidth, height:height - trackInset.top - trackInset.bottom } };
        _partRects[CPScrollerDecrementLine] = { origin: { x:0.0, y:0.0 }, size: { width:decrementLineSize.width, height:decrementLineSize.height } };
        _partRects[CPScrollerIncrementLine] = { origin: { x:width - incrementLineSize.width, y:0.0 }, size: { width:incrementLineSize.width, height:incrementLineSize.height } };
        if(width < knobWidth + decrementLineSize.width + incrementLineSize.width + trackInset.left + trackInset.right)
            _partRects[CPScrollerKnob] = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
        if(width < decrementLineSize.width + incrementLineSize.width - 2)
        {
            _partRects[CPScrollerIncrementLine] = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
            _partRects[CPScrollerDecrementLine] = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
            _partRects[CPScrollerKnobSlot] = { origin: { x:0.0, y:0.0 }, size: { width:width, height:slotHeight } };
        }
    }
}
}), new objj_method(sel_getUid("usableParts"), function(self, _cmd)
{ with(self)
{
    return _usableParts;
}
}), new objj_method(sel_getUid("drawArrow:highlight:"), function(self, _cmd, anArrow, shouldHighlight)
{ with(self)
{
}
}), new objj_method(sel_getUid("drawKnob"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("drawKnobSlot"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("createViewForPart:"), function(self, _cmd, aPart)
{ with(self)
{
    var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
    objj_msgSend(view, "setHitTests:", NO);
    return view;
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    return _partRects[aName];
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
    objj_msgSend(view, "setHitTests:", NO);
    return view;
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "checkSpaceForParts");
    var index = 0,
        count = PARTS_ARRANGEMENT.length;
    for (; index < count; ++index)
    {
        var part = PARTS_ARRANGEMENT[index];
        if (index === 0)
            view = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", part, CPWindowBelow, PARTS_ARRANGEMENT[index + 1]);
        else
            view = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", part, CPWindowAbove, PARTS_ARRANGEMENT[index - 1]);
        if (view)
            objj_msgSend(view, "setBackgroundColor:", objj_msgSend(self, "currentValueForThemeAttribute:", NAMES_FOR_PARTS[part] + "-color"));
    }
}
}), new objj_method(sel_getUid("drawParts"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "drawKnobSlot");
    objj_msgSend(self, "drawKnob");
    objj_msgSend(self, "drawArrow:highlight:", CPScrollerDecrementArrow, NO);
    objj_msgSend(self, "drawArrow:highlight:", CPScrollerIncrementArrow, NO);
}
}), new objj_method(sel_getUid("hitPart"), function(self, _cmd)
{ with(self)
{
    return _hitPart;
}
}), new objj_method(sel_getUid("trackKnob:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type");
    if (type === CPLeftMouseUp)
    {
        _hitPart = CPScrollerNoPart;
        return;
    }
    if (type === CPLeftMouseDown)
    {
        _trackingFloatValue = objj_msgSend(self, "floatValue");
        _trackingStartPoint = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
    }
    else if (type === CPLeftMouseDragged)
    {
        var knobRect = objj_msgSend(self, "rectForPart:", CPScrollerKnob),
            knobSlotRect = objj_msgSend(self, "rectForPart:", CPScrollerKnobSlot),
            remainder = !objj_msgSend(self, "isVertical") ? ((knobSlotRect.size.width) - (knobRect.size.width)) : ((knobSlotRect.size.height) - (knobRect.size.height));
        if (remainder <= 0)
            objj_msgSend(self, "setFloatValue:", 0.0);
        else
        {
            var location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
                delta = !objj_msgSend(self, "isVertical") ? location.x - _trackingStartPoint.x : location.y - _trackingStartPoint.y;
            objj_msgSend(self, "setFloatValue:", _trackingFloatValue + delta / remainder);
        }
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackKnob:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
    objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
}
}), new objj_method(sel_getUid("trackScrollButtons:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type");
    if (type === CPLeftMouseUp)
    {
        objj_msgSend(self, "highlight:", NO);
        objj_msgSend(CPEvent, "stopPeriodicEvents");
        _hitPart = CPScrollerNoPart;
        return;
    }
    if (type === CPLeftMouseDown)
    {
        _trackingPart = objj_msgSend(self, "hitPart");
        _trackingStartPoint = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
        if (objj_msgSend(anEvent, "modifierFlags") & CPAlternateKeyMask)
        {
            if (_trackingPart == CPScrollerDecrementLine)
                _hitPart = CPScrollerDecrementPage;
            else if (_trackingPart == CPScrollerIncrementLine)
                _hitPart = CPScrollerIncrementPage;
            else if (_trackingPart == CPScrollerDecrementPage || _trackingPart == CPScrollerIncrementPage)
            {
                var knobRect = objj_msgSend(self, "rectForPart:", CPScrollerKnob),
                    knobWidth = !objj_msgSend(self, "isVertical") ? (knobRect.size.width) : (knobRect.size.height),
                    knobSlotRect = objj_msgSend(self, "rectForPart:", CPScrollerKnobSlot),
                    remainder = (!objj_msgSend(self, "isVertical") ? (knobSlotRect.size.width) : (knobSlotRect.size.height)) - knobWidth;
                objj_msgSend(self, "setFloatValue:", ((!objj_msgSend(self, "isVertical") ? _trackingStartPoint.x - (knobSlotRect.origin.x) : _trackingStartPoint.y - (knobSlotRect.origin.y)) - knobWidth / 2.0) / remainder);
                _hitPart = CPScrollerKnob;
                objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
                return objj_msgSend(self, "trackKnob:", anEvent);
            }
        }
        objj_msgSend(self, "highlight:", YES);
        objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
        objj_msgSend(CPEvent, "startPeriodicEventsAfterDelay:withPeriod:", 0.5, 0.04);
    }
    else if (type === CPLeftMouseDragged)
    {
        _trackingStartPoint = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
        if (_trackingPart == CPScrollerDecrementPage || _trackingPart == CPScrollerIncrementPage)
        {
            var hitPart = objj_msgSend(self, "testPart:", objj_msgSend(anEvent, "locationInWindow"));
            if (hitPart == CPScrollerDecrementPage || hitPart == CPScrollerIncrementPage)
            {
                _trackingPart = hitPart;
                _hitPart = hitPart;
            }
        }
        objj_msgSend(self, "highlight:", CGRectContainsPoint(objj_msgSend(self, "rectForPart:", _trackingPart), _trackingStartPoint));
    }
    else if (type == CPPeriodic && CGRectContainsPoint(objj_msgSend(self, "rectForPart:", _trackingPart), _trackingStartPoint))
        objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackScrollButtons:"), CPPeriodicMask | CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("_calculateIsVertical"), function(self, _cmd)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        width = (bounds.size.width),
        height = (bounds.size.height);
    _isVertical = width < height ? 1 : (width > height ? 0 : -1);
    if (_isVertical === 1)
        objj_msgSend(self, "setThemeState:", CPThemeStateVertical);
    else if (_isVertical === 0)
        objj_msgSend(self, "unsetThemeState:", CPThemeStateVertical);
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScroller").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "checkSpaceForParts");
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(self, "isEnabled"))
        return;
    _hitPart = objj_msgSend(self, "testPart:", objj_msgSend(anEvent, "locationInWindow"));
    switch (_hitPart)
    {
        case CPScrollerKnob: return objj_msgSend(self, "trackKnob:", anEvent);
        case CPScrollerDecrementLine:
        case CPScrollerIncrementLine:
        case CPScrollerDecrementPage:
        case CPScrollerIncrementPage: return objj_msgSend(self, "trackScrollButtons:", anEvent);
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "scroller";
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [ objj_msgSend(CPNull, "null"), objj_msgSend(CPNull, "null"), objj_msgSend(CPNull, "null"), objj_msgSend(CPNull, "null"),
                                                    { width:0.0, height:0.0 }, { width:0.0, height:0.0 }, { top:(0), right:(0), bottom:(0), left:(0) }, { top:(0), right:(0), bottom:(0), left:(0) }, { width:0.0, height:0.0 }], [ "knob-slot-color",
                                                    "decrement-line-color",
                                                    "increment-line-color",
                                                    "knob-color",
                                                    "decrement-line-size",
                                                    "increment-line-size",
                                                    "track-inset",
                                                    "knob-inset",
                                                    "minimum-knob-length"]);
}
}), new objj_method(sel_getUid("scrollerWidth"), function(self, _cmd)
{ with(self)
{
    return 15.0;
}
}), new objj_method(sel_getUid("scrollerWidthForControlSize:"), function(self, _cmd, aControlSize)
{ with(self)
{
    return 15.0;
}
})]);
}
var CPScrollerControlSizeKey = "CPScrollerControlSize",
    CPScrollerKnobProportionKey = "CPScrollerKnobProportion";
{
var the_class = objj_getClass("CPScroller")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPScroller\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScroller").super_class }, "initWithCoder:", aCoder))
    {
        _controlSize = CPRegularControlSize;
        if (objj_msgSend(aCoder, "containsValueForKey:", CPScrollerControlSizeKey))
            _controlSize = objj_msgSend(aCoder, "decodeIntForKey:", CPScrollerControlSizeKey);
        _knobProportion = 1.0;
        if (objj_msgSend(aCoder, "containsValueForKey:", CPScrollerKnobProportionKey))
            _knobProportion = objj_msgSend(aCoder, "decodeFloatForKey:", CPScrollerKnobProportionKey);
        _partRects = [];
        _hitPart = CPScrollerNoPart;
        objj_msgSend(self, "_calculateIsVertical");
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScroller").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeInt:forKey:", _controlSize, CPScrollerControlSizeKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _knobProportion, CPScrollerKnobProportionKey);
}
})]);
}
{
var the_class = objj_getClass("CPScroller")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPScroller\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("setFloatValue:knobProportion:"), function(self, _cmd, aValue, aProportion)
{ with(self)
{
    objj_msgSend(self, "setFloatValue:", aValue);
    objj_msgSend(self, "setKnobProportion:", aProportion);
}
})]);
}

p;14;CPScrollView.jt;24764;@STATIC;1.0;i;8;CPView.ji;12;CPClipView.ji;12;CPScroller.jt;24698;objj_executeFile("CPView.j", true);
objj_executeFile("CPClipView.j", true);
objj_executeFile("CPScroller.j", true);
{var the_class = objj_allocateClassPair(CPView, "CPScrollView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_contentView"), new objj_ivar("_headerClipView"), new objj_ivar("_cornerView"), new objj_ivar("_hasVerticalScroller"), new objj_ivar("_hasHorizontalScroller"), new objj_ivar("_autohidesScrollers"), new objj_ivar("_verticalScroller"), new objj_ivar("_horizontalScroller"), new objj_ivar("_recursionCount"), new objj_ivar("_verticalLineScroll"), new objj_ivar("_verticalPageScroll"), new objj_ivar("_horizontalLineScroll"), new objj_ivar("_horizontalPageScroll")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScrollView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _verticalLineScroll = 10.0;
        _verticalPageScroll = 10.0;
        _horizontalLineScroll = 10.0;
        _horizontalPageScroll = 10.0;
        _contentView = objj_msgSend(objj_msgSend(CPClipView, "alloc"), "initWithFrame:", objj_msgSend(self, "bounds"));
        objj_msgSend(self, "addSubview:", _contentView);
        _headerClipView = objj_msgSend(objj_msgSend(CPClipView, "alloc"), "init");
        objj_msgSend(self, "addSubview:", _headerClipView);
        objj_msgSend(self, "setHasVerticalScroller:", YES);
        objj_msgSend(self, "setHasHorizontalScroller:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("contentSize"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_contentView, "frame").size;
}
}), new objj_method(sel_getUid("documentView"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_contentView, "documentView");
}
}), new objj_method(sel_getUid("setContentView:"), function(self, _cmd, aContentView)
{ with(self)
{
    if (_contentView !== aContentView || !aContentView)
        return;
    var documentView = objj_msgSend(aContentView, "documentView");
    if (documentView)
        objj_msgSend(documentView, "removeFromSuperview");
    objj_msgSend(_contentView, "removeFromSuperview");
    _contentView = aContentView;
    objj_msgSend(_contentView, "setDocumentView:", documentView);
    objj_msgSend(self, "addSubview:", _contentView);
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("contentView"), function(self, _cmd)
{ with(self)
{
    return _contentView;
}
}), new objj_method(sel_getUid("setDocumentView:"), function(self, _cmd, aView)
{ with(self)
{
    objj_msgSend(_contentView, "setDocumentView:", aView);
    objj_msgSend(self, "_updateCornerAndHeaderView");
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("reflectScrolledClipView:"), function(self, _cmd, aClipView)
{ with(self)
{
    if(_contentView !== aClipView)
        return;
    if (_recursionCount > 5)
        return;
    ++_recursionCount;
    var documentView = objj_msgSend(self, "documentView");
    if (!documentView)
    {
        if (_autohidesScrollers)
        {
            objj_msgSend(_verticalScroller, "setHidden:", YES);
            objj_msgSend(_horizontalScroller, "setHidden:", YES);
        }
        else
        {
        }
        objj_msgSend(_contentView, "setFrame:", objj_msgSend(self, "bounds"));
        objj_msgSend(_headerClipView, "setFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
        --_recursionCount;
        return;
    }
    var documentFrame = objj_msgSend(documentView, "frame"),
        contentFrame = objj_msgSend(self, "bounds"),
        headerClipViewFrame = objj_msgSend(self, "_headerClipViewFrame"),
        headerClipViewHeight = (headerClipViewFrame.size.height);
    contentFrame.origin.y += headerClipViewHeight;
    contentFrame.size.height -= headerClipViewHeight;
    var difference = { width:(documentFrame.size.width) - (contentFrame.size.width), height:(documentFrame.size.height) - (contentFrame.size.height) },
        verticalScrollerWidth = (objj_msgSend(_verticalScroller, "frame").size.width),
        horizontalScrollerHeight = (objj_msgSend(_horizontalScroller, "frame").size.height),
        hasVerticalScroll = difference.height > 0.0,
        hasHorizontalScroll = difference.width > 0.0,
        shouldShowVerticalScroller = _hasVerticalScroller && (!_autohidesScrollers || hasVerticalScroll),
        shouldShowHorizontalScroller = _hasHorizontalScroller && (!_autohidesScrollers || hasHorizontalScroll);
    if (shouldShowVerticalScroller)
    {
        difference.width += verticalScrollerWidth;
        hasHorizontalScroll = difference.width > 0.0;
        shouldShowHorizontalScroller = _hasHorizontalScroller && (!_autohidesScrollers || hasHorizontalScroll);
    }
    if (shouldShowHorizontalScroller)
    {
        difference.height += horizontalScrollerHeight;
        hasVerticalScroll = difference.height > 0.0;
        shouldShowVerticalScroller = _hasVerticalScroller && (!_autohidesScrollers || hasVerticalScroll);
    }
    objj_msgSend(_verticalScroller, "setHidden:", !shouldShowVerticalScroller);
    objj_msgSend(_verticalScroller, "setEnabled:", hasVerticalScroll);
    objj_msgSend(_horizontalScroller, "setHidden:", !shouldShowHorizontalScroller);
    objj_msgSend(_horizontalScroller, "setEnabled:", hasHorizontalScroll);
    if (shouldShowVerticalScroller)
        contentFrame.size.width -= verticalScrollerWidth;
    if (shouldShowHorizontalScroller)
        contentFrame.size.height -= horizontalScrollerHeight;
    var scrollPoint = objj_msgSend(_contentView, "bounds").origin,
        wasShowingVerticalScroller = !objj_msgSend(_verticalScroller, "isHidden"),
        wasShowingHorizontalScroller = !objj_msgSend(_horizontalScroller, "isHidden");
    if (shouldShowVerticalScroller)
    {
        var verticalScrollerY = MAX((objj_msgSend(self, "_cornerViewFrame").size.height), headerClipViewHeight),
            verticalScrollerHeight = (objj_msgSend(self, "bounds").size.height) - verticalScrollerY;
        if (shouldShowHorizontalScroller)
            verticalScrollerHeight -= horizontalScrollerHeight;
        objj_msgSend(_verticalScroller, "setFloatValue:", (difference.height <= 0.0) ? 0.0 : scrollPoint.y / difference.height);
        objj_msgSend(_verticalScroller, "setKnobProportion:", (contentFrame.size.height) / (documentFrame.size.height));
        objj_msgSend(_verticalScroller, "setFrame:", { origin: { x:(contentFrame.origin.x + contentFrame.size.width), y:verticalScrollerY }, size: { width:verticalScrollerWidth, height:verticalScrollerHeight } });
    }
    else if (wasShowingVerticalScroller)
    {
        objj_msgSend(_verticalScroller, "setFloatValue:", 0.0);
        objj_msgSend(_verticalScroller, "setKnobProportion:", 1.0);
    }
    if (shouldShowHorizontalScroller)
    {
        objj_msgSend(_horizontalScroller, "setFloatValue:", (difference.width <= 0.0) ? 0.0 : scrollPoint.x / difference.width);
        objj_msgSend(_horizontalScroller, "setKnobProportion:", (contentFrame.size.width) / (documentFrame.size.width));
        objj_msgSend(_horizontalScroller, "setFrame:", { origin: { x:0.0, y:(contentFrame.origin.y + contentFrame.size.height) }, size: { width:(contentFrame.size.width), height:horizontalScrollerHeight } });
    }
    else if (wasShowingHorizontalScroller)
    {
        objj_msgSend(_horizontalScroller, "setFloatValue:", 0.0);
        objj_msgSend(_horizontalScroller, "setKnobProportion:", 1.0);
    }
    objj_msgSend(_contentView, "setFrame:", contentFrame);
    objj_msgSend(_headerClipView, "setFrame:", headerClipViewFrame);
    objj_msgSend(_cornerView, "setFrame:", objj_msgSend(self, "_cornerViewFrame"));
    --_recursionCount;
}
}), new objj_method(sel_getUid("setHorizontalScroller:"), function(self, _cmd, aScroller)
{ with(self)
{
    if (_horizontalScroller === aScroller)
        return;
    objj_msgSend(_horizontalScroller, "removeFromSuperview");
    objj_msgSend(_horizontalScroller, "setTarget:", nil);
    objj_msgSend(_horizontalScroller, "setAction:", nil);
    _horizontalScroller = aScroller;
    objj_msgSend(_horizontalScroller, "setTarget:", self);
    objj_msgSend(_horizontalScroller, "setAction:", sel_getUid("_horizontalScrollerDidScroll:"));
    objj_msgSend(self, "addSubview:", _horizontalScroller);
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("horizontalScroller"), function(self, _cmd)
{ with(self)
{
    return _horizontalScroller;
}
}), new objj_method(sel_getUid("setHasHorizontalScroller:"), function(self, _cmd, shouldHaveHorizontalScroller)
{ with(self)
{
    if (_hasHorizontalScroller === shouldHaveHorizontalScroller)
        return;
    _hasHorizontalScroller = shouldHaveHorizontalScroller;
    if (_hasHorizontalScroller && !_horizontalScroller)
    {
        objj_msgSend(self, "setHorizontalScroller:", objj_msgSend(objj_msgSend(CPScroller, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, MAX((objj_msgSend(self, "bounds").size.width), objj_msgSend(CPScroller, "scrollerWidth")+1), objj_msgSend(CPScroller, "scrollerWidth"))));
        objj_msgSend(objj_msgSend(self, "horizontalScroller"), "setFrameSize:", CGSizeMake((objj_msgSend(self, "bounds").size.width), objj_msgSend(CPScroller, "scrollerWidth")));
    }
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("hasHorizontalScroller"), function(self, _cmd)
{ with(self)
{
    return _hasHorizontalScroller;
}
}), new objj_method(sel_getUid("setVerticalScroller:"), function(self, _cmd, aScroller)
{ with(self)
{
    if (_verticalScroller === aScroller)
        return;
    objj_msgSend(_verticalScroller, "removeFromSuperview");
    objj_msgSend(_verticalScroller, "setTarget:", nil);
    objj_msgSend(_verticalScroller, "setAction:", nil);
    _verticalScroller = aScroller;
    objj_msgSend(_verticalScroller, "setTarget:", self);
    objj_msgSend(_verticalScroller, "setAction:", sel_getUid("_verticalScrollerDidScroll:"));
    objj_msgSend(self, "addSubview:", _verticalScroller);
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("verticalScroller"), function(self, _cmd)
{ with(self)
{
    return _verticalScroller;
}
}), new objj_method(sel_getUid("setHasVerticalScroller:"), function(self, _cmd, shouldHaveVerticalScroller)
{ with(self)
{
    if (_hasVerticalScroller === shouldHaveVerticalScroller)
        return;
    _hasVerticalScroller = shouldHaveVerticalScroller;
    if (_hasVerticalScroller && !_verticalScroller)
    {
        objj_msgSend(self, "setVerticalScroller:", objj_msgSend(objj_msgSend(CPScroller, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:objj_msgSend(CPScroller, "scrollerWidth"), height:MAX((objj_msgSend(self, "bounds").size.height), objj_msgSend(CPScroller, "scrollerWidth")+1) } }));
        objj_msgSend(objj_msgSend(self, "verticalScroller"), "setFrameSize:", CGSizeMake(objj_msgSend(CPScroller, "scrollerWidth"), (objj_msgSend(self, "bounds").size.height)));
    }
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("hasVerticalScroller"), function(self, _cmd)
{ with(self)
{
    return _hasVerticalScroller;
}
}), new objj_method(sel_getUid("setAutohidesScrollers:"), function(self, _cmd, autohidesScrollers)
{ with(self)
{
    if (_autohidesScrollers == autohidesScrollers)
        return;
    _autohidesScrollers = autohidesScrollers;
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("autohidesScrollers"), function(self, _cmd)
{ with(self)
{
    return _autohidesScrollers;
}
}), new objj_method(sel_getUid("_updateCornerAndHeaderView"), function(self, _cmd)
{ with(self)
{
    var documentView = objj_msgSend(self, "documentView"),
        currentHeaderView = objj_msgSend(self, "_headerView"),
        documentHeaderView = objj_msgSend(documentView, "respondsToSelector:", sel_getUid("headerView")) ? objj_msgSend(documentView, "headerView") : nil;
    if (currentHeaderView !== documentHeaderView)
    {
        objj_msgSend(currentHeaderView, "removeFromSuperview");
        objj_msgSend(_headerClipView, "setDocumentView:", documentHeaderView);
    }
    var documentCornerView = objj_msgSend(documentView, "respondsToSelector:", sel_getUid("cornerView")) ? objj_msgSend(documentView, "cornerView") : nil;
    if (_cornerView !== documentCornerView)
    {
        objj_msgSend(_cornerView, "removeFromSuperview");
        _cornerView = documentCornerView;
        if (_cornerView)
            objj_msgSend(self, "addSubview:", _cornerView);
    }
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("_headerView"), function(self, _cmd)
{ with(self)
{
    var headerClipViewSubviews = objj_msgSend(_headerClipView, "subviews");
    return objj_msgSend(headerClipViewSubviews, "count") ? headerClipViewSubviews[0] : nil;
}
}), new objj_method(sel_getUid("_cornerViewFrame"), function(self, _cmd)
{ with(self)
{
    if (!_cornerView)
        return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    var bounds = objj_msgSend(self, "bounds"),
        frame = objj_msgSend(_cornerView, "frame");
    frame.origin.x = (bounds.origin.x + bounds.size.width) - (frame.size.width);
    frame.origin.y = 0;
    return frame;
}
}), new objj_method(sel_getUid("_headerClipViewFrame"), function(self, _cmd)
{ with(self)
{
    var headerView = objj_msgSend(self, "_headerView");
    if (!headerView)
        return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    var frame = objj_msgSend(self, "bounds");
    frame.size.height = (objj_msgSend(headerView, "frame").size.height);
    frame.size.width -= (objj_msgSend(self, "_cornerViewFrame").size.width);
    return frame;
}
}), new objj_method(sel_getUid("_verticalScrollerDidScroll:"), function(self, _cmd, aScroller)
{ with(self)
{
   var value = objj_msgSend(aScroller, "floatValue"),
        documentFrame = objj_msgSend(objj_msgSend(_contentView, "documentView"), "frame");
        contentBounds = objj_msgSend(_contentView, "bounds");
    switch (objj_msgSend(_verticalScroller, "hitPart"))
    {
        case CPScrollerDecrementLine: contentBounds.origin.y -= _verticalLineScroll;
                                        break;
        case CPScrollerIncrementLine: contentBounds.origin.y += _verticalLineScroll;
                                        break;
        case CPScrollerDecrementPage: contentBounds.origin.y -= (contentBounds.size.height) - _verticalPageScroll;
                                        break;
        case CPScrollerIncrementPage: contentBounds.origin.y += (contentBounds.size.height) - _verticalPageScroll;
                                        break;
        case CPScrollerKnobSlot:
        case CPScrollerKnob:
        default: contentBounds.origin.y = ROUND(value * ((documentFrame.size.height) - (contentBounds.size.height)));
    }
    objj_msgSend(_contentView, "scrollToPoint:", contentBounds.origin);
}
}), new objj_method(sel_getUid("_horizontalScrollerDidScroll:"), function(self, _cmd, aScroller)
{ with(self)
{
   var value = objj_msgSend(aScroller, "floatValue"),
       documentFrame = objj_msgSend(objj_msgSend(self, "documentView"), "frame"),
       contentBounds = objj_msgSend(_contentView, "bounds");
    switch (objj_msgSend(_horizontalScroller, "hitPart"))
    {
        case CPScrollerDecrementLine: contentBounds.origin.x -= _horizontalLineScroll;
                                        break;
        case CPScrollerIncrementLine: contentBounds.origin.x += _horizontalLineScroll;
                                        break;
        case CPScrollerDecrementPage: contentBounds.origin.x -= (contentBounds.size.width) - _horizontalPageScroll;
                                        break;
        case CPScrollerIncrementPage: contentBounds.origin.x += (contentBounds.size.width) - _horizontalPageScroll;
                                        break;
        case CPScrollerKnobSlot:
        case CPScrollerKnob:
        default: contentBounds.origin.x = ROUND(value * ((documentFrame.size.width) - (contentBounds.size.width)));
    }
    objj_msgSend(_contentView, "scrollToPoint:", contentBounds.origin);
    objj_msgSend(_headerClipView, "scrollToPoint:", CGPointMake(contentBounds.origin.x, 0.0));
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSend(self, "reflectScrolledClipView:", _contentView);
}
}), new objj_method(sel_getUid("setLineScroll:"), function(self, _cmd, aLineScroll)
{ with(self)
{
    objj_msgSend(self, "setHorizonalLineScroll:", aLineScroll);
    objj_msgSend(self, "setVerticalLineScroll:", aLineScroll);
}
}), new objj_method(sel_getUid("lineScroll"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "horizontalLineScroll");
}
}), new objj_method(sel_getUid("setHorizontalLineScroll:"), function(self, _cmd, aLineScroll)
{ with(self)
{
    _horizontalLineScroll = aLineScroll;
}
}), new objj_method(sel_getUid("horizontalLineScroll"), function(self, _cmd)
{ with(self)
{
    return _horizontalLineScroll;
}
}), new objj_method(sel_getUid("setVerticalLineScroll:"), function(self, _cmd, aLineScroll)
{ with(self)
{
    _verticalLineScroll = aLineScroll;
}
}), new objj_method(sel_getUid("verticalLineScroll"), function(self, _cmd)
{ with(self)
{
    return _verticalLineScroll;
}
}), new objj_method(sel_getUid("setPageScroll:"), function(self, _cmd, aPageScroll)
{ with(self)
{
    objj_msgSend(self, "setHorizontalPageScroll:", aPageScroll);
    objj_msgSend(self, "setVerticalPageScroll:", aPageScroll);
}
}), new objj_method(sel_getUid("pageScroll"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "horizontalPageScroll");
}
}), new objj_method(sel_getUid("setHorizontalPageScroll:"), function(self, _cmd, aPageScroll)
{ with(self)
{
    _horizontalPageScroll = aPageScroll;
}
}), new objj_method(sel_getUid("horizontalPageScroll"), function(self, _cmd)
{ with(self)
{
    return _horizontalPageScroll;
}
}), new objj_method(sel_getUid("setVerticalPageScroll:"), function(self, _cmd, aPageScroll)
{ with(self)
{
    _verticalPageScroll = aPageScroll;
}
}), new objj_method(sel_getUid("verticalPageScroll"), function(self, _cmd)
{ with(self)
{
    return _verticalPageScroll;
}
}), new objj_method(sel_getUid("scrollWheel:"), function(self, _cmd, anEvent)
{ with(self)
{
   var documentFrame = objj_msgSend(objj_msgSend(self, "documentView"), "frame"),
       contentBounds = objj_msgSend(_contentView, "bounds");
    contentBounds.origin.x = ROUND(contentBounds.origin.x + objj_msgSend(anEvent, "deltaX") * _horizontalLineScroll);
    contentBounds.origin.y = ROUND(contentBounds.origin.y + objj_msgSend(anEvent, "deltaY") * _verticalLineScroll);
    objj_msgSend(_contentView, "scrollToPoint:", contentBounds.origin);
    objj_msgSend(_headerClipView, "scrollToPoint:", CGPointMake(contentBounds.origin.x, 0.0));
}
}), new objj_method(sel_getUid("keyDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    var keyCode = objj_msgSend(anEvent, "keyCode"),
        documentFrame = objj_msgSend(objj_msgSend(self, "documentView"), "frame"),
        contentBounds = objj_msgSend(_contentView, "bounds");
    switch (keyCode)
    {
        case 33:
                    contentBounds.origin.y -= (contentBounds.size.height) - _verticalPageScroll;
                    break;
        case 34:
                    contentBounds.origin.y += (contentBounds.size.height) - _verticalPageScroll;
                    break;
        case 38:
                    contentBounds.origin.y -= _verticalLineScroll;
                    break;
        case 40:
                    contentBounds.origin.y += _verticalLineScroll;
                    break;
        case 37:
                    contentBounds.origin.x -= _horizontalLineScroll;
                    break;
        case 49:
                    contentBounds.origin.x += _horizontalLineScroll;
                    break;
        default: return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScrollView").super_class }, "keyDown:", anEvent);
    }
    objj_msgSend(_contentView, "scrollToPoint:", contentBounds.origin);
    objj_msgSend(_headerClipView, "scrollToPoint:", CGPointMake(contentBounds.origin, 0));
}
})]);
}
var CPScrollViewContentViewKey = "CPScrollViewContentView",
    CPScrollViewHeaderClipViewKey = "CPScrollViewHeaderClipViewKey",
    CPScrollViewVLineScrollKey = "CPScrollViewVLineScroll",
    CPScrollViewHLineScrollKey = "CPScrollViewHLineScroll",
    CPScrollViewVPageScrollKey = "CPScrollViewVPageScroll",
    CPScrollViewHPageScrollKey = "CPScrollViewHPageScroll",
    CPScrollViewHasVScrollerKey = "CPScrollViewHasVScroller",
    CPScrollViewHasHScrollerKey = "CPScrollViewHasHScroller",
    CPScrollViewVScrollerKey = "CPScrollViewVScroller",
    CPScrollViewHScrollerKey = "CPScrollViewHScroller",
    CPScrollViewAutohidesScrollerKey = "CPScrollViewAutohidesScroller",
    CPScrollViewCornerViewKey = "CPScrollViewCornerViewKey";
{
var the_class = objj_getClass("CPScrollView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPScrollView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScrollView").super_class }, "initWithCoder:", aCoder))
    {
        _verticalLineScroll = objj_msgSend(aCoder, "decodeFloatForKey:", CPScrollViewVLineScrollKey);
        _verticalPageScroll = objj_msgSend(aCoder, "decodeFloatForKey:", CPScrollViewVPageScrollKey);
        _horizontalLineScroll = objj_msgSend(aCoder, "decodeFloatForKey:", CPScrollViewHLineScrollKey);
        _horizontalPageScroll = objj_msgSend(aCoder, "decodeFloatForKey:", CPScrollViewHPageScrollKey);
        _contentView = objj_msgSend(aCoder, "decodeObjectForKey:", CPScrollViewContentViewKey);
        _headerClipView = objj_msgSend(aCoder, "decodeObjectForKey:", CPScrollViewHeaderClipViewKey);
        _verticalScroller = objj_msgSend(aCoder, "decodeObjectForKey:", CPScrollViewVScrollerKey);
        _horizontalScroller = objj_msgSend(aCoder, "decodeObjectForKey:", CPScrollViewHScrollerKey);
        _hasVerticalScroller = objj_msgSend(aCoder, "decodeBoolForKey:", CPScrollViewHasVScrollerKey);
        _hasHorizontalScroller = objj_msgSend(aCoder, "decodeBoolForKey:", CPScrollViewHasHScrollerKey);
        _autohidesScrollers = objj_msgSend(aCoder, "decodeBoolForKey:", CPScrollViewAutohidesScrollerKey);
        _cornerView = objj_msgSend(aCoder, "decodeObjectForKey:", CPScrollViewCornerViewKey);
        objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "performSelector:target:argument:order:modes:", sel_getUid("reflectScrolledClipView:"), self, _contentView, 0, [CPDefaultRunLoopMode]);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPScrollView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _contentView, CPScrollViewContentViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _headerClipView, CPScrollViewHeaderClipViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _verticalScroller, CPScrollViewVScrollerKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _horizontalScroller, CPScrollViewHScrollerKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _verticalLineScroll, CPScrollViewVLineScrollKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _verticalPageScroll, CPScrollViewVPageScrollKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _horizontalLineScroll, CPScrollViewHLineScrollKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _horizontalPageScroll, CPScrollViewHPageScrollKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _hasVerticalScroller, CPScrollViewHasVScrollerKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _hasHorizontalScroller, CPScrollViewHasHScrollerKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _autohidesScrollers, CPScrollViewAutohidesScrollerKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _cornerView, CPScrollViewCornerViewKey);
}
})]);
}

p;15;CPSearchField.jt;24488;@STATIC;1.0;i;13;CPTextField.jt;24450;objj_executeFile("CPTextField.j", true);
CPSearchFieldRecentsTitleMenuItemTag = 1000;
CPSearchFieldRecentsMenuItemTag = 1001;
CPSearchFieldClearRecentsMenuItemTag = 1002;
CPSearchFieldNoRecentsMenuItemTag = 1003;
var CPSearchFieldSearchImage = nil,
    CPSearchFieldFindImage = nil,
    CPSearchFieldCancelImage = nil,
    CPSearchFieldCancelPressedImage = nil;
{var the_class = objj_allocateClassPair(CPTextField, "CPSearchField"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_searchButton"), new objj_ivar("_cancelButton"), new objj_ivar("_searchMenuTemplate"), new objj_ivar("_searchMenu"), new objj_ivar("_recentsAutosaveName"), new objj_ivar("_recentSearches"), new objj_ivar("_maximumRecents"), new objj_ivar("_sendsWholeSearchString"), new objj_ivar("_sendsSearchStringImmediately"), new objj_ivar("_partialStringTimer")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, frame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "initWithFrame:", frame);
    if (self != nil)
    {
        _recentSearches = objj_msgSend(CPArray, "array");
        _maximumRecents = 10;
        _sendsWholeSearchString = NO;
        _sendsSearchStringImmediately = NO;
        _recentsAutosaveName = nil;
        objj_msgSend(self, "setBezeled:", YES);
        objj_msgSend(self, "setBezelStyle:", CPTextFieldRoundedBezel);
        objj_msgSend(self, "setBordered:", YES);
        objj_msgSend(self, "setEditable:", YES);
        objj_msgSend(self, "setDelegate:", self);
        _cancelButton = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CPMakeRect(frame.size.width - 27,(frame.size.height-22)/2,22,22));
        objj_msgSend(self, "resetCancelButton");
        objj_msgSend(_cancelButton, "setHidden:", YES);
        objj_msgSend(_cancelButton, "setAutoresizingMask:", CPViewMinXMargin);
        objj_msgSend(self, "addSubview:", _cancelButton);
        _searchButton = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CPMakeRect(5,(frame.size.height-25)/2,25,25));
        objj_msgSend(self, "resetSearchButton");
        objj_msgSend(self, "addSubview:", _searchButton);
    _cancelButton._DOMElement.style.cursor = "default";
    _searchButton._DOMElement.style.cursor = "default";
    }
    return self;
}
}), new objj_method(sel_getUid("copy"), function(self, _cmd)
{ with(self)
{
    var copy = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "copy");
    objj_msgSend(copy, "setCancelButton:", objj_msgSend(_cancelButton, "copy"));
    objj_msgSend(copy, "setSearchButton:", objj_msgSend(_searchButton, "copy"));
    objj_msgSend(copy, "setSendsWholeSearchString:", objj_msgSend(_sendsWholeSearchString, "copy"));
    objj_msgSend(copy, "setSendsSearchStringImmediately:", objj_msgSend(_sendsSearchStringImmediately, "copy"));
    objj_msgSend(copy, "setMaximumRecents:", _maximumRecents);
    if (_recentsAutosaveName)
        objj_msgSend(copy, "setrecentsAutosaveName:", objj_msgSend(_recentsAutosaveName, "copy"));
    if (_searchMenuTemplate)
        objj_msgSend(copy, "setSearchMenutemplate:", objj_msgSend(_searchMenuTemplate, "copy"));
    return copy;
}
}), new objj_method(sel_getUid("setSearchButton:"), function(self, _cmd, button)
{ with(self)
{
    _searchButton = button;
}
}), new objj_method(sel_getUid("searchButton"), function(self, _cmd)
{ with(self)
{
    return _searchButton;
}
}), new objj_method(sel_getUid("resetSearchButton"), function(self, _cmd)
{ with(self)
{
    var searchButtonImage,
        action,
        target,
        button = objj_msgSend(self, "searchButton");
    if (_searchMenuTemplate === nil)
    {
        searchButtonImage = CPSearchFieldSearchImage;
        action = sel_getUid("_sendAction:");
        target = self;
    }
    else
    {
        searchButtonImage = CPSearchFieldFindImage;
        action = sel_getUid("_showMenu:");
        target = self;
    }
    objj_msgSend(button, "setBordered:", NO);
    objj_msgSend(button, "setImageScaling:", CPScaleToFit);
    objj_msgSend(button, "setImage:", searchButtonImage);
    objj_msgSend(button, "setAutoresizingMask:", CPViewMaxXMargin);
    objj_msgSend(button, "setTarget:", target);
    objj_msgSend(button, "setAction:", action);
}
}), new objj_method(sel_getUid("setCancelButton:"), function(self, _cmd, button)
{ with(self)
{
    _cancelButton = button;
}
}), new objj_method(sel_getUid("cancelButton"), function(self, _cmd)
{ with(self)
{
    return _cancelButton;
}
}), new objj_method(sel_getUid("resetCancelButton"), function(self, _cmd)
{ with(self)
{
    var button = objj_msgSend(self, "cancelButton");
    objj_msgSend(button, "setBordered:", NO);
    objj_msgSend(button, "setImageScaling:", CPScaleToFit);
    objj_msgSend(button, "setImage:", CPSearchFieldCancelImage);
    objj_msgSend(button, "setAlternateImage:", CPSearchFieldCancelPressedImage);
    objj_msgSend(button, "setAutoresizingMask:", CPViewMinXMargin);
    objj_msgSend(button, "setTarget:", self);
    objj_msgSend(button, "setAction:", sel_getUid("_searchFieldCancel:"));
}
}), new objj_method(sel_getUid("searchTextRectForBounds:"), function(self, _cmd, rect)
{ with(self)
{
    var leftOffset = 0, width = rect.size.width;
    if (_searchButton)
    {
        var searchRect = objj_msgSend(_searchButton, "frame");
        leftOffset = searchRect.origin.x + searchRect.size.width;
    }
    if (_cancelButton)
    {
        var cancelRect = objj_msgSend(_cancelButton, "frame");
        width = cancelRect.origin.x - leftOffset;
    }
    return CPMakeRect(leftOffset,rect.origin.y,width,rect.size.height);
}
}), new objj_method(sel_getUid("searchButtonRectForBounds:"), function(self, _cmd, rect)
{ with(self)
{
    return objj_msgSend(_searchButton, "frame");
}
}), new objj_method(sel_getUid("cancelButtonRectForBounds:"), function(self, _cmd, rect)
{ with(self)
{
    return objj_msgSend(_cancelButton, "frame");
}
}), new objj_method(sel_getUid("searchMenuTemplate"), function(self, _cmd)
{ with(self)
{
    return _searchMenuTemplate;
}
}), new objj_method(sel_getUid("setSearchMenuTemplate:"), function(self, _cmd, menu)
{ with(self)
{
    _searchMenuTemplate = menu;
    objj_msgSend(self, "resetSearchButton");
    objj_msgSend(self, "_loadRecentSearchList");
    objj_msgSend(self, "_updateSearchMenu");
}
}), new objj_method(sel_getUid("sendsWholeSearchString"), function(self, _cmd)
{ with(self)
{
    return _sendsWholeSearchString;
}
}), new objj_method(sel_getUid("setSendsWholeSearchString:"), function(self, _cmd, flag)
{ with(self)
{
    _sendsWholeSearchString = flag;
}
}), new objj_method(sel_getUid("sendsSearchStringImmediately"), function(self, _cmd)
{ with(self)
{
    return _sendsSearchStringImmediately;
}
}), new objj_method(sel_getUid("setSendsSearchStringImmediately:"), function(self, _cmd, flag)
{ with(self)
{
    _sendsSearchStringImmediately = flag;
}
}), new objj_method(sel_getUid("maximumRecents"), function(self, _cmd)
{ with(self)
{
    return _maximumRecents;
}
}), new objj_method(sel_getUid("setMaximumRecents:"), function(self, _cmd, max)
{ with(self)
{
    if (max > 254)
        max = 254;
    else if (max < 0)
        max = 10;
    _maximumRecents = max;
}
}), new objj_method(sel_getUid("recentSearches"), function(self, _cmd)
{ with(self)
{
    return _recentSearches;
}
}), new objj_method(sel_getUid("setRecentSearches:"), function(self, _cmd, searches)
{ with(self)
{
    var max = MIN(objj_msgSend(self, "maximumRecents"), objj_msgSend(searches, "count")),
        searches = objj_msgSend(searches, "subarrayWithRange:", CPMakeRange(0, max));
    _recentSearches = searches;
    objj_msgSend(self, "_autosaveRecentSearchList");
}
}), new objj_method(sel_getUid("recentsAutosaveName"), function(self, _cmd)
{ with(self)
{
    return _recentsAutosaveName;
}
}), new objj_method(sel_getUid("setRecentsAutosaveName:"), function(self, _cmd, name)
{ with(self)
{
    if (_recentsAutosaveName != nil)
        objj_msgSend(self, "_deregisterForAutosaveNotification");
    _recentsAutosaveName = name;
    if (_recentsAutosaveName != nil)
      objj_msgSend(self, "_registerForAutosaveNotification");
}
}), new objj_method(sel_getUid("contentRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    var superbounds = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "contentRectForBounds:", bounds);
    return objj_msgSend(self, "searchTextRectForBounds:", superbounds);
}
}), new objj_method(sel_getUid("menu"), function(self, _cmd)
{ with(self)
{
    return _searchMenu;
}
}), new objj_method(sel_getUid("isOpaque"), function(self, _cmd)
{ with(self)
{
  return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "isOpaque") && objj_msgSend(_cancelButton, "isOpaque") && objj_msgSend(_searchButton, "isOpaque");
}
}), new objj_method(sel_getUid("_updateCancelButtonVisibility"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_cancelButton, "setHidden:", (objj_msgSend(objj_msgSend(self, "stringValue"), "length") === 0));
}
}), new objj_method(sel_getUid("controlTextDidChange:"), function(self, _cmd, aNotification)
{ with(self)
{
    if (!objj_msgSend(self, "sendsWholeSearchString"))
    {
        if (objj_msgSend(self, "sendsSearchStringImmediately"))
            objj_msgSend(self, "_sendPartialString");
        else
        {
            objj_msgSend(_partialStringTimer, "invalidate");
            var timeInterval = objj_msgSend(CPSearchField, "_keyboardDelayForPartialSearchString:", objj_msgSend(self, "stringValue"));
            _partialStringTimer = objj_msgSend(CPTimer, "scheduledTimerWithTimeInterval:target:selector:userInfo:repeats:", timeInterval, self, sel_getUid("_sendPartialString"), nil, NO);
        }
    }
    objj_msgSend(self, "_updateCancelButtonVisibility");
}
}), new objj_method(sel_getUid("_sendAction:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
}
}), new objj_method(sel_getUid("sendAction:to:"), function(self, _cmd, anAction, anObject)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "sendAction:to:", anAction, anObject);
    objj_msgSend(_partialStringTimer, "invalidate");
    objj_msgSend(self, "_addStringToRecentSearches:", objj_msgSend(self, "stringValue"));
    objj_msgSend(self, "_updateCancelButtonVisibility");
}
}), new objj_method(sel_getUid("_addStringToRecentSearches:"), function(self, _cmd, string)
{ with(self)
{
    if (string === nil || string === "" || objj_msgSend(_recentSearches, "containsObject:", string))
        return;
    var searches = objj_msgSend(CPMutableArray, "arrayWithArray:", _recentSearches);
    objj_msgSend(searches, "addObject:", string);
    objj_msgSend(self, "setRecentSearches:", searches);
    objj_msgSend(self, "_updateSearchMenu");
}
}), new objj_method(sel_getUid("trackMouse:"), function(self, _cmd, event)
{ with(self)
{
    var rect,
        point,
        location = objj_msgSend(event, "locationInWindow");
    point = objj_msgSend(self, "convertPoint:fromView:", location, nil);
    rect = objj_msgSend(self, "searchButtonRectForBounds:", objj_msgSend(self, "frame"));
    if (CPRectContainsPoint(rect,point))
    {
        return objj_msgSend(objj_msgSend(self, "searchButton"), "trackMouse:", event);
    }
    rect = objj_msgSend(self, "cancelButtonRectForBounds:", objj_msgSend(self, "frame"));
    if (CPRectContainsPoint(rect,point))
    {
        return objj_msgSend(objj_msgSend(self, "cancelButton"), "trackMouse:", event);
    }
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "trackMouse:", event);
}
}), new objj_method(sel_getUid("_defaultSearchMenuTemplate"), function(self, _cmd)
{ with(self)
{
    var template, item;
    template = objj_msgSend(objj_msgSend(CPMenu, "alloc"), "init");
    item = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Recent searches", NULL, "");
    objj_msgSend(item, "setTag:", CPSearchFieldRecentsTitleMenuItemTag);
    objj_msgSend(item, "setEnabled:", NO);
    objj_msgSend(template, "addItem:", item);
    item = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Recent search item", sel_getUid("_searchFieldSearch:"), "");
    objj_msgSend(item, "setTag:", CPSearchFieldRecentsMenuItemTag);
    objj_msgSend(item, "setTarget:", self);
    objj_msgSend(template, "addItem:", item);
    item = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "Clear recent searches", sel_getUid("_searchFieldClearRecents:"), "");
    objj_msgSend(item, "setTag:", CPSearchFieldClearRecentsMenuItemTag);
    objj_msgSend(item, "setTarget:", self);
    objj_msgSend(template, "addItem:", item);
    item = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", "No recent searches", NULL, "");
    objj_msgSend(item, "setTag:", CPSearchFieldNoRecentsMenuItemTag);
    objj_msgSend(item, "setEnabled:", NO);
    objj_msgSend(template, "addItem:", item);
    return template;
}
}), new objj_method(sel_getUid("_updateSearchMenu"), function(self, _cmd)
{ with(self)
{
    if (_searchMenuTemplate === nil)
        return;
    var i, menu = objj_msgSend(objj_msgSend(CPMenu, "alloc"), "init"),
        countOfRecents = objj_msgSend(_recentSearches, "count"),
        numberOfItems = objj_msgSend(_searchMenuTemplate, "numberOfItems");
    for (i = 0; i < numberOfItems; i++)
    {
        var item = objj_msgSend(_searchMenuTemplate, "itemAtIndex:", i),
            tag = objj_msgSend(item, "tag");
        if (!(tag === CPSearchFieldRecentsTitleMenuItemTag && countOfRecents === 0) &&
            !(tag === CPSearchFieldClearRecentsMenuItemTag && countOfRecents === 0) &&
            !(tag === CPSearchFieldNoRecentsMenuItemTag && countOfRecents != 0) &&
            !(tag === CPSearchFieldRecentsMenuItemTag))
        {
            var itemAction, itemTarget;
            switch (tag)
            {
                case CPSearchFieldRecentsTitleMenuItemTag : itemAction = NULL; itemTarget = NULL; break;
                case CPSearchFieldClearRecentsMenuItemTag : itemAction = sel_getUid("_searchFieldClearRecents:"); itemTarget = self; break;
                case CPSearchFieldNoRecentsMenuItemTag : itemAction = NULL; itemTarget = NULL; break;
                default: itemAction = objj_msgSend(item, "action"); itemTarget = objj_msgSend(item, "target"); break;
            }
            if (tag === CPSearchFieldClearRecentsMenuItemTag || tag === CPSearchFieldRecentsTitleMenuItemTag)
            {
                var separator = objj_msgSend(CPMenuItem, "separatorItem");
                objj_msgSend(separator, "setEnabled:", NO);
                objj_msgSend(menu, "addItem:", separator);
            }
            var templateItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", objj_msgSend(item, "title"), itemAction, objj_msgSend(item, "keyEquivalent"));
            objj_msgSend(templateItem, "setTarget:", itemTarget);
            objj_msgSend(templateItem, "setEnabled:", (objj_msgSend(item, "isEnabled") && itemAction != NULL));
            objj_msgSend(templateItem, "setTag:", tag);
            objj_msgSend(menu, "addItem:", templateItem);
        }
        else if (tag === CPSearchFieldRecentsMenuItemTag)
        {
            var j;
            for (j = 0; j < countOfRecents; j++)
            {
                var rencentItem = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", objj_msgSend(_recentSearches, "objectAtIndex:", j), sel_getUid("_searchFieldSearch:"), objj_msgSend(item, "keyEquivalent"));
                objj_msgSend(rencentItem, "setTarget:", self);
                objj_msgSend(menu, "addItem:", rencentItem);
            }
        }
    }
    _searchMenu = menu;
}
}), new objj_method(sel_getUid("_showMenu:"), function(self, _cmd, sender)
{ with(self)
{
    if (_searchMenu === nil || objj_msgSend(_searchMenu, "numberOfItems") === 0 || !objj_msgSend(self, "isEnabled"))
        return;
    var aFrame = objj_msgSend(objj_msgSend(self, "superview"), "convertRect:toView:", objj_msgSend(self, "frame"), nil),
        location = CPMakePoint(aFrame.origin.x + 10, aFrame.origin.y + aFrame.size.height - 4);
    var anEvent = objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", CPRightMouseDown, location, 0, objj_msgSend(objj_msgSend(CPApp, "currentEvent"), "timestamp"), objj_msgSend(objj_msgSend(self, "window"), "windowNumber"), nil, 1, 1, 0);
    objj_msgSend(CPMenu, "popUpContextMenu:withEvent:forView:", _searchMenu, anEvent, sender);
}
}), new objj_method(sel_getUid("_sendPartialString"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "target"), "performSelector:withObject:", objj_msgSend(self, "action"), self);
}
}), new objj_method(sel_getUid("_searchFieldCancel:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", "");
    objj_msgSend(self, "_sendPartialString");
    objj_msgSend(self, "_updateCancelButtonVisibility");
}
}), new objj_method(sel_getUid("_searchFieldSearch:"), function(self, _cmd, sender)
{ with(self)
{
    var searchString = objj_msgSend(sender, "title");
    if (objj_msgSend(sender, "tag") != CPSearchFieldRecentsMenuItemTag)
        objj_msgSend(self, "_addStringToRecentSearches:", searchString);
    objj_msgSend(self, "setObjectValue:", searchString);
    objj_msgSend(self, "_sendPartialString");
    objj_msgSend(self, "_updateCancelButtonVisibility");
}
}), new objj_method(sel_getUid("_searchFieldClearRecents:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "setRecentSearches:", objj_msgSend(CPArray, "array"));
    objj_msgSend(self, "_updateSearchMenu");
 }
}), new objj_method(sel_getUid("_registerForAutosaveNotification"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "addObserver:selector:name:object:", self, sel_getUid("_updateAutosavedRecents:"), "CPAutosavedRecentsChangedNotification", nil);
}
}), new objj_method(sel_getUid("_deregisterForAutosaveNotification"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "removeObserver:name:object:", self, "CPAutosavedRecentsChangedNotification", nil);
}
}), new objj_method(sel_getUid("_autosaveRecentSearchList"), function(self, _cmd)
{ with(self)
{
    if (_recentsAutosaveName != nil)
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", "CPAutosavedRecentsChangedNotification", _recentsAutosaveName);
}
}), new objj_method(sel_getUid("_updateAutosavedRecents:"), function(self, _cmd, notification)
{ with(self)
{
    var list = objj_msgSend(self, "recentSearches"),
        name = objj_msgSend(notification, "object"),
        bundle_name = objj_msgSend(objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "infoDictionary"), "objectForKey:", "CPBundleName"),
        cookie_name = objj_msgSend(bundle_name, "lowercaseString") + "." + objj_msgSend(notification, "object"),
        cookie = objj_msgSend(objj_msgSend(CPCookie, "alloc"), "initWithName:", cookie_name),
        cookie_value = objj_msgSend(list, "componentsJoinedByString:", ",");
    objj_msgSend(cookie, "setValue:expires:domain:", cookie_value, objj_msgSend(objj_msgSend(CPDate, "alloc"), "initWithTimeIntervalSinceNow:", 3600*24*365), (window.location.href.hostname));
}
}), new objj_method(sel_getUid("_loadRecentSearchList"), function(self, _cmd)
{ with(self)
{
    var list,
        name = objj_msgSend(self, "recentsAutosaveName");
    if (name === nil)
        return;
    var bundle_name = objj_msgSend(objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "infoDictionary"), "objectForKey:", "CPBundleName"),
        cookie_name = objj_msgSend(bundle_name, "lowercaseString") + "." + name,
        cookie = objj_msgSend(objj_msgSend(CPCookie, "alloc"), "initWithName:", cookie_name);
    if (cookie != nil)
    {
        var cookie_value = objj_msgSend(cookie, "value");
        list = (cookie_value != "") ? objj_msgSend(cookie_value, "componentsSeparatedByString:", ",") : objj_msgSend(CPArray, "array");
        _recentSearches = list;
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPSearchField, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    CPSearchFieldSearchImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", objj_msgSend(bundle, "pathForResource:", "CPSearchField/CPSearchFieldSearch.png"));
    CPSearchFieldFindImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", objj_msgSend(bundle, "pathForResource:", "CPSearchField/CPSearchFieldFind.png"));
    CPSearchFieldCancelImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", objj_msgSend(bundle, "pathForResource:", "CPSearchField/CPSearchFieldCancel.png"));
    CPSearchFieldCancelPressedImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:", objj_msgSend(bundle, "pathForResource:", "CPSearchField/CPSearchFieldCancelPressed.png"));
}
}), new objj_method(sel_getUid("_keyboardDelayForPartialSearchString:"), function(self, _cmd, string)
{ with(self)
{
    return (6 - MIN(objj_msgSend(string, "length"),4))/10;
}
})]);
}
var CPSearchButtonKey = "CPSearchButtonKey",
    CPCancelButtonKey = "CPCancelButtonKey",
    CPRecentsAutosaveNameKey = "CPRecentsAutosaveNameKey",
    CPSendsWholeSearchStringKey = "CPSendsWholeSearchStringKey",
    CPSendsSearchStringImmediatelyKey = "CPSendsSearchStringImmediatelyKey",
    CPMaximumRecentsKey = "CPMaximumRecentsKey",
    CPSearchMenuTemplateKey = "CPSearchMenuTemplateKey";
{
var the_class = objj_getClass("CPSearchField")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPSearchField\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, coder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "encodeWithCoder:", coder);
    objj_msgSend(coder, "encodeObject:forKey:", _searchButton, CPSearchButtonKey);
    objj_msgSend(coder, "encodeObject:forKey:", _cancelButton, CPCancelButtonKey);
    objj_msgSend(coder, "encodeBool:forKey:", _sendsWholeSearchString, CPSendsWholeSearchStringKey);
    objj_msgSend(coder, "encodeBool:forKey:", _sendsSearchStringImmediately, CPSendsSearchStringImmediatelyKey);
    objj_msgSend(coder, "encodeInt:forKey:", _maximumRecents, CPMaximumRecentsKey);
    if (_recentsAutosaveName)
        objj_msgSend(coder, "encodeObject:forKey:", _recentsAutosaveName, CPRecentsAutosaveNameKey);
    if (_searchMenuTemplate)
        objj_msgSend(coder, "encodeObject:forKey:", _searchMenuTemplate, CPSearchMenuTemplateKey);
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, coder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSearchField").super_class }, "initWithCoder:", coder);
    _searchButton = objj_msgSend(coder, "decodeObjectForKey:", CPSearchButtonKey);
    _cancelButton = objj_msgSend(coder, "decodeObjectForKey:", CPCancelButtonKey);
    _recentsAutosaveName = objj_msgSend(coder, "decodeObjectForKey:", CPRecentsAutosaveNameKey);
    _sendsWholeSearchString = objj_msgSend(coder, "decodeBoolForKey:", CPSendsWholeSearchStringKey);
    _sendsSearchStringImmediately = objj_msgSend(coder, "decodeBoolForKey:", CPSendsSearchStringImmediatelyKey);
    _maximumRecents = objj_msgSend(coder, "decodeIntForKey:", CPMaximumRecentsKey);
    var template = objj_msgSend(coder, "decodeObjectForKey:", CPSearchMenuTemplateKey);
    if (template)
        objj_msgSend(self, "setSearchMenuTemplate:", template);
    objj_msgSend(self, "setDelegate:", self);
    return self;
}
})]);
}

p;19;CPSecureTextField.jt;353;@STATIC;1.0;i;13;CPTextField.jt;317;


objj_executeFile("CPTextField.j", true);




{var the_class = objj_allocateClassPair(CPTextField, "CPSecureTextField"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("isSecure"), function(self, _cmd)
{ with(self)
{
    return YES;
}
})]);
}

p;20;CPSegmentedControl.jt;28425;@STATIC;1.0;I;20;Foundation/CPArray.ji;11;CPControl.jt;28364;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("CPControl.j", true);
CPSegmentSwitchTrackingSelectOne = 0;
CPSegmentSwitchTrackingSelectAny = 1;
CPSegmentSwitchTrackingMomentary = 2;
{var the_class = objj_allocateClassPair(CPControl, "CPSegmentedControl"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_segments"), new objj_ivar("_themeStates"), new objj_ivar("_selectedSegment"), new objj_ivar("_segmentStyle"), new objj_ivar("_trackingMode"), new objj_ivar("_trackingSegment"), new objj_ivar("_trackingHighlighted")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aRect)
{ with(self)
{
    _segments = [];
    _themeStates = [];
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSegmentedControl").super_class }, "initWithFrame:", aRect);
    if (self)
    {
        _selectedSegment = -1;
        _trackingMode = CPSegmentSwitchTrackingSelectOne;
    }
    return self;
}
}), new objj_method(sel_getUid("selectedTag"), function(self, _cmd)
{ with(self)
{
    return _segments[_selectedSegment].tag;
}
}), new objj_method(sel_getUid("setSegmentCount:"), function(self, _cmd, aCount)
{ with(self)
{
    if (_segments.length == aCount)
        return;
    var height = CGRectGetHeight(objj_msgSend(self, "bounds"));
    if (_segments.length < aCount)
    {
        for (var index = _segments.length; index < aCount; ++index)
        {
            _segments[index] = objj_msgSend(objj_msgSend(_CPSegmentItem, "alloc"), "init");
            _themeStates[index] = CPThemeStateNormal;
        }
    }
    else if (aCount < _segments.length)
    {
        _segments.length = aCount;
        _themeStates.length = aCount;
    }
    if (_selectedSegment >= _segments.length)
        _selectedSegment = -1;
    objj_msgSend(self, "tileWithChangedSegment:", 0);
}
}), new objj_method(sel_getUid("segmentCount"), function(self, _cmd)
{ with(self)
{
    return _segments.length;
}
}), new objj_method(sel_getUid("setSelectedSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    objj_msgSend(self, "setSelected:forSegment:", YES, aSegment);
}
}), new objj_method(sel_getUid("selectedSegment"), function(self, _cmd)
{ with(self)
{
    return _selectedSegment;
}
}), new objj_method(sel_getUid("selectSegmentWithTag:"), function(self, _cmd, aTag)
{ with(self)
{
    var index = 0;
    for (; index < _segments.length; ++index)
        if (_segments[index].tag == aTag)
        {
            objj_msgSend(self, "setSelectedSegment:", index);
            return YES;
        }
    return NO;
}
}), new objj_method(sel_getUid("isTracking"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("setTrackingMode:"), function(self, _cmd, aTrackingMode)
{ with(self)
{
    if (_trackingMode == aTrackingMode)
        return;
    _trackingMode = aTrackingMode;
    if (_trackingMode == CPSegmentSwitchTrackingSelectOne)
    {
        var index = 0,
            selected = NO;
        for (; index < _segments.length; ++index)
            if (_segments[index].selected)
                if (selected)
                    objj_msgSend(self, "setSelected:forSegment:", NO, index);
                else
                    selected = YES;
    }
    else if (_trackingMode == CPSegmentSwitchTrackingMomentary)
    {
        var index = 0;
        for (; index < _segments.length; ++index)
            if (_segments[index].selected)
                objj_msgSend(self, "setSelected:forSegment:", NO, index);
    }
}
}), new objj_method(sel_getUid("trackingMode"), function(self, _cmd)
{ with(self)
{
    return _trackingMode;
}
}), new objj_method(sel_getUid("setWidth:forSegment:"), function(self, _cmd, aWidth, aSegment)
{ with(self)
{
    _segments[aSegment].width = aWidth;
    objj_msgSend(self, "tileWithChangedSegment:", aSegment);
}
}), new objj_method(sel_getUid("widthForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return _segments[aSegment].width;
}
}), new objj_method(sel_getUid("setImage:forSegment:"), function(self, _cmd, anImage, aSegment)
{ with(self)
{
    var segment = _segments[aSegment];
    segment.image = anImage;
    objj_msgSend(self, "tileWithChangedSegment:", aSegment);
}
}), new objj_method(sel_getUid("imageForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return _segments[aSegment].image;
}
}), new objj_method(sel_getUid("setLabel:forSegment:"), function(self, _cmd, aLabel, aSegment)
{ with(self)
{
    var segment = _segments[aSegment];
    _segments[aSegment].label = aLabel;
    objj_msgSend(self, "tileWithChangedSegment:", aSegment);
}
}), new objj_method(sel_getUid("labelForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return _segments[aSegment].label;
}
}), new objj_method(sel_getUid("setMenu:forSegment:"), function(self, _cmd, aMenu, aSegment)
{ with(self)
{
    _segments[aSegment].menu = aMenu;
}
}), new objj_method(sel_getUid("menuForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return _segments[aSegment].menu;
}
}), new objj_method(sel_getUid("setSelected:forSegment:"), function(self, _cmd, isSelected, aSegment)
{ with(self)
{
    var segment = _segments[aSegment];
    if (segment.selected == isSelected)
        return;
    segment.selected = isSelected;
    _themeStates[aSegment] = isSelected ? CPThemeStateSelected : CPThemeStateNormal;
    if (isSelected)
    {
        var oldSelectedSegment = _selectedSegment;
        _selectedSegment = aSegment;
        if (_trackingMode == CPSegmentSwitchTrackingSelectOne && oldSelectedSegment != aSegment && oldSelectedSegment != -1)
        {
            _segments[oldSelectedSegment].selected = NO;
            _themeStates[oldSelectedSegment] = CPThemeStateNormal;
            objj_msgSend(self, "drawSegmentBezel:highlight:", oldSelectedSegment, NO);
        }
    }
    if (_trackingMode != CPSegmentSwitchTrackingMomentary)
        objj_msgSend(self, "drawSegmentBezel:highlight:", aSegment, NO);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("isSelectedForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return _segments[aSegment].selected;
}
}), new objj_method(sel_getUid("setEnabled:forSegment:"), function(self, _cmd, isEnabled, aSegment)
{ with(self)
{
    if (isEnabled)
        _themeStates[aSegment] &= ~CPThemeStateDisabled;
    else
        _themeStates[aSegment] |= CPThemeStateDisabled;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("isEnabledForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return !(_themeStates[aSegment] & CPThemeStateDisabled)
}
}), new objj_method(sel_getUid("setTag:forSegment:"), function(self, _cmd, aTag, aSegment)
{ with(self)
{
    _segments[aSegment].tag = aTag;
}
}), new objj_method(sel_getUid("tagForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return _segments[aSegment].tag;
}
}), new objj_method(sel_getUid("drawSegmentBezel:highlight:"), function(self, _cmd, aSegment, shouldHighlight)
{ with(self)
{
    if (shouldHighlight)
        _themeStates[aSegment] |= CPThemeStateHighlighted;
    else
        _themeStates[aSegment] &= ~CPThemeStateHighlighted;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("_leftOffsetForSegment:"), function(self, _cmd, segment)
{ with(self)
{
    var bezelInset = objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-inset");
    if (segment == 0)
        return bezelInset.left;
    var thickness = objj_msgSend(self, "currentValueForThemeAttribute:", "divider-thickness");
    return objj_msgSend(self, "_leftOffsetForSegment:", segment - 1) + objj_msgSend(self, "widthForSegment:", segment - 1) + thickness;
}
}), new objj_method(sel_getUid("_indexOfLastSegment"), function(self, _cmd)
{ with(self)
{
    var lastSegmentIndex = objj_msgSend(_segments, "count") - 1;
    if (lastSegmentIndex < 0)
        lastSegmentIndex = 0;
    return lastSegmentIndex;
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    var height = objj_msgSend(self, "currentValueForThemeAttribute:", "default-height"),
        contentInset = objj_msgSend(self, "currentValueForThemeAttribute:", "content-inset"),
        bezelInset = objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-inset"),
        bounds = objj_msgSend(self, "bounds");
    if (aName === "left-segment-bezel")
    {
        return CGRectMake(bezelInset.left, bezelInset.top, contentInset.left, height);
    }
    else if (aName === "right-segment-bezel")
    {
        return CPRectMake(CGRectGetWidth(objj_msgSend(self, "bounds")) - contentInset.right,
                            bezelInset.top,
                            contentInset.right,
                            height);
    }
    else if (aName.indexOf("segment-bezel") === 0)
    {
        var segment = parseInt(aName.substring("segment-bezel-".length), 10),
            frame = CGRectCreateCopy(_segments[segment].frame);
        if (segment === 0)
        {
            frame.origin.x += contentInset.left;
            frame.size.width -= contentInset.left;
        }
        if (segment === _segments.length - 1)
            frame.size.width = CGRectGetWidth(objj_msgSend(self, "bounds")) - contentInset.right - frame.origin.x;
        return frame;
    }
    else if (aName.indexOf("divider-bezel") === 0)
    {
        var segment = parseInt(aName.substring("divider-bezel-".length), 10),
            width = objj_msgSend(self, "widthForSegment:", segment),
            left = objj_msgSend(self, "_leftOffsetForSegment:", segment),
            thickness = objj_msgSend(self, "currentValueForThemeAttribute:", "divider-thickness");
        return CGRectMake(left + width, bezelInset.top, thickness, height);
    }
    else if (aName.indexOf("segment-content") === 0)
    {
        var segment = parseInt(aName.substring("segment-content-".length), 10);
        return objj_msgSend(self, "contentFrameForSegment:", segment);
    }
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSegmentedControl").super_class }, "rectForEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName.substring(0, "segment-content".length) == "segment-content")
        return objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
    return objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    if (_segments.length <= 0)
        return;
    var themeState = _themeStates[0];
    themeState |= _themeState & CPThemeStateDisabled;
    var leftCapColor = objj_msgSend(self, "valueForThemeAttribute:inState:", "left-segment-bezel-color", themeState);
    var leftBezelView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "left-segment-bezel", CPWindowBelow, nil);
    objj_msgSend(leftBezelView, "setBackgroundColor:", leftCapColor);
    var themeState = _themeStates[_themeStates.length - 1];
    themeState |= _themeState & CPThemeStateDisabled;
    var rightCapColor = objj_msgSend(self, "valueForThemeAttribute:inState:", "right-segment-bezel-color", themeState);
    var rightBezelView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "right-segment-bezel", CPWindowBelow, nil);
    objj_msgSend(rightBezelView, "setBackgroundColor:", rightCapColor);
    for (var i=0, count = _themeStates.length; i<count; i++)
    {
        var themeState = _themeStates[i];
        themeState |= _themeState & CPThemeStateDisabled;
        var bezelColor = objj_msgSend(self, "valueForThemeAttribute:inState:", "center-segment-bezel-color", themeState);
        var bezelView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "segment-bezel-"+i, CPWindowBelow, nil);
        objj_msgSend(bezelView, "setBackgroundColor:", bezelColor);
        var segment = _segments[i];
        var contentView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "segment-content-"+i, CPWindowAbove, "segment-bezel-"+i);
        objj_msgSend(contentView, "setText:", segment.label);
        objj_msgSend(contentView, "setImage:", segment.image);
        objj_msgSend(contentView, "setFont:", objj_msgSend(self, "valueForThemeAttribute:inState:", "font", themeState));
        objj_msgSend(contentView, "setTextColor:", objj_msgSend(self, "valueForThemeAttribute:inState:", "text-color", themeState));
        objj_msgSend(contentView, "setAlignment:", objj_msgSend(self, "valueForThemeAttribute:inState:", "alignment", themeState));
        objj_msgSend(contentView, "setVerticalAlignment:", objj_msgSend(self, "valueForThemeAttribute:inState:", "vertical-alignment", themeState));
        objj_msgSend(contentView, "setLineBreakMode:", objj_msgSend(self, "valueForThemeAttribute:inState:", "line-break-mode", themeState));
        objj_msgSend(contentView, "setTextShadowColor:", objj_msgSend(self, "valueForThemeAttribute:inState:", "text-shadow-color", themeState));
        objj_msgSend(contentView, "setTextShadowOffset:", objj_msgSend(self, "valueForThemeAttribute:inState:", "text-shadow-offset", themeState));
        objj_msgSend(contentView, "setImageScaling:", objj_msgSend(self, "valueForThemeAttribute:inState:", "image-scaling", themeState));
        if (segment.image && segment.label)
            objj_msgSend(contentView, "setImagePosition:", objj_msgSend(self, "valueForThemeAttribute:inState:", "image-position", themeState));
        else if (segment.image)
            objj_msgSend(contentView, "setImagePosition:", CPImageOnly);
        if (i == count - 1)
            continue;
        var borderState = _themeStates[i] | _themeStates[i+1];
        borderState = (borderState & CPThemeStateSelected & ~CPThemeStateHighlighted) ? CPThemeStateSelected : CPThemeStateNormal;
        borderState |= _themeState & CPThemeStateDisabled;
        var borderColor = objj_msgSend(self, "valueForThemeAttribute:inState:", "divider-bezel-color", borderState);
        var borderView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "divider-bezel-"+i, CPWindowBelow, nil);
        objj_msgSend(borderView, "setBackgroundColor:", borderColor);
    }
}
}), new objj_method(sel_getUid("drawSegment:highlight:"), function(self, _cmd, aSegment, shouldHighlight)
{ with(self)
{
}
}), new objj_method(sel_getUid("tileWithChangedSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    if (aSegment >= _segments.length)
        return;
    var segment = _segments[aSegment],
        segmentWidth = segment.width,
        themeState = _themeStates[aSegment] | (_themeState & CPThemeStateDisabled),
        contentInset = objj_msgSend(self, "valueForThemeAttribute:inState:", "content-inset", themeState),
        font = objj_msgSend(self, "valueForThemeAttribute:inState:", "font", themeState);
    if (!segmentWidth)
    {
        if (segment.image && segment.label)
            segmentWidth = objj_msgSend(segment.label, "sizeWithFont:", font).width + objj_msgSend(segment.image, "size").width + contentInset.left + contentInset.right;
        else if (segment.image)
            segmentWidth = objj_msgSend(segment.image, "size").width + contentInset.left + contentInset.right;
        else if (segment.label)
            segmentWidth = objj_msgSend(segment.label, "sizeWithFont:", font).width + contentInset.left + contentInset.right;
        else
            segmentWidth = 0.0;
    }
    var delta = segmentWidth - CGRectGetWidth(segment.frame);
    if (!delta)
        return;
    var frame = objj_msgSend(self, "frame");
    objj_msgSend(self, "setFrameSize:", CGSizeMake(CGRectGetWidth(frame) + delta, CGRectGetHeight(frame)));
    segment.width = segmentWidth;
    segment.frame = objj_msgSend(self, "frameForSegment:", aSegment);;
    var index = aSegment + 1;
    for (; index < _segments.length; ++index)
    {
        _segments[index].frame.origin.x += delta;
        objj_msgSend(self, "drawSegmentBezel:highlight:", index, NO);
        objj_msgSend(self, "drawSegment:highlight:", index, NO);
    }
    objj_msgSend(self, "drawSegmentBezel:highlight:", aSegment, NO);
    objj_msgSend(self, "drawSegment:highlight:", aSegment, NO);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("frameForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    return objj_msgSend(self, "bezelFrameForSegment:", aSegment);
}
}), new objj_method(sel_getUid("bezelFrameForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    var height = objj_msgSend(self, "currentValueForThemeAttribute:", "default-height"),
        bezelInset = objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-inset"),
        width = objj_msgSend(self, "widthForSegment:", aSegment),
        left = objj_msgSend(self, "_leftOffsetForSegment:", aSegment);
    return CGRectMake(left, bezelInset.top, width, height);
}
}), new objj_method(sel_getUid("contentFrameForSegment:"), function(self, _cmd, aSegment)
{ with(self)
{
    var height = objj_msgSend(self, "currentValueForThemeAttribute:", "default-height"),
        contentInset = objj_msgSend(self, "currentValueForThemeAttribute:", "content-inset"),
        width = objj_msgSend(self, "widthForSegment:", aSegment),
        left = objj_msgSend(self, "_leftOffsetForSegment:", aSegment);
    return CGRectMake(left + contentInset.left, contentInset.top, width - contentInset.left - contentInset.right, height - contentInset.top - contentInset.bottom);
}
}), new objj_method(sel_getUid("testSegment:"), function(self, _cmd, aPoint)
{ with(self)
{
    var location = objj_msgSend(self, "convertPoint:fromView:", aPoint, nil),
        count = _segments.length;
    while (count--)
        if (CGRectContainsPoint(_segments[count].frame, aPoint))
            return count;
    if (_segments.length)
    {
        var adjustedLastFrame = CGRectCreateCopy(_segments[_segments.length - 1].frame);
        adjustedLastFrame.size.width = CGRectGetWidth(objj_msgSend(self, "bounds")) - adjustedLastFrame.origin.x;
        if (CGRectContainsPoint(adjustedLastFrame, aPoint))
            return _segments.length - 1;
    }
    return -1;
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(self, "isEnabled"))
        return;
    objj_msgSend(self, "trackSegment:", anEvent);
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
}
}), new objj_method(sel_getUid("trackSegment:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type"),
        location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
    if (type == CPLeftMouseUp)
    {
        if (_trackingSegment == -1)
            return;
        if (_trackingSegment === objj_msgSend(self, "testSegment:", location))
        {
            if (_trackingMode == CPSegmentSwitchTrackingSelectAny)
            {
                objj_msgSend(self, "setSelected:forSegment:", !objj_msgSend(self, "isSelectedForSegment:", _trackingSegment), _trackingSegment);
                _selectedSegment = _trackingSegment;
            }
            else
                objj_msgSend(self, "setSelected:forSegment:", YES, _trackingSegment);
            objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
            if (_trackingMode == CPSegmentSwitchTrackingMomentary)
            {
                objj_msgSend(self, "setSelected:forSegment:", NO, _trackingSegment);
                _selectedSegment = -1;
            }
        }
        objj_msgSend(self, "drawSegmentBezel:highlight:", _trackingSegment, NO);
        _trackingSegment = -1;
        return;
    }
    if (type == CPLeftMouseDown)
    {
        var trackingSegment = objj_msgSend(self, "testSegment:", location);
        if (trackingSegment > -1 && objj_msgSend(self, "isEnabledForSegment:", trackingSegment))
        {
            _trackingHighlighted = YES;
            _trackingSegment = trackingSegment;
            objj_msgSend(self, "drawSegmentBezel:highlight:", _trackingSegment, YES);
        }
    }
    else if (type == CPLeftMouseDragged)
    {
        if (_trackingSegment == -1)
            return;
        var highlighted = objj_msgSend(self, "testSegment:", location) === _trackingSegment;
        if (highlighted != _trackingHighlighted)
        {
            _trackingHighlighted = highlighted;
            objj_msgSend(self, "drawSegmentBezel:highlight:", _trackingSegment, _trackingHighlighted);
        }
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackSegment:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSegmentedControl").super_class }, "setFont:", aFont);
    objj_msgSend(self, "tileWithChangedSegment:", 0);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "segmented-control";
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [CPCenterTextAlignment, CPCenterVerticalTextAlignment, CPImageLeft, CPScaleNone, { top:(0), right:(0), bottom:(0), left:(0) }, { top:(0), right:(0), bottom:(0), left:(0) }, objj_msgSend(CPNull, "null"), objj_msgSend(CPNull, "null"), objj_msgSend(CPNull, "null"), objj_msgSend(CPNull, "null"), 1.0, 24.0], ["alignment", "vertical-alignment", "image-position", "image-scaling", "bezel-inset", "content-inset", "left-segment-bezel-color", "right-segment-bezel-color", "center-segment-bezel-color", "divider-bezel-color", "divider-thickness", "default-height"]);
}
})]);
}
var CPSegmentedControlSegmentsKey = "CPSegmentedControlSegmentsKey",
    CPSegmentedControlSelectedKey = "CPSegmentedControlSelectedKey",
    CPSegmentedControlSegmentStyleKey = "CPSegmentedControlSegmentStyleKey",
    CPSegmentedControlTrackingModeKey = "CPSegmentedControlTrackingModeKey";
{
var the_class = objj_getClass("CPSegmentedControl")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPSegmentedControl\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSegmentedControl").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        var frame = objj_msgSend(self, "frame"),
            originalWidth = frame.size.width;
        frame.size.width = 0;
        objj_msgSend(self, "setFrame:", frame);
        _segments = objj_msgSend(aCoder, "decodeObjectForKey:", CPSegmentedControlSegmentsKey);
        _segmentStyle = objj_msgSend(aCoder, "decodeIntForKey:", CPSegmentedControlSegmentStyleKey);
        _themeStates = [];
        if (objj_msgSend(aCoder, "containsValueForKey:", CPSegmentedControlSelectedKey))
            _selectedSegment = objj_msgSend(aCoder, "decodeIntForKey:", CPSegmentedControlSelectedKey);
        else
            _selectedSegment = -1;
        if (objj_msgSend(aCoder, "containsValueForKey:", CPSegmentedControlTrackingModeKey))
            _trackingMode = objj_msgSend(aCoder, "decodeIntForKey:", CPSegmentedControlTrackingModeKey);
        else
            _trackingMode = CPSegmentSwitchTrackingSelectOne;
        for (var i = 0; i < _segments.length; i++)
        {
            _themeStates[i] = _segments[i].selected ? CPThemeStateSelected : CPThemeStateNormal;
            objj_msgSend(self, "tileWithChangedSegment:", i);
        }
        var difference = MAX(originalWidth - objj_msgSend(self, "frame").size.width, 0.0),
            remainingWidth = FLOOR(difference / _segments.length);
        for (var i=0; i < _segments.length; i++)
            objj_msgSend(self, "setWidth:forSegment:", _segments[i].width + remainingWidth, i);
        objj_msgSend(self, "tileWithChangedSegment:", 0);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSegmentedControl").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _segments, CPSegmentedControlSegmentsKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _selectedSegment, CPSegmentedControlSelectedKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _segmentStyle, CPSegmentedControlSegmentStyleKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _trackingMode, CPSegmentedControlTrackingModeKey);
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "_CPSegmentItem"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("image"), new objj_ivar("label"), new objj_ivar("menu"), new objj_ivar("selected"), new objj_ivar("enabled"), new objj_ivar("tag"), new objj_ivar("width"), new objj_ivar("frame")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPSegmentItem").super_class }, "init"))
    {
        image = nil;
        label = "";
        menu = nil;
        selected = NO;
        enabled = NO;
        tag = 0;
        width = 0;
        frame = CGRectMakeZero();
    }
    return self;
}
})]);
}
var CPSegmentItemImageKey = "CPSegmentItemImageKey",
    CPSegmentItemLabelKey = "CPSegmentItemLabelKey",
    CPSegmentItemMenuKey = "CPSegmentItemMenuKey",
    CPSegmentItemSelectedKey = "CPSegmentItemSelectedKey",
    CPSegmentItemEnabledKey = "CPSegmentItemEnabledKey",
    CPSegmentItemTagKey = "CPSegmentItemTagKey",
    CPSegmentItemWidthKey = "CPSegmentItemWidthKey";
{
var the_class = objj_getClass("_CPSegmentItem")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPSegmentItem\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPSegmentItem").super_class }, "init");
    if (self)
    {
        image = objj_msgSend(aCoder, "decodeObjectForKey:", CPSegmentItemImageKey);
        label = objj_msgSend(aCoder, "decodeObjectForKey:", CPSegmentItemLabelKey);
        menu = objj_msgSend(aCoder, "decodeObjectForKey:", CPSegmentItemMenuKey);
        selected = objj_msgSend(aCoder, "decodeBoolForKey:", CPSegmentItemSelectedKey);
        enabled = objj_msgSend(aCoder, "decodeBoolForKey:", CPSegmentItemEnabledKey);
        tag = objj_msgSend(aCoder, "decodeIntForKey:", CPSegmentItemTagKey);
        width = objj_msgSend(aCoder, "decodeFloatForKey:", CPSegmentItemWidthKey);
        frame = CGRectMakeZero();
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", image, CPSegmentItemImageKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", label, CPSegmentItemLabelKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", menu, CPSegmentItemMenuKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", selected, CPSegmentItemSelectedKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", enabled, CPSegmentItemEnabledKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", tag, CPSegmentItemTagKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", width, CPSegmentItemWidthKey);
}
})]);
}

p;10;CPShadow.jt;1667;@STATIC;1.0;I;21;Foundation/CPObject.jt;1622;objj_executeFile("Foundation/CPObject.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPShadow"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_offset"), new objj_ivar("_blurRadius"), new objj_ivar("_color"), new objj_ivar("_cssString")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_initWithOffset:blurRadius:color:"), function(self, _cmd, anOffset, aBlurRadius, aColor)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPShadow").super_class }, "init");
    if (self)
    {
        _offset = anOffset;
        _blurRadius = aBlurRadius;
        _color = aColor;
        _cssString = objj_msgSend(_color, "cssString") + " " + Math.round(anOffset.width) + "px " + Math.round(anOffset.height) + "px " + Math.round(_blurRadius) + "px";
    }
    return self;
}
}), new objj_method(sel_getUid("shadowOffset"), function(self, _cmd)
{ with(self)
{
    return _offset;
}
}), new objj_method(sel_getUid("shadowBlurRadius"), function(self, _cmd)
{ with(self)
{
    return _blurRadius;
}
}), new objj_method(sel_getUid("shadowColor"), function(self, _cmd)
{ with(self)
{
    return _color;
}
}), new objj_method(sel_getUid("cssString"), function(self, _cmd)
{ with(self)
{
    return _cssString;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("shadowWithOffset:blurRadius:color:"), function(self, _cmd, anOffset, aBlurRadius, aColor)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPShadow, "alloc"), "_initWithOffset:blurRadius:color:", anOffset, aBlurRadius, aColor);
}
})]);
}

p;14;CPShadowView.jt;7665;@STATIC;1.0;I;21;Foundation/CPBundle.ji;12;CGGeometry.ji;9;CPImage.ji;13;CPImageView.ji;8;CPView.jt;7560;objj_executeFile("Foundation/CPBundle.j", false);
objj_executeFile("CGGeometry.j", true);
objj_executeFile("CPImage.j", true);
objj_executeFile("CPImageView.j", true);
objj_executeFile("CPView.j", true);
CPLightShadow = 0;
CPHeavyShadow = 1;
var CPShadowViewLightBackgroundColor = nil,
    CPShadowViewHeavyBackgroundColor = nil;
var LIGHT_LEFT_INSET = 3.0,
    LIGHT_RIGHT_INSET = 3.0,
    LIGHT_TOP_INSET = 3.0,
    LIGHT_BOTTOM_INSET = 5.0,
    HEAVY_LEFT_INSET = 7.0,
    HEAVY_RIGHT_INSET = 7.0,
    HEAVY_TOP_INSET = 5.0,
    HEAVY_BOTTOM_INSET = 5.0;
{var the_class = objj_allocateClassPair(CPView, "CPShadowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_weight")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPShadowView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _weight = CPLightShadow;
        objj_msgSend(self, "setBackgroundColor:", CPShadowViewLightBackgroundColor);
        objj_msgSend(self, "setHitTests:", NO);
    }
    return self;
}
}), new objj_method(sel_getUid("setWeight:"), function(self, _cmd, aWeight)
{ with(self)
{
    if (_weight == aWeight)
        return;
    _weight = aWeight;
    if (_weight == CPLightShadow)
        objj_msgSend(self, "setBackgroundColor:", CPShadowViewLightBackgroundColor);
    else
        objj_msgSend(self, "setBackgroundColor:", CPShadowViewHeavyBackgroundColor);
}
}), new objj_method(sel_getUid("leftInset"), function(self, _cmd)
{ with(self)
{
    return _weight == CPLightShadow ? LIGHT_LEFT_INSET : HEAVY_LEFT_INSET;
}
}), new objj_method(sel_getUid("rightInset"), function(self, _cmd)
{ with(self)
{
    return _weight == CPLightShadow ? LIGHT_RIGHT_INSET : HEAVY_RIGHT_INSET;
}
}), new objj_method(sel_getUid("topInset"), function(self, _cmd)
{ with(self)
{
    return _weight == CPLightShadow ? LIGHT_TOP_INSET : HEAVY_TOP_INSET;
}
}), new objj_method(sel_getUid("bottomInset"), function(self, _cmd)
{ with(self)
{
    return _weight == CPLightShadow ? LIGHT_BOTTOM_INSET : HEAVY_BOTTOM_INSET;
}
}), new objj_method(sel_getUid("horizontalInset"), function(self, _cmd)
{ with(self)
{
    if (_weight == CPLightShadow)
        return LIGHT_LEFT_INSET + LIGHT_RIGHT_INSET;
    return HEAVY_LEFT_INSET + HEAVY_RIGHT_INSET;
}
}), new objj_method(sel_getUid("verticalInset"), function(self, _cmd)
{ with(self)
{
    if (_weight == CPLightShadow)
        return LIGHT_TOP_INSET + LIGHT_BOTTOM_INSET;
    return HEAVY_TOP_INSET + HEAVY_BOTTOM_INSET;
}
}), new objj_method(sel_getUid("frameForContentFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "class"), "frameForContentFrame:withWeight:", aFrame, _weight);
}
}), new objj_method(sel_getUid("setFrameForContentFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    objj_msgSend(self, "setFrame:", objj_msgSend(self, "frameForContentFrame:", aFrame));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPShadowView, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(self, "class"));
    CPShadowViewLightBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
        [
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightTopLeft.png"), CGSizeMake(9.0, 9.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightTop.png"), CGSizeMake(1.0, 9.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightTopRight.png"), CGSizeMake(9.0, 9.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightLeft.png"), CGSizeMake(9.0, 1.0)),
            nil,
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightRight.png"), CGSizeMake(9.0, 1.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightBottomLeft.png"), CGSizeMake(9.0, 9.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightBottom.png"), CGSizeMake(1.0, 9.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewLightBottomRight.png"), CGSizeMake(9.0, 9.0))
        ]));
    CPShadowViewHeavyBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
        [
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyTopLeft.png"), CGSizeMake(17.0, 17.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyTop.png"), CGSizeMake(1.0, 17.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyTopRight.png"), CGSizeMake(17.0, 17.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyLeft.png"), CGSizeMake(17.0, 1.0)),
            nil,
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyRight.png"), CGSizeMake(17.0, 1.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyBottomLeft.png"), CGSizeMake(17.0, 17.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyBottom.png"), CGSizeMake(1.0, 17.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPShadowView/CPShadowViewHeavyBottomRight.png"), CGSizeMake(17.0, 17.0))
        ]));
}
}), new objj_method(sel_getUid("frameForContentFrame:withWeight:"), function(self, _cmd, aFrame, aWeight)
{ with(self)
{
    if (aWeight == CPLightShadow)
        return CGRectMake((aFrame.origin.x) - LIGHT_LEFT_INSET, (aFrame.origin.y) - LIGHT_TOP_INSET, (aFrame.size.width) + LIGHT_LEFT_INSET + LIGHT_RIGHT_INSET, (aFrame.size.height) + LIGHT_TOP_INSET + LIGHT_BOTTOM_INSET);
    else
        return CGRectMake((aFrame.origin.x) - HEAVY_LEFT_INSET, (aFrame.origin.y) - HEAVY_TOP_INSET, (aFrame.size.width) + HEAVY_LEFT_INSET + HEAVY_RIGHT_INSET, (aFrame.size.height) + HEAVY_TOP_INSET + HEAVY_BOTTOM_INSET);
}
})]);
}

p;10;CPSlider.jt;15045;@STATIC;1.0;i;11;CPControl.jt;15009;objj_executeFile("CPControl.j", true);
CPLinearSlider = 0;
CPCircularSlider = 1;
{var the_class = objj_allocateClassPair(CPControl, "CPSlider"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_minValue"), new objj_ivar("_maxValue"), new objj_ivar("_altIncrementValue"), new objj_ivar("_isVertical")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _minValue = 0.0;
        _maxValue = 100.0;
        objj_msgSend(self, "setObjectValue:", 50.0);
        objj_msgSend(self, "setContinuous:", YES);
        objj_msgSend(self, "_recalculateIsVertical");
    }
    return self;
}
}), new objj_method(sel_getUid("setMinValue:"), function(self, _cmd, aMinimumValue)
{ with(self)
{
    if (_minValue === aMinimumValue)
        return;
    _minValue = aMinimumValue;
    var doubleValue = objj_msgSend(self, "doubleValue");
    if (doubleValue < _minValue)
        objj_msgSend(self, "setDoubleValue:", _minValue);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("minValue"), function(self, _cmd)
{ with(self)
{
    return _minValue;
}
}), new objj_method(sel_getUid("setMaxValue:"), function(self, _cmd, aMaximumValue)
{ with(self)
{
    if (_maxValue === aMaximumValue)
        return;
    _maxValue = aMaximumValue;
    var doubleValue = objj_msgSend(self, "doubleValue");
    if (doubleValue > _maxValue)
        objj_msgSend(self, "setDoubleValue:", _maxValue);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("maxValue"), function(self, _cmd)
{ with(self)
{
    return _maxValue;
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "setObjectValue:", MIN(MAX(aValue, _minValue), _maxValue));
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("setSliderType:"), function(self, _cmd, aSliderType)
{ with(self)
{
    if (aSliderType === CPCircularSlider)
        objj_msgSend(self, "setThemeState:", CPThemeStateCircular);
    else
        objj_msgSend(self, "unsetThemeState:", CPThemeStateCircular);
}
}), new objj_method(sel_getUid("sliderType"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "hasThemeState:", CPThemeStateCircular) ? CPCircularSlider : CPLinearSlider;
}
}), new objj_method(sel_getUid("trackRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    if (objj_msgSend(self, "hasThemeState:", CPThemeStateCircular))
    {
        var originalBounds = CGRectCreateCopy(bounds);
        bounds.size.width = MIN(bounds.size.width, bounds.size.height);
        bounds.size.height = bounds.size.width;
        if (bounds.size.width < originalBounds.size.width)
            bounds.origin.x += (originalBounds.size.width - bounds.size.width) / 2.0;
        else
            bounds.origin.y += (originalBounds.size.height - bounds.size.height) / 2.0;
    }
    else
    {
        var trackWidth = objj_msgSend(self, "currentValueForThemeAttribute:", "track-width");
        if (trackWidth <= 0)
            return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
        if (objj_msgSend(self, "isVertical"))
        {
            bounds.origin.x = ((bounds.size.width) - trackWidth) / 2.0;
            bounds.size.width = trackWidth;
        }
        else
        {
            bounds.origin.y = ((bounds.size.height) - trackWidth) / 2.0;
            bounds.size.height = trackWidth;
        }
    }
    return bounds;
}
}), new objj_method(sel_getUid("knobRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    var knobSize = objj_msgSend(self, "currentValueForThemeAttribute:", "knob-size");
    if (knobSize.width <= 0 || knobSize.height <= 0)
        return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    var knobRect = { origin: { x:0.0, y:0.0 }, size: { width:knobSize.width, height:knobSize.height } },
        trackRect = objj_msgSend(self, "trackRectForBounds:", bounds);
    if (!trackRect || (trackRect.size.width <= 0.0 || trackRect.size.height <= 0.0))
        trackRect = bounds;
    if (objj_msgSend(self, "hasThemeState:", CPThemeStateCircular))
    {
        var angle = 3*PI_2 - (1.0 - objj_msgSend(self, "doubleValue") - _minValue) / (_maxValue - _minValue) * PI2,
            radius = CGRectGetWidth(trackRect) / 2.0 - 8.0;
        knobRect.origin.x = radius * COS(angle) + CGRectGetMidX(trackRect) - 3.0;
        knobRect.origin.y = radius * SIN(angle) + CGRectGetMidY(trackRect) - 2.0;
    }
    else if (objj_msgSend(self, "isVertical"))
    {
        knobRect.origin.x = (trackRect.origin.x + (trackRect.size.width) / 2.0) - knobSize.width / 2.0;
        knobRect.origin.y = ((objj_msgSend(self, "doubleValue") - _minValue) / (_maxValue - _minValue)) * ((trackRect.size.height) - knobSize.height);
    }
    else
    {
        knobRect.origin.x = ((objj_msgSend(self, "doubleValue") - _minValue) / (_maxValue - _minValue)) * ((trackRect.size.width) - knobSize.width);
        knobRect.origin.y = (trackRect.origin.y + (trackRect.size.height) / 2.0) - knobSize.height / 2.0;
    }
    return knobRect;
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "track-view")
        return objj_msgSend(self, "trackRectForBounds:", objj_msgSend(self, "bounds"));
    else if (aName === "knob-view")
        return objj_msgSend(self, "knobRectForBounds:", objj_msgSend(self, "bounds"));
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "rectForEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "track-view" || aName === "knob-view")
    {
        var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "init");
        objj_msgSend(view, "setHitTests:", NO);
        return view;
    }
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "createEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("setAltIncrementValue:"), function(self, _cmd, anAltIncrementValue)
{ with(self)
{
    _altIncrementValue = anAltIncrementValue;
}
}), new objj_method(sel_getUid("altIncrementValue"), function(self, _cmd)
{ with(self)
{
    return _altIncrementValue;
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "_recalculateIsVertical");
}
}), new objj_method(sel_getUid("_recalculateIsVertical"), function(self, _cmd)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        width = (bounds.size.width),
        height = (bounds.size.height);
    _isVertical = width < height ? 1 : (width > height ? 0 : -1);
    if (_isVertical === 1)
        objj_msgSend(self, "setThemeState:", CPThemeStateVertical);
    else if (_isVertical === 0)
        objj_msgSend(self, "unsetThemeState:", CPThemeStateVertical);
}
}), new objj_method(sel_getUid("isVertical"), function(self, _cmd)
{ with(self)
{
    return _isVertical;
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var trackView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "track-view", CPWindowBelow, "knob-view");
    if (trackView)
        objj_msgSend(trackView, "setBackgroundColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "track-color"));
    var knobView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "knob-view", CPWindowAbove, "track-view");
    if (knobView)
        objj_msgSend(knobView, "setBackgroundColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "knob-color"));
}
}), new objj_method(sel_getUid("tracksMouseOutsideOfFrame"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("_valueAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        knobRect = objj_msgSend(self, "knobRectForBounds:", bounds),
        trackRect = objj_msgSend(self, "trackRectForBounds:", bounds);
    if (objj_msgSend(self, "hasThemeState:", CPThemeStateCircular))
    {
        var knobWidth = (knobRect.size.width);
        trackRect.origin.x += knobWidth / 2;
        trackRect.size.width -= knobWidth;
        var minValue = objj_msgSend(self, "minValue"),
            dx = aPoint.x - (trackRect.origin.x + (trackRect.size.width) / 2.0),
            dy = aPoint.y - (trackRect.origin.y + (trackRect.size.height) / 2.0);
        return MAX(0.0, MIN(1.0, 1.0 - (3 * PI_2 - ATAN2(dy, dx)) % PI2 / PI2)) * (objj_msgSend(self, "maxValue") - minValue) + minValue;
    }
    else if (objj_msgSend(self, "isVertical"))
    {
        var knobHeight = (knobRect.size.height);
        trackRect.origin.y += knobHeight / 2;
        trackRect.size.height -= knobHeight;
        var minValue = objj_msgSend(self, "minValue");
        return MAX(0.0, MIN(1.0, (aPoint.y - (trackRect.origin.y)) / (trackRect.size.height))) * (objj_msgSend(self, "maxValue") - minValue) + minValue;
    }
    else
    {
        var knobWidth = (knobRect.size.width);
        trackRect.origin.x += knobWidth / 2;
        trackRect.size.width -= knobWidth;
        var minValue = objj_msgSend(self, "minValue");
        return MAX(0.0, MIN(1.0, (aPoint.x - (trackRect.origin.x)) / (trackRect.size.width))) * (objj_msgSend(self, "maxValue") - minValue) + minValue;
    }
}
}), new objj_method(sel_getUid("startTrackingAt:"), function(self, _cmd, aPoint)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        knobRect = objj_msgSend(self, "knobRectForBounds:", { origin: { x:bounds.origin.x, y:bounds.origin.y }, size: { width:bounds.size.width, height:bounds.size.height } });
    if ((aPoint.x >= (knobRect.origin.x) && aPoint.y >= (knobRect.origin.y) && aPoint.x < (knobRect.origin.x + knobRect.size.width) && aPoint.y < (knobRect.origin.y + knobRect.size.height)))
        _dragOffset = { width:(knobRect.origin.x + (knobRect.size.width) / 2.0) - aPoint.x, height:(knobRect.origin.y + (knobRect.size.height) / 2.0) - aPoint.y };
    else
    {
        var trackRect = objj_msgSend(self, "trackRectForBounds:", bounds);
        if (trackRect && (aPoint.x >= (trackRect.origin.x) && aPoint.y >= (trackRect.origin.y) && aPoint.x < (trackRect.origin.x + trackRect.size.width) && aPoint.y < (trackRect.origin.y + trackRect.size.height)))
        {
            _dragOffset = { width:0.0, height:0.0 };
            objj_msgSend(self, "setObjectValue:", objj_msgSend(self, "_valueAtPoint:", aPoint));
        }
        else
            return NO;
    }
    objj_msgSend(self, "setHighlighted:", YES);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
    return YES;
}
}), new objj_method(sel_getUid("continueTracking:at:"), function(self, _cmd, lastPoint, aPoint)
{ with(self)
{
    objj_msgSend(self, "setObjectValue:", objj_msgSend(self, "_valueAtPoint:", { x:aPoint.x + _dragOffset.width, y:aPoint.y + _dragOffset.height }));
    return YES;
}
}), new objj_method(sel_getUid("stopTracking:at:mouseIsUp:"), function(self, _cmd, lastPoint, aPoint, mouseIsUp)
{ with(self)
{
    objj_msgSend(self, "setHighlighted:", NO);
    if (objj_msgSend(_target, "respondsToSelector:", sel_getUid("sliderDidFinish:")))
        objj_msgSend(_target, "sliderDidFinish:", self);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("setContinuous:"), function(self, _cmd, flag)
{ with(self)
{
    if (flag)
        _sendActionOn |= CPLeftMouseDraggedMask;
    else
        _sendActionOn &= ~CPLeftMouseDraggedMask;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "slider";
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [objj_msgSend(CPNull, "null"), { width:0.0, height:0.0 }, 0.0, objj_msgSend(CPNull, "null")], ["knob-color", "knob-size", "track-width", "track-color"]);
}
})]);
}
var CPSliderMinValueKey = "CPSliderMinValueKey",
    CPSliderMaxValueKey = "CPSliderMaxValueKey",
    CPSliderAltIncrValueKey = "CPSliderAltIncrValueKey";
{
var the_class = objj_getClass("CPSlider")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPSlider\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    _minValue = objj_msgSend(aCoder, "decodeDoubleForKey:", CPSliderMinValueKey);
    _maxValue = objj_msgSend(aCoder, "decodeDoubleForKey:", CPSliderMaxValueKey);
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _altIncrementValue = objj_msgSend(aCoder, "decodeDoubleForKey:", CPSliderAltIncrValueKey);
        objj_msgSend(self, "setContinuous:", YES);
        objj_msgSend(self, "_recalculateIsVertical");
        objj_msgSend(self, "setNeedsLayout");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSlider").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeDouble:forKey:", _minValue, CPSliderMinValueKey);
    objj_msgSend(aCoder, "encodeDouble:forKey:", _maxValue, CPSliderMaxValueKey);
    objj_msgSend(aCoder, "encodeDouble:forKey:", _altIncrementValue, CPSliderAltIncrValueKey);
}
})]);
}
{
var the_class = objj_getClass("CPSlider")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPSlider\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("value"), function(self, _cmd)
{ with(self)
{
    CPLog.warn("[CPSlider value] is deprecated, use doubleValue or objectValue instead.");
    return objj_msgSend(self, "doubleValue");
}
}), new objj_method(sel_getUid("setValue:"), function(self, _cmd, aValue)
{ with(self)
{
    CPLog.warn("[CPSlider setValue:] is deprecated, use setDoubleValue: or setObjectValue: instead.");
    objj_msgSend(self, "setObjectValue:", aValue);
}
})]);
}

p;21;CPSliderColorPicker.jt;16803;@STATIC;1.0;i;15;CPColorPicker.jt;16763;objj_executeFile("CPColorPicker.j", true);
{var the_class = objj_allocateClassPair(CPColorPicker, "CPSliderColorPicker"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_contentView"), new objj_ivar("_redSlider"), new objj_ivar("_greenSlider"), new objj_ivar("_blueSlider"), new objj_ivar("_hueSlider"), new objj_ivar("_saturationSlider"), new objj_ivar("_brightnessSlider"), new objj_ivar("_rgbLabel"), new objj_ivar("_hsbLabel"), new objj_ivar("_redLabel"), new objj_ivar("_greenLabel"), new objj_ivar("_blueLabel"), new objj_ivar("_hueLabel"), new objj_ivar("_saturationLabel"), new objj_ivar("_brightnessLabel"), new objj_ivar("_hexLabel"), new objj_ivar("_redValue"), new objj_ivar("_greenValue"), new objj_ivar("_blueValue"), new objj_ivar("_hueValue"), new objj_ivar("_saturationValue"), new objj_ivar("_brightnessValue"), new objj_ivar("_hexValue")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithPickerMask:colorPanel:"), function(self, _cmd, mask, owningColorPanel)
{ with(self)
{
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSliderColorPicker").super_class }, "initWithPickerMask:colorPanel:", mask,  owningColorPanel);
}
}), new objj_method(sel_getUid("initView"), function(self, _cmd)
{ with(self)
{
    aFrame = CPRectMake(0, 0, CPColorPickerViewWidth, CPColorPickerViewHeight);
    _contentView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", aFrame);
    objj_msgSend(_contentView, "setAutoresizingMask:", CPViewWidthSizable|CPViewHeightSizable);
    _rgbLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 10, 100, 20));
    objj_msgSend(_rgbLabel, "setStringValue:",  "Red, Green, Blue");
    objj_msgSend(_rgbLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _redLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 35, 15, 20));
    objj_msgSend(_redLabel, "setStringValue:",  "R");
    objj_msgSend(_redLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _redSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:",  CPRectMake(15, 35, aFrame.size.width - 70, 20));
    objj_msgSend(_redSlider, "setMaxValue:",  1.0);
    objj_msgSend(_redSlider, "setMinValue:",  0.0);
    objj_msgSend(_redSlider, "setTarget:",  self);
    objj_msgSend(_redSlider, "setAction:",  sel_getUid("sliderChanged:"));
    objj_msgSend(_redSlider, "setAutoresizingMask:",  CPViewWidthSizable);
    var updateFunction = function(aDOMEvent)
    {
        if(isNaN(this.value))
            return;
        switch(this)
        {
            case _redValue: objj_msgSend(_redSlider, "setFloatValue:", MAX(MIN(ROUND(this.value), 255) / 255.0, 0));
                                   break;
            case _greenValue: objj_msgSend(_greenSlider, "setFloatValue:", MAX(MIN(ROUND(this.value), 255) / 255.0, 0));
                                   break;
            case _blueValue: objj_msgSend(_blueSlider, "setFloatValue:", MAX(MIN(ROUND(this.value), 255) / 255.0, 0));
                                   break;
            case _hueValue: objj_msgSend(_hueSlider, "setFloatValue:", MAX(MIN(ROUND(this.value), 360), 0));
                                   break;
            case _saturationValue: objj_msgSend(_saturationSlider, "setFloatValue:", MAX(MIN(ROUND(this.value), 100), 0));
                                   break;
            case _brightnessValue: objj_msgSend(_brightnessSlider, "setFloatValue:", MAX(MIN(ROUND(this.value), 100), 0));
                                   break;
        }
        this.blur();
    };
    var keypressFunction = function(aDOMEvent)
    {
        aDOMEvent = aDOMEvent || window.event;
        if (aDOMEvent.keyCode == 13)
        {
            updateFunction(aDOMEvent);
            if(aDOMEvent.preventDefault)
                aDOMEvent.preventDefault();
            else if(aDOMEvent.stopPropagation)
                aDOMEvent.stopPropagation();
        }
    }
    var redValue = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(aFrame.size.width - 45, 35, 45, 20));
    objj_msgSend(redValue, "setAutoresizingMask:",  CPViewMinXMargin);
    _redValue = document.createElement("input");
    _redValue.style.width = "40px";
    _redValue.style.backgroundColor = "transparent";
    _redValue.style.border = "1px solid black";
    _redValue.style.color = "black";
    _redValue.style.position = "absolute";
    _redValue.style.top = "0px";
    _redValue.style.left = "0px";
    _redValue.onchange = updateFunction;
    redValue._DOMElement.appendChild(_redValue);
    objj_msgSend(_contentView, "addSubview:",  redValue);
    _greenLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 58, 15, 20));
    objj_msgSend(_greenLabel, "setStringValue:",  "G");
    objj_msgSend(_greenLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _greenSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:",  CPRectMake(15, 58, aFrame.size.width - 70, 20));
    objj_msgSend(_greenSlider, "setMaxValue:",  1.0);
    objj_msgSend(_greenSlider, "setMinValue:",  0.0);
    objj_msgSend(_greenSlider, "setTarget:",  self);
    objj_msgSend(_greenSlider, "setAction:",  sel_getUid("sliderChanged:"));
    objj_msgSend(_greenSlider, "setAutoresizingMask:",  CPViewWidthSizable);
    var greenValue = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(aFrame.size.width - 45, 58, 45, 20));
    objj_msgSend(greenValue, "setAutoresizingMask:",  CPViewMinXMargin);
    _greenValue = _redValue.cloneNode(false);
    _greenValue.onchange = updateFunction;
    greenValue._DOMElement.appendChild(_greenValue);
    objj_msgSend(_contentView, "addSubview:",  greenValue);
    _blueLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 81, 15, 20));
    objj_msgSend(_blueLabel, "setStringValue:",  "B");
    objj_msgSend(_blueLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _blueSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:",  CPRectMake(15, 81, aFrame.size.width - 70, 20));
    objj_msgSend(_blueSlider, "setMaxValue:",  1.0);
    objj_msgSend(_blueSlider, "setMinValue:",  0.0);
    objj_msgSend(_blueSlider, "setTarget:",  self);
    objj_msgSend(_blueSlider, "setAction:",  sel_getUid("sliderChanged:"));
    objj_msgSend(_blueSlider, "setAutoresizingMask:",  CPViewWidthSizable);
    var blueValue = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(aFrame.size.width - 45, 81, 45, 20));
    objj_msgSend(blueValue, "setAutoresizingMask:",  CPViewMinXMargin);
    _blueValue = _redValue.cloneNode(false);
    _blueValue.onchange = updateFunction;
    blueValue._DOMElement.appendChild(_blueValue);
    objj_msgSend(_contentView, "addSubview:",  blueValue);
    _hsbLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 120, 190, 20));
    objj_msgSend(_hsbLabel, "setStringValue:",  "Hue, Saturation, Brightness");
    objj_msgSend(_hsbLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _hueLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 145, 15, 20));
    objj_msgSend(_hueLabel, "setStringValue:",  "H");
    objj_msgSend(_hueLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _hueSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:",  CPRectMake(15, 145, aFrame.size.width - 70, 20));
    objj_msgSend(_hueSlider, "setMaxValue:",  359.0);
    objj_msgSend(_hueSlider, "setMinValue:",  0.0);
    objj_msgSend(_hueSlider, "setTarget:",  self);
    objj_msgSend(_hueSlider, "setAction:",  sel_getUid("sliderChanged:"));
    objj_msgSend(_hueSlider, "setAutoresizingMask:",  CPViewWidthSizable);
    var hueValue = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(aFrame.size.width - 45, 145, 45, 20));
    objj_msgSend(hueValue, "setAutoresizingMask:",  CPViewMinXMargin);
    _hueValue = _redValue.cloneNode(false);
    _hueValue.onchange = updateFunction;
    hueValue._DOMElement.appendChild(_hueValue);
    objj_msgSend(_contentView, "addSubview:",  hueValue);
    _saturationLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 168, 15, 20));
    objj_msgSend(_saturationLabel, "setStringValue:",  "S");
    objj_msgSend(_saturationLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _saturationSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:",  CPRectMake(15, 168, aFrame.size.width - 70, 20));
    objj_msgSend(_saturationSlider, "setMaxValue:",  100.0);
    objj_msgSend(_saturationSlider, "setMinValue:",  0.0);
    objj_msgSend(_saturationSlider, "setTarget:",  self);
    objj_msgSend(_saturationSlider, "setAction:",  sel_getUid("sliderChanged:"));
    objj_msgSend(_saturationSlider, "setAutoresizingMask:",  CPViewWidthSizable);
    var saturationValue = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(aFrame.size.width - 45, 168, 45, 20));
    objj_msgSend(saturationValue, "setAutoresizingMask:",  CPViewMinXMargin);
    _saturationValue = _redValue.cloneNode(false);
    _saturationValue.onchange = updateFunction;
    saturationValue._DOMElement.appendChild(_saturationValue);
    objj_msgSend(_contentView, "addSubview:",  saturationValue);
    _brightnessLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 191, 15, 20));
    objj_msgSend(_brightnessLabel, "setStringValue:",  "B");
    objj_msgSend(_brightnessLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _brightnessSlider = objj_msgSend(objj_msgSend(CPSlider, "alloc"), "initWithFrame:",  CPRectMake(15, 191, aFrame.size.width - 70, 20));
    objj_msgSend(_brightnessSlider, "setMaxValue:",  100.0);
    objj_msgSend(_brightnessSlider, "setMinValue:",  0.0);
    objj_msgSend(_brightnessSlider, "setTarget:",  self);
    objj_msgSend(_brightnessSlider, "setAction:",  sel_getUid("sliderChanged:"));
    objj_msgSend(_brightnessSlider, "setAutoresizingMask:",  CPViewWidthSizable);
    var brightnessValue = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:",  CPRectMake(aFrame.size.width - 45, 191, 45, 20));
    objj_msgSend(brightnessValue, "setAutoresizingMask:",  CPViewMinXMargin);
    _brightnessValue = _redValue.cloneNode(false);
    _brightnessValue.onchange = updateFunction;
    brightnessValue._DOMElement.appendChild(_brightnessValue);
    objj_msgSend(_contentView, "addSubview:",  brightnessValue);
    _hexLabel = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:",  CPRectMake(0, 230, 30, 20));
    objj_msgSend(_hexLabel, "setStringValue:",  "Hex");
    objj_msgSend(_hexLabel, "setTextColor:", objj_msgSend(CPColor, "blackColor"));
    _hexValue = _redValue.cloneNode(false);
    _hexValue.style.top = "228px";
    _hexValue.style.width = "80px";
    _hexValue.style.left = "35px";
    _hexValue.onkeypress = function(aDOMEvent)
    {
        aDOMEvent = aDOMEvent || window.event;
        if (aDOMEvent.keyCode == 13)
        {
            var newColor = objj_msgSend(CPColor, "colorWithHexString:",  this.value);
            if(newColor)
            {
                objj_msgSend(self, "setColor:",  newColor);
                objj_msgSend(objj_msgSend(self, "colorPanel"), "setColor:",  newColor);
            }
            if(aDOMEvent.preventDefault)
                aDOMEvent.preventDefault();
            else if(aDOMEvent.stopPropagation)
                aDOMEvent.stopPropagation();
            this.blur();
        }
    };
    _contentView._DOMElement.appendChild(_hexValue);
    objj_msgSend(_contentView, "addSubview:",  _rgbLabel);
    objj_msgSend(_contentView, "addSubview:",  _redLabel);
    objj_msgSend(_contentView, "addSubview:",  _greenLabel);
    objj_msgSend(_contentView, "addSubview:",  _blueLabel);
    objj_msgSend(_contentView, "addSubview:",  _redSlider);
    objj_msgSend(_contentView, "addSubview:",  _greenSlider);
    objj_msgSend(_contentView, "addSubview:",  _blueSlider);
    objj_msgSend(_contentView, "addSubview:",  _hsbLabel);
    objj_msgSend(_contentView, "addSubview:",  _hueLabel);
    objj_msgSend(_contentView, "addSubview:",  _saturationLabel);
    objj_msgSend(_contentView, "addSubview:",  _brightnessLabel);
    objj_msgSend(_contentView, "addSubview:",  _hueSlider);
    objj_msgSend(_contentView, "addSubview:",  _saturationSlider);
    objj_msgSend(_contentView, "addSubview:",  _brightnessSlider);
    objj_msgSend(_contentView, "addSubview:",  _hexLabel);
}
}), new objj_method(sel_getUid("provideNewView:"), function(self, _cmd, initialRequest)
{ with(self)
{
    if (initialRequest)
        objj_msgSend(self, "initView");
    return _contentView;
}
}), new objj_method(sel_getUid("currentMode"), function(self, _cmd)
{ with(self)
{
    return CPSliderColorPickerMode;
}
}), new objj_method(sel_getUid("supportsMode:"), function(self, _cmd, mode)
{ with(self)
{
    return (mode == CPSliderColorPickerMode) ? YES : NO;
}
}), new objj_method(sel_getUid("sliderChanged:"), function(self, _cmd, sender)
{ with(self)
{
    var newColor,
        colorPanel = objj_msgSend(self, "colorPanel"),
        alpha = objj_msgSend(colorPanel, "opacity");
    switch(sender)
    {
        case _hueSlider:
        case _saturationSlider:
        case _brightnessSlider: newColor = objj_msgSend(CPColor, "colorWithHue:saturation:brightness:alpha:",  objj_msgSend(_hueSlider, "floatValue"),  objj_msgSend(_saturationSlider, "floatValue"),  objj_msgSend(_brightnessSlider, "floatValue"),  alpha);
                                        objj_msgSend(self, "updateRGBSliders:",  newColor);
                                        break;
        case _redSlider:
        case _greenSlider:
        case _blueSlider: newColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:",  objj_msgSend(_redSlider, "floatValue"),  objj_msgSend(_greenSlider, "floatValue"),  objj_msgSend(_blueSlider, "floatValue"),  alpha);
                                        objj_msgSend(self, "updateHSBSliders:",  newColor);
                                        break;
    }
    objj_msgSend(self, "updateLabels");
    objj_msgSend(self, "updateHex:",  newColor);
    objj_msgSend(colorPanel, "setColor:",  newColor);
}
}), new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    objj_msgSend(self, "updateRGBSliders:",  aColor);
    objj_msgSend(self, "updateHSBSliders:",  aColor);
    objj_msgSend(self, "updateHex:",  aColor);
    objj_msgSend(self, "updateLabels");
}
}), new objj_method(sel_getUid("updateHSBSliders:"), function(self, _cmd, aColor)
{ with(self)
{
    var hsb = objj_msgSend(aColor, "hsbComponents");
    objj_msgSend(_hueSlider, "setFloatValue:", hsb[0]);
    objj_msgSend(_saturationSlider, "setFloatValue:", hsb[1]);
    objj_msgSend(_brightnessSlider, "setFloatValue:", hsb[2]);
}
}), new objj_method(sel_getUid("updateHex:"), function(self, _cmd, aColor)
{ with(self)
{
    _hexValue.value = objj_msgSend(aColor, "hexString");
}
}), new objj_method(sel_getUid("updateRGBSliders:"), function(self, _cmd, aColor)
{ with(self)
{
    var rgb = objj_msgSend(aColor, "components");
    objj_msgSend(_redSlider, "setFloatValue:", rgb[0]);
    objj_msgSend(_greenSlider, "setFloatValue:", rgb[1]);
    objj_msgSend(_blueSlider, "setFloatValue:", rgb[2]);
}
}), new objj_method(sel_getUid("updateLabels"), function(self, _cmd)
{ with(self)
{
    _hueValue.value = ROUND(objj_msgSend(_hueSlider, "floatValue"));
    _saturationValue.value = ROUND(objj_msgSend(_saturationSlider, "floatValue"));
    _brightnessValue.value = ROUND(objj_msgSend(_brightnessSlider, "floatValue"));
    _redValue.value = ROUND(objj_msgSend(_redSlider, "floatValue") * 255);
    _greenValue.value = ROUND(objj_msgSend(_greenSlider, "floatValue") * 255);
    _blueValue.value = ROUND(objj_msgSend(_blueSlider, "floatValue") * 255);
}
}), new objj_method(sel_getUid("provideNewButtonImage"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", CPColorPicker), "pathForResource:", "slider_button.png"), CGSizeMake(32, 32));
}
}), new objj_method(sel_getUid("provideNewAlternateButtonImage"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", CPColorPicker), "pathForResource:", "slider_button_h.png"), CGSizeMake(32, 32));
}
})]);
}

p;13;CPSplitView.jt;23542;@STATIC;1.0;i;9;CPImage.ji;8;CPView.jt;23497;objj_executeFile("CPImage.j", true);
objj_executeFile("CPView.j", true);
CPSplitViewDidResizeSubviewsNotification = "CPSplitViewDidResizeSubviewsNotification";
CPSplitViewWillResizeSubviewsNotification = "CPSplitViewWillResizeSubviewsNotification";
var CPSplitViewHorizontalImage = nil,
    CPSplitViewVerticalImage = nil;
{var the_class = objj_allocateClassPair(CPView, "CPSplitView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_delegate"), new objj_ivar("_isVertical"), new objj_ivar("_isPaneSplitter"), new objj_ivar("_currentDivider"), new objj_ivar("_initialOffset"), new objj_ivar("_originComponent"), new objj_ivar("_sizeComponent"), new objj_ivar("_DOMDividerElements"), new objj_ivar("_dividerImagePath"), new objj_ivar("_drawingDivider"), new objj_ivar("_needsResizeSubviews")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSplitView").super_class }, "initWithFrame:", aFrame))
    {
        _currentDivider = CPNotFound;
        _DOMDividerElements = [];
        objj_msgSend(self, "_setVertical:", YES);
    }
    return self;
}
}), new objj_method(sel_getUid("dividerThickness"), function(self, _cmd)
{ with(self)
{
    return _isPaneSplitter ? 1.0 : 10.0;
}
}), new objj_method(sel_getUid("isVertical"), function(self, _cmd)
{ with(self)
{
    return _isVertical;
}
}), new objj_method(sel_getUid("setVertical:"), function(self, _cmd, shouldBeVertical)
{ with(self)
{
    if (!objj_msgSend(self, "_setVertical:", shouldBeVertical))
        return;
    var frame = objj_msgSend(self, "frame"),
        dividerThickness = objj_msgSend(self, "dividerThickness");
    objj_msgSend(self, "_postNotificationWillResize");
    var eachSize = ROUND((frame.size[_sizeComponent] - dividerThickness * (_subviews.length - 1)) / _subviews.length),
        index = 0,
        count = _subviews.length;
    if (objj_msgSend(self, "isVertical"))
        for (; index < count; ++index)
            objj_msgSend(_subviews[index], "setFrame:", CGRectMake(ROUND((eachSize + dividerThickness) * index), 0, eachSize, frame.size.height));
    else
        for (; index < count; ++index)
            objj_msgSend(_subviews[index], "setFrame:", CGRectMake(0, ROUND((eachSize + dividerThickness) * index), frame.size.width, eachSize));
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "_postNotificationDidResize");
}
}), new objj_method(sel_getUid("_setVertical:"), function(self, _cmd, shouldBeVertical)
{ with(self)
{
    var changed = (_isVertical != shouldBeVertical);
    _isVertical = shouldBeVertical;
    _originComponent = objj_msgSend(self, "isVertical") ? "x" : "y";
    _sizeComponent = objj_msgSend(self, "isVertical") ? "width" : "height";
    _dividerImagePath = objj_msgSend(self, "isVertical") ? objj_msgSend(CPSplitViewVerticalImage, "filename") : objj_msgSend(CPSplitViewHorizontalImage, "filename");
    return changed;
}
}), new objj_method(sel_getUid("isPaneSplitter"), function(self, _cmd)
{ with(self)
{
    return _isPaneSplitter;
}
}), new objj_method(sel_getUid("setIsPaneSplitter:"), function(self, _cmd, shouldBePaneSplitter)
{ with(self)
{
    if (_isPaneSplitter == shouldBePaneSplitter)
        return;
    _isPaneSplitter = shouldBePaneSplitter;
    if(_DOMDividerElements[_drawingDivider])
        objj_msgSend(self, "_setupDOMDivider")
    _needsResizeSubviews = YES;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("didAddSubview:"), function(self, _cmd, aSubview)
{ with(self)
{
    _needsResizeSubviews = YES;
}
}), new objj_method(sel_getUid("isSubviewCollapsed:"), function(self, _cmd, subview)
{ with(self)
{
    return objj_msgSend(subview, "frame").size[_sizeComponent] < 1 ? YES : NO;
}
}), new objj_method(sel_getUid("rectOfDividerAtIndex:"), function(self, _cmd, aDivider)
{ with(self)
{
    var frame = objj_msgSend(_subviews[aDivider], "frame"),
        rect = CGRectMakeZero();
    rect.size = objj_msgSend(self, "frame").size;
    rect.size[_sizeComponent] = objj_msgSend(self, "dividerThickness");
    rect.origin[_originComponent] = frame.origin[_originComponent] + frame.size[_sizeComponent];
    return rect;
}
}), new objj_method(sel_getUid("effectiveRectOfDividerAtIndex:"), function(self, _cmd, aDivider)
{ with(self)
{
    var realRect = objj_msgSend(self, "rectOfDividerAtIndex:", aDivider);
    var padding = 2;
    realRect.size[_sizeComponent] += padding * 2;
    realRect.origin[_originComponent] -= padding;
    return realRect;
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, rect)
{ with(self)
{
    var count = objj_msgSend(_subviews, "count") - 1;
    while ((count--) > 0)
    {
        _drawingDivider = count;
        objj_msgSend(self, "drawDividerInRect:", objj_msgSend(self, "rectOfDividerAtIndex:", count));
    }
}
}), new objj_method(sel_getUid("drawDividerInRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if (!_DOMDividerElements[_drawingDivider])
    {
        _DOMDividerElements[_drawingDivider] = document.createElement("div");
        _DOMDividerElements[_drawingDivider].style.cursor = "move";
        _DOMDividerElements[_drawingDivider].style.position = "absolute";
        _DOMDividerElements[_drawingDivider].style.backgroundRepeat = "repeat";
        _DOMElement.appendChild(_DOMDividerElements[_drawingDivider]);
        objj_msgSend(self, "_setupDOMDivider");
    }
    if (NULL) var ____p = _CGPointApplyAffineTransform(CGPointMake((aRect.origin.x), (aRect.origin.y)), NULL); else var ____p = { x:(aRect.origin.x), y:(aRect.origin.y) }; _DOMDividerElements[_drawingDivider].style.left = ROUND(____p.x) + "px";_DOMDividerElements[_drawingDivider].style.top = ROUND(____p.y) + "px";;
    _DOMDividerElements[_drawingDivider].style.width = MAX(0.0, ROUND((aRect.size.width))) + "px"; _DOMDividerElements[_drawingDivider].style.height = MAX(0.0, ROUND((aRect.size.height))) + "px";;
}
}), new objj_method(sel_getUid("_setupDOMDivider"), function(self, _cmd)
{ with(self)
{
    if (_isPaneSplitter)
    {
        _DOMDividerElements[_drawingDivider].style.backgroundColor = "#A5A5A5";
        _DOMDividerElements[_drawingDivider].style.backgroundImage = "";
    }
    else
    {
        _DOMDividerElements[_drawingDivider].style.backgroundColor = "";
        _DOMDividerElements[_drawingDivider].style.backgroundImage = "url('"+_dividerImagePath+"')";
    }
}
}), new objj_method(sel_getUid("viewWillDraw"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_adjustSubviewsWithCalculatedSize");
}
}), new objj_method(sel_getUid("_adjustSubviewsWithCalculatedSize"), function(self, _cmd)
{ with(self)
{
    if (!_needsResizeSubviews)
        return;
    _needsResizeSubviews = NO;
    var subviews = objj_msgSend(self, "subviews"),
        count = subviews.length,
        oldSize = CGSizeMakeZero();
    if (objj_msgSend(self, "isVertical"))
    {
        oldSize.width += objj_msgSend(self, "dividerThickness") * (count - 1);
        oldSize.height = CGRectGetHeight(objj_msgSend(self, "frame"));
    }
    else
    {
        oldSize.width = CGRectGetWidth(objj_msgSend(self, "frame"));
        oldSize.height += objj_msgSend(self, "dividerThickness") * (count - 1);
    }
    while (count--)
        oldSize[_sizeComponent] += objj_msgSend(subviews[count], "frame").size[_sizeComponent];
    objj_msgSend(self, "resizeSubviewsWithOldSize:", oldSize);
}
}), new objj_method(sel_getUid("cursorAtPoint:hitDividerAtIndex:"), function(self, _cmd, aPoint, anIndex)
{ with(self)
{
    var frame = objj_msgSend(_subviews[anIndex], "frame"),
        startPosition = frame.origin[_originComponent] + frame.size[_sizeComponent],
        effectiveRect = objj_msgSend(self, "effectiveRectOfDividerAtIndex:", anIndex),
        additionalRect = null;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:effectiveRect:forDrawnRect:ofDividerAtIndex:")))
        effectiveRect = objj_msgSend(_delegate, "splitView:effectiveRect:forDrawnRect:ofDividerAtIndex:", self, effectiveRect, effectiveRect, anIndex);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:additionalEffectiveRectOfDividerAtIndex:")))
        additionalRect = objj_msgSend(_delegate, "splitView:additionalEffectiveRectOfDividerAtIndex:", self, anIndex);
    return CGRectContainsPoint(effectiveRect, aPoint) || (additionalRect && CGRectContainsPoint(additionalRect, aPoint));
}
}), new objj_method(sel_getUid("hitTest:"), function(self, _cmd, aPoint)
{ with(self)
{
    if (objj_msgSend(self, "isHidden") || !objj_msgSend(self, "hitTests") || !CGRectContainsPoint(objj_msgSend(self, "frame"), aPoint))
        return nil;
    var point = objj_msgSend(self, "convertPoint:fromView:", aPoint, objj_msgSend(self, "superview"));
    var count = objj_msgSend(_subviews, "count") - 1;
    for (var i = 0; i < count; i++)
    {
        if (objj_msgSend(self, "cursorAtPoint:hitDividerAtIndex:", point, i))
            return self;
    }
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSplitView").super_class }, "hitTest:", aPoint);
}
}), new objj_method(sel_getUid("trackDivider:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type");
    if (type == CPLeftMouseUp)
    {
        if (_currentDivider != CPNotFound)
        {
            _currentDivider = CPNotFound;
            objj_msgSend(self, "_postNotificationDidResize");
        }
        return;
    }
    if (type == CPLeftMouseDown)
    {
        var point = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
        _currentDivider = CPNotFound;
        var count = objj_msgSend(_subviews, "count") - 1;
        for (var i = 0; i < count; i++)
        {
            var frame = objj_msgSend(_subviews[i], "frame"),
                startPosition = frame.origin[_originComponent] + frame.size[_sizeComponent];
            if (objj_msgSend(self, "cursorAtPoint:hitDividerAtIndex:", point, i))
            {
                if (objj_msgSend(anEvent, "clickCount") == 2 &&
                    objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:canCollapseSubview:")) &&
                    objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:shouldCollapseSubview:forDoubleClickOnDividerAtIndex:")))
                {
                    var minPosition = objj_msgSend(self, "minPossiblePositionOfDividerAtIndex:", i),
                        maxPosition = objj_msgSend(self, "maxPossiblePositionOfDividerAtIndex:", i);
                    if (objj_msgSend(_delegate, "splitView:canCollapseSubview:", self, _subviews[i]) && objj_msgSend(_delegate, "splitView:shouldCollapseSubview:forDoubleClickOnDividerAtIndex:", self, _subviews[i], i))
                    {
                        if (objj_msgSend(self, "isSubviewCollapsed:", _subviews[i]))
                            objj_msgSend(self, "setPosition:ofDividerAtIndex:", (minPosition + (maxPosition - minPosition) / 2), i);
                        else
                            objj_msgSend(self, "setPosition:ofDividerAtIndex:", minPosition, i);
                    }
                    else if (objj_msgSend(_delegate, "splitView:canCollapseSubview:", self, _subviews[i+1]) && objj_msgSend(_delegate, "splitView:shouldCollapseSubview:forDoubleClickOnDividerAtIndex:", self, _subviews[i+1], i))
                    {
                        if (objj_msgSend(self, "isSubviewCollapsed:", _subviews[i+1]))
                            objj_msgSend(self, "setPosition:ofDividerAtIndex:", (minPosition + (maxPosition - minPosition) / 2), i);
                        else
                            objj_msgSend(self, "setPosition:ofDividerAtIndex:", maxPosition, i);
                    }
                }
                else
                {
                    _currentDivider = i;
                    _initialOffset = startPosition - point[_originComponent];
                    objj_msgSend(self, "_postNotificationWillResize");
                }
            }
        }
        if (_currentDivider === CPNotFound)
            return;
    }
    else if (type == CPLeftMouseDragged && _currentDivider != CPNotFound)
    {
        var point = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil);
        objj_msgSend(self, "setPosition:ofDividerAtIndex:", (point[_originComponent] + _initialOffset), _currentDivider);
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackDivider:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "trackDivider:", anEvent);
}
}), new objj_method(sel_getUid("maxPossiblePositionOfDividerAtIndex:"), function(self, _cmd, dividerIndex)
{ with(self)
{
    var frame = objj_msgSend(_subviews[dividerIndex + 1], "frame");
    if (dividerIndex + 1 < objj_msgSend(_subviews, "count") - 1)
        return frame.origin[_originComponent] + frame.size[_sizeComponent] - objj_msgSend(self, "dividerThickness");
    else
        return objj_msgSend(self, "frame").size[_sizeComponent] - objj_msgSend(self, "dividerThickness");
}
}), new objj_method(sel_getUid("minPossiblePositionOfDividerAtIndex:"), function(self, _cmd, dividerIndex)
{ with(self)
{
    if (dividerIndex > 0)
    {
        var frame = objj_msgSend(_subviews[dividerIndex - 1], "frame");
        return frame.origin[_originComponent] + frame.size[_sizeComponent] + objj_msgSend(self, "dividerThickness");
    }
    else
        return 0;
}
}), new objj_method(sel_getUid("setPosition:ofDividerAtIndex:"), function(self, _cmd, position, dividerIndex)
{ with(self)
{
    objj_msgSend(self, "_adjustSubviewsWithCalculatedSize");
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:constrainSplitPosition:ofSubviewAt:")))
        position = objj_msgSend(_delegate, "splitView:constrainSplitPosition:ofSubviewAt:", self, position, dividerIndex);
    var proposedMax = objj_msgSend(self, "maxPossiblePositionOfDividerAtIndex:", dividerIndex),
        proposedMin = objj_msgSend(self, "minPossiblePositionOfDividerAtIndex:", dividerIndex),
        actualMax = proposedMax,
        actualMin = proposedMin;
    if(objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:constrainMinCoordinate:ofSubviewAt:")))
        actualMin = objj_msgSend(_delegate, "splitView:constrainMinCoordinate:ofSubviewAt:", self, proposedMin, dividerIndex);
    if(objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:constrainMaxCoordinate:ofSubviewAt:")))
        actualMax = objj_msgSend(_delegate, "splitView:constrainMaxCoordinate:ofSubviewAt:", self, proposedMax, dividerIndex);
    var frame = objj_msgSend(self, "frame"),
        viewA = _subviews[dividerIndex],
        frameA = objj_msgSend(viewA, "frame"),
        viewB = _subviews[dividerIndex + 1],
        frameB = objj_msgSend(viewB, "frame");
    var realPosition = MAX(MIN(position, actualMax), actualMin);
    if (position < proposedMin + (actualMin - proposedMin) / 2)
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:canCollapseSubview:")))
            if (objj_msgSend(_delegate, "splitView:canCollapseSubview:", self, viewA))
                realPosition = proposedMin;
    frameA.size[_sizeComponent] = realPosition - frameA.origin[_originComponent];
    objj_msgSend(_subviews[dividerIndex], "setFrame:", frameA);
    frameB.size[_sizeComponent] = frameB.origin[_originComponent] + frameB.size[_sizeComponent] - realPosition - objj_msgSend(self, "dividerThickness");
    frameB.origin[_originComponent] = realPosition + objj_msgSend(self, "dividerThickness");
    objj_msgSend(_subviews[dividerIndex + 1], "setFrame:", frameB);
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSend(self, "_adjustSubviewsWithCalculatedSize");
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSplitView").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, oldSize)
{ with(self)
{
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitView:resizeSubviewsWithOldSize:")))
    {
        objj_msgSend(_delegate, "splitView:resizeSubviewsWithOldSize:", self, oldSize);
        return;
    }
    objj_msgSend(self, "_postNotificationWillResize");
    var index = 0,
        count = objj_msgSend(_subviews, "count"),
        bounds = objj_msgSend(self, "bounds"),
        dividerThickness = objj_msgSend(self, "dividerThickness"),
        totalDividers = count - 1,
        totalSizableSpace = 0,
        nonSizableSpace = 0,
        lastSizableIndex = -1,
        totalSizablePanes = 0,
        isVertical = objj_msgSend(self, "isVertical");
    for (index = 0; index < count; ++index)
    {
        var view = _subviews[index],
            isSizable = isVertical ? objj_msgSend(view, "autoresizingMask") & CPViewWidthSizable : objj_msgSend(view, "autoresizingMask") & CPViewHeightSizable;
        if (isSizable)
        {
            totalSizableSpace += objj_msgSend(view, "frame").size[_sizeComponent];
            lastSizableIndex = index;
            totalSizablePanes++;
        }
    }
    if (totalSizablePanes === count)
        totalSizableSpace = 0;
    var nonSizableSpace = totalSizableSpace ? bounds.size[_sizeComponent] - totalSizableSpace : 0,
        remainingFlexibleSpace = bounds.size[_sizeComponent] - oldSize[_sizeComponent],
        oldDimension = (oldSize[_sizeComponent]- totalDividers*dividerThickness - nonSizableSpace),
        ratio = oldDimension <= 0 ? 0 : (bounds.size[_sizeComponent] - totalDividers*dividerThickness - nonSizableSpace) / oldDimension;
    for (index = 0; index < count; ++index)
    {
        var view = _subviews[index],
            viewFrame = CGRectMakeCopy(bounds),
            isSizable = isVertical ? objj_msgSend(view, "autoresizingMask") & CPViewWidthSizable : objj_msgSend(view, "autoresizingMask") & CPViewHeightSizable;
            if (index + 1 == count)
                viewFrame.size[_sizeComponent] = bounds.size[_sizeComponent] - viewFrame.origin[_originComponent];
            else if (totalSizableSpace && isSizable && lastSizableIndex === index)
                viewFrame.size[_sizeComponent] = MAX(0, ROUND(objj_msgSend(view, "frame").size[_sizeComponent] + remainingFlexibleSpace))
            else if (isSizable || !totalSizableSpace)
            {
                viewFrame.size[_sizeComponent] = MAX(0, ROUND(ratio * objj_msgSend(view, "frame").size[_sizeComponent]));
                remainingFlexibleSpace -= (viewFrame.size[_sizeComponent] - objj_msgSend(view, "frame").size[_sizeComponent]);
            }
            else if (totalSizableSpace && !isSizable)
                viewFrame.size[_sizeComponent] = objj_msgSend(view, "frame").size[_sizeComponent];
        bounds.origin[_originComponent] += viewFrame.size[_sizeComponent] + dividerThickness;
        objj_msgSend(view, "setFrame:", viewFrame);
    }
    objj_msgSend(self, "_postNotificationDidResize");
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, delegate)
{ with(self)
{
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitViewDidResizeSubviews:")))
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "removeObserver:name:object:", _delegate, CPSplitViewDidResizeSubviewsNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitViewWillResizeSubviews:")))
        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "removeObserver:name:object:", _delegate, CPSplitViewWillResizeSubviewsNotification, self);
   _delegate = delegate;
   if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitViewDidResizeSubviews:")))
       objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "addObserver:selector:name:object:", _delegate, sel_getUid("splitViewDidResizeSubviews:"), CPSplitViewDidResizeSubviewsNotification, self);
   if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("splitViewWillResizeSubviews:")))
       objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "addObserver:selector:name:object:", _delegate, sel_getUid("splitViewWillResizeSubviews:"), CPSplitViewWillResizeSubviewsNotification, self);
}
}), new objj_method(sel_getUid("_postNotificationWillResize"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPSplitViewWillResizeSubviewsNotification, self);
}
}), new objj_method(sel_getUid("_postNotificationDidResize"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPSplitViewDidResizeSubviewsNotification, self);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPSplitView, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    CPSplitViewHorizontalImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPSplitView/CPSplitViewHorizontal.png"), CPSizeMake(5.0, 10.0));
    CPSplitViewVerticalImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPSplitView/CPSplitViewVertical.png"), CPSizeMake(10.0, 5.0));
}
})]);
}
var CPSplitViewDelegateKey = "CPSplitViewDelegateKey",
    CPSplitViewIsVerticalKey = "CPSplitViewIsVerticalKey",
    CPSplitViewIsPaneSplitterKey = "CPSplitViewIsPaneSplitterKey";
{
var the_class = objj_getClass("CPSplitView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPSplitView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSplitView").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _currentDivider = CPNotFound;
        _DOMDividerElements = [];
        _delegate = objj_msgSend(aCoder, "decodeObjectForKey:", CPSplitViewDelegateKey);;
        _isPaneSplitter = objj_msgSend(aCoder, "decodeBoolForKey:", CPSplitViewIsPaneSplitterKey);
        objj_msgSend(self, "_setVertical:", objj_msgSend(aCoder, "decodeBoolForKey:", CPSplitViewIsVerticalKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPSplitView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _delegate, CPSplitViewDelegateKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isVertical, CPSplitViewIsVerticalKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isPaneSplitter, CPSplitViewIsPaneSplitterKey);
}
})]);
}

p;17;CPStringDrawing.jt;838;@STATIC;1.0;I;21;Foundation/CPString.ji;18;CPPlatformString.jt;771;objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPPlatformString.j", true);
{
var the_class = objj_getClass("CPString")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPString\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("cssString"), function(self, _cmd)
{ with(self)
{
    return self;
}
}), new objj_method(sel_getUid("sizeWithFont:"), function(self, _cmd, aFont)
{ with(self)
{
    return objj_msgSend(self, "sizeWithFont:inWidth:", aFont, NULL);
}
}), new objj_method(sel_getUid("sizeWithFont:inWidth:"), function(self, _cmd, aFont, aWidth)
{ with(self)
{
    return objj_msgSend(CPPlatformString, "sizeOfString:withFont:forWidth:", self, aFont, aWidth);
}
})]);
}

p;15;CPTableColumn.jt;13728;@STATIC;1.0;I;25;Foundation/CPDictionary.jI;21;Foundation/CPObject.jI;29;Foundation/CPSortDescriptor.jI;21;Foundation/CPString.ji;19;CPTableHeaderView.jt;13568;objj_executeFile("Foundation/CPDictionary.j", false);
objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPSortDescriptor.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPTableHeaderView.j", true);
CPTableColumnNoResizing = 0;
CPTableColumnAutoresizingMask = 1 << 0;
CPTableColumnUserResizingMask = 1 << 1;
{var the_class = objj_allocateClassPair(CPObject, "CPTableColumn"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_tableView"), new objj_ivar("_headerView"), new objj_ivar("_dataView"), new objj_ivar("_dataViewData"), new objj_ivar("_width"), new objj_ivar("_minWidth"), new objj_ivar("_maxWidth"), new objj_ivar("_resizingMask"), new objj_ivar("_identifier"), new objj_ivar("_isEditable"), new objj_ivar("_sortDescriptorPrototype"), new objj_ivar("_isHidden"), new objj_ivar("_headerToolTip"), new objj_ivar("_disableResizingPosting")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("disableResizingPosting"), function(self, _cmd)
{ with(self)
{
return _disableResizingPosting;
}
}),
new objj_method(sel_getUid("setDisableResizingPosting:"), function(self, _cmd, newValue)
{ with(self)
{
_disableResizingPosting = newValue;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithIdentifier:", "");
}
}), new objj_method(sel_getUid("initWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableColumn").super_class }, "init");
    if (self)
    {
        _dataViewData = { };
        _width = 100.0;
        _minWidth = 10.0;
        _maxWidth = 1000000.0;
        _resizingMask = CPTableColumnAutoresizingMask | CPTableColumnUserResizingMask;
        _disableResizingPosting = NO;
        objj_msgSend(self, "setIdentifier:", anIdentifier);
        var header = objj_msgSend(objj_msgSend(_CPTableColumnHeaderView, "alloc"), "initWithFrame:", CGRectMakeZero());
        objj_msgSend(self, "setHeaderView:", header);
        var textDataView = objj_msgSend(CPTextField, "new");
        objj_msgSend(textDataView, "setLineBreakMode:", CPLineBreakByTruncatingTail);
        objj_msgSend(textDataView, "setValue:forThemeAttribute:", objj_msgSend(CPColor, "colorWithHexString:", "333333"), "text-color");
        objj_msgSend(textDataView, "setValue:forThemeAttribute:inState:", objj_msgSend(CPColor, "whiteColor"), "text-color", CPThemeStateHighlighted);
        objj_msgSend(textDataView, "setValue:forThemeAttribute:inState:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 12), "font", CPThemeStateHighlighted);
        objj_msgSend(textDataView, "setValue:forThemeAttribute:", CGInsetMake(4.0, 8.0, 0.0, 8.0), "content-inset");
        objj_msgSend(self, "setDataView:", textDataView);
    }
    return self;
}
}), new objj_method(sel_getUid("setTableView:"), function(self, _cmd, aTableView)
{ with(self)
{
    _tableView = aTableView;
}
}), new objj_method(sel_getUid("tableView"), function(self, _cmd)
{ with(self)
{
    return _tableView;
}
}), new objj_method(sel_getUid("setWidth:"), function(self, _cmd, aWidth)
{ with(self)
{
    aWidth = +aWidth;
    if (_width === aWidth)
        return;
    var newWidth = MIN(MAX(aWidth, objj_msgSend(self, "minWidth")), objj_msgSend(self, "maxWidth"));
    if (_width === newWidth)
        return;
    var oldWidth = _width;
    _width = newWidth;
    var tableView = objj_msgSend(self, "tableView");
    if (tableView)
    {
        var index = objj_msgSend(objj_msgSend(tableView, "tableColumns"), "indexOfObjectIdenticalTo:", self),
            dirtyTableColumnRangeIndex = tableView._dirtyTableColumnRangeIndex;
        if (dirtyTableColumnRangeIndex < 0)
            tableView._dirtyTableColumnRangeIndex = index;
        else
            tableView._dirtyTableColumnRangeIndex = MIN(index, tableView._dirtyTableColumnRangeIndex);
        var rows = tableView._exposedRows,
            columns = objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", CPMakeRange(index, objj_msgSend(tableView._exposedColumns, "lastIndex") - index + 1));
        objj_msgSend(tableView, "_layoutDataViewsInRows:columns:", rows, columns);
        objj_msgSend(tableView, "tile");
        if (!_disableResizingPosting)
            objj_msgSend(self, "_postDidResizeNotificationWithOldWidth:", oldWidth);
    }
}
}), new objj_method(sel_getUid("width"), function(self, _cmd)
{ with(self)
{
    return _width;
}
}), new objj_method(sel_getUid("setMinWidth:"), function(self, _cmd, aMinWidth)
{ with(self)
{
    aMinWidth = +aMinWidth;
    if (_minWidth === aMinWidth)
        return;
    _minWidth = aMinWidth;
    var width = objj_msgSend(self, "width"),
        newWidth = MAX(width, objj_msgSend(self, "minWidth"));
    if (width !== newWidth)
        objj_msgSend(self, "setWidth:", newWidth);
}
}), new objj_method(sel_getUid("minWidth"), function(self, _cmd)
{ with(self)
{
    return _minWidth;
}
}), new objj_method(sel_getUid("setMaxWidth:"), function(self, _cmd, aMaxWidth)
{ with(self)
{
    aMaxWidth = +aMaxWidth;
    if (_maxWidth === aMaxWidth)
        return;
    _maxWidth = aMaxWidth;
    var width = objj_msgSend(self, "width"),
        newWidth = MIN(width, objj_msgSend(self, "maxWidth"));
    if (width !== newWidth)
        objj_msgSend(self, "setWidth:", newWidth);
}
}), new objj_method(sel_getUid("maxWidth"), function(self, _cmd)
{ with(self)
{
    return _maxWidth;
}
}), new objj_method(sel_getUid("setResizingMask:"), function(self, _cmd, aResizingMask)
{ with(self)
{
    _resizingMask = aResizingMask;
}
}), new objj_method(sel_getUid("resizingMask"), function(self, _cmd)
{ with(self)
{
    return _resizingMask;
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    var width = (objj_msgSend(_headerView, "frame").size.width);
    if (width < objj_msgSend(self, "minWidth"))
        objj_msgSend(self, "setMinWidth:", width);
    else if (width > objj_msgSend(self, "maxWidth"))
        objj_msgSend(self, "setMaxWidth:", width)
    if (_width !== width)
        objj_msgSend(self, "setWidth:", width);
}
}), new objj_method(sel_getUid("setHeaderView:"), function(self, _cmd, aView)
{ with(self)
{
    if (!aView)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "Attempt to set nil header view on " + objj_msgSend(self, "description"));
    _headerView = aView;
    var tableHeaderView = objj_msgSend(_tableView, "headerView");
    objj_msgSend(tableHeaderView, "setNeedsLayout");
    objj_msgSend(tableHeaderView, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("headerView"), function(self, _cmd)
{ with(self)
{
    return _headerView;
}
}), new objj_method(sel_getUid("setDataView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_dataView === aView)
        return;
    if (_dataView)
        _dataViewData[objj_msgSend(_dataView, "UID")] = nil;
    _dataView = aView;
    _dataViewData[objj_msgSend(aView, "UID")] = objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", aView);
}
}), new objj_method(sel_getUid("dataView"), function(self, _cmd)
{ with(self)
{
    return _dataView;
}
}), new objj_method(sel_getUid("dataViewForRow:"), function(self, _cmd, aRowIndex)
{ with(self)
{
    return objj_msgSend(self, "dataView");
}
}), new objj_method(sel_getUid("_newDataViewForRow:"), function(self, _cmd, aRowIndex)
{ with(self)
{
    var dataView = objj_msgSend(self, "dataViewForRow:", aRowIndex),
        dataViewUID = objj_msgSend(dataView, "UID");
    var x = objj_msgSend(self, "tableView")._cachedDataViews[dataViewUID];
    if (x && x.length)
    return x.pop();
    if (!_dataViewData[dataViewUID])
        _dataViewData[dataViewUID] = objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", dataView);
    var newDataView = objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", _dataViewData[dataViewUID]);
    newDataView.identifier = dataViewUID;
    return newDataView;
}
}), new objj_method(sel_getUid("setIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    _identifier = anIdentifier;
}
}), new objj_method(sel_getUid("identifier"), function(self, _cmd)
{ with(self)
{
    return _identifier;
}
}), new objj_method(sel_getUid("setEditable:"), function(self, _cmd, shouldBeEditable)
{ with(self)
{
    _isEditable = shouldBeEditable;
}
}), new objj_method(sel_getUid("isEditable"), function(self, _cmd)
{ with(self)
{
    return _isEditable;
}
}), new objj_method(sel_getUid("setSortDescriptorPrototype:"), function(self, _cmd, aSortDescriptor)
{ with(self)
{
    _sortDescriptorPrototype = aSortDescriptor;
}
}), new objj_method(sel_getUid("sortDescriptorPrototype"), function(self, _cmd)
{ with(self)
{
    return _sortDescriptorPrototype;
}
}), new objj_method(sel_getUid("setHidden:"), function(self, _cmd, shouldBeHidden)
{ with(self)
{
    _isHidden = shouldBeHidden;
}
}), new objj_method(sel_getUid("isHidden"), function(self, _cmd)
{ with(self)
{
    return _isHidden;
}
}), new objj_method(sel_getUid("setHeaderToolTip:"), function(self, _cmd, aToolTip)
{ with(self)
{
    _headerToolTip = aToolTip;
}
}), new objj_method(sel_getUid("headerToolTip"), function(self, _cmd)
{ with(self)
{
    return _headerToolTip;
}
}), new objj_method(sel_getUid("_postDidResizeNotificationWithOldWidth:"), function(self, _cmd, oldWidth)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPTableViewColumnDidResizeNotification, objj_msgSend(self, "tableView"), objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [self, oldWidth], ["CPTableColumn", "CPOldWidth"]));
}
})]);
}
var CPTableColumnIdentifierKey = "CPTableColumnIdentifierKey",
    CPTableColumnHeaderViewKey = "CPTableColumnHeaderViewKey",
    CPTableColumnDataViewKey = "CPTableColumnDataViewKey",
    CPTableColumnWidthKey = "CPTableColumnWidthKey",
    CPTableColumnMinWidthKey = "CPTableColumnMinWidthKey",
    CPTableColumnMaxWidthKey = "CPTableColumnMaxWidthKey",
    CPTableColumnResizingMaskKey = "CPTableColumnResizingMaskKey";
{
var the_class = objj_getClass("CPTableColumn")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTableColumn\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableColumn").super_class }, "init");
    if (self)
    {
        _dataViewData = { };
        _width = objj_msgSend(aCoder, "decodeFloatForKey:", CPTableColumnWidthKey);
        _minWidth = objj_msgSend(aCoder, "decodeFloatForKey:", CPTableColumnMinWidthKey);
        _maxWidth = objj_msgSend(aCoder, "decodeFloatForKey:", CPTableColumnMaxWidthKey);
        objj_msgSend(self, "setIdentifier:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTableColumnIdentifierKey));
        objj_msgSend(self, "setHeaderView:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTableColumnHeaderViewKey));
        objj_msgSend(self, "setDataView:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTableColumnDataViewKey));
        objj_msgSend(self, "setHeaderView:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTableColumnHeaderViewKey));
        _resizingMask = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableColumnResizingMaskKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _identifier, CPTableColumnIdentifierKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _width, CPTableColumnWidthKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _minWidth, CPTableColumnMinWidthKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _maxWidth, CPTableColumnMaxWidthKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _headerView, CPTableColumnHeaderViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _dataView, CPTableColumnDataViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _resizingMask, CPTableColumnResizingMaskKey);
}
})]);
}
{
var the_class = objj_getClass("CPTableColumn")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTableColumn\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("setHeaderCell:"), function(self, _cmd, aView)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "setHeaderCell: is not supported. -setHeaderCell:aView instead.");
}
}), new objj_method(sel_getUid("headerCell"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "headCell is not supported. -headerView instead.");
}
}), new objj_method(sel_getUid("setDataCell:"), function(self, _cmd, aView)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "setDataCell: is not supported. Use -setHeaderCell:aView instead.");
}
}), new objj_method(sel_getUid("dataCell"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "dataCell is not supported. Use -dataCell instead.");
}
}), new objj_method(sel_getUid("dataCellForRow:"), function(self, _cmd, row)
{ with(self)
{
    objj_msgSend(CPException, "raise:reason:", CPUnsupportedMethodException, "dataCellForRow: is not supported. Use -dataViewForRow:row instead.");
}
})]);
}

p;19;CPTableHeaderView.jt;18584;@STATIC;1.0;i;15;CPTableColumn.ji;13;CPTableView.ji;8;CPView.jt;18514;objj_executeFile("CPTableColumn.j", true);
objj_executeFile("CPTableView.j", true);
objj_executeFile("CPView.j", true);
var CPThemeStatePressed = CPThemeState("pressed");
{var the_class = objj_allocateClassPair(CPView, "_CPTableColumnHeaderView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_textField")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, frame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTableColumnHeaderView").super_class }, "initWithFrame:", frame);
    if (self)
    {
        objj_msgSend(self, "_init");
    }
    return self;
}
}), new objj_method(sel_getUid("_init"), function(self, _cmd)
{ with(self)
{
    _textField = objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", CGRectMake(5, 1, CGRectGetWidth(objj_msgSend(self, "bounds")) - 10, CGRectGetHeight(objj_msgSend(self, "bounds")) - 1));
    objj_msgSend(_textField, "setAutoresizingMask:", CPViewWidthSizable|CPViewHeightSizable);
    objj_msgSend(_textField, "setLineBreakMode:", CPLineBreakByTruncatingTail);
    objj_msgSend(_textField, "setTextColor:",  objj_msgSend(CPColor, "colorWithHexString:",  "333333"));
    objj_msgSend(_textField, "setFont:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 12.0));
    objj_msgSend(_textField, "setAlignment:", CPLeftTextAlignment);
    objj_msgSend(_textField, "setVerticalAlignment:", CPCenterVerticalTextAlignment);
    objj_msgSend(_textField, "setTextShadowColor:", objj_msgSend(CPColor, "whiteColor"));
    objj_msgSend(_textField, "setTextShadowOffset:", CGSizeMake(0,1));
    objj_msgSend(self, "addSubview:", _textField);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var themeState = objj_msgSend(self, "themeState");
    if(themeState & CPThemeStateHighlighted && themeState & CPThemeStatePressed)
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithPatternImage:", CPAppKitImage("tableview-headerview-highlighted-pressed.png", CGSizeMake(1.0, 22.0))));
    else if (themeState & CPThemeStateHighlighted)
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithPatternImage:", CPAppKitImage("tableview-headerview-highlighted.png", CGSizeMake(1.0, 22.0))));
    else if (themeState & CPThemeStatePressed)
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithPatternImage:", CPAppKitImage("tableview-headerview-pressed.png", CGSizeMake(1.0, 22.0))));
    else
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithPatternImage:", CPAppKitImage("tableview-headerview.png", CGSizeMake(1.0, 22.0))));
}
}), new objj_method(sel_getUid("setStringValue:"), function(self, _cmd, string)
{ with(self)
{
    objj_msgSend(_textField, "setText:", string);
}
}), new objj_method(sel_getUid("stringValue"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_textField, "text");
}
}), new objj_method(sel_getUid("textField"), function(self, _cmd)
{ with(self)
{
    return _textField;
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_textField, "sizeToFit");
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    objj_msgSend(_textField, "setFont:", aFont);
}
}), new objj_method(sel_getUid("setValue:forThemeAttribute:"), function(self, _cmd, aValue, aKey)
{ with(self)
{
    objj_msgSend(_textField, "setValue:forThemeAttribute:", aValue, aKey);
}
}), new objj_method(sel_getUid("_setIndicatorImage:"), function(self, _cmd, anImage)
{ with(self)
{
 if (anImage)
 {
  objj_msgSend(_textField, "setImage:", anImage);
  objj_msgSend(_textField, "setImagePosition:", CPImageRight);
 }
 else
 {
  objj_msgSend(_textField, "setImagePosition:", CPNoImage);
 }
}
})]);
}
var _CPTableColumnHeaderViewStringValueKey = "_CPTableColumnHeaderViewStringValueKey",
    _CPTableColumnHeaderViewFontKey = "_CPTableColumnHeaderViewFontKey",
    _CPTableColumnHeaderViewImageKey = "_CPTableColumnHeaderViewImageKey";
{
var the_class = objj_getClass("_CPTableColumnHeaderView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPTableColumnHeaderView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTableColumnHeaderView").super_class }, "initWithCoder:", aCoder))
    {
        objj_msgSend(self, "_init");
        objj_msgSend(self, "_setIndicatorImage:", objj_msgSend(aCoder, "decodeObjectForKey:", _CPTableColumnHeaderViewImageKey));
        objj_msgSend(self, "setStringValue:", objj_msgSend(aCoder, "decodeObjectForKey:", _CPTableColumnHeaderViewStringValueKey));
        objj_msgSend(self, "setFont:", objj_msgSend(aCoder, "decodeObjectForKey:", _CPTableColumnHeaderViewFontKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTableColumnHeaderView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(_textField, "text"), _CPTableColumnHeaderViewStringValueKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(_textField, "image"), _CPTableColumnHeaderViewImageKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(_textField, "font"), _CPTableColumnHeaderViewFontKey);
}
})]);
}
{var the_class = objj_allocateClassPair(CPView, "CPTableHeaderView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_resizedColumn"), new objj_ivar("_draggedColumn"), new objj_ivar("_pressedColumn"), new objj_ivar("_draggedDistance"), new objj_ivar("_lastLocation"), new objj_ivar("_columnOldWidth"), new objj_ivar("_tableView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("resizedColumn"), function(self, _cmd)
{ with(self)
{
return _resizedColumn;
}
}),
new objj_method(sel_getUid("draggedColumn"), function(self, _cmd)
{ with(self)
{
return _draggedColumn;
}
}),
new objj_method(sel_getUid("pressedColumn"), function(self, _cmd)
{ with(self)
{
return _pressedColumn;
}
}),
new objj_method(sel_getUid("draggedDistance"), function(self, _cmd)
{ with(self)
{
return _draggedDistance;
}
}),
new objj_method(sel_getUid("tableView"), function(self, _cmd)
{ with(self)
{
return _tableView;
}
}),
new objj_method(sel_getUid("setTableView:"), function(self, _cmd, newValue)
{ with(self)
{
_tableView = newValue;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableHeaderView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _resizedColumn = -1;
        _draggedColumn = -1;
        _pressedColumn = -1;
        _draggedDistance = 0.0;
        _lastLocation = nil;
        _columnOldWidth = nil;
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "colorWithPatternImage:", CPAppKitImage("tableview-headerview.png", CGSizeMake(1.0, 22.0))));
    }
    return self;
}
}), new objj_method(sel_getUid("columnAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(_tableView, "columnAtPoint:", CGPointMake(aPoint.x, 0));
}
}), new objj_method(sel_getUid("headerRectOfColumn:"), function(self, _cmd, aColumnIndex)
{ with(self)
{
    var tableColumns = objj_msgSend(_tableView, "tableColumns");
    if (aColumnIndex < 0 || aColumnIndex > objj_msgSend(tableColumns, "count"))
        objj_msgSend(CPException, "raise:reason:", "invalid", "tried to get headerRectOfColumn: on invalid column");
    var tableRange = _tableView._tableColumnRanges[aColumnIndex],
        bounds = objj_msgSend(self, "bounds");
    bounds.origin.x = tableRange.location;
    bounds.size.width = tableRange.length;
    return bounds;
}
}), new objj_method(sel_getUid("_cursorRectForColumn:"), function(self, _cmd, column)
{ with(self)
{
    if (column == -1 || !(objj_msgSend(_tableView._tableColumns[column], "resizingMask") & CPTableColumnUserResizingMask))
        return CGRectMakeZero();
    var rect = objj_msgSend(self, "headerRectOfColumn:", column);
    rect.origin.x = CGRectGetMaxX(rect) - 5;
    rect.size.width = 20;
    return rect;
}
}), new objj_method(sel_getUid("_setPressedColumn:"), function(self, _cmd, column)
{ with(self)
{
    if (_pressedColumn != -1)
    {
        var headerView = objj_msgSend(_tableView._tableColumns[_pressedColumn], "headerView");
        objj_msgSend(headerView, "unsetThemeState:", CPThemeStatePressed);
    }
    if (column != -1)
    {
        var headerView = objj_msgSend(_tableView._tableColumns[column], "headerView");
        objj_msgSend(headerView, "setThemeState:", CPThemeStatePressed);
    }
    _pressedColumn = column;
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, theEvent)
{ with(self)
{
    var mouseLocation = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(theEvent, "locationInWindow"), nil),
        clickedColumn = objj_msgSend(self, "columnAtPoint:", mouseLocation);
    objj_msgSend(_tableView, "_sendDelegateDidMouseDownInHeader:", clickedColumn);
    var resizeLocation = CGPointMake(mouseLocation.x - 5, mouseLocation.y),
        resizedColumn = objj_msgSend(self, "columnAtPoint:", resizeLocation);
    if (resizedColumn == -1)
        return;
    if (objj_msgSend(_tableView, "allowsColumnResizing") && objj_msgSend(_tableView, "columnAutoresizingStyle") & CPTableViewUniformColumnAutoresizingStyle
        && CGRectContainsPoint(objj_msgSend(self, "_cursorRectForColumn:", resizedColumn), mouseLocation))
    {
        _resizedColumn = resizedColumn;
        objj_msgSend(_tableView._tableColumns[_resizedColumn], "setDisableResizingPosting:", YES);
        objj_msgSend(_tableView, "setDisableAutomaticResizing:", YES);
        objj_msgSend(self, "trackResizeWithEvent:", theEvent);
    }
    else
    {
        objj_msgSend(self, "_setPressedColumn:", clickedColumn);
        objj_msgSend(self, "trackMouseWithEvent:", theEvent);
    }
}
}), new objj_method(sel_getUid("trackMouseWithEvent:"), function(self, _cmd, theEvent)
{ with(self)
{
    var type = objj_msgSend(theEvent, "type");
    if (type == CPLeftMouseUp)
    {
        var location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(theEvent, "locationInWindow"), nil),
            clickedColumn = objj_msgSend(self, "columnAtPoint:", location);
        objj_msgSend(self, "_setPressedColumn:", -1);
        if (clickedColumn != -1)
            objj_msgSend(_tableView, "_didClickTableColumn:modifierFlags:", clickedColumn, objj_msgSend(theEvent, "modifierFlags"));
        return;
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackMouseWithEvent:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask | CPLeftMouseDownMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("trackResizeWithEvent:"), function(self, _cmd, anEvent)
{ with(self)
{
    var location = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil),
        tableColumn = objj_msgSend(objj_msgSend(_tableView, "tableColumns"), "objectAtIndex:", _resizedColumn),
        type = objj_msgSend(anEvent, "type");
    if (_lastLocation == nil)
        _lastLocation = location;
    if (_columnOldWidth == nil)
        _columnOldWidth = objj_msgSend(tableColumn, "width");
    if (type === CPLeftMouseUp)
    {
        objj_msgSend(self, "_updateResizeCursor:", anEvent);
        objj_msgSend(tableColumn, "_postDidResizeNotificationWithOldWidth:", _columnOldWidth);
        objj_msgSend(tableColumn, "setDisableResizingPosting:", NO);
        objj_msgSend(_tableView, "setDisableAutomaticResizing:", NO);
        _resizedColumn = -1;
        _lastLocation = nil;
        _columnOldWidth = nil;
        return;
    }
    else if (type === CPLeftMouseDragged)
    {
        var newWidth = objj_msgSend(tableColumn, "width") + location.x - _lastLocation.x;
        if (newWidth < objj_msgSend(tableColumn, "minWidth"))
            objj_msgSend(objj_msgSend(CPCursor, "resizeRightCursor"), "set");
        else if (newWidth > objj_msgSend(tableColumn, "maxWidth"))
            objj_msgSend(objj_msgSend(CPCursor, "resizeLeftCursor"), "set");
        else
        {
            objj_msgSend(tableColumn, "setWidth:", newWidth);
            objj_msgSend(_tableView, "resizeWithOldSuperviewSize:", objj_msgSend(_tableView, "bounds"));
            _lastLocation = location;
            objj_msgSend(objj_msgSend(CPCursor, "resizeLeftRightCursor"), "set");
            objj_msgSend(self, "setNeedsLayout");
            objj_msgSend(self, "setNeedsDisplay:", YES);
        }
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackResizeWithEvent:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("_updateResizeCursor:"), function(self, _cmd, theEvent)
{ with(self)
{
    var mouseLocation = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(theEvent, "locationInWindow"), nil),
        mouseOverLocation = CGPointMake(mouseLocation.x - 5, mouseLocation.y),
        overColumn = objj_msgSend(self, "columnAtPoint:", mouseOverLocation);
    if (overColumn >= 0 && CGRectContainsPoint(objj_msgSend(self, "_cursorRectForColumn:", overColumn), mouseLocation))
    {
        var tableColumn = objj_msgSend(objj_msgSend(_tableView, "tableColumns"), "objectAtIndex:", overColumn),
            width = objj_msgSend(tableColumn, "width");
        if (width == objj_msgSend(tableColumn, "minWidth"))
            objj_msgSend(objj_msgSend(CPCursor, "resizeRightCursor"), "set");
        else if (width == objj_msgSend(tableColumn, "maxWidth"))
            objj_msgSend(objj_msgSend(CPCursor, "resizeLeftCursor"), "set");
        else
            objj_msgSend(objj_msgSend(CPCursor, "resizeLeftRightCursor"), "set");
    }
    else
        objj_msgSend(objj_msgSend(CPCursor, "arrowCursor"), "set");
}
}), new objj_method(sel_getUid("viewDidMoveToWindow"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(_tableView, "allowsColumnResizing"))
        objj_msgSend(objj_msgSend(self, "window"), "setAcceptsMouseMovedEvents:", YES);
}
}), new objj_method(sel_getUid("mouseEntered:"), function(self, _cmd, theEvent)
{ with(self)
{
    objj_msgSend(self, "_updateResizeCursor:", theEvent);
}
}), new objj_method(sel_getUid("mouseMoved:"), function(self, _cmd, theEvent)
{ with(self)
{
    objj_msgSend(self, "_updateResizeCursor:", theEvent);
}
}), new objj_method(sel_getUid("mouseExited:"), function(self, _cmd, theEvent)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPCursor, "arrowCursor"), "set");
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var tableColumns = objj_msgSend(_tableView, "tableColumns"),
        count = objj_msgSend(tableColumns, "count");
    for (var i = 0; i < count; i++)
    {
        var column = objj_msgSend(tableColumns, "objectAtIndex:", i),
            headerView = objj_msgSend(column, "headerView");
        var frame = objj_msgSend(self, "headerRectOfColumn:", i);
        frame.size.height -= 0.5;
        if (i > 0)
        {
            frame.origin.x += 0.5;
            frame.size.width -= 1;
        }
        objj_msgSend(headerView, "setFrame:", frame);
        if(objj_msgSend(headerView, "superview") != self)
            objj_msgSend(self, "addSubview:", headerView);
    }
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        exposedColumnIndexes = objj_msgSend(_tableView, "columnIndexesInRect:", aRect),
        columnsArray = [],
        tableColumns = objj_msgSend(_tableView, "tableColumns"),
        exposedTableColumns = _tableView._exposedColumns,
        firstIndex = objj_msgSend(exposedTableColumns, "firstIndex"),
        exposedRange = CPMakeRange(firstIndex, objj_msgSend(exposedTableColumns, "lastIndex") - firstIndex + 1);
    CGContextSetLineWidth(context, 1);
    CGContextSetStrokeColor(context, objj_msgSend(_tableView, "gridColor"));
    objj_msgSend(exposedColumnIndexes, "getIndexes:maxCount:inIndexRange:", columnsArray, -1, exposedRange);
    var columnArrayIndex = 0,
        columnArrayCount = columnsArray.length,
        columnMaxX;
    CGContextBeginPath(context);
    for(; columnArrayIndex < columnArrayCount; columnArrayIndex++)
    {
        var columnIndex = columnsArray[columnArrayIndex],
            columnToStroke = objj_msgSend(self, "headerRectOfColumn:", columnIndex);
        columnMaxX = CGRectGetMaxX(columnToStroke);
        CGContextMoveToPoint(context, ROUND(columnMaxX) + 0.5, ROUND(CGRectGetMinY(columnToStroke)));
        CGContextAddLineToPoint(context, ROUND(columnMaxX) + 0.5, ROUND(CGRectGetMaxY(columnToStroke)));
    }
    CGContextClosePath(context);
    CGContextStrokePath(context);
}
})]);
}
var CPTableHeaderViewTableViewKey = "CPTableHeaderViewTableViewKey";
{
var the_class = objj_getClass("CPTableHeaderView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTableHeaderView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableHeaderView").super_class }, "initWithCoder:", aCoder))
    {
        _resizedColumn = -1;
        _draggedColumn = -1;
        _pressedColumn = -1;
        _draggedDistance = 0.0;
        _lastLocation = nil;
        _columnOldWidth = nil;
        _tableView = objj_msgSend(aCoder, "decodeObjectForKey:", CPTableHeaderViewTableViewKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableHeaderView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _tableView, CPTableHeaderViewTableViewKey);
}
})]);
}

p;13;CPTableView.jt;114084;@STATIC;1.0;I;20;Foundation/CPArray.jI;19;AppKit/CGGradient.ji;11;CPControl.ji;15;CPTableColumn.ji;15;_CPCornerView.ji;12;CPScroller.jt;113941;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("AppKit/CGGradient.j", false);
objj_executeFile("CPControl.j", true);
objj_executeFile("CPTableColumn.j", true);
objj_executeFile("_CPCornerView.j", true);
objj_executeFile("CPScroller.j", true);
CPTableViewColumnDidMoveNotification = "CPTableViewColumnDidMoveNotification";
CPTableViewColumnDidResizeNotification = "CPTableViewColumnDidResizeNotification";
CPTableViewSelectionDidChangeNotification = "CPTableViewSelectionDidChangeNotification";
CPTableViewSelectionIsChangingNotification = "CPTableViewSelectionIsChangingNotification";
var CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_ = 1 << 2,
    CPTableViewDataSource_tableView_acceptDrop_row_dropOperation_ = 1 << 3,
    CPTableViewDataSource_tableView_namesOfPromisedFilesDroppedAtDestination_forDraggedRowsWithIndexes_ = 1 << 4,
    CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_ = 1 << 5,
    CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_ = 1 << 6,
    CPTableViewDataSource_tableView_sortDescriptorsDidChange_ = 1 << 7;
var CPTableViewDelegate_selectionShouldChangeInTableView_ = 1 << 0,
    CPTableViewDelegate_tableView_dataViewForTableColumn_row_ = 1 << 1,
    CPTableViewDelegate_tableView_didClickTableColumn_ = 1 << 2,
    CPTableViewDelegate_tableView_didDragTableColumn_ = 1 << 3,
    CPTableViewDelegate_tableView_heightOfRow_ = 1 << 4,
    CPTableViewDelegate_tableView_isGroupRow_ = 1 << 5,
    CPTableViewDelegate_tableView_mouseDownInHeaderOfTableColumn_ = 1 << 6,
    CPTableViewDelegate_tableView_nextTypeSelectMatchFromRow_toRow_forString_ = 1 << 7,
    CPTableViewDelegate_tableView_selectionIndexesForProposedSelection_ = 1 << 8,
    CPTableViewDelegate_tableView_shouldEditTableColumn_row_ = 1 << 9,
    CPTableViewDelegate_tableView_shouldSelectRow_ = 1 << 10,
    CPTableViewDelegate_tableView_shouldSelectTableColumn_ = 1 << 11,
    CPTableViewDelegate_tableView_shouldShowViewExpansionForTableColumn_row_ = 1 << 12,
    CPTableViewDelegate_tableView_shouldTrackView_forTableColumn_row_ = 1 << 13,
    CPTableViewDelegate_tableView_shouldTypeSelectForEvent_withCurrentSearchString_ = 1 << 14,
    CPTableViewDelegate_tableView_toolTipForView_rect_tableColumn_row_mouseLocation_ = 1 << 15,
    CPTableViewDelegate_tableView_typeSelectStringForTableColumn_row_ = 1 << 16,
    CPTableViewDelegate_tableView_willDisplayView_forTableColumn_row_ = 1 << 17,
    CPTableViewDelegate_tableViewSelectionDidChange_ = 1 << 18,
    CPTableViewDelegate_tableViewSelectionIsChanging_ = 1 << 19;
CPTableViewDraggingDestinationFeedbackStyleNone = -1,
CPTableViewDraggingDestinationFeedbackStyleRegular = 0,
CPTableViewDraggingDestinationFeedbackStyleSourceList = 1;
CPTableViewDropOn = 0,
CPTableViewDropAbove = 1;
CPTableViewSelectionHighlightStyleNone = -1,
CPTableViewSelectionHighlightStyleRegular = 0,
CPTableViewSelectionHighlightStyleSourceList = 1;
CPTableViewGridNone = 0;
CPTableViewSolidVerticalGridLineMask = 1 << 0;
CPTableViewSolidHorizontalGridLineMask = 1 << 1;
CPTableViewNoColumnAutoresizing = 0,
CPTableViewUniformColumnAutoresizingStyle = 1,
CPTableViewSequentialColumnAutoresizingStyle = 2,
CPTableViewReverseSequentialColumnAutoresizingStyle = 3,
CPTableViewLastColumnOnlyAutoresizingStyle = 4,
CPTableViewFirstColumnOnlyAutoresizingStyle = 5;
{var the_class = objj_allocateClassPair(CPView, "_CPTableDrawView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_tableView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithTableView:"), function(self, _cmd, aTableView)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTableDrawView").super_class }, "init");
    if (self)
        _tableView = aTableView;
    return self;
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var frame = objj_msgSend(self, "frame"),
        context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextTranslateCTM(context, -(frame.origin.x), -(frame.origin.y));
    objj_msgSend(_tableView, "_drawRect:", aRect);
}
})]);
}
{var the_class = objj_allocateClassPair(CPControl, "CPTableView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_dataSource"), new objj_ivar("_implementedDataSourceMethods"), new objj_ivar("_delegate"), new objj_ivar("_implementedDelegateMethods"), new objj_ivar("_tableColumns"), new objj_ivar("_tableColumnRanges"), new objj_ivar("_dirtyTableColumnRangeIndex"), new objj_ivar("_numberOfHiddenColumns"), new objj_ivar("_reloadAllRows"), new objj_ivar("_objectValues"), new objj_ivar("_exposedRows"), new objj_ivar("_exposedColumns"), new objj_ivar("_dataViewsForTableColumns"), new objj_ivar("_cachedDataViews"), new objj_ivar("_allowsColumnReordering"), new objj_ivar("_allowsColumnResizing"), new objj_ivar("_allowsColumnSelection"), new objj_ivar("_allowsMultipleSelection"), new objj_ivar("_allowsEmptySelection"), new objj_ivar("_sortDescriptors"), new objj_ivar("_intercellSpacing"), new objj_ivar("_rowHeight"), new objj_ivar("_usesAlternatingRowBackgroundColors"), new objj_ivar("_alternatingRowBackgroundColors"), new objj_ivar("_selectionHighlightStyle"), new objj_ivar("_currentHighlightedTableColumn"), new objj_ivar("_gridStyleMask"), new objj_ivar("_gridColor"), new objj_ivar("_numberOfRows"), new objj_ivar("_headerView"), new objj_ivar("_cornerView"), new objj_ivar("_selectedColumnIndexes"), new objj_ivar("_selectedRowIndexes"), new objj_ivar("_selectionAnchorRow"), new objj_ivar("_lastSelectedRow"), new objj_ivar("_previouslySelectedRowIndexes"), new objj_ivar("_startTrackingPoint"), new objj_ivar("_startTrackingTimestamp"), new objj_ivar("_trackingPointMovedOutOfClickSlop"), new objj_ivar("_editingCellIndex"), new objj_ivar("_tableDrawView"), new objj_ivar("_doubleAction"), new objj_ivar("_columnAutoResizingStyle"), new objj_ivar("_originalMouseDownPoint"), new objj_ivar("_verticalMotionCanDrag"), new objj_ivar("_destinationDragStyle"), new objj_ivar("_isSelectingSession"), new objj_ivar("_draggedRowIndexes"), new objj_ivar("_dropOperationFeedbackView"), new objj_ivar("_dragOperationDefaultMask"), new objj_ivar("_retargetedDropRow"), new objj_ivar("_retargetedDropOperation"), new objj_ivar("_disableAutomaticResizing"), new objj_ivar("_sourceListActiveGradient"), new objj_ivar("_sourceListActiveTopLineColor"), new objj_ivar("_sourceListActiveBottomLineColor")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("disableAutomaticResizing"), function(self, _cmd)
{ with(self)
{
return _disableAutomaticResizing;
}
}),
new objj_method(sel_getUid("setDisableAutomaticResizing:"), function(self, _cmd, newValue)
{ with(self)
{
_disableAutomaticResizing = newValue;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _allowsColumnReordering = YES;
        _allowsColumnResizing = YES;
        _allowsMultipleSelection = NO;
        _allowsEmptySelection = YES;
        _allowsColumnSelection = NO;
        _disableAutomaticResizing = NO;
        _tableViewFlags = 0;
        _selectionHighlightStyle = CPTableViewSelectionHighlightStyleRegular;
        objj_msgSend(self, "setUsesAlternatingRowBackgroundColors:", NO);
        objj_msgSend(self, "setAlternatingRowBackgroundColors:", [objj_msgSend(CPColor, "whiteColor"), objj_msgSend(CPColor, "colorWithHexString:", "f5f9fc")]);
        _tableColumns = [];
        _tableColumnRanges = [];
        _dirtyTableColumnRangeIndex = CPNotFound;
        _numberOfHiddenColumns = 0;
        _objectValues = { };
        _dataViewsForTableColumns = { };
        _dataViews= [];
        _numberOfRows = 0;
        _exposedRows = objj_msgSend(CPIndexSet, "indexSet");
        _exposedColumns = objj_msgSend(CPIndexSet, "indexSet");
        _cachedDataViews = { };
        _intercellSpacing = { width:0.0, height:0.0 };
        _rowHeight = 23.0;
        objj_msgSend(self, "setGridColor:", objj_msgSend(CPColor, "colorWithHexString:", "dce0e2"));
        objj_msgSend(self, "setGridStyleMask:", CPTableViewGridNone);
        _headerView = objj_msgSend(objj_msgSend(CPTableHeaderView, "alloc"), "initWithFrame:", CGRectMake(0, 0, objj_msgSend(self, "bounds").size.width, _rowHeight));
        objj_msgSend(_headerView, "setTableView:", self);
        _cornerView = objj_msgSend(objj_msgSend(_CPCornerView, "alloc"), "initWithFrame:", CGRectMake(0, 0, objj_msgSend(CPScroller, "scrollerWidth"), CGRectGetHeight(objj_msgSend(_headerView, "frame"))));
        _lastSelectedRow = -1;
        _selectedColumnIndexes = objj_msgSend(CPIndexSet, "indexSet");
        _selectedRowIndexes = objj_msgSend(CPIndexSet, "indexSet");
        _currentHighlightedTableColumn = nil;
        _sortDescriptors = objj_msgSend(CPArray, "array");
        _draggedRowIndexes = objj_msgSend(CPIndexSet, "indexSet");
        _verticalMotionCanDrag = YES;
        _isSelectingSession = NO;
        _retargetedDropRow = nil;
        _retargetedDropOperation = nil;
        _dragOperationDefaultMask = nil;
        _destinationDragStyle = CPTableViewDraggingDestinationFeedbackStyleRegular;
        _dropOperationFeedbackView = objj_msgSend(objj_msgSend(_dropOperationDrawingView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
        objj_msgSend(self, "addSubview:", _dropOperationFeedbackView);
        objj_msgSend(_dropOperationFeedbackView, "setHidden:", YES);
        objj_msgSend(_dropOperationFeedbackView, "setTableView:", self);
        _tableDrawView = objj_msgSend(objj_msgSend(_CPTableDrawView, "alloc"), "initWithTableView:", self);
        objj_msgSend(_tableDrawView, "setBackgroundColor:", objj_msgSend(CPColor, "clearColor"));
        objj_msgSend(self, "addSubview:", _tableDrawView);
        objj_msgSend(self, "_init");
    }
    return self;
}
}), new objj_method(sel_getUid("_init"), function(self, _cmd)
{ with(self)
{
        _sourceListActiveGradient = CGGradientCreateWithColorComponents(CGColorSpaceCreateDeviceRGB(), [89.0/255.0, 153.0/255.0, 209.0/255.0,1.0, 33.0/255.0, 94.0/255.0, 208.0/255.0,1.0], [0,1], 2);
        _sourceListActiveTopLineColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", (61.0/255.0), (123.0/255.0), (218.0/255.0), 1.0);
        _sourceListActiveBottomLineColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", (31.0/255.0), (92.0/255.0), (207.0/255.0), 1.0);
}
}), new objj_method(sel_getUid("setDataSource:"), function(self, _cmd, aDataSource)
{ with(self)
{
    if (_dataSource === aDataSource)
        return;
    _dataSource = aDataSource;
    _implementedDataSourceMethods = 0;
    if (!_dataSource)
        return;
    if (!objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("numberOfRowsInTableView:")))
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, objj_msgSend(aDataSource, "description") + " does not implement numberOfRowsInTableView:.");
    if (!objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:objectValueForTableColumn:row:")))
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, objj_msgSend(aDataSource, "description") + " does not implement tableView:objectValueForTableColumn:row:");
    if (objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:setObjectValue:forTableColumn:row:")))
        _implementedDataSourceMethods |= CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_;
    if (objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:acceptDrop:row:dropOperation:")))
        _implementedDataSourceMethods |= CPTableViewDataSource_tableView_acceptDrop_row_dropOperation_;
    if (objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:namesOfPromisedFilesDroppedAtDestination:forDraggedRowsWithIndexes:")))
        _implementedDataSourceMethods |= CPTableViewDataSource_tableView_namesOfPromisedFilesDroppedAtDestination_forDraggedRowsWithIndexes_;
    if (objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:validateDrop:proposedRow:proposedDropOperation:")))
        _implementedDataSourceMethods |= CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_;
    if (objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:writeRowsWithIndexes:toPasteboard:")))
        _implementedDataSourceMethods |= CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_;
    if (objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:sortDescriptorsDidChange:")))
        _implementedDataSourceMethods |= CPTableViewDataSource_tableView_sortDescriptorsDidChange_;
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("dataSource"), function(self, _cmd)
{ with(self)
{
    return _dataSource;
}
}), new objj_method(sel_getUid("reloadDataForRowIndexes:columnIndexes:"), function(self, _cmd, rowIndexes, columnIndexes)
{ with(self)
{
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("reloadData"), function(self, _cmd)
{ with(self)
{
    if (!_dataSource)
        return;
    _reloadAllRows = YES;
    _objectValues = { };
    objj_msgSend(self, "noteNumberOfRowsChanged");
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("setDoubleAction:"), function(self, _cmd, anAction)
{ with(self)
{
    _doubleAction = anAction;
}
}), new objj_method(sel_getUid("doubleAction"), function(self, _cmd)
{ with(self)
{
    return _doubleAction;
}
}), new objj_method(sel_getUid("setAllowsColumnReordering:"), function(self, _cmd, shouldAllowColumnReordering)
{ with(self)
{
    _allowsColumnReordering = !!shouldAllowColumnReordering;
}
}), new objj_method(sel_getUid("allowsColumnReordering"), function(self, _cmd)
{ with(self)
{
    return _allowsColumnReordering;
}
}), new objj_method(sel_getUid("setAllowsColumnResizing:"), function(self, _cmd, shouldAllowColumnResizing)
{ with(self)
{
    _allowsColumnResizing = !!shouldAllowColumnResizing;
}
}), new objj_method(sel_getUid("allowsColumnResizing"), function(self, _cmd)
{ with(self)
{
    return _allowsColumnResizing;
}
}), new objj_method(sel_getUid("setAllowsMultipleSelection:"), function(self, _cmd, shouldAllowMultipleSelection)
{ with(self)
{
    _allowsMultipleSelection = !!shouldAllowMultipleSelection;
}
}), new objj_method(sel_getUid("allowsMultipleSelection"), function(self, _cmd)
{ with(self)
{
    return _allowsMultipleSelection;
}
}), new objj_method(sel_getUid("setAllowsEmptySelection:"), function(self, _cmd, shouldAllowEmptySelection)
{ with(self)
{
    _allowsEmptySelection = !!shouldAllowEmptySelection;
}
}), new objj_method(sel_getUid("allowsEmptySelection"), function(self, _cmd)
{ with(self)
{
    return _allowsEmptySelection;
}
}), new objj_method(sel_getUid("setAllowsColumnSelection:"), function(self, _cmd, shouldAllowColumnSelection)
{ with(self)
{
    _allowsColumnSelection = !!shouldAllowColumnSelection;
}
}), new objj_method(sel_getUid("allowsColumnSelection"), function(self, _cmd)
{ with(self)
{
    return _allowsColumnSelection;
}
}), new objj_method(sel_getUid("setIntercellSpacing:"), function(self, _cmd, aSize)
{ with(self)
{
    if ((_intercellSpacing.width == aSize.width && _intercellSpacing.height == aSize.height))
        return;
    _intercellSpacing = { width:aSize.width, height:aSize.height };
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("setThemeState:"), function(self, _cmd, astae)
{ with(self)
{
}
}), new objj_method(sel_getUid("intercellSpacing"), function(self, _cmd)
{ with(self)
{
    return { width:_intercellSpacing.width, height:_intercellSpacing.height };
}
}), new objj_method(sel_getUid("setRowHeight:"), function(self, _cmd, aRowHeight)
{ with(self)
{
    aRowHeight = +aRowHeight;
    if (_rowHeight === aRowHeight)
        return;
    _rowHeight = MAX(0.0, aRowHeight);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("rowHeight"), function(self, _cmd)
{ with(self)
{
    return _rowHeight;
}
}), new objj_method(sel_getUid("setUsesAlternatingRowBackgroundColors:"), function(self, _cmd, shouldUseAlternatingRowBackgroundColors)
{ with(self)
{
    _usesAlternatingRowBackgroundColors = shouldUseAlternatingRowBackgroundColors;
}
}), new objj_method(sel_getUid("usesAlternatingRowBackgroundColors"), function(self, _cmd)
{ with(self)
{
    return _usesAlternatingRowBackgroundColors;
}
}), new objj_method(sel_getUid("setAlternatingRowBackgroundColors:"), function(self, _cmd, alternatingRowBackgroundColors)
{ with(self)
{
    if (objj_msgSend(_alternatingRowBackgroundColors, "isEqual:", alternatingRowBackgroundColors))
        return;
    _alternatingRowBackgroundColors = alternatingRowBackgroundColors;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("alternatingRowBackgroundColors"), function(self, _cmd)
{ with(self)
{
    return _alternatingRowBackgroundColors;
}
}), new objj_method(sel_getUid("selectionHighlightStyle"), function(self, _cmd)
{ with(self)
{
    return _selectionHighlightStyle;
}
}), new objj_method(sel_getUid("setSelectionHighlightStyle:"), function(self, _cmd, aSelectionHighlightStyle)
{ with(self)
{
    if (aSelectionHighlightStyle == CPTableViewSelectionHighlightStyleSourceList && !CPFeatureIsCompatible(CPHTMLCanvasFeature))
        return;
    _selectionHighlightStyle = aSelectionHighlightStyle;
    if (aSelectionHighlightStyle === CPTableViewSelectionHighlightStyleSourceList)
        _destinationDragStyle = CPTableViewDraggingDestinationFeedbackStyleSourceList;
    else
        _destinationDragStyle = CPTableViewDraggingDestinationFeedbackStyleRegular;
}
}), new objj_method(sel_getUid("setGridColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_gridColor === aColor)
        return;
    _gridColor = aColor;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("gridColor"), function(self, _cmd)
{ with(self)
{
    return _gridColor;
}
}), new objj_method(sel_getUid("setGridStyleMask:"), function(self, _cmd, aGrideStyleMask)
{ with(self)
{
    if (_gridStyleMask === aGrideStyleMask)
        return;
    _gridStyleMask = aGrideStyleMask;
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("gridStyleMask"), function(self, _cmd)
{ with(self)
{
    return _gridStyleMask;
}
}), new objj_method(sel_getUid("addTableColumn:"), function(self, _cmd, aTableColumn)
{ with(self)
{
    objj_msgSend(_tableColumns, "addObject:", aTableColumn);
    objj_msgSend(aTableColumn, "setTableView:", self);
    if (_dirtyTableColumnRangeIndex < 0)
        _dirtyTableColumnRangeIndex = (_tableColumns.length) - 1;
    else
        _dirtyTableColumnRangeIndex = MIN((_tableColumns.length) - 1, _dirtyTableColumnRangeIndex);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("removeTableColumn:"), function(self, _cmd, aTableColumn)
{ with(self)
{
    if (objj_msgSend(aTableColumn, "tableView") !== self)
        return;
    var index = objj_msgSend(_tableColumns, "indexOfObjectIdenticalTo:", aTableColumn);
    if (index === CPNotFound)
        return;
    objj_msgSend(aTableColumn, "setTableView:", nil);
    objj_msgSend(_tableColumns, "removeObjectAtIndex:", index);
    var tableColumnUID = objj_msgSend(aTableColumn, "UID");
    if (_objectValues[tableColumnUID])
        _objectValues[tableColumnUID] = nil;
    if (_dirtyTableColumnRangeIndex < 0)
        _dirtyTableColumnRangeIndex = index;
    else
        _dirtyTableColumnRangeIndex = MIN(index, _dirtyTableColumnRangeIndex);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("moveColumn:toColumn:"), function(self, _cmd, fromIndex, toIndex)
{ with(self)
{
    fromIndex = +fromIndex;
    toIndex = +toIndex;
    if (fromIndex === toIndex)
        return;
    if (_dirtyTableColumnRangeIndex < 0)
        _dirtyTableColumnRangeIndex = MIN(fromIndex, toIndex);
    else
        _dirtyTableColumnRangeIndex = MIN(fromIndex, toIndex, _dirtyTableColumnRangeIndex);
    if (toIndex > fromIndex)
        --toIndex;
    var tableColumn = _tableColumns[fromIndex];
    objj_msgSend(_tableColumns, "removeObjectAtIndex:", fromIndex);
    objj_msgSend(_tableColumns, "insertObject:atIndex:", tableColumn, toIndex);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("tableColumns"), function(self, _cmd)
{ with(self)
{
    return _tableColumns;
}
}), new objj_method(sel_getUid("columnWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    var index = 0,
        count = (_tableColumns.length);
    for (; index < count; ++index)
        if (objj_msgSend(_tableColumns[index], "identifier") === anIdentifier)
            return index;
    return CPNotFound;
}
}), new objj_method(sel_getUid("tableColumnWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    var index = objj_msgSend(self, "columnWithIdentifier:", anIdentifier);
    if (index === CPNotFound)
        return nil;
    return _tableColumns[index];
}
}), new objj_method(sel_getUid("selectColumnIndexes:byExtendingSelection:"), function(self, _cmd, columns, shouldExtendSelection)
{ with(self)
{
    if ((objj_msgSend(columns, "firstIndex") != CPNotFound && objj_msgSend(columns, "firstIndex") < 0) || objj_msgSend(columns, "lastIndex") >= objj_msgSend(self, "numberOfColumns"))
        return;
    if (objj_msgSend(_selectedRowIndexes, "count") > 0)
    {
        objj_msgSend(self, "_updateHighlightWithOldRows:newRows:", _selectedRowIndexes, objj_msgSend(CPIndexSet, "indexSet"));
        _selectedRowIndexes = objj_msgSend(CPIndexSet, "indexSet");
    }
    var previousSelectedIndexes = objj_msgSend(_selectedColumnIndexes, "copy");
    if (shouldExtendSelection)
        objj_msgSend(_selectedColumnIndexes, "addIndexes:", columns);
    else
        _selectedColumnIndexes = objj_msgSend(columns, "copy");
    objj_msgSend(self, "_updateHighlightWithOldColumns:newColumns:", previousSelectedIndexes, _selectedColumnIndexes);
    objj_msgSend(_tableDrawView, "display");
    objj_msgSend(_headerView, "setNeedsDisplay:", YES);
    objj_msgSend(self, "_noteSelectionDidChange");
}
}), new objj_method(sel_getUid("selectRowIndexes:byExtendingSelection:"), function(self, _cmd, rows, shouldExtendSelection)
{ with(self)
{
    if (objj_msgSend(rows, "isEqualToIndexSet:", _selectedRowIndexes) ||
        ((objj_msgSend(rows, "firstIndex") != CPNotFound && objj_msgSend(rows, "firstIndex") < 0) || objj_msgSend(rows, "lastIndex") >= objj_msgSend(self, "numberOfRows")))
        return;
    if (objj_msgSend(_selectedColumnIndexes, "count") > 0)
    {
        objj_msgSend(self, "_updateHighlightWithOldColumns:newColumns:", _selectedColumnIndexes, objj_msgSend(CPIndexSet, "indexSet"));
        _selectedColumnIndexes = objj_msgSend(CPIndexSet, "indexSet");
        objj_msgSend(_headerView, "setNeedsDisplay:", YES);
    }
    var previousSelectedIndexes = objj_msgSend(_selectedRowIndexes, "copy");
    if (shouldExtendSelection)
        objj_msgSend(_selectedRowIndexes, "addIndexes:", rows);
    else
        _selectedRowIndexes = objj_msgSend(rows, "copy");
    objj_msgSend(self, "_updateHighlightWithOldRows:newRows:", previousSelectedIndexes, _selectedRowIndexes);
    objj_msgSend(_tableDrawView, "display");
    objj_msgSend(self, "_noteSelectionDidChange");
}
}), new objj_method(sel_getUid("_updateHighlightWithOldRows:newRows:"), function(self, _cmd, oldRows, newRows)
{ with(self)
{
    var firstExposedRow = objj_msgSend(_exposedRows, "firstIndex"),
        exposedLength = objj_msgSend(_exposedRows, "lastIndex") - firstExposedRow + 1,
        deselectRows = [],
        selectRows = [],
        deselectRowIndexes = objj_msgSend(oldRows, "copy"),
        selectRowIndexes = objj_msgSend(newRows, "copy");
    objj_msgSend(deselectRowIndexes, "removeMatches:", selectRowIndexes);
    objj_msgSend(deselectRowIndexes, "getIndexes:maxCount:inIndexRange:", deselectRows, -1, CPMakeRange(firstExposedRow, exposedLength));
    objj_msgSend(selectRowIndexes, "getIndexes:maxCount:inIndexRange:", selectRows, -1, CPMakeRange(firstExposedRow, exposedLength));
    for (var identifier in _dataViewsForTableColumns)
    {
        var dataViewsInTableColumn = _dataViewsForTableColumns[identifier];
        var count = deselectRows.length;
        while (count--)
        {
            var rowIndex = deselectRows[count];
            var view = dataViewsInTableColumn[rowIndex];
            objj_msgSend(view, "unsetThemeState:", CPThemeStateHighlighted);
        }
        count = selectRows.length;
        while (count--)
        {
            var rowIndex = selectRows[count];
            var view = dataViewsInTableColumn[rowIndex];
            objj_msgSend(view, "setThemeState:", CPThemeStateHighlighted);
        }
    }
}
}), new objj_method(sel_getUid("_updateHighlightWithOldColumns:newColumns:"), function(self, _cmd, oldColumns, newColumns)
{ with(self)
{
    var firstExposedColumn = objj_msgSend(_exposedColumns, "firstIndex"),
        exposedLength = objj_msgSend(_exposedColumns, "lastIndex") - firstExposedColumn +1,
        deselectColumns = [],
        selectColumns = [],
        deselectColumnIndexes = objj_msgSend(oldColumns, "copy"),
        selectColumnIndexes = objj_msgSend(newColumns, "copy"),
        selectRows = [];
    objj_msgSend(deselectColumnIndexes, "removeMatches:", selectColumnIndexes);
    objj_msgSend(deselectColumnIndexes, "getIndexes:maxCount:inIndexRange:", deselectColumns, -1, CPMakeRange(firstExposedColumn, exposedLength));
    objj_msgSend(selectColumnIndexes, "getIndexes:maxCount:inIndexRange:", selectColumns, -1, CPMakeRange(firstExposedColumn, exposedLength));
    objj_msgSend(_exposedRows, "getIndexes:maxCount:inIndexRange:", selectRows, -1, nil);
    var rowsCount = selectRows.length,
        count = deselectColumns.length;
    while (count--)
    {
        var columnIndex = deselectColumns[count],
            identifier = objj_msgSend(_tableColumns[columnIndex], "UID"),
            dataViewsInTableColumn = _dataViewsForTableColumns[identifier];
        for (var i = 0; i < rowsCount; i++)
        {
            var rowIndex = selectRows[i],
                dataView = dataViewsInTableColumn[rowIndex];
            objj_msgSend(dataView, "unsetThemeState:", CPThemeStateHighlighted);
        }
        var headerView = objj_msgSend(_tableColumns[columnIndex], "headerView");
        objj_msgSend(headerView, "unsetThemeState:", CPThemeStateHighlighted);
    }
    count = selectColumns.length;
    while (count--)
    {
        var columnIndex = selectColumns[count],
            identifier = objj_msgSend(_tableColumns[columnIndex], "UID"),
            dataViewsInTableColumn = _dataViewsForTableColumns[identifier];
        for (var i = 0; i < rowsCount; i++)
        {
            var rowIndex = selectRows[i],
                dataView = dataViewsInTableColumn[rowIndex];
            objj_msgSend(dataView, "setThemeState:", CPThemeStateHighlighted);
        }
        var headerView = objj_msgSend(_tableColumns[columnIndex], "headerView");
        objj_msgSend(headerView, "setThemeState:", CPThemeStateHighlighted);
    }
}
}), new objj_method(sel_getUid("selectedColumnIndexes"), function(self, _cmd)
{ with(self)
{
    return _selectedColumnIndexes;
}
}), new objj_method(sel_getUid("selectedRowIndexes"), function(self, _cmd)
{ with(self)
{
    return _selectedRowIndexes;
}
}), new objj_method(sel_getUid("deselectColumn:"), function(self, _cmd, aColumn)
{ with(self)
{
    var selectedColumnIndexes = objj_msgSend(_selectedColumnIndexes, "copy");
    objj_msgSend(selectedColumnIndexes, "removeIndex:", aColumn);
    objj_msgSend(self, "selectColumnIndexes:byExtendingSelection:", selectedColumnIndexes, NO);
    objj_msgSend(self, "_noteSelectionDidChange");
}
}), new objj_method(sel_getUid("deselectRow:"), function(self, _cmd, aRow)
{ with(self)
{
    var selectedRowIndexes = objj_msgSend(_selectedRowIndexes, "copy");
    objj_msgSend(selectedRowIndexes, "removeIndex:", aRow);
    objj_msgSend(self, "selectRowIndexes:byExtendingSelection:", selectedRowIndexes, NO);
    objj_msgSend(self, "_noteSelectionDidChange");
}
}), new objj_method(sel_getUid("numberOfSelectedColumns"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_selectedColumnIndexes, "count");
}
}), new objj_method(sel_getUid("numberOfSelectedRows"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_selectedRowIndexes, "count");
}
}), new objj_method(sel_getUid("isColumnSelected:"), function(self, _cmd, aColumn)
{ with(self)
{
    return objj_msgSend(_selectedColumnIndexes, "containsIndex:", aColumn);
}
}), new objj_method(sel_getUid("isRowSelected:"), function(self, _cmd, aRow)
{ with(self)
{
    return objj_msgSend(_selectedRowIndexes, "containsIndex:", aRow);
}
}), new objj_method(sel_getUid("deselectAll"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "selectRowIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSet"), NO);
    objj_msgSend(self, "selectColumnIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSet"), NO);
}
}), new objj_method(sel_getUid("numberOfColumns"), function(self, _cmd)
{ with(self)
{
    return (_tableColumns.length);
}
}), new objj_method(sel_getUid("numberOfRows"), function(self, _cmd)
{ with(self)
{
    if (!_dataSource)
        return 0;
    return objj_msgSend(_dataSource, "numberOfRowsInTableView:", self);
}
}), new objj_method(sel_getUid("cornerView"), function(self, _cmd)
{ with(self)
{
    return _cornerView;
}
}), new objj_method(sel_getUid("setCornerView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_cornerView === aView)
        return;
    _cornerView = aView;
    var scrollView = objj_msgSend(objj_msgSend(self, "superview"), "superview");
    if (objj_msgSend(scrollView, "isKindOfClass:", objj_msgSend(CPScrollView, "class")) && objj_msgSend(scrollView, "documentView") === self)
        objj_msgSend(scrollView, "_updateCornerAndHeaderView");
}
}), new objj_method(sel_getUid("headerView"), function(self, _cmd)
{ with(self)
{
    return _headerView;
}
}), new objj_method(sel_getUid("setHeaderView:"), function(self, _cmd, aHeaderView)
{ with(self)
{
    if (_headerView === aHeaderView)
        return;
    objj_msgSend(_headerView, "setTableView:", nil);
    _headerView = aHeaderView;
    if (_headerView)
    {
        objj_msgSend(_headerView, "setTableView:", self);
        objj_msgSend(_headerView, "setFrameSize:", { width:(objj_msgSend(self, "frame").size.width), height:(objj_msgSend(_headerView, "frame").size.height) });
    }
    var scrollView = objj_msgSend(objj_msgSend(self, "superview"), "superview");
    if (objj_msgSend(scrollView, "isKindOfClass:", objj_msgSend(CPScrollView, "class")) && objj_msgSend(scrollView, "documentView") === self)
        objj_msgSend(scrollView, "_updateCornerAndHeaderView");
}
}), new objj_method(sel_getUid("_recalculateTableColumnRanges"), function(self, _cmd)
{ with(self)
{
    if (_dirtyTableColumnRangeIndex < 0)
        return;
    var index = _dirtyTableColumnRangeIndex,
        count = (_tableColumns.length),
        x = index === 0 ? 0.0 : CPMaxRange(_tableColumnRanges[index - 1]);
    for (; index < count; ++index)
    {
        var tableColumn = _tableColumns[index];
        if (objj_msgSend(tableColumn, "isHidden"))
            _tableColumnRanges[index] = CPMakeRange(x, 0.0);
        else
        {
            var width = objj_msgSend(_tableColumns[index], "width");
            _tableColumnRanges[index] = CPMakeRange(x, width);
            x += width;
        }
    }
    _tableColumnRanges.length = count;
    _dirtyTableColumnRangeIndex = CPNotFound;
}
}), new objj_method(sel_getUid("rectOfColumn:"), function(self, _cmd, aColumnIndex)
{ with(self)
{
    aColumnIndex = +aColumnIndex;
    if (aColumnIndex < 0 || aColumnIndex >= (_tableColumns.length))
        return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
    var range = _tableColumnRanges[aColumnIndex];
    return { origin: { x:range.location, y:0.0 }, size: { width:range.length, height:CGRectGetHeight(objj_msgSend(self, "bounds")) } };
}
}), new objj_method(sel_getUid("rectOfRow:"), function(self, _cmd, aRowIndex)
{ with(self)
{
    if (NO)
        return NULL;
    return { origin: { x:0.0, y:(aRowIndex * (_rowHeight + _intercellSpacing.height)) }, size: { width:(objj_msgSend(self, "bounds").size.width), height:_rowHeight } };
}
}), new objj_method(sel_getUid("rowsInRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if (_numberOfRows <= 0)
        return CPMakeRange(0, 0);
    var bounds = objj_msgSend(self, "bounds");
    if (!CGRectIntersectsRect(aRect, bounds))
        return CPMakeRange(0, 0);
    var firstRow = objj_msgSend(self, "rowAtPoint:", aRect.origin);
    if (firstRow < 0)
        firstRow = 0;
    var lastRow = objj_msgSend(self, "rowAtPoint:", { x:0.0, y:(aRect.origin.y + aRect.size.height) });
    if (lastRow < 0)
        lastRow = _numberOfRows - 1;
    return CPMakeRange(firstRow, lastRow - firstRow + 1);
}
}), new objj_method(sel_getUid("columnIndexesInRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var column = MAX(0, objj_msgSend(self, "columnAtPoint:", { x:aRect.origin.x, y:0.0 })),
        lastColumn = objj_msgSend(self, "columnAtPoint:", { x:(aRect.origin.x + aRect.size.width), y:0.0 });
    if (lastColumn === CPNotFound)
        lastColumn = (_tableColumns.length) - 1;
    if (_numberOfHiddenColumns <= 0)
        return objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", CPMakeRange(column, lastColumn - column + 1));
    var indexSet = objj_msgSend(CPIndexSet, "indexSet");
    for (; column <= lastColumn; ++column)
    {
        var tableColumn = _tableColumns[column];
        if (!objj_msgSend(tableColumn, "isHidden"))
            objj_msgSend(indexSet, "addIndex:", column);
    }
    return indexSet;
}
}), new objj_method(sel_getUid("columnAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds");
    if (!(aPoint.x >= (bounds.origin.x) && aPoint.y >= (bounds.origin.y) && aPoint.x < (bounds.origin.x + bounds.size.width) && aPoint.y < (bounds.origin.y + bounds.size.height)))
        return CPNotFound;
    if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
    var x = aPoint.x,
        low = 0,
        high = _tableColumnRanges.length - 1;
    while (low <= high)
    {
        var middle = FLOOR(low + (high - low) / 2),
            range = _tableColumnRanges[middle];
        if (x < range.location)
            high = middle - 1;
        else if (x >= CPMaxRange(range))
            low = middle + 1;
        else
        {
            var numberOfColumns = _tableColumnRanges.length;
            while (middle < numberOfColumns && objj_msgSend(_tableColumns[middle], "isHidden"))
                ++middle;
            if (middle < numberOfColumns)
                return middle;
            return CPNotFound;
        }
   }
   return CPNotFound;
}
}), new objj_method(sel_getUid("rowAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var y = aPoint.y;
    var row = FLOOR(y / (_rowHeight + _intercellSpacing.height));
    if (row >= _numberOfRows)
        return -1;
    return row;
}
}), new objj_method(sel_getUid("frameOfDataViewAtColumn:row:"), function(self, _cmd, aColumn, aRow)
{ with(self)
{
    if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
    var tableColumnRange = _tableColumnRanges[aColumn],
        rectOfRow = objj_msgSend(self, "rectOfRow:", aRow);
    return { origin: { x:tableColumnRange.location, y:(rectOfRow.origin.y) }, size: { width:tableColumnRange.length, height:(rectOfRow.size.height) } };
}
}), new objj_method(sel_getUid("resizeWithOldSuperviewSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableView").super_class }, "resizeWithOldSuperviewSize:", aSize);
    if (_disableAutomaticResizing)
        return;
    var mask = _columnAutoResizingStyle;
    if(mask === CPTableViewUniformColumnAutoresizingStyle)
    {
       objj_msgSend(self, "_resizeAllColumnUniformlyWithOldSize:", aSize);
    }
    if(mask === CPTableViewLastColumnOnlyAutoresizingStyle)
    {
        objj_msgSend(self, "sizeLastColumnToFit");
    }
    if(mask === CPTableViewFirstColumnOnlyAutoresizingStyle)
    {
        var superview = objj_msgSend(self, "superview");
        if (!superview)
            return;
        var superviewSize = objj_msgSend(superview, "bounds").size;
        if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
        var count = (_tableColumns.length);
        var visColumns = objj_msgSend(objj_msgSend(CPArray, "alloc"), "init");
        var totalWidth = 0;
        for(var i=0; i < count; i++)
        {
            if(!objj_msgSend(_tableColumns[i], "isHidden"))
            {
                objj_msgSend(visColumns, "addObject:", i);
                totalWidth += objj_msgSend(_tableColumns[i], "width");
            }
        }
        count = objj_msgSend(visColumns, "count");
        if (count > 0)
        {
            var columnToResize = _tableColumns[visColumns[0]];
            var newWidth = superviewSize.width - totalWidth;
            newWidth += objj_msgSend(columnToResize, "width");
            newWidth = (newWidth < objj_msgSend(columnToResize, "minWidth")) ? objj_msgSend(columnToResize, "minWidth") : newWidth;
            newWidth = (newWidth > objj_msgSend(columnToResize, "maxWidth")) ? objj_msgSend(columnToResize, "maxWidth") : newWidth;
            objj_msgSend(columnToResize, "setWidth:", FLOOR(newWidth));
        }
        objj_msgSend(self, "setNeedsLayout");
    }
}
}), new objj_method(sel_getUid("_resizeAllColumnUniformlyWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
        var superview = objj_msgSend(self, "superview");
        if (!superview)
            return;
        var superviewSize = objj_msgSend(superview, "bounds").size;
        if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
        var count = (_tableColumns.length);
        var visColumns = objj_msgSend(objj_msgSend(CPArray, "alloc"), "init");
        for(var i=0; i < count; i++)
        {
            var tableColumn = _tableColumns[i];
            if(!objj_msgSend(tableColumn, "isHidden") && (objj_msgSend(tableColumn, "resizingMask") & CPTableColumnAutoresizingMask))
                objj_msgSend(visColumns, "addObject:", i);
        }
        count = objj_msgSend(visColumns, "count");
        if (count > 0)
        {
            var g = superviewSize.width / aSize.width;
                buffer = 0.0;
            for (var i = 0; i < count; i++)
            {
                var column = visColumns[i];
                    columnToResize = _tableColumns[column],
                    newWidth = g * objj_msgSend(columnToResize, "width");
                var fbuffer = FLOOR(buffer);
                newWidth += fbuffer;
                buffer -= fbuffer;
                var fwidth = MAX(objj_msgSend(columnToResize, "minWidth"), MIN(FLOOR(newWidth),objj_msgSend(columnToResize, "maxWidth")));
                buffer += newWidth - fwidth;
                objj_msgSend(columnToResize, "setWidth:", fwidth);
            }
        }
        objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("setColumnAutoresizingStyle:"), function(self, _cmd, style)
{ with(self)
{
    _columnAutoResizingStyle = style;
}
}), new objj_method(sel_getUid("columnAutoresizingStyle"), function(self, _cmd)
{ with(self)
{
    return _columnAutoResizingStyle;
}
}), new objj_method(sel_getUid("sizeLastColumnToFit"), function(self, _cmd)
{ with(self)
{
    var superview = objj_msgSend(self, "superview");
    if (!superview)
        return;
    var superviewSize = objj_msgSend(superview, "bounds").size;
    if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
    var count = (_tableColumns.length);
    while (count-- && objj_msgSend(_tableColumns[count], "isHidden")) ;
    if (count >= 0)
    {
        var columnToResize = _tableColumns[count];
        var newSize = MAX(0.0, superviewSize.width - CGRectGetMinX(objj_msgSend(self, "rectOfColumn:", count)));
        if (newSize > 0)
        {
            newSize = MAX(objj_msgSend(columnToResize, "minWidth"), newSize);
            newSize = MIN(objj_msgSend(columnToResize, "maxWidth"), newSize);
            objj_msgSend(columnToResize, "setWidth:", newSize);
        }
    }
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("noteNumberOfRowsChanged"), function(self, _cmd)
{ with(self)
{
    _numberOfRows = objj_msgSend(_dataSource, "numberOfRowsInTableView:", self);
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
    var width = _tableColumnRanges.length > 0 ? CPMaxRange(objj_msgSend(_tableColumnRanges, "lastObject")) : 0.0,
        height = (_rowHeight + _intercellSpacing.height) * _numberOfRows,
        superview = objj_msgSend(self, "superview");
    if (objj_msgSend(superview, "isKindOfClass:", objj_msgSend(CPClipView, "class")))
    {
        var superviewSize = objj_msgSend(superview, "bounds").size;
        width = MAX(superviewSize.width, width);
        height = MAX(superviewSize.height, height);
    }
    objj_msgSend(self, "setFrameSize:", { width:width, height:height });
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("scrollRowToVisible:"), function(self, _cmd, rowIndex)
{ with(self)
{
    objj_msgSend(self, "scrollRectToVisible:", objj_msgSend(self, "rectOfRow:", rowIndex));
}
}), new objj_method(sel_getUid("scrollColumnToVisible:"), function(self, _cmd, columnIndex)
{ with(self)
{
    objj_msgSend(self, "scrollRectToVisible:", objj_msgSend(self, "rectOfColumn:", columnIndex));
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    if (_delegate === aDelegate)
        return;
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_delegate)
    {
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewColumnDidMove:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPTableViewColumnDidMoveNotification, self);
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewColumnDidResize:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPTableViewColumnDidResizeNotification, self);
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewSelectionDidChange:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPTableViewSelectionDidChangeNotification, self);
        if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewSelectionIsChanging:")))
            objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPTableViewSelectionIsChangingNotification, self);
    }
    _delegate = aDelegate;
    _implementedDelegateMethods = 0;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("selectionShouldChangeInTableView:")))
        _implementedDelegateMethods |= CPTableViewDelegate_selectionShouldChangeInTableView_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:dataViewForTableColumn:row:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_dataViewForTableColumn_row_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:didClickTableColumn:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_didClickTableColumn_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:didDragTableColumn:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_didDragTableColumn_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:heightOfRow:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_heightOfRow_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:isGroupRow:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_isGroupRow_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:mouseDownInHeaderOfTableColumn:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_mouseDownInHeaderOfTableColumn_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:nextTypeSelectMatchFromRow:toRow:forString:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_nextTypeSelectMatchFromRow_toRow_forString_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:selectionIndexesForProposedSelection:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_selectionIndexesForProposedSelection_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:shouldEditTableColumn:row:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_shouldEditTableColumn_row_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:shouldSelectRow:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_shouldSelectRow_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:shouldSelectTableColumn:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_shouldSelectTableColumn_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:shouldShowViewExpansionForTableColumn:row:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_shouldShowViewExpansionForTableColumn_row_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:shouldTrackView:forTableColumn:row:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_shouldTrackView_forTableColumn_row_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:shouldTypeSelectForEvent:withCurrentSearchString:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_shouldTypeSelectForEvent_withCurrentSearchString_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:toolTipForView:rect:tableColumn:row:mouseLocation:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_toolTipForView_rect_tableColumn_row_mouseLocation_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:typeSelectStringForTableColumn:row:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_typeSelectStringForTableColumn_row_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableView:willDisplayView:forTableColumn:row:")))
        _implementedDelegateMethods |= CPTableViewDelegate_tableView_willDisplayView_forTableColumn_row_;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewColumnDidMove:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("tableViewColumnDidMove:"), CPTableViewColumnDidMoveNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewColumnDidResize:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("tableViewColumnDidResize:"), CPTableViewColumnDidResizeNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewSelectionDidChange:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("tableViewSelectionDidChange:"), CPTableViewSelectionDidChangeNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tableViewSelectionIsChanging:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("tableViewSelectionIsChanging:"), CPTableViewSelectionIsChangingNotification, self);
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("_sendDelegateDidClickColumn:"), function(self, _cmd, column)
{ with(self)
{
    if (_implementedDelegateMethods & CPTableViewDelegate_tableView_didClickTableColumn_)
            objj_msgSend(_delegate, "tableView:didClickTableColumn:", self, _tableColumns[column]);
}
}), new objj_method(sel_getUid("_sendDelegateDidDragColumn:"), function(self, _cmd, column)
{ with(self)
{
    if (_implementedDelegateMethods & CPTableViewDelegate_tableView_didDragTableColumn_)
            objj_msgSend(_delegate, "tableView:didDragTableColumn:", self, _tableColumns[column]);
}
}), new objj_method(sel_getUid("_sendDelegateDidMouseDownInHeader:"), function(self, _cmd, column)
{ with(self)
{
    if (_implementedDelegateMethods & CPTableViewDelegate_tableView_mouseDownInHeaderOfTableColumn_)
            objj_msgSend(_delegate, "tableView:mouseDownInHeaderOfTableColumn:", self, _tableColumns[column]);
}
}), new objj_method(sel_getUid("_sendDataSourceSortDescriptorsDidChange:"), function(self, _cmd, oldDescriptors)
{ with(self)
{
    if (_implementedDataSourceMethods & CPTableViewDataSource_tableView_sortDescriptorsDidChange_)
            objj_msgSend(_dataSource, "tableView:sortDescriptorsDidChange:", self, oldDescriptors);
}
}), new objj_method(sel_getUid("_didClickTableColumn:modifierFlags:"), function(self, _cmd, clickedColumn, modifierFlags)
{ with(self)
{
    objj_msgSend(self, "_sendDelegateDidClickColumn:", clickedColumn);
    if (_allowsColumnSelection)
    {
        if (modifierFlags & CPCommandKeyMask)
        {
            if (objj_msgSend(self, "isColumnSelected:", clickedColumn))
                objj_msgSend(self, "deselectColumn:", clickedColumn);
            else if (objj_msgSend(self, "allowsMultipleSelection") == YES)
                objj_msgSend(self, "selectColumnIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", clickedColumn), YES);
            return;
        }
        else if (modifierFlags & CPShiftKeyMask)
        {
            var startColumn = MIN(clickedColumn, objj_msgSend(_selectedColumnIndexes, "lastIndex")),
                endColumn = MAX(clickedColumn, objj_msgSend(_selectedColumnIndexes, "firstIndex"));
            objj_msgSend(self, "selectColumnIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", CPMakeRange(startColumn, endColumn - startColumn + 1)), YES);
            return;
        }
        else
            objj_msgSend(self, "selectColumnIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", clickedColumn), NO);
    }
    objj_msgSend(self, "_changeSortDescriptorsForClickOnColumn:", clickedColumn);
}
}), new objj_method(sel_getUid("_changeSortDescriptorsForClickOnColumn:"), function(self, _cmd, column)
{ with(self)
{
    var tableColumn = objj_msgSend(_tableColumns, "objectAtIndex:", column),
        newMainSortDescriptor = objj_msgSend(tableColumn, "sortDescriptorPrototype");
    if (!newMainSortDescriptor)
       return;
    var oldMainSortDescriptor = nil,
        oldSortDescriptors = objj_msgSend(self, "sortDescriptors"),
        newSortDescriptors = objj_msgSend(CPArray, "arrayWithArray:", oldSortDescriptors),
        e = objj_msgSend(newSortDescriptors, "objectEnumerator"),
        descriptor = nil,
        outdatedDescriptors = objj_msgSend(CPArray, "array");
    if (objj_msgSend(_sortDescriptors, "count") > 0)
        oldMainSortDescriptor = objj_msgSend(objj_msgSend(self, "sortDescriptors"), "objectAtIndex:",  0);
    while ((descriptor = objj_msgSend(e, "nextObject")) != nil)
    {
        if (objj_msgSend(objj_msgSend(descriptor, "key"), "isEqual:",  objj_msgSend(newMainSortDescriptor, "key")))
            objj_msgSend(outdatedDescriptors, "addObject:", descriptor);
    }
    if (objj_msgSend(objj_msgSend(newMainSortDescriptor, "key"), "isEqual:", objj_msgSend(oldMainSortDescriptor, "key")))
        newMainSortDescriptor = objj_msgSend(oldMainSortDescriptor, "reversedSortDescriptor");
    objj_msgSend(newSortDescriptors, "removeObjectsInArray:", outdatedDescriptors);
    objj_msgSend(newSortDescriptors, "insertObject:atIndex:", newMainSortDescriptor, 0);
    var image = objj_msgSend(newMainSortDescriptor, "ascending") ? objj_msgSend(CPTableView, "_defaultTableHeaderSortImage") : objj_msgSend(CPTableView, "_defaultTableHeaderReverseSortImage");
    objj_msgSend(self, "setIndicatorImage:inTableColumn:", nil, _currentHighlightedTableColumn);
 objj_msgSend(self, "setIndicatorImage:inTableColumn:", image, tableColumn);
 objj_msgSend(self, "setHighlightedTableColumn:", tableColumn);
    objj_msgSend(self, "setSortDescriptors:", newSortDescriptors);
}
}), new objj_method(sel_getUid("setIndicatorImage:inTableColumn:"), function(self, _cmd, anImage, aTableColumn)
{ with(self)
{
    if (aTableColumn)
        objj_msgSend(objj_msgSend(aTableColumn, "headerView"), "_setIndicatorImage:", anImage);
}
}), new objj_method(sel_getUid("highlightedTableColumn"), function(self, _cmd)
{ with(self)
{
    return _currentHighlightedTableColumn;
}
}), new objj_method(sel_getUid("setHighlightedTableColumn:"), function(self, _cmd, aTableColumn)
{ with(self)
{
    if (_currentHighlightedTableColumn == aTableColumn)
        return;
    if (_currentHighlightedTableColumn != nil)
        objj_msgSend(objj_msgSend(_currentHighlightedTableColumn, "headerView"), "unsetThemeState:", CPThemeStateHighlighted);
    if (aTableColumn != nil)
        objj_msgSend(objj_msgSend(aTableColumn, "headerView"), "setThemeState:", CPThemeStateHighlighted);
    _currentHighlightedTableColumn = aTableColumn;
}
}), new objj_method(sel_getUid("canDragRowsWithIndexes:atPoint:"), function(self, _cmd, rowIndexes, mouseDownPoint)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("dragImageForRowsWithIndexes:tableColumns:event:offset:"), function(self, _cmd, dragRows, theTableColumns, dragEvent, dragImageOffset)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", "Frameworks/AppKit/Resources/GenericFile.png", CGSizeMake(32,32));
}
}), new objj_method(sel_getUid("dragViewForRowsWithIndexes:tableColumns:event:offset:"), function(self, _cmd, theDraggedRows, theTableColumns, theDragEvent, dragViewOffset)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds"),
        view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", bounds);
    objj_msgSend(view, "setBackgroundColor:", objj_msgSend(CPColor, "clearColor"));
    objj_msgSend(view, "setAlphaValue:", 0.7);
    var firstExposedColumn = objj_msgSend(_exposedColumns, "firstIndex"),
        firstExposedRow = objj_msgSend(_exposedRows, "firstIndex"),
        exposedColumnsLength = objj_msgSend(_exposedColumns, "lastIndex") - firstExposedColumn + 1,
        exposedRowsLength = objj_msgSend(_exposedRows, "lastIndex") - firstExposedRow + 1,
        columns = [],
        rows = [];
    objj_msgSend(_exposedColumns, "getIndexes:maxCount:inIndexRange:", columns, -1, CPMakeRange(firstExposedColumn, exposedColumnsLength));
    objj_msgSend(theDraggedRows, "getIndexes:maxCount:inIndexRange:", rows, -1, CPMakeRange(firstExposedRow, exposedRowsLength));
    var columnIndex = objj_msgSend(columns, "count");
    while (columnIndex--)
    {
        var column = columns[columnIndex],
            tableColumn = objj_msgSend(_tableColumns, "objectAtIndex:", column),
            rowIndex = objj_msgSend(rows, "count");
        while (rowIndex--)
        {
            var row = rows[rowIndex];
            var dataView = objj_msgSend(self, "_newDataViewForRow:tableColumn:", row, tableColumn);
            objj_msgSend(dataView, "setBackgroundColor:", objj_msgSend(CPColor, "clearColor"));
            objj_msgSend(dataView, "setFrame:", objj_msgSend(self, "frameOfDataViewAtColumn:row:", column, row));
            objj_msgSend(dataView, "setObjectValue:", objj_msgSend(self, "_objectValueForTableColumn:row:", tableColumn, row));
            objj_msgSend(view, "addSubview:", dataView);
        }
    }
    var dragPoint = objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(theDragEvent, "locationInWindow"), nil);
    dragViewOffset.x = CGRectGetWidth(bounds)/2 - dragPoint.x;
    dragViewOffset.y = CGRectGetHeight(bounds)/2 - dragPoint.y;
    return view;
}
}), new objj_method(sel_getUid("setDraggingSourceOperationMask:forLocal:"), function(self, _cmd, mask, isLocal)
{ with(self)
{
    _dragOperationDefaultMask = mask;
}
}), new objj_method(sel_getUid("setDropRow:dropOperation:"), function(self, _cmd, row, operation)
{ with(self)
{
    if(row < 0 && operation === CPTableViewDropAbove)
        row = 0;
    if(row >= objj_msgSend(self, "numberOfRows") && operation === CPTableViewDropOn)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "Attempt to set dropRow="+ row +", dropOperation=CPTableViewDropOn when [0 - "+
                           objj_msgSend(self, "numberOfRows") +"] is valid range of rows.");
    _retargetedDropRow = row;
    _retargetedDropOperation = operation;
}
}), new objj_method(sel_getUid("setDraggingDestinationFeedbackStyle:"), function(self, _cmd, aStyle)
{ with(self)
{
    _destinationDragStyle = aStyle;
}
}), new objj_method(sel_getUid("draggingDestinationFeedbackStyle"), function(self, _cmd)
{ with(self)
{
    return _destinationDragStyle;
}
}), new objj_method(sel_getUid("setVerticalMotionCanBeginDrag:"), function(self, _cmd, aFlag)
{ with(self)
{
    _verticalMotionCanDrag = aFlag;
}
}), new objj_method(sel_getUid("verticalMotionCanBeginDrag"), function(self, _cmd)
{ with(self)
{
    return _verticalMotionCanDrag;
}
}), new objj_method(sel_getUid("setSortDescriptors:"), function(self, _cmd, sortDescriptors)
{ with(self)
{
    var oldSortDescriptors = objj_msgSend(self, "sortDescriptors"),
        newSortDescriptors = nil;
    if (sortDescriptors == nil)
        newSortDescriptors = objj_msgSend(CPArray, "array");
    else
        newSortDescriptors = objj_msgSend(CPArray, "arrayWithArray:", sortDescriptors);
    if (objj_msgSend(newSortDescriptors, "isEqual:", oldSortDescriptors))
        return;
    _sortDescriptors = newSortDescriptors;
   objj_msgSend(self, "_sendDataSourceSortDescriptorsDidChange:", oldSortDescriptors);
}
}), new objj_method(sel_getUid("sortDescriptors"), function(self, _cmd)
{ with(self)
{
    return _sortDescriptors;
}
}), new objj_method(sel_getUid("_objectValueForTableColumn:row:"), function(self, _cmd, aTableColumn, aRowIndex)
{ with(self)
{
    var tableColumnUID = objj_msgSend(aTableColumn, "UID"),
        tableColumnObjectValues = _objectValues[tableColumnUID];
    if (!tableColumnObjectValues)
    {
        tableColumnObjectValues = [];
        _objectValues[tableColumnUID] = tableColumnObjectValues;
    }
    var objectValue = tableColumnObjectValues[aRowIndex];
    if (objectValue === undefined)
    {
        objectValue = objj_msgSend(_dataSource, "tableView:objectValueForTableColumn:row:", self, aTableColumn, aRowIndex);
        tableColumnObjectValues[aRowIndex] = objectValue;
    }
    return objectValue;
}
}), new objj_method(sel_getUid("_exposedRect"), function(self, _cmd)
{ with(self)
{
    var superview = objj_msgSend(self, "superview");
    if (!objj_msgSend(superview, "isKindOfClass:", objj_msgSend(CPClipView, "class")))
        return objj_msgSend(self, "bounds");
    return objj_msgSend(self, "convertRect:fromView:", CGRectIntersection(objj_msgSend(superview, "bounds"), objj_msgSend(self, "frame")), superview);
}
}), new objj_method(sel_getUid("load"), function(self, _cmd)
{ with(self)
{
    if (_reloadAllRows)
    {
        objj_msgSend(self, "_unloadDataViewsInRows:columns:", _exposedRows, _exposedColumns);
        _exposedRows = objj_msgSend(CPIndexSet, "indexSet");
        _exposedColumns = objj_msgSend(CPIndexSet, "indexSet");
        _reloadAllRows = NO;
    }
    var exposedRect = objj_msgSend(self, "_exposedRect"),
        exposedRows = objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", objj_msgSend(self, "rowsInRect:", exposedRect)),
        exposedColumns = objj_msgSend(self, "columnIndexesInRect:", exposedRect),
        obscuredRows = objj_msgSend(_exposedRows, "copy"),
        obscuredColumns = objj_msgSend(_exposedColumns, "copy");
    objj_msgSend(obscuredRows, "removeIndexes:", exposedRows);
    objj_msgSend(obscuredColumns, "removeIndexes:", exposedColumns);
    var newlyExposedRows = objj_msgSend(exposedRows, "copy"),
        newlyExposedColumns = objj_msgSend(exposedColumns, "copy");
    objj_msgSend(newlyExposedRows, "removeIndexes:", _exposedRows);
    objj_msgSend(newlyExposedColumns, "removeIndexes:", _exposedColumns);
    var previouslyExposedRows = objj_msgSend(exposedRows, "copy"),
        previouslyExposedColumns = objj_msgSend(exposedColumns, "copy");
    objj_msgSend(previouslyExposedRows, "removeIndexes:", newlyExposedRows);
    objj_msgSend(previouslyExposedColumns, "removeIndexes:", newlyExposedColumns);
    objj_msgSend(self, "_unloadDataViewsInRows:columns:", previouslyExposedRows, obscuredColumns);
    objj_msgSend(self, "_unloadDataViewsInRows:columns:", obscuredRows, previouslyExposedColumns);
    objj_msgSend(self, "_unloadDataViewsInRows:columns:", obscuredRows, obscuredColumns);
    objj_msgSend(self, "_loadDataViewsInRows:columns:", previouslyExposedRows, newlyExposedColumns);
    objj_msgSend(self, "_loadDataViewsInRows:columns:", newlyExposedRows, previouslyExposedColumns);
    objj_msgSend(self, "_loadDataViewsInRows:columns:", newlyExposedRows, newlyExposedColumns);
    _exposedRows = exposedRows;
    _exposedColumns = exposedColumns;
    objj_msgSend(_tableDrawView, "setFrame:", exposedRect);
    objj_msgSend(_tableDrawView, "display");
    for (identifier in _cachedDataViews)
    {
        var dataViews = _cachedDataViews[identifier],
            count = dataViews.length;
        while (count--)
            objj_msgSend(dataViews[count], "removeFromSuperview");
    }
}
}), new objj_method(sel_getUid("_unloadDataViewsInRows:columns:"), function(self, _cmd, rows, columns)
{ with(self)
{
    if (!objj_msgSend(rows, "count") || !objj_msgSend(columns, "count"))
        return;
    var rowArray = [],
        columnArray = [];
    objj_msgSend(rows, "getIndexes:maxCount:inIndexRange:", rowArray, -1, nil);
    objj_msgSend(columns, "getIndexes:maxCount:inIndexRange:", columnArray, -1, nil);
    var columnIndex = 0,
        columnsCount = columnArray.length;
    for (; columnIndex < columnsCount; ++columnIndex)
    {
        var column = columnArray[columnIndex],
            tableColumn = _tableColumns[column],
            tableColumnUID = objj_msgSend(tableColumn, "UID");
        var rowIndex = 0,
            rowsCount = rowArray.length;
        for (; rowIndex < rowsCount; ++rowIndex)
        {
            var row = rowArray[rowIndex],
                dataView = _dataViewsForTableColumns[tableColumnUID][row];
            _dataViewsForTableColumns[tableColumnUID][row] = nil;
            objj_msgSend(self, "_enqueueReusableDataView:", dataView);
        }
    }
}
}), new objj_method(sel_getUid("_loadDataViewsInRows:columns:"), function(self, _cmd, rows, columns)
{ with(self)
{
    if (!objj_msgSend(rows, "count") || !objj_msgSend(columns, "count"))
        return;
    var rowArray = [],
        rowRects = [],
        columnArray = [];
    objj_msgSend(rows, "getIndexes:maxCount:inIndexRange:", rowArray, -1, nil);
    objj_msgSend(columns, "getIndexes:maxCount:inIndexRange:", columnArray, -1, nil);
    if (_dirtyTableColumnRangeIndex !== CPNotFound) objj_msgSend(self, "_recalculateTableColumnRanges");;
    var columnIndex = 0,
        columnsCount = columnArray.length;
    for (; columnIndex < columnsCount; ++columnIndex)
    {
        var column = columnArray[columnIndex],
            tableColumn = _tableColumns[column],
            tableColumnUID = objj_msgSend(tableColumn, "UID");
        if (!_dataViewsForTableColumns[tableColumnUID])
            _dataViewsForTableColumns[tableColumnUID] = [];
        var rowIndex = 0,
            rowsCount = rowArray.length;
        var isColumnSelected = objj_msgSend(_selectedColumnIndexes, "containsIndex:", column);
        for (; rowIndex < rowsCount; ++rowIndex)
        {
            var row = rowArray[rowIndex],
                dataView = objj_msgSend(self, "_newDataViewForRow:tableColumn:", row, tableColumn),
                isTextField = objj_msgSend(dataView, "isKindOfClass:", objj_msgSend(CPTextField, "class"));
            objj_msgSend(dataView, "setFrame:", objj_msgSend(self, "frameOfDataViewAtColumn:row:", column, row));
            objj_msgSend(dataView, "setObjectValue:", objj_msgSend(self, "_objectValueForTableColumn:row:", tableColumn, row));
            if (isColumnSelected || objj_msgSend(self, "isRowSelected:", row))
                objj_msgSend(dataView, "setThemeState:", CPThemeStateHighlighted);
            else
                objj_msgSend(dataView, "unsetThemeState:", CPThemeStateHighlighted);
            if (_implementedDelegateMethods & CPTableViewDelegate_tableView_willDisplayView_forTableColumn_row_)
                objj_msgSend(objj_msgSend(self, "delegate"), "tableView:willDisplayView:forTableColumn:row:", self, dataView, tableColumn, row);
            if (objj_msgSend(dataView, "superview") !== self)
                objj_msgSend(self, "addSubview:", dataView);
            _dataViewsForTableColumns[tableColumnUID][row] = dataView;
            if (_editingCellIndex && _editingCellIndex.x === column && _editingCellIndex.y === row) {
                _editingCellIndex = undefined;
                if (isTextField) {
                    objj_msgSend(dataView, "setEditable:", YES);
                    objj_msgSend(dataView, "setSendsActionOnEndEditing:", YES);
                    objj_msgSend(dataView, "setSelectable:", YES);
                    objj_msgSend(dataView, "selectText:", nil);
                }
                objj_msgSend(dataView, "setTarget:", self);
                objj_msgSend(dataView, "setAction:", sel_getUid("_commitDataViewObjectValue:"));
                dataView.tableViewEditedColumnObj = tableColumn;
                dataView.tableViewEditedRowIndex = row;
            } else if (isTextField) {
                objj_msgSend(dataView, "setEditable:", NO);
                objj_msgSend(dataView, "setSelectable:", NO);
            }
        }
    }
}
}), new objj_method(sel_getUid("_layoutDataViewsInRows:columns:"), function(self, _cmd, rows, columns)
{ with(self)
{
    var rowArray = [],
        columnArray = [];
    objj_msgSend(rows, "getIndexes:maxCount:inIndexRange:", rowArray, -1, nil);
    objj_msgSend(columns, "getIndexes:maxCount:inIndexRange:", columnArray, -1, nil);
    var columnIndex = 0,
        columnsCount = columnArray.length;
    for (; columnIndex < columnsCount; ++columnIndex)
    {
        var column = columnArray[columnIndex],
            tableColumn = _tableColumns[column],
            tableColumnUID = objj_msgSend(tableColumn, "UID"),
            dataViewsForTableColumn = _dataViewsForTableColumns[tableColumnUID],
            columnRange = _tableColumnRanges[column];
        var rowIndex = 0,
            rowsCount = rowArray.length;
        for (; rowIndex < rowsCount; ++rowIndex)
        {
            var row = rowArray[rowIndex],
                dataView = dataViewsForTableColumn[row];
            objj_msgSend(dataView, "setFrame:", objj_msgSend(self, "frameOfDataViewAtColumn:row:", column, row));
        }
    }
}
}), new objj_method(sel_getUid("_commitDataViewObjectValue:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(_dataSource, "tableView:setObjectValue:forTableColumn:row:", self, objj_msgSend(sender, "objectValue"), sender.tableViewEditedColumnObj, sender.tableViewEditedRowIndex);
}
}), new objj_method(sel_getUid("_newDataViewForRow:tableColumn:"), function(self, _cmd, aRow, aTableColumn)
{ with(self)
{
    return objj_msgSend(aTableColumn, "_newDataViewForRow:", aRow);
}
}), new objj_method(sel_getUid("_enqueueReusableDataView:"), function(self, _cmd, aDataView)
{ with(self)
{
    var identifier = aDataView.identifier;
    if (!_cachedDataViews[identifier])
        _cachedDataViews[identifier] = [aDataView];
    else
        _cachedDataViews[identifier].push(aDataView);
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableView").super_class }, "setFrameSize:", aSize);
    if (_headerView)
        objj_msgSend(_headerView, "setFrameSize:", { width:(objj_msgSend(self, "frame").size.width), height:(objj_msgSend(_headerView, "frame").size.height) });
}
}), new objj_method(sel_getUid("exposedClipRect"), function(self, _cmd)
{ with(self)
{
    var superview = objj_msgSend(self, "superview");
    if (!objj_msgSend(superview, "isKindOfClass:", objj_msgSend(CPClipView, "class")))
        return objj_msgSend(self, "bounds");
    return objj_msgSend(self, "convertRect:fromView:", CGRectIntersection(objj_msgSend(superview, "bounds"), objj_msgSend(self, "frame")), superview);
}
}), new objj_method(sel_getUid("_drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var exposedRect = objj_msgSend(self, "_exposedRect");
    objj_msgSend(self, "drawBackgroundInClipRect:", exposedRect);
    objj_msgSend(self, "drawGridInClipRect:", exposedRect);
    objj_msgSend(self, "highlightSelectionInClipRect:", exposedRect);
}
}), new objj_method(sel_getUid("drawBackgroundInClipRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if (!objj_msgSend(self, "usesAlternatingRowBackgroundColors"))
        return;
    var rowColors = objj_msgSend(self, "alternatingRowBackgroundColors"),
        colorCount = objj_msgSend(rowColors, "count");
    if (colorCount === 0)
        return;
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    if (colorCount === 1)
    {
        CGContextSetFillColor(context, rowColors[0]);
        CGContextFillRect(context, aRect);
        return;
    }
    var exposedRows = objj_msgSend(self, "rowsInRect:", aRect),
        firstRow = exposedRows.location,
        lastRow = CPMaxRange(exposedRows) - 1,
        colorIndex = MIN(exposedRows.length, colorCount),
        heightFilled = 0.0;
    while (colorIndex--)
    {
        var row = firstRow - firstRow % colorCount + colorIndex,
            fillRect = nil;
        CGContextBeginPath(context);
        for (; row <= lastRow; row += colorCount)
            if (row >= firstRow)
                CGContextAddRect(context, CGRectIntersection(aRect, fillRect = objj_msgSend(self, "rectOfRow:", row)));
        if (row - colorCount === lastRow)
            heightFilled = (fillRect.origin.y + fillRect.size.height);
        CGContextClosePath(context);
        CGContextSetFillColor(context, rowColors[colorIndex]);
        CGContextFillPath(context);
    }
    var totalHeight = (aRect.origin.y + aRect.size.height);
    if (heightFilled >= totalHeight || _rowHeight <= 0.0)
        return;
    var rowHeight = _rowHeight + _intercellSpacing.height,
        fillRect = { origin: { x:(aRect.origin.x), y:(aRect.origin.y) + heightFilled }, size: { width:(aRect.size.width), height:rowHeight } };
    for (row = lastRow + 1; heightFilled < totalHeight; ++row)
    {
        CGContextSetFillColor(context, rowColors[row % colorCount]);
        CGContextFillRect(context, fillRect);
        heightFilled += rowHeight;
        fillRect.origin.y += rowHeight;
    }
}
}), new objj_method(sel_getUid("drawGridInClipRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        gridStyleMask = objj_msgSend(self, "gridStyleMask");
    if (!(gridStyleMask & (CPTableViewSolidHorizontalGridLineMask | CPTableViewSolidVerticalGridLineMask)))
        return;
    CGContextBeginPath(context);
    if (gridStyleMask & CPTableViewSolidHorizontalGridLineMask)
    {
        var exposedRows = objj_msgSend(self, "rowsInRect:", aRect);
            row = exposedRows.location,
            lastRow = CPMaxRange(exposedRows) - 1,
            rowY = 0.0,
            minX = (aRect.origin.x),
            maxX = (aRect.origin.x + aRect.size.width);
        for (; row <= lastRow; ++row)
        {
            var rowRect = objj_msgSend(self, "rectOfRow:", row),
                rowY = (rowRect.origin.y + rowRect.size.height) - 0.5;
            CGContextMoveToPoint(context, minX, rowY);
            CGContextAddLineToPoint(context, maxX, rowY);
        }
        if (_rowHeight > 0.0)
        {
            var rowHeight = _rowHeight + _intercellSpacing.height,
                totalHeight = (aRect.origin.y + aRect.size.height);
            while (rowY < totalHeight)
            {
                rowY += rowHeight;
                CGContextMoveToPoint(context, minX, rowY);
                CGContextAddLineToPoint(context, maxX, rowY);
            }
        }
    }
    if (gridStyleMask & CPTableViewSolidVerticalGridLineMask)
    {
        var exposedColumnIndexes = objj_msgSend(self, "columnIndexesInRect:", aRect),
            columnsArray = [];
        objj_msgSend(exposedColumnIndexes, "getIndexes:maxCount:inIndexRange:", columnsArray, -1, nil);
        var columnArrayIndex = 0,
            columnArrayCount = columnsArray.length,
            minY = (aRect.origin.y),
            maxY = (aRect.origin.y + aRect.size.height);
        for (; columnArrayIndex < columnArrayCount; ++columnArrayIndex)
        {
            var columnRect = objj_msgSend(self, "rectOfColumn:", columnsArray[columnArrayIndex]),
                columnX = (columnRect.origin.x + columnRect.size.width) + 0.5;
            CGContextMoveToPoint(context, columnX, minY);
            CGContextAddLineToPoint(context, columnX, maxY);
        }
    }
    CGContextClosePath(context);
    CGContextSetStrokeColor(context, _gridColor);
    CGContextStrokePath(context);
}
}), new objj_method(sel_getUid("highlightSelectionInClipRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        indexes = [],
        rectSelector = sel_getUid("rectOfRow:");
    if (objj_msgSend(_selectedRowIndexes, "count") >= 1)
    {
        var exposedRows = objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", objj_msgSend(self, "rowsInRect:", aRect)),
            firstRow = objj_msgSend(exposedRows, "firstIndex"),
            exposedRange = CPMakeRange(firstRow, objj_msgSend(exposedRows, "lastIndex") - firstRow + 1);
        objj_msgSend(_selectedRowIndexes, "getIndexes:maxCount:inIndexRange:", indexes, -1, exposedRange);
    }
    else if (objj_msgSend(_selectedColumnIndexes, "count") >= 1)
    {
        rectSelector = sel_getUid("rectOfColumn:");
        var exposedColumns = objj_msgSend(self, "columnIndexesInRect:", aRect),
            firstColumn = objj_msgSend(exposedColumns, "firstIndex"),
            exposedRange = CPMakeRange(firstColumn, objj_msgSend(exposedColumns, "lastIndex") - firstColumn + 1);
        objj_msgSend(_selectedColumnIndexes, "getIndexes:maxCount:inIndexRange:", indexes, -1, exposedRange);
    }
    var count = count2 = objj_msgSend(indexes, "count");
    if (!count)
        return;
    var drawGradient = (_selectionHighlightStyle === CPTableViewSelectionHighlightStyleSourceList && objj_msgSend(_selectedRowIndexes, "count") >= 1);
    var deltaHeight = 0.5 * (_gridStyleMask & CPTableViewSolidHorizontalGridLineMask);
    CGContextBeginPath(context);
    while (count--)
    {
        var rowRect = CGRectIntersection(objj_msgSend(self, rectSelector, indexes[count]), aRect);
        CGContextAddRect(context, rowRect);
        if (drawGradient)
        {
            var minX = (rowRect.origin.x),
                minY = (rowRect.origin.y),
                maxX = (rowRect.origin.x + rowRect.size.width),
                maxY = (rowRect.origin.y + rowRect.size.height) - deltaHeight;
            CGContextDrawLinearGradient(context, _sourceListActiveGradient, rowRect.origin, CGPointMake(minX, maxY), 0);
            CGContextClosePath(context);
            CGContextBeginPath(context);
            CGContextMoveToPoint(context, minX, minY);
            CGContextAddLineToPoint(context, maxX, minY);
            CGContextClosePath(context);
            CGContextSetStrokeColor(context, _sourceListActiveTopLineColor);
            CGContextStrokePath(context);
            CGContextBeginPath(context);
            CGContextMoveToPoint(context, minX, maxY);
            CGContextAddLineToPoint(context, maxX, maxY - 1);
            CGContextClosePath(context);
            CGContextSetStrokeColor(context, _sourceListActiveBottomLineColor);
            CGContextStrokePath(context);
        }
    }
    CGContextClosePath(context);
    if (!drawGradient)
    {
        objj_msgSend(objj_msgSend(CPColor, "selectionColor"), "setFill");
        CGContextFillPath(context);
    }
    CGContextBeginPath(context);
    gridStyleMask = objj_msgSend(self, "gridStyleMask");
    for(var i=0; i < count2; i++)
    {
         var rect = objj_msgSend(self, rectSelector, indexes[i]),
             minX = CGRectGetMinX(rect) - 0.5,
             maxX = CGRectGetMaxX(rect) - 0.5,
             minY = CGRectGetMinY(rect) - 0.5,
             maxY = CGRectGetMaxY(rect) - 0.5;
        if (objj_msgSend(_selectedRowIndexes, "count") >= 1 && gridStyleMask & CPTableViewSolidVerticalGridLineMask)
        {
            var exposedColumns = objj_msgSend(self, "columnIndexesInRect:", aRect),
            exposedColumnIndexes = [],
            firstExposedColumn = objj_msgSend(exposedColumns, "firstIndex"),
            exposedRange = CPMakeRange(firstExposedColumn, objj_msgSend(exposedColumns, "lastIndex") - firstExposedColumn + 1);
            objj_msgSend(exposedColumns, "getIndexes:maxCount:inIndexRange:", exposedColumnIndexes, -1, exposedRange);
            var exposedColumnCount = objj_msgSend(exposedColumnIndexes, "count");
            for(var c = firstExposedColumn; c < exposedColumnCount; c++)
            {
                var colRect = objj_msgSend(self, "rectOfColumn:", exposedColumnIndexes[c]),
                    colX = CGRectGetMaxX(colRect) + 0.5;
                CGContextMoveToPoint(context, colX, minY);
                CGContextAddLineToPoint(context, colX, maxY);
            }
        }
        if(objj_msgSend(indexes, "containsObject:", indexes[i]+1))
        {
            CGContextMoveToPoint(context, minX, maxY);
            CGContextAddLineToPoint(context, maxX, maxY);
        }
    }
    CGContextClosePath(context);
    CGContextSetStrokeColor(context, objj_msgSend(CPColor, "colorWithHexString:", "e5e5e5"));
    CGContextStrokePath(context);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "load");
}
}), new objj_method(sel_getUid("viewWillMoveToSuperview:"), function(self, _cmd, aView)
{ with(self)
{
    var superview = objj_msgSend(self, "superview"),
        defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (superview)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPViewFrameDidChangeNotification, superview);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPViewBoundsDidChangeNotification, superview);
    }
    if (aView)
    {
        objj_msgSend(aView, "setPostsFrameChangedNotifications:", YES);
        objj_msgSend(aView, "setPostsBoundsChangedNotifications:", YES);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("superviewFrameChanged:"), CPViewFrameDidChangeNotification, aView);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("superviewBoundsChanged:"), CPViewBoundsDidChangeNotification, aView);
    }
}
}), new objj_method(sel_getUid("superviewBoundsChanged:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("superviewFrameChanged:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("tracksMouseOutsideOfFrame"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("startTrackingAt:"), function(self, _cmd, aPoint)
{ with(self)
{
    var row = objj_msgSend(self, "rowAtPoint:", aPoint);
    if (row < 0 && _allowsEmptySelection)
        objj_msgSend(self, "selectRowIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSet"), NO);
    objj_msgSend(self, "_noteSelectionIsChanging");
    if (objj_msgSend(self, "mouseDownFlags") & CPShiftKeyMask)
        _selectionAnchorRow = (ABS(objj_msgSend(_selectedRowIndexes, "firstIndex") - row) < ABS(objj_msgSend(_selectedRowIndexes, "lastIndex") - row)) ?
            objj_msgSend(_selectedRowIndexes, "firstIndex") : objj_msgSend(_selectedRowIndexes, "lastIndex");
    else
        _selectionAnchorRow = row;
    _startTrackingPoint = aPoint;
    _startTrackingTimestamp = new Date();
    if (_implementedDataSourceMethods & CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_)
        _trackingPointMovedOutOfClickSlop = NO;
    if (!(_implementedDataSourceMethods & CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_))
        objj_msgSend(self, "_updateSelectionWithMouseAtRow:", row);
    objj_msgSend(objj_msgSend(self, "window"), "makeFirstResponder:", self);
    return YES;
}
}), new objj_method(sel_getUid("trackMouse:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(_draggedRowIndexes, "count"))
        objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableView").super_class }, "trackMouse:", anEvent);
    else
        objj_msgSend(CPApp, "sendEvent:", anEvent);
}
}), new objj_method(sel_getUid("continueTracking:at:"), function(self, _cmd, lastPoint, aPoint)
{ with(self)
{
    var row = objj_msgSend(self, "rowAtPoint:", aPoint);
    if(!_isSelectingSession && _implementedDataSourceMethods & CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_)
    {
        if ((ABS(_startTrackingPoint.x - aPoint.x) > 3 || (_verticalMotionCanDrag && ABS(_startTrackingPoint.y - aPoint.y) > 3)) ||
            (objj_msgSend(_selectedRowIndexes, "containsIndex:", row)))
        {
            if (objj_msgSend(_selectedRowIndexes, "containsIndex:", row))
                _draggedRowIndexes = objj_msgSend(objj_msgSend(CPIndexSet, "alloc"), "initWithIndexSet:", _selectedRowIndexes);
            else
                _draggedRowIndexes = objj_msgSend(CPIndexSet, "indexSetWithIndex:", row);
            var pboard = objj_msgSend(CPPasteboard, "pasteboardWithName:", CPDragPboard);
            if (objj_msgSend(self, "canDragRowsWithIndexes:atPoint:", _draggedRowIndexes, aPoint) &&
                objj_msgSend(_dataSource, "tableView:writeRowsWithIndexes:toPasteboard:", self, _draggedRowIndexes, pboard))
            {
                var currentEvent = objj_msgSend(CPApp, "currentEvent"),
                    offset = CPPointMakeZero(),
                    tableColumns = objj_msgSend(_tableColumns, "objectsAtIndexes:", _exposedColumns);
                var view = objj_msgSend(self, "dragViewForRowsWithIndexes:tableColumns:event:offset:", _draggedRowIndexes, tableColumns, currentEvent, offset);
                if (!view)
                {
                    var image = objj_msgSend(self, "dragImageForRowsWithIndexes:tableColumns:event:offset:", _draggedRowIndexes, tableColumns, currentEvent, offset);
                    view = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CPMakeRect(0, 0, objj_msgSend(image, "size").width, objj_msgSend(image, "size").height));
                    objj_msgSend(view, "setImage:", image);
                }
                var bounds = objj_msgSend(view, "bounds"),
                    viewLocation = CPPointMake(aPoint.x - CGRectGetWidth(bounds)/2 + offset.x, aPoint.y - CGRectGetHeight(bounds)/2 + offset.y);
                objj_msgSend(self, "dragView:at:offset:event:pasteboard:source:slideBack:", view, viewLocation, CPPointMakeZero(), objj_msgSend(CPApp, "currentEvent"), pboard, self, YES);
                _startTrackingPoint = nil;
                return NO;
            }
        }
        else if (ABS(_startTrackingPoint.x - aPoint.x) < 5 && ABS(_startTrackingPoint.y - aPoint.y) < 5)
            return YES;
    }
    _isSelectingSession = YES;
    objj_msgSend(self, "_updateSelectionWithMouseAtRow:", row);
    objj_msgSend(self, "_updateSelectionWithMouseAtRow:", objj_msgSend(self, "rowAtPoint:", aPoint));
    if ((_implementedDataSourceMethods & CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_)
        && !_trackingPointMovedOutOfClickSlop)
    {
        var CLICK_SPACE_DELTA = 5.0;
        if (ABS(aPoint.x - _startTrackingPoint.x) > CLICK_SPACE_DELTA
            || ABS(aPoint.y - _startTrackingPoint.y) > CLICK_SPACE_DELTA)
        {
            _trackingPointMovedOutOfClickSlop = YES;
        }
    }
    return YES;
}
}), new objj_method(sel_getUid("stopTracking:at:mouseIsUp:"), function(self, _cmd, lastPoint, aPoint, mouseIsUp)
{ with(self)
{
    _isSelectingSession = NO;
    var CLICK_TIME_DELTA = 1000,
        columnIndex,
        column,
        rowIndex,
        shouldEdit = YES;
    if(_implementedDataSourceMethods & CPTableViewDataSource_tableView_writeRowsWithIndexes_toPasteboard_)
    {
        rowIndex = objj_msgSend(self, "rowAtPoint:", aPoint);
        if (rowIndex !== -1)
        {
            if (objj_msgSend(_draggedRowIndexes, "count") > 0)
            {
                _draggedRowIndexes = objj_msgSend(CPIndexSet, "indexSet");
                return;
            }
             _previouslySelectedRowIndexes = objj_msgSend(_selectedRowIndexes, "copy");
            objj_msgSend(self, "_updateSelectionWithMouseAtRow:", rowIndex);
        }
    }
    if (mouseIsUp
        && (_implementedDataSourceMethods & CPTableViewDataSource_tableView_setObjectValue_forTableColumn_row_)
        && !_trackingPointMovedOutOfClickSlop
        && (objj_msgSend(objj_msgSend(CPApp, "currentEvent"), "clickCount") > 1))
    {
        columnIndex = objj_msgSend(self, "columnAtPoint:", lastPoint);
        if (columnIndex !== -1)
        {
            column = _tableColumns[columnIndex];
            if (objj_msgSend(column, "isEditable"))
            {
                rowIndex = objj_msgSend(self, "rowAtPoint:", aPoint);
                if (rowIndex !== -1)
                {
                    if (_implementedDelegateMethods & CPTableViewDelegate_tableView_shouldEditTableColumn_row_)
                        shouldEdit = objj_msgSend(_delegate, "tableView:shouldEditTableColumn:row:", self, column, rowIndex);
                    if (shouldEdit)
                    {
                        _editingCellIndex = CGPointMake(columnIndex, rowIndex);
                        objj_msgSend(self, "reloadDataForRowIndexes:columnIndexes:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", rowIndex), objj_msgSend(CPIndexSet, "indexSetWithIndex:", columnIndex));
                        return;
                    }
                }
            }
        }
    }
    if(objj_msgSend(objj_msgSend(CPApp, "currentEvent"), "clickCount") === 2 && _doubleAction && _target)
        objj_msgSend(self, "sendAction:to:", _doubleAction, _target);
}
}), new objj_method(sel_getUid("draggingEntered:"), function(self, _cmd, sender)
{ with(self)
{
    var dropOperation = objj_msgSend(self, "_proposedDropOperation"),
        draggingLocation = objj_msgSend(sender, "draggingLocation"),
        row;
    var location = objj_msgSend(self, "convertPoint:fromView:", draggingLocation, nil);
    row = objj_msgSend(self, "_proposedRowAtPoint:", location);
    if(_retargetedDropRow !== nil)
        row = _retargetedDropRow;
    var draggedTypes = objj_msgSend(self, "registeredDraggedTypes"),
        count = objj_msgSend(draggedTypes, "count"),
        i;
    for (i = 0; i < count; i++)
    {
        if (objj_msgSend(objj_msgSend(objj_msgSend(sender, "draggingPasteboard"), "types"), "containsObject:", objj_msgSend(draggedTypes, "objectAtIndex:",  i)))
            return objj_msgSend(self, "_validateDrop:proposedRow:proposedDropOperation:", sender, row, dropOperation);
    }
    return CPDragOperationNone;
}
}), new objj_method(sel_getUid("draggingExited:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(_dropOperationFeedbackView, "setHidden:", YES);
}
}), new objj_method(sel_getUid("draggingEnded:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "_draggingEnded");
}
}), new objj_method(sel_getUid("_draggingEnded"), function(self, _cmd)
{ with(self)
{
    _retargetedDropOperation = nil;
    _retargetedDropRow = nil;
    _draggedRowIndexes = objj_msgSend(CPIndexSet, "indexSet");
    objj_msgSend(_dropOperationFeedbackView, "setHidden:", YES);
}
}), new objj_method(sel_getUid("wantsPeriodicDraggingUpdates"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("_proposedDropOperation"), function(self, _cmd)
{ with(self)
{
    if(_retargetedDropOperation !== nil)
        return _retargetedDropOperation;
    else
        return CPTableViewDropAbove;
}
}), new objj_method(sel_getUid("_proposedRowAtPoint:"), function(self, _cmd, dragPoint)
{ with(self)
{
    var numberOfRows = objj_msgSend(self, "numberOfRows"),
        row;
    dragPoint.y += FLOOR(_rowHeight/4);
    if (dragPoint.y > numberOfRows * (_rowHeight + _intercellSpacing.height))
    {
        if (objj_msgSend(self, "_proposedDropOperation") === CPTableViewDropAbove)
            row = numberOfRows;
        else
            row = numberOfRows - 1;
    }
    else
        row = objj_msgSend(self, "rowAtPoint:", dragPoint);
    return row;
}
}), new objj_method(sel_getUid("_validateDrop:proposedRow:proposedDropOperation:"), function(self, _cmd, info, row, dropOperation)
{ with(self)
{
    if(_implementedDataSourceMethods & CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_)
        return objj_msgSend(_dataSource, "tableView:validateDrop:proposedRow:proposedDropOperation:", self, info, row, dropOperation);
    return CPDragOperationNone;
}
}), new objj_method(sel_getUid("draggingUpdated:"), function(self, _cmd, sender)
{ with(self)
{
    var dropOperation = objj_msgSend(self, "_proposedDropOperation"),
        numberOfRows = objj_msgSend(self, "numberOfRows"),
        draggingLocation = objj_msgSend(sender, "draggingLocation"),
        dragOperation,
        row;
    var location = objj_msgSend(self, "convertPoint:fromView:", draggingLocation, nil);
    row = objj_msgSend(self, "_proposedRowAtPoint:", location);
    dragOperation = objj_msgSend(self, "_validateDrop:proposedRow:proposedDropOperation:", sender, row, dropOperation);
    if(_retargetedDropRow !== nil)
        row = _retargetedDropRow;
    var rowRect;
    if(_retargetedDropRow === -1)
        rowRect = objj_msgSend(self, "exposedClipRect");
    else
        rowRect = objj_msgSend(self, "rectOfRow:", row);
    var exposedClipRect = objj_msgSend(self, "exposedClipRect");
    var visibleWidth = (exposedClipRect.size.width);
    rowRect = { origin: { x:(exposedClipRect.origin.x), y:rowRect.origin.y }, size: { width:visibleWidth, height:rowRect.size.height } };
    objj_msgSend(_dropOperationFeedbackView, "setDropOperation:", dropOperation);
    objj_msgSend(_dropOperationFeedbackView, "setHidden:", (dragOperation == CPDragOperationNone));
    objj_msgSend(_dropOperationFeedbackView, "setFrame:", rowRect);
    objj_msgSend(_dropOperationFeedbackView, "setCurrentRow:", row);
    objj_msgSend(self, "addSubview:", _dropOperationFeedbackView);
    if (row > 0 && location.y - CGRectGetMinY(exposedClipRect) < _rowHeight)
        objj_msgSend(self, "scrollRowToVisible:", row - 1);
    else if (row < numberOfRows && CGRectGetMaxY(exposedClipRect) - location.y < _rowHeight)
        objj_msgSend(self, "scrollRowToVisible:", row + 1);
    return dragOperation;
}
}), new objj_method(sel_getUid("prepareForDragOperation:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(_dropOperationFeedbackView, "setHidden:", YES);
    return (_implementedDataSourceMethods & CPTableViewDataSource_tableView_validateDrop_proposedRow_proposedDropOperation_);
}
}), new objj_method(sel_getUid("performDragOperation:"), function(self, _cmd, sender)
{ with(self)
{
    var operation = objj_msgSend(self, "_proposedDropOperation"),
        draggingLocation = objj_msgSend(sender, "draggingLocation");
    var location = objj_msgSend(self, "convertPoint:fromView:", draggingLocation, nil);
    if(_retargetedDropRow !== nil)
        var row = _retargetedDropRow;
    else
        var row = objj_msgSend(self, "rowAtPoint:", location) - 1;
    return objj_msgSend(_dataSource, "tableView:acceptDrop:row:dropOperation:", self, sender, row, operation);
}
}), new objj_method(sel_getUid("concludeDragOperation:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "reloadData");
}
}), new objj_method(sel_getUid("draggedImage:endedAt:operation:"), function(self, _cmd, anImage, aLocation, anOperation)
{ with(self)
{
    if(objj_msgSend(_dataSource, "respondsToSelector:", sel_getUid("tableView:didEndDraggedImage:atPosition:operation:")))
        objj_msgSend(_dataSource, "tableView:didEndDraggedImage:atPosition:operation:", self, anImage, aLocation, anOperation);
}
}), new objj_method(sel_getUid("draggedView:endedAt:operation:"), function(self, _cmd, aView, aLocation, anOperation)
{ with(self)
{
    objj_msgSend(self, "_draggingEnded");
    objj_msgSend(self, "draggedImage:endedAt:operation:", aView, aLocation, anOperation);
}
}), new objj_method(sel_getUid("_updateSelectionWithMouseAtRow:"), function(self, _cmd, aRow)
{ with(self)
{
    if(aRow < 0)
        return;
    var newSelection,
        shouldExtendSelection = NO;
    if (objj_msgSend(self, "mouseDownFlags") & (CPCommandKeyMask | CPControlKeyMask | CPAlternateKeyMask))
    {
        if (objj_msgSend(_selectedRowIndexes, "containsIndex:", aRow))
        {
            newSelection = objj_msgSend(_selectedRowIndexes, "copy");
            objj_msgSend(newSelection, "removeIndex:", aRow);
        }
        else if (_allowsMultipleSelection)
        {
            newSelection = objj_msgSend(_selectedRowIndexes, "copy");
            objj_msgSend(newSelection, "addIndex:", aRow);
        }
        else
            newSelection = objj_msgSend(CPIndexSet, "indexSetWithIndex:", aRow);
    }
    else if (_allowsMultipleSelection)
    {
        newSelection = objj_msgSend(CPIndexSet, "indexSetWithIndexesInRange:", CPMakeRange(MIN(aRow, _selectionAnchorRow), ABS(aRow - _selectionAnchorRow) + 1));
        shouldExtendSelection = objj_msgSend(self, "mouseDownFlags") & CPShiftKeyMask &&
                                ((_lastSelectedRow == objj_msgSend(_selectedRowIndexes, "lastIndex") && aRow > _lastSelectedRow) ||
                                (_lastSelectedRow == objj_msgSend(_selectedRowIndexes, "firstIndex") && aRow < _lastSelectedRow));
    }
    else if (aRow >= 0 && aRow < _numberOfRows)
        newSelection = objj_msgSend(CPIndexSet, "indexSetWithIndex:", aRow);
    else
        newSelection = objj_msgSend(CPIndexSet, "indexSet");
    if (objj_msgSend(newSelection, "isEqualToIndexSet:", _selectedRowIndexes))
        return;
    if (_implementedDelegateMethods & CPTableViewDelegate_selectionShouldChangeInTableView_ &&
        !objj_msgSend(_delegate, "selectionShouldChangeInTableView:", self))
        return;
    if (_implementedDelegateMethods & CPTableViewDelegate_tableView_selectionIndexesForProposedSelection_)
        newSelection = objj_msgSend(_delegate, "tableView:selectionIndexesForProposedSelection:", self, newSelection);
    if (_implementedDelegateMethods & CPTableViewDelegate_tableView_shouldSelectRow_)
    {
        var indexArray = [];
        objj_msgSend(newSelection, "getIndexes:maxCount:inIndexRange:", indexArray, -1, nil);
        var indexCount = indexArray.length;
        while (indexCount--)
        {
            var index = indexArray[indexCount];
            if (!objj_msgSend(_delegate, "tableView:shouldSelectRow:", self, index))
                objj_msgSend(newSelection, "removeIndex:", index);
        }
    }
    _lastSelectedRow = (objj_msgSend(newSelection, "count") > 0) ? aRow : -1;
    if (!_allowsEmptySelection && objj_msgSend(newSelection, "count") === 0)
        return;
    if (objj_msgSend(newSelection, "isEqualToIndexSet:", _selectedRowIndexes))
        return;
    objj_msgSend(self, "selectRowIndexes:byExtendingSelection:", newSelection, shouldExtendSelection);
}
}), new objj_method(sel_getUid("_noteSelectionIsChanging"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPTableViewSelectionIsChangingNotification, self, nil);
}
}), new objj_method(sel_getUid("_noteSelectionDidChange"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPTableViewSelectionDidChangeNotification, self, nil);
}
}), new objj_method(sel_getUid("becomeFirstResponder"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("acceptsFirstResponder"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("keyDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    objj_msgSend(self, "interpretKeyEvents:", objj_msgSend(CPArray, "arrayWithObject:", anEvent));
}
}), new objj_method(sel_getUid("moveDown:"), function(self, _cmd, sender)
{ with(self)
{
    if (_implementedDelegateMethods & CPTableViewDelegate_selectionShouldChangeInTableView_ &&
        !objj_msgSend(_delegate, "selectionShouldChangeInTableView:", self))
        return;
    var anEvent = objj_msgSend(CPApp, "currentEvent");
    if(objj_msgSend(objj_msgSend(self, "selectedRowIndexes"), "count") > 0)
    {
       var extend = NO;
       if((objj_msgSend(anEvent, "modifierFlags") & CPShiftKeyMask) && _allowsMultipleSelection)
           extend = YES;
        var i = objj_msgSend(objj_msgSend(self, "selectedRowIndexes"), "lastIndex");
        if(i<objj_msgSend(self, "numberOfRows") - 1)
            i++;
    }
    else
    {
        var extend = NO;
        if(objj_msgSend(self, "numberOfRows") > 0)
            var i = 0;
    }
    if(_implementedDelegateMethods & CPTableViewDelegate_tableView_shouldSelectRow_)
    {
        while((!objj_msgSend(_delegate, "tableView:shouldSelectRow:", self, i)) && i<objj_msgSend(self, "numberOfRows"))
        {
            i++;
        }
         if(!objj_msgSend(_delegate, "tableView:shouldSelectRow:", self, i))
             return;
    }
    objj_msgSend(self, "selectRowIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", i), extend);
    if(i >= 0)
        objj_msgSend(self, "scrollRowToVisible:", i);
}
}), new objj_method(sel_getUid("moveUp:"), function(self, _cmd, sender)
{ with(self)
{
    if (_implementedDelegateMethods & CPTableViewDelegate_selectionShouldChangeInTableView_ &&
        !objj_msgSend(_delegate, "selectionShouldChangeInTableView:", self))
        return;
    var anEvent = objj_msgSend(CPApp, "currentEvent");
    if(objj_msgSend(objj_msgSend(self, "selectedRowIndexes"), "count") > 0)
    {
         var extend = NO;
         if((objj_msgSend(anEvent, "modifierFlags") & CPShiftKeyMask) && _allowsMultipleSelection)
           extend = YES;
          var i = objj_msgSend(objj_msgSend(self, "selectedRowIndexes"), "firstIndex");
          if(i > 0)
              i--;
    }
    else
    {
      var extend = NO;
        if(objj_msgSend(self, "numberOfRows") > 0)
            var i = objj_msgSend(self, "numberOfRows") - 1;
     }
     if(_implementedDelegateMethods & CPTableViewDelegate_tableView_shouldSelectRow_)
     {
          while((!objj_msgSend(_delegate, "tableView:shouldSelectRow:", self, i)) && i > 0)
          {
              i--;
          }
           if(!objj_msgSend(_delegate, "tableView:shouldSelectRow:", self, i))
               return;
     }
     objj_msgSend(self, "selectRowIndexes:byExtendingSelection:", objj_msgSend(CPIndexSet, "indexSetWithIndex:", i), extend);
     if(i >= 0)
        objj_msgSend(self, "scrollRowToVisible:", i);
}
}), new objj_method(sel_getUid("deleteBackward:"), function(self, _cmd, sender)
{ with(self)
{
    if(objj_msgSend(_delegate, "respondsToSelector:",  sel_getUid("tableViewDeleteKeyPressed:")))
        objj_msgSend(_delegate, "tableViewDeleteKeyPressed:", self);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("_defaultTableHeaderSortImage"), function(self, _cmd)
{ with(self)
{
    return CPAppKitImage("tableview-headerview-ascending.png", CGSizeMake(9.0, 8.0));
}
}), new objj_method(sel_getUid("_defaultTableHeaderReverseSortImage"), function(self, _cmd)
{ with(self)
{
    return CPAppKitImage("tableview-headerview-descending.png", CGSizeMake(9.0, 8.0));
}
})]);
}
var CPTableViewDataSourceKey = "CPTableViewDataSourceKey",
    CPTableViewDelegateKey = "CPTableViewDelegateKey",
    CPTableViewHeaderViewKey = "CPTableViewHeaderViewKey",
    CPTableViewTableColumnsKey = "CPTableViewTableColumnsKey",
    CPTableViewRowHeightKey = "CPTableViewRowHeightKey",
    CPTableViewIntercellSpacingKey = "CPTableViewIntercellSpacingKey",
    CPTableViewMultipleSelectionKey = "CPTableViewMultipleSelectionKey",
    CPTableViewEmptySelectionKey = "CPTableViewEmptySelectionKey",
    CPTableViewColumnReorderingKey = "CPTableViewColumnReorderingKey",
    CPTableViewColumnResizingKey = "CPTableViewColumnResizingKey",
    CPTableViewColumnSelectionKey = "CPTableViewColumnSelectionKey",
    CPTableViewGridColorKey = "CPTableViewGridColorKey",
    CPTableViewGridStyleMaskKey = "CPTableViewGridStyleMaskKey",
    CPTableViewUsesAlternatingBackgroundKey = "CPTableViewUsesAlternatingBackgroundKey",
    CPTableViewHeaderViewKey = "CPTableViewHeaderViewKey",
    CPTableViewCornerViewKey = "CPTableViewCornerViewKey";
{
var the_class = objj_getClass("CPTableView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTableView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableView").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _allowsColumnReordering = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableViewColumnReorderingKey);
        _allowsColumnResizing = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableViewColumnResizingKey);
        _allowsMultipleSelection = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableViewMultipleSelectionKey);
        _allowsEmptySelection = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableViewEmptySelectionKey);
        _allowsColumnSelection = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableViewColumnSelectionKey);
        _tableViewFlags = 0;
        _selectionHighlightStyle = CPTableViewSelectionHighlightStyleRegular;
        _usesAlternatingRowBackgroundColors = objj_msgSend(aCoder, "decodeBoolForKey:", CPTableViewUsesAlternatingBackgroundKey);
        objj_msgSend(self, "setAlternatingRowBackgroundColors:", [objj_msgSend(CPColor, "whiteColor"), objj_msgSend(CPColor, "colorWithHexString:", "e4e7ff")]);
        _tableColumns = objj_msgSend(aCoder, "decodeObjectForKey:", CPTableViewTableColumnsKey);
        objj_msgSend(_tableColumns, "makeObjectsPerformSelector:withObject:", sel_getUid("setTableView:"), self);
        _tableColumnRanges = [];
        _dirtyTableColumnRangeIndex = 0;
        _numberOfHiddenColumns = 0;
        _objectValues = { };
        _dataViewsForTableColumns = { };
        _dataViews= [];
        _numberOfRows = 0;
        _exposedRows = objj_msgSend(CPIndexSet, "indexSet");
        _exposedColumns = objj_msgSend(CPIndexSet, "indexSet");
        _cachedDataViews = { };
        _rowHeight = objj_msgSend(aCoder, "decodeFloatForKey:", CPTableViewRowHeightKey);
        if (objj_msgSend(aCoder, "containsValueForKey:", CPTableViewIntercellSpacingKey))
            _intercellSpacing = objj_msgSend(aCoder, "decodeSizeForKey:", CPTableViewIntercellSpacingKey);
        else
            _intercellSpacing = { width:0.0, height:0.0 };
        _gridColor = objj_msgSend(aCoder, "decodeObjectForKey:", CPTableViewGridColorKey) || objj_msgSend(CPColor, "grayColor");
        _gridStyleMask = objj_msgSend(aCoder, "decodeIntForKey:", CPTableViewGridStyleMaskKey) || CPTableViewGridNone;
        _headerView = objj_msgSend(aCoder, "decodeObjectForKey:", CPTableViewHeaderViewKey);
        _cornerView = objj_msgSend(aCoder, "decodeObjectForKey:", CPTableViewCornerViewKey);
        _selectedColumnIndexes = objj_msgSend(CPIndexSet, "indexSet");
        _selectedRowIndexes = objj_msgSend(CPIndexSet, "indexSet");
        objj_msgSend(self, "setDataSource:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTableViewDataSourceKey));
        objj_msgSend(self, "setDelegate:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTableViewDelegateKey));
        _tableDrawView = objj_msgSend(objj_msgSend(_CPTableDrawView, "alloc"), "initWithTableView:", self);
        objj_msgSend(_tableDrawView, "setBackgroundColor:", objj_msgSend(CPColor, "clearColor"));
        objj_msgSend(self, "addSubview:", _tableDrawView);
        objj_msgSend(self, "_init");
        objj_msgSend(self, "viewWillMoveToSuperview:", objj_msgSend(self, "superview"));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTableView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _dataSource, CPTableViewDataSourceKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _delegate, CPTableViewDelegateKey);
    objj_msgSend(aCoder, "encodeFloat:forKey:", _rowHeight, CPTableViewRowHeightKey);
    objj_msgSend(aCoder, "encodeSize:forKey:", _intercellSpacing, CPTableViewIntercellSpacingKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _allowsMultipleSelection, CPTableViewMultipleSelectionKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _allowsEmptySelection, CPTableViewEmptySelectionKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _allowsColumnReordering, CPTableViewColumnReorderingKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _allowsColumnResizing, CPTableViewColumnResizingKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _allowsColumnSelection, CPTableViewColumnSelectionKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _tableColumns, CPTableViewTableColumnsKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _gridColor, CPTableViewGridColorKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _gridStyleMask, CPTableViewGridStyleMaskKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _usesAlternatingRowBackgroundColors, CPTableViewUsesAlternatingBackgroundKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _cornerView, CPTableViewCornerViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _headerView, CPTableViewHeaderViewKey);
}
})]);
}
{
var the_class = objj_getClass("CPColor")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPColor\"");
var meta_class = the_class.isa;class_addMethods(meta_class, [new objj_method(sel_getUid("selectionColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPColor, "colorWithHexString:", "5f83b9");
}
}), new objj_method(sel_getUid("selectionColorSourceView"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initByReferencingFile:size:", "Resources/tableviewselection.png", CGSizeMake(6,22)));
}
})]);
}
{
var the_class = objj_getClass("CPIndexSet")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPIndexSet\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("removeMatches:"), function(self, _cmd, otherSet)
{ with(self)
{
    var firstindex = objj_msgSend(self, "firstIndex");
    var index = MIN(firstindex,objj_msgSend(otherSet, "firstIndex"));
    var switchFlag = (index == firstindex);
    while(index != CPNotFound)
    {
        var indexSet = (switchFlag) ? otherSet : self;
        otherIndex = objj_msgSend(indexSet, "indexGreaterThanOrEqualToIndex:", index);
        if (otherIndex == index)
        {
            objj_msgSend(self, "removeIndex:", index);
            objj_msgSend(otherSet, "removeIndex:", index);
        }
        index = otherIndex;
        switchFlag = !switchFlag;
    }
}
})]);
}
{var the_class = objj_allocateClassPair(CPView, "_dropOperationDrawingView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("dropOperation"), new objj_ivar("tableView"), new objj_ivar("currentRow")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("dropOperation"), function(self, _cmd)
{ with(self)
{
return dropOperation;
}
}),
new objj_method(sel_getUid("setDropOperation:"), function(self, _cmd, newValue)
{ with(self)
{
dropOperation = newValue;
}
}),
new objj_method(sel_getUid("tableView"), function(self, _cmd)
{ with(self)
{
return tableView;
}
}),
new objj_method(sel_getUid("setTableView:"), function(self, _cmd, newValue)
{ with(self)
{
tableView = newValue;
}
}),
new objj_method(sel_getUid("currentRow"), function(self, _cmd)
{ with(self)
{
return currentRow;
}
}),
new objj_method(sel_getUid("setCurrentRow:"), function(self, _cmd, newValue)
{ with(self)
{
currentRow = newValue;
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if(tableView._destinationDragStyle === CPTableViewDraggingDestinationFeedbackStyleNone)
        return;
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");
    CGContextSetStrokeColor(context, objj_msgSend(CPColor, "colorWithHexString:", "4886ca"));
    CGContextSetLineWidth(context, 3);
    if(dropOperation === CPTableViewDropOn)
    {
        var selectedRows = objj_msgSend(tableView, "selectedRowIndexes");
        var newRect = { origin: { x:aRect.origin.x + 2, y:aRect.origin.y + 2 }, size: { width:aRect.size.width - 4, height:aRect.size.height - 5 } };
        if(objj_msgSend(selectedRows, "containsIndex:", currentRow))
        {
            CGContextSetLineWidth(context, 2);
            CGContextSetStrokeColor(context, objj_msgSend(CPColor, "whiteColor"));
        }
        else
        {
            CGContextSetFillColor(context, objj_msgSend(CPColor, "colorWithRed:green:blue:alpha:", 72/255, 134/255, 202/255, 0.25));
            CGContextFillRoundedRectangleInRect(context, newRect, 8, YES, YES, YES, YES);
        }
        CGContextStrokeRoundedRectangleInRect(context, newRect, 8, YES, YES, YES, YES);
    }
    if(dropOperation === CPTableViewDropAbove)
    {
        objj_msgSend(self, "setFrameOrigin:", CGPointMake(_frame.origin.x, _frame.origin.y - 8));
        var selectedRows = objj_msgSend(tableView, "selectedRowIndexes");
        if(objj_msgSend(selectedRows, "containsIndex:", currentRow - 1) || objj_msgSend(selectedRows, "containsIndex:", currentRow))
        {
            CGContextSetStrokeColor(context, objj_msgSend(CPColor, "whiteColor"));
            CGContextSetLineWidth(context, 4);
            CGContextStrokeEllipseInRect(context, { origin: { x:aRect.origin.x + 4, y:aRect.origin.y + 4 }, size: { width:8, height:8 } });
            CGContextBeginPath(context);
            CGContextMoveToPoint(context, 10, aRect.origin.y + 8);
            CGContextAddLineToPoint(context, aRect.size.width - aRect.origin.y - 8, aRect.origin.y + 8);
            CGContextClosePath(context);
            CGContextStrokePath(context);
            CGContextSetStrokeColor(context, objj_msgSend(CPColor, "colorWithHexString:", "4886ca"));
            CGContextSetLineWidth(context, 3);
        }
        CGContextStrokeEllipseInRect(context, { origin: { x:aRect.origin.x + 4, y:aRect.origin.y + 4 }, size: { width:8, height:8 } });
        CGContextBeginPath(context);
        CGContextMoveToPoint(context, 10, aRect.origin.y + 8);
        CGContextAddLineToPoint(context, aRect.size.width - aRect.origin.y - 8, aRect.origin.y + 8);
        CGContextClosePath(context);
        CGContextStrokePath(context);
    }
}
})]);
}

p;11;CPTabView.jt;24764;@STATIC;1.0;i;13;CPImageView.ji;15;CPTabViewItem.ji;8;CPView.jt;24694;objj_executeFile("CPImageView.j", true);
objj_executeFile("CPTabViewItem.j", true);
objj_executeFile("CPView.j", true);
CPTopTabsBezelBorder = 0;
CPNoTabsBezelBorder = 4;
CPNoTabsLineBorder = 5;
CPNoTabsNoBorder = 6;
var CPTabViewBezelBorderLeftImage = nil,
    CPTabViewBackgroundCenterImage = nil,
    CPTabViewBezelBorderRightImage = nil,
    CPTabViewBezelBorderColor = nil,
    CPTabViewBezelBorderBackgroundColor = nil;
var LEFT_INSET = 7.0,
    RIGHT_INSET = 7.0;
var CPTabViewDidSelectTabViewItemSelector = 1,
    CPTabViewShouldSelectTabViewItemSelector = 2,
    CPTabViewWillSelectTabViewItemSelector = 4,
    CPTabViewDidChangeNumberOfTabViewItemsSelector = 8;
{var the_class = objj_allocateClassPair(CPView, "CPTabView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_labelsView"), new objj_ivar("_backgroundView"), new objj_ivar("_separatorView"), new objj_ivar("_auxiliaryView"), new objj_ivar("_contentView"), new objj_ivar("_tabViewItems"), new objj_ivar("_selectedTabViewItem"), new objj_ivar("_tabViewType"), new objj_ivar("_delegate"), new objj_ivar("_delegateSelectors")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTabView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _tabViewType = CPTopTabsBezelBorder;
        _tabViewItems = [];
    }
    return self;
}
}), new objj_method(sel_getUid("viewDidMoveToWindow"), function(self, _cmd)
{ with(self)
{
    if (_tabViewType != CPTopTabsBezelBorder || _labelsView)
        return;
    objj_msgSend(self, "_createBezelBorder");
    objj_msgSend(self, "layoutSubviews");
}
}), new objj_method(sel_getUid("_createBezelBorder"), function(self, _cmd)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds");
    _labelsView = objj_msgSend(objj_msgSend(_CPTabLabelsView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, CGRectGetWidth(bounds), 0.0));
    objj_msgSend(_labelsView, "setTabView:", self);
    objj_msgSend(_labelsView, "setAutoresizingMask:", CPViewWidthSizable);
    objj_msgSend(self, "addSubview:", _labelsView);
    _backgroundView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMakeZero());
    objj_msgSend(_backgroundView, "setBackgroundColor:", CPTabViewBezelBorderBackgroundColor);
    objj_msgSend(_backgroundView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
    objj_msgSend(self, "addSubview:", _backgroundView);
    _separatorView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMakeZero());
    objj_msgSend(_separatorView, "setBackgroundColor:", objj_msgSend(objj_msgSend(self, "class"), "bezelBorderColor"));
    objj_msgSend(_separatorView, "setAutoresizingMask:", CPViewWidthSizable | CPViewMaxYMargin);
    objj_msgSend(self, "addSubview:", _separatorView);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    if (_tabViewType == CPTopTabsBezelBorder)
    {
        var backgroundRect = objj_msgSend(self, "bounds"),
            labelsViewHeight = objj_msgSend(_CPTabLabelsView, "height");
        backgroundRect.origin.y += labelsViewHeight;
        backgroundRect.size.height -= labelsViewHeight;
        objj_msgSend(_backgroundView, "setFrame:", backgroundRect);
        var auxiliaryViewHeight = 5.0;
        if (_auxiliaryView)
        {
            auxiliaryViewHeight = CGRectGetHeight(objj_msgSend(_auxiliaryView, "frame"));
            objj_msgSend(_auxiliaryView, "setFrame:", CGRectMake(LEFT_INSET, labelsViewHeight, CGRectGetWidth(backgroundRect) - LEFT_INSET - RIGHT_INSET, auxiliaryViewHeight));
        }
        objj_msgSend(_separatorView, "setFrame:", CGRectMake(LEFT_INSET, labelsViewHeight + auxiliaryViewHeight, CGRectGetWidth(backgroundRect) - LEFT_INSET - RIGHT_INSET, 1.0));
    }
    objj_msgSend(_contentView, "setFrame:", objj_msgSend(self, "contentRect"));
}
}), new objj_method(sel_getUid("addTabViewItem:"), function(self, _cmd, aTabViewItem)
{ with(self)
{
    objj_msgSend(self, "insertTabViewItem:atIndex:", aTabViewItem, objj_msgSend(_tabViewItems, "count"));
}
}), new objj_method(sel_getUid("insertTabViewItem:atIndex:"), function(self, _cmd, aTabViewItem, anIndex)
{ with(self)
{
    if (!_labelsView && _tabViewType == CPTopTabsBezelBorder)
        objj_msgSend(self, "_createBezelBorder");
    objj_msgSend(_tabViewItems, "insertObject:atIndex:", aTabViewItem, anIndex);
    objj_msgSend(_labelsView, "tabView:didAddTabViewItem:", self, aTabViewItem);
    objj_msgSend(aTabViewItem, "_setTabView:", self);
    if (objj_msgSend(_tabViewItems, "count") == 1)
        objj_msgSend(self, "selectFirstTabViewItem:", self);
    if (_delegateSelectors & CPTabViewDidChangeNumberOfTabViewItemsSelector)
        objj_msgSend(_delegate, "tabViewDidChangeNumberOfTabViewItems:", self);
}
}), new objj_method(sel_getUid("removeTabViewItem:"), function(self, _cmd, aTabViewItem)
{ with(self)
{
    var index = objj_msgSend(self, "indexOfTabViewItem:", aTabViewItem);
    objj_msgSend(_tabViewItems, "removeObjectIdenticalTo:", aTabViewItem);
    objj_msgSend(_labelsView, "tabView:didRemoveTabViewItemAtIndex:", self, index);
    objj_msgSend(aTabViewItem, "_setTabView:", nil);
    if (_delegateSelectors & CPTabViewDidChangeNumberOfTabViewItemsSelector)
        objj_msgSend(_delegate, "tabViewDidChangeNumberOfTabViewItems:", self);
}
}), new objj_method(sel_getUid("indexOfTabViewItem:"), function(self, _cmd, aTabViewItem)
{ with(self)
{
    return objj_msgSend(_tabViewItems, "indexOfObjectIdenticalTo:", aTabViewItem);
}
}), new objj_method(sel_getUid("indexOfTabViewItemWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    var index = 0,
        count = objj_msgSend(_tabViewItems, "count");
    for (; index < count; ++index)
        if (objj_msgSend(objj_msgSend(_tabViewItems[index], "identifier"), "isEqual:", anIdentifier))
            return index;
    return index;
}
}), new objj_method(sel_getUid("numberOfTabViewItems"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_tabViewItems, "count");
}
}), new objj_method(sel_getUid("tabViewItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return _tabViewItems[anIndex];
}
}), new objj_method(sel_getUid("tabViewItems"), function(self, _cmd)
{ with(self)
{
    return _tabViewItems;
}
}), new objj_method(sel_getUid("selectFirstTabViewItem:"), function(self, _cmd, aSender)
{ with(self)
{
    var count = objj_msgSend(_tabViewItems, "count");
    if (count)
        objj_msgSend(self, "selectTabViewItemAtIndex:", 0);
}
}), new objj_method(sel_getUid("selectLastTabViewItem:"), function(self, _cmd, aSender)
{ with(self)
{
    var count = objj_msgSend(_tabViewItems, "count");
    if (count)
        objj_msgSend(self, "selectTabViewItemAtIndex:", count - 1);
}
}), new objj_method(sel_getUid("selectNextTabViewItem:"), function(self, _cmd, aSender)
{ with(self)
{
    if (!_selectedTabViewItem)
        return;
    var index = objj_msgSend(self, "indexOfTabViewItem:", _selectedTabViewItem),
        count = objj_msgSend(_tabViewItems, "count");
    objj_msgSend(self, "selectTabViewItemAtIndex:", index + 1 % count);
}
}), new objj_method(sel_getUid("selectPreviousTabViewItem:"), function(self, _cmd, aSender)
{ with(self)
{
    if (!_selectedTabViewItem)
        return;
    var index = objj_msgSend(self, "indexOfTabViewItem:", _selectedTabViewItem),
        count = objj_msgSend(_tabViewItems, "count");
    objj_msgSend(self, "selectTabViewItemAtIndex:", index == 0 ? count : index - 1);
}
}), new objj_method(sel_getUid("selectTabViewItem:"), function(self, _cmd, aTabViewItem)
{ with(self)
{
    if ((_delegateSelectors & CPTabViewShouldSelectTabViewItemSelector) && !objj_msgSend(_delegate, "tabView:shouldSelectTabViewItem:", self, aTabViewItem))
        return;
    if (_delegateSelectors & CPTabViewWillSelectTabViewItemSelector)
        objj_msgSend(_delegate, "tabView:willSelectTabViewItem:", self, aTabViewItem);
    if (_selectedTabViewItem)
    {
        _selectedTabViewItem._tabState = CPBackgroundTab;
        objj_msgSend(_labelsView, "tabView:didChangeStateOfTabViewItem:", self, _selectedTabViewItem);
        objj_msgSend(_contentView, "removeFromSuperview");
        objj_msgSend(_auxiliaryView, "removeFromSuperview");
    }
    _selectedTabViewItem = aTabViewItem;
    _selectedTabViewItem._tabState = CPSelectedTab;
    _contentView = objj_msgSend(_selectedTabViewItem, "view");
    objj_msgSend(_contentView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
    _auxiliaryView = objj_msgSend(_selectedTabViewItem, "auxiliaryView");
    objj_msgSend(_auxiliaryView, "setAutoresizingMask:", CPViewWidthSizable);
    objj_msgSend(self, "addSubview:", _contentView);
    if (_auxiliaryView)
        objj_msgSend(self, "addSubview:", _auxiliaryView);
    objj_msgSend(_labelsView, "tabView:didChangeStateOfTabViewItem:", self, _selectedTabViewItem);
    objj_msgSend(self, "layoutSubviews");
    if (_delegateSelectors & CPTabViewDidSelectTabViewItemSelector)
        objj_msgSend(_delegate, "tabView:didSelectTabViewItem:", self, aTabViewItem);
}
}), new objj_method(sel_getUid("selectTabViewItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    objj_msgSend(self, "selectTabViewItem:", _tabViewItems[anIndex]);
}
}), new objj_method(sel_getUid("selectedTabViewItem"), function(self, _cmd)
{ with(self)
{
    return _selectedTabViewItem;
}
}), new objj_method(sel_getUid("setTabViewType:"), function(self, _cmd, aTabViewType)
{ with(self)
{
    if (_tabViewType == aTabViewType)
        return;
    _tabViewType = aTabViewType;
    if (_tabViewType == CPNoTabsBezelBorder || _tabViewType == CPNoTabsLineBorder || _tabViewType == CPNoTabsNoBorder)
        objj_msgSend(_labelsView, "removeFromSuperview");
    else if (!objj_msgSend(_labelsView, "superview"))
        objj_msgSend(self, "addSubview:", _labelsView);
    if (_tabViewType == CPNoTabsLineBorder || _tabViewType == CPNoTabsNoBorder)
        objj_msgSend(_backgroundView, "removeFromSuperview");
    else if (!objj_msgSend(_backgroundView, "superview"))
        objj_msgSend(self, "addSubview:", _backgroundView);
    objj_msgSend(self, "layoutSubviews");
}
}), new objj_method(sel_getUid("tabViewType"), function(self, _cmd)
{ with(self)
{
    return _tabViewType;
}
}), new objj_method(sel_getUid("contentRect"), function(self, _cmd)
{ with(self)
{
    var contentRect = CGRectMakeCopy(objj_msgSend(self, "bounds"));
    if (_tabViewType == CPTopTabsBezelBorder)
    {
        var labelsViewHeight = objj_msgSend(_CPTabLabelsView, "height"),
            auxiliaryViewHeight = _auxiliaryView ? CGRectGetHeight(objj_msgSend(_auxiliaryView, "frame")) : 5.0,
            separatorViewHeight = 1.0;
        contentRect.origin.y += labelsViewHeight + auxiliaryViewHeight + separatorViewHeight;
        contentRect.size.height -= labelsViewHeight + auxiliaryViewHeight + separatorViewHeight * 2.0;
        contentRect.origin.x += LEFT_INSET;
        contentRect.size.width -= LEFT_INSET + RIGHT_INSET;
    }
    return contentRect;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    if (_delegate == aDelegate)
        return;
    _delegate = aDelegate;
    _delegateSelectors = 0;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tabView:shouldSelectTabViewItem:")))
        _delegateSelectors |= CPTabViewShouldSelectTabViewItemSelector;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tabView:willSelectTabViewItem:")))
        _delegateSelectors |= CPTabViewWillSelectTabViewItemSelector;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tabView:didSelectTabViewItem:")))
        _delegateSelectors |= CPTabViewDidSelectTabViewItemSelector;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("tabViewDidChangeNumberOfTabViewItems:")))
        _delegateSelectors |= CPTabViewDidChangeNumberOfTabViewItemsSelector;
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    var location = objj_msgSend(_labelsView, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil),
        tabViewItem = objj_msgSend(_labelsView, "representedTabViewItemAtPoint:", location);
    if (tabViewItem)
        objj_msgSend(self, "selectTabViewItem:", tabViewItem);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != CPTabView)
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self),
        emptyImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initByReferencingFile:size:", "", CGSizeMake(7.0, 0.0)),
        backgroundImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/CPTabViewBezelBackgroundCenter.png"), CGSizeMake(1.0, 1.0)),
        bezelBorderLeftImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/CPTabViewBezelBorderLeft.png"), CGSizeMake(7.0, 1.0)),
        bezerBorderImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/CPTabViewBezelBorder.png"), CGSizeMake(1.0, 1.0)),
        bezelBorderRightImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/CPTabViewBezelBorderRight.png"), CGSizeMake(7.0, 1.0));
    CPTabViewBezelBorderBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
        [
            emptyImage,
            emptyImage,
            emptyImage,
            bezelBorderLeftImage,
            backgroundImage,
            bezelBorderRightImage,
            bezelBorderLeftImage,
            bezerBorderImage,
            bezelBorderRightImage
        ]));
    CPTabViewBezelBorderColor = objj_msgSend(CPColor, "colorWithPatternImage:", bezerBorderImage);
}
}), new objj_method(sel_getUid("bezelBorderColor"), function(self, _cmd)
{ with(self)
{
    return CPTabViewBezelBorderColor;
}
})]);
}
var CPTabViewItemsKey = "CPTabViewItemsKey",
    CPTabViewSelectedItemKey = "CPTabViewSelectedItemKey",
    CPTabViewTypeKey = "CPTabViewTypeKey",
    CPTabViewDelegateKey = "CPTabViewDelegateKey";
{
var the_class = objj_getClass("CPTabView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTabView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTabView").super_class }, "initWithCoder:", aCoder))
    {
        _tabViewType = objj_msgSend(aCoder, "decodeIntForKey:", CPTabViewTypeKey);
        _tabViewItems = [];
        objj_msgSend(self, "_createBezelBorder");
        var items = objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewItemsKey);
        for (var i = 0; items && i < items.length; i++)
            objj_msgSend(self, "insertTabViewItem:atIndex:", items[i], i);
        var selected = objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewSelectedItemKey);
        if (selected)
            objj_msgSend(self, "selectTabViewItem:", selected);
        objj_msgSend(self, "setDelegate:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewDelegateKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    var actualSubviews = _subviews;
    _subviews = [];
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTabView").super_class }, "encodeWithCoder:", aCoder);
    _subviews = actualSubviews;
    objj_msgSend(aCoder, "encodeObject:forKey:", _tabViewItems, CPTabViewItemsKey);;
    objj_msgSend(aCoder, "encodeObject:forKey:", _selectedTabViewItem, CPTabViewSelectedItemKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _tabViewType, CPTabViewTypeKey);
    objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _delegate, CPTabViewDelegateKey);
}
})]);
}
var _CPTabLabelsViewBackgroundColor = nil,
    _CPTabLabelsViewInsideMargin = 10.0,
    _CPTabLabelsViewOutsideMargin = 15.0;
{var the_class = objj_allocateClassPair(CPView, "_CPTabLabelsView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_tabView"), new objj_ivar("_tabLabels")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTabLabelsView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _tabLabels = [];
        objj_msgSend(self, "setBackgroundColor:", _CPTabLabelsViewBackgroundColor);
        objj_msgSend(self, "setFrameSize:", CGSizeMake(CGRectGetWidth(aFrame), 26.0));
    }
    return self;
}
}), new objj_method(sel_getUid("setTabView:"), function(self, _cmd, aTabView)
{ with(self)
{
    _tabView = aTabView;
}
}), new objj_method(sel_getUid("tabView"), function(self, _cmd)
{ with(self)
{
    return _tabView;
}
}), new objj_method(sel_getUid("tabView:didAddTabViewItem:"), function(self, _cmd, aTabView, aTabViewItem)
{ with(self)
{
    var label = objj_msgSend(objj_msgSend(_CPTabLabel, "alloc"), "initWithFrame:", CGRectMakeZero());
    objj_msgSend(label, "setTabViewItem:", aTabViewItem);
    _tabLabels.push(label);
    objj_msgSend(self, "addSubview:", label);
    objj_msgSend(self, "layoutSubviews");
}
}), new objj_method(sel_getUid("tabView:didRemoveTabViewItemAtIndex:"), function(self, _cmd, aTabView, index)
{ with(self)
{
    var label = _tabLabels[index];
    objj_msgSend(_tabLabels, "removeObjectAtIndex:", index);
    objj_msgSend(label, "removeFromSuperview");
    objj_msgSend(self, "layoutSubviews");
}
}), new objj_method(sel_getUid("tabView:didChangeStateOfTabViewItem:"), function(self, _cmd, aTabView, aTabViewItem)
{ with(self)
{
    objj_msgSend(_tabLabels[objj_msgSend(aTabView, "indexOfTabViewItem:", aTabViewItem)], "setTabState:", objj_msgSend(aTabViewItem, "tabState"));
 }
}), new objj_method(sel_getUid("representedTabViewItemAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var index = 0,
        count = _tabLabels.length;
    for (; index < count; ++index)
    {
        var label = _tabLabels[index];
        if (CGRectContainsPoint(objj_msgSend(label, "frame"), aPoint))
            return objj_msgSend(label, "tabViewItem");
    }
    return nil;
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var index = 0,
        count = _tabLabels.length,
        width = ((objj_msgSend(self, "bounds").size.width) - (count - 1) * _CPTabLabelsViewInsideMargin - 2 * _CPTabLabelsViewOutsideMargin) / count,
        x = _CPTabLabelsViewOutsideMargin;
    for (; index < count; ++index)
    {
        var label = _tabLabels[index],
            frame = { origin: { x:x, y:8.0 }, size: { width:width, height:18.0 } };
        objj_msgSend(label, "setFrame:", frame);
        x = (frame.origin.x + frame.size.width) + _CPTabLabelsViewInsideMargin;
    }
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    if (CGSizeEqualToSize(objj_msgSend(self, "frame").size, aSize))
        return;
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTabLabelsView").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "layoutSubviews");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPTabLabelsView, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    _CPTabLabelsViewBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPThreePartImage, "alloc"), "initWithImageSlices:isVertical:", 
        [
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelsViewLeft.png"), CGSizeMake(12.0, 26.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelsViewCenter.png"), CGSizeMake(1.0, 26.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelsViewRight.png"), CGSizeMake(12.0, 26.0))
        ], NO));
}
}), new objj_method(sel_getUid("height"), function(self, _cmd)
{ with(self)
{
    return 26.0;
}
})]);
}
var _CPTabLabelBackgroundColor = nil,
    _CPTabLabelSelectedBackgroundColor = nil;
{var the_class = objj_allocateClassPair(CPView, "_CPTabLabel"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_tabViewItem"), new objj_ivar("_labelField")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTabLabel").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _labelField = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMakeZero());
        objj_msgSend(_labelField, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(_labelField, "setFrame:", CGRectMake(5.0, 0.0, CGRectGetWidth(aFrame) - 10.0, 20.0));
        objj_msgSend(_labelField, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_labelField, "setFont:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 11.0));
        objj_msgSend(self, "addSubview:", _labelField);
        objj_msgSend(self, "setTabState:", CPBackgroundTab);
    }
    return self;
}
}), new objj_method(sel_getUid("setTabState:"), function(self, _cmd, aTabState)
{ with(self)
{
    objj_msgSend(self, "setBackgroundColor:", aTabState == CPSelectedTab ? _CPTabLabelSelectedBackgroundColor : _CPTabLabelBackgroundColor);
}
}), new objj_method(sel_getUid("setTabViewItem:"), function(self, _cmd, aTabViewItem)
{ with(self)
{
    _tabViewItem = aTabViewItem;
    objj_msgSend(self, "update");
}
}), new objj_method(sel_getUid("tabViewItem"), function(self, _cmd)
{ with(self)
{
    return _tabViewItem;
}
}), new objj_method(sel_getUid("update"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_labelField, "setStringValue:", objj_msgSend(_tabViewItem, "label"));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPTabLabel, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    _CPTabLabelBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPThreePartImage, "alloc"), "initWithImageSlices:isVertical:", 
        [
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelBackgroundLeft.png"), CGSizeMake(6.0, 18.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelBackgroundCenter.png"), CGSizeMake(1.0, 18.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelBackgroundRight.png"), CGSizeMake(6.0, 18.0))
        ], NO));
    _CPTabLabelSelectedBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPThreePartImage, "alloc"), "initWithImageSlices:isVertical:", 
        [
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelSelectedLeft.png"), CGSizeMake(3.0, 18.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelSelectedCenter.png"), CGSizeMake(1.0, 18.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPTabView/_CPTabLabelSelectedRight.png"), CGSizeMake(3.0, 18.0))
        ], NO));
}
})]);
}

p;15;CPTabViewItem.jt;3695;@STATIC;1.0;I;21;Foundation/CPObject.jI;15;AppKit/CPView.jt;3630;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("AppKit/CPView.j", false);
CPSelectedTab = 0;
CPBackgroundTab = 1;
CPPressedTab = 2;
{var the_class = objj_allocateClassPair(CPObject, "CPTabViewItem"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_identifier"), new objj_ivar("_label"), new objj_ivar("_view"), new objj_ivar("_auxiliaryView"), new objj_ivar("_tabView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithIdentifier:", "");
}
}), new objj_method(sel_getUid("initWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTabViewItem").super_class }, "init");
    if (self)
        _identifier = anIdentifier;
    return self;
}
}), new objj_method(sel_getUid("setLabel:"), function(self, _cmd, aLabel)
{ with(self)
{
    _label = aLabel;
}
}), new objj_method(sel_getUid("label"), function(self, _cmd)
{ with(self)
{
    return _label;
}
}), new objj_method(sel_getUid("tabState"), function(self, _cmd)
{ with(self)
{
    return _tabState;
}
}), new objj_method(sel_getUid("setIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    _identifier = anIdentifier;
}
}), new objj_method(sel_getUid("identifier"), function(self, _cmd)
{ with(self)
{
    return _identifier;
}
}), new objj_method(sel_getUid("setView:"), function(self, _cmd, aView)
{ with(self)
{
    _view = aView;
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return _view;
}
}), new objj_method(sel_getUid("setAuxiliaryView:"), function(self, _cmd, anAuxiliaryView)
{ with(self)
{
    _auxiliaryView = anAuxiliaryView;
}
}), new objj_method(sel_getUid("auxiliaryView"), function(self, _cmd)
{ with(self)
{
    return _auxiliaryView;
}
}), new objj_method(sel_getUid("tabView"), function(self, _cmd)
{ with(self)
{
    return _tabView;
}
}), new objj_method(sel_getUid("_setTabView:"), function(self, _cmd, aView)
{ with(self)
{
    _tabView = aView;
}
})]);
}
var CPTabViewItemIdentifierKey = "CPTabViewItemIdentifierKey",
    CPTabViewItemLabelKey = "CPTabViewItemLabelKey",
    CPTabViewItemViewKey = "CPTabViewItemViewKey",
    CPTabViewItemAuxViewKey = "CPTabViewItemAuxViewKey";
{
var the_class = objj_getClass("CPTabViewItem")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTabViewItem\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTabViewItem").super_class }, "init");
    if (self)
    {
        _identifier = objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewItemIdentifierKey);
        _label = objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewItemLabelKey);
        _view = objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewItemViewKey);
        _auxiliaryView = objj_msgSend(aCoder, "decodeObjectForKey:", CPTabViewItemAuxViewKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _identifier, CPTabViewItemIdentifierKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _label, CPTabViewItemLabelKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _view, CPTabViewItemViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _auxiliaryView, CPTabViewItemAuxViewKey);
}
})]);
}

p;13;CPTextField.jt;36864;@STATIC;1.0;i;11;CPControl.ji;17;CPStringDrawing.ji;17;CPCompatibility.ji;21;_CPImageAndTextView.jt;36758;objj_executeFile("CPControl.j", true);
objj_executeFile("CPStringDrawing.j", true);
objj_executeFile("CPCompatibility.j", true);
objj_executeFile("_CPImageAndTextView.j", true);
CPTextFieldSquareBezel = 0;
CPTextFieldRoundedBezel = 1;
CPTextFieldDidFocusNotification = "CPTextFieldDidFocusNotification";
CPTextFieldDidBlurNotification = "CPTextFieldDidBlurNotification";
var CPTextFieldDOMInputElement = nil,
    CPTextFieldDOMPasswordInputElement = nil,
    CPTextFieldDOMStandardInputElement = nil,
    CPTextFieldInputOwner = nil,
    CPTextFieldTextDidChangeValue = nil,
    CPTextFieldInputResigning = NO,
    CPTextFieldInputDidBlur = NO,
    CPTextFieldInputIsActive = NO,
    CPTextFieldCachedSelectStartFunction = nil,
    CPTextFieldCachedDragFunction = nil,
    CPTextFieldBlurFunction = nil;
var CPSecureTextFieldCharacter = "\u2022";
{
var the_class = objj_getClass("CPString")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPString\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("string"), function(self, _cmd)
{ with(self)
{
    return self;
}
})]);
}
CPTextFieldStateRounded = CPThemeState("rounded");
CPTextFieldStatePlaceholder = CPThemeState("placeholder");
{var the_class = objj_allocateClassPair(CPControl, "CPTextField"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_isEditing"), new objj_ivar("_isEditable"), new objj_ivar("_isSelectable"), new objj_ivar("_isSecure"), new objj_ivar("_drawsBackground"), new objj_ivar("_textFieldBackgroundColor"), new objj_ivar("_placeholderString"), new objj_ivar("_delegate"), new objj_ivar("_textDidChangeValue"), new objj_ivar("_bezelStyle"), new objj_ivar("_isBordered"), new objj_ivar("_controlSize")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("_inputElement"), function(self, _cmd)
{ with(self)
{
    if (!CPTextFieldDOMInputElement)
    {
        CPTextFieldDOMInputElement = document.createElement("input");
        CPTextFieldDOMInputElement.style.position = "absolute";
        CPTextFieldDOMInputElement.style.border = "0px";
        CPTextFieldDOMInputElement.style.padding = "0px";
        CPTextFieldDOMInputElement.style.margin = "0px";
        CPTextFieldDOMInputElement.style.whiteSpace = "pre";
        CPTextFieldDOMInputElement.style.background = "transparent";
        CPTextFieldDOMInputElement.style.outline = "none";
        CPTextFieldBlurFunction = function(anEvent)
        {
            if (CPTextFieldInputOwner && CPTextFieldInputOwner._DOMElement != CPTextFieldDOMInputElement.parentNode)
                return;
            if (!CPTextFieldInputResigning)
            {
                objj_msgSend(objj_msgSend(CPTextFieldInputOwner, "window"), "makeFirstResponder:", nil);
                return;
            }
            CPTextFieldHandleBlur(anEvent, CPTextFieldDOMInputElement);
            CPTextFieldInputDidBlur = YES;
            return true;
        }
        CPTextFieldHandleBlur = function(anEvent)
        {
            CPTextFieldInputOwner = nil;
            objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
        }
        CPTextFieldDOMInputElement.onblur = CPTextFieldBlurFunction;
        CPTextFieldDOMStandardInputElement = CPTextFieldDOMInputElement;
    }
    if (CPFeatureIsCompatible(CPInputTypeCanBeChangedFeature))
    {
        if (objj_msgSend(self, "isSecure"))
            CPTextFieldDOMInputElement.type = "password";
        else
            CPTextFieldDOMInputElement.type = "text";
        return CPTextFieldDOMInputElement;
    }
    if (objj_msgSend(self, "isSecure"))
    {
        if (!CPTextFieldDOMPasswordInputElement)
        {
            CPTextFieldDOMPasswordInputElement = document.createElement("input");
            CPTextFieldDOMPasswordInputElement.style.position = "absolute";
            CPTextFieldDOMPasswordInputElement.style.border = "0px";
            CPTextFieldDOMPasswordInputElement.style.padding = "0px";
            CPTextFieldDOMPasswordInputElement.style.margin = "0px";
            CPTextFieldDOMPasswordInputElement.style.whiteSpace = "pre";
            CPTextFieldDOMPasswordInputElement.style.background = "transparent";
            CPTextFieldDOMPasswordInputElement.style.outline = "none";
            CPTextFieldDOMPasswordInputElement.type = "password";
            CPTextFieldDOMPasswordInputElement.onblur = CPTextFieldBlurFunction;
        }
        CPTextFieldDOMInputElement = CPTextFieldDOMPasswordInputElement;
    }
    else
    {
        CPTextFieldDOMInputElement = CPTextFieldDOMStandardInputElement;
    }
    return CPTextFieldDOMInputElement;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        objj_msgSend(self, "setStringValue:", "");
        objj_msgSend(self, "setPlaceholderString:", "");
        _sendActionOn = CPKeyUpMask | CPKeyDownMask;
        objj_msgSend(self, "setValue:forThemeAttribute:", CPLeftTextAlignment, "alignment");
    }
    return self;
}
}), new objj_method(sel_getUid("setEditable:"), function(self, _cmd, shouldBeEditable)
{ with(self)
{
    _isEditable = shouldBeEditable;
}
}), new objj_method(sel_getUid("isEditable"), function(self, _cmd)
{ with(self)
{
    return _isEditable;
}
}), new objj_method(sel_getUid("setSelectable:"), function(self, _cmd, aFlag)
{ with(self)
{
    _isSelectable = aFlag;
}
}), new objj_method(sel_getUid("isSelectable"), function(self, _cmd)
{ with(self)
{
    return _isSelectable;
}
}), new objj_method(sel_getUid("setSecure:"), function(self, _cmd, aFlag)
{ with(self)
{
    _isSecure = aFlag;
}
}), new objj_method(sel_getUid("isSecure"), function(self, _cmd)
{ with(self)
{
    return _isSecure;
}
}), new objj_method(sel_getUid("setBezeled:"), function(self, _cmd, shouldBeBezeled)
{ with(self)
{
    if (shouldBeBezeled)
        objj_msgSend(self, "setThemeState:", CPThemeStateBezeled);
    else
        objj_msgSend(self, "unsetThemeState:", CPThemeStateBezeled);
}
}), new objj_method(sel_getUid("isBezeled"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "hasThemeState:", CPThemeStateBezeled);
}
}), new objj_method(sel_getUid("setBezelStyle:"), function(self, _cmd, aBezelStyle)
{ with(self)
{
    var shouldBeRounded = aBezelStyle === CPTextFieldRoundedBezel;
    if (shouldBeRounded)
        objj_msgSend(self, "setThemeState:", CPTextFieldStateRounded);
    else
        objj_msgSend(self, "unsetThemeState:", CPTextFieldStateRounded);
}
}), new objj_method(sel_getUid("bezelStyle"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(self, "hasThemeState:", CPTextFieldStateRounded))
        return CPTextFieldRoundedBezel;
    return CPTextFieldSquareBezel;
}
}), new objj_method(sel_getUid("setBordered:"), function(self, _cmd, shouldBeBordered)
{ with(self)
{
    if (shouldBeBordered)
        objj_msgSend(self, "setThemeState:", CPThemeStateBordered);
    else
        objj_msgSend(self, "unsetThemeState:", CPThemeStateBordered);
}
}), new objj_method(sel_getUid("isBordered"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "hasThemeState:", CPThemeStateBordered);
}
}), new objj_method(sel_getUid("setDrawsBackground:"), function(self, _cmd, shouldDrawBackground)
{ with(self)
{
    if (_drawsBackground == shouldDrawBackground)
        return;
    _drawsBackground = shouldDrawBackground;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("drawsBackground"), function(self, _cmd)
{ with(self)
{
    return _drawsBackground;
}
}), new objj_method(sel_getUid("setTextFieldBackgroundColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_textFieldBackgroundColor == aColor)
        return;
    _textFieldBackgroundColor = aColor;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("textFieldBackgroundColor"), function(self, _cmd)
{ with(self)
{
    return _textFieldBackgroundColor;
}
}), new objj_method(sel_getUid("acceptsFirstResponder"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "isEditable") && objj_msgSend(self, "isEnabled");
}
}), new objj_method(sel_getUid("becomeFirstResponder"), function(self, _cmd)
{ with(self)
{
    if (CPTextFieldInputOwner && objj_msgSend(CPTextFieldInputOwner, "window") !== objj_msgSend(self, "window"))
        objj_msgSend(objj_msgSend(CPTextFieldInputOwner, "window"), "makeFirstResponder:", nil);
    objj_msgSend(self, "setThemeState:", CPThemeStateEditing);
    objj_msgSend(self, "_updatePlaceholderState");
    objj_msgSend(self, "setNeedsLayout");
    _isEditing = NO;
    var string = objj_msgSend(self, "stringValue"),
        element = objj_msgSend(self, "_inputElement");
    element.value = string;
    element.style.color = objj_msgSend(objj_msgSend(self, "currentValueForThemeAttribute:", "text-color"), "cssString");
    element.style.font = objj_msgSend(objj_msgSend(self, "currentValueForThemeAttribute:", "font"), "cssString");
    element.style.zIndex = 1000;
    switch (objj_msgSend(self, "alignment"))
    {
        case CPCenterTextAlignment: element.style.textAlign = "center";
                                    break;
        case CPRightTextAlignment: element.style.textAlign = "right";
                                    break;
        default: element.style.textAlign = "left";
    }
    var contentRect = objj_msgSend(self, "contentRectForBounds:", objj_msgSend(self, "bounds"));
    element.style.top = (contentRect.origin.y) + "px";
    element.style.left = ((contentRect.origin.x) - 1) + "px";
    element.style.width = (contentRect.size.width) + "px";
    element.style.height = (contentRect.size.height) + "px";
    _DOMElement.appendChild(element);
    window.setTimeout(function()
    {
        element.focus();
        CPTextFieldInputOwner = self;
    }, 0.0);
    element.value = objj_msgSend(self, "stringValue");
    objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
    CPTextFieldInputIsActive = YES;
    if (document.attachEvent)
    {
        CPTextFieldCachedSelectStartFunction = objj_msgSend(objj_msgSend(self, "window"), "platformWindow")._DOMBodyElement.onselectstart;
        CPTextFieldCachedDragFunction = objj_msgSend(objj_msgSend(self, "window"), "platformWindow")._DOMBodyElement.ondrag;
        objj_msgSend(objj_msgSend(self, "window"), "platformWindow")._DOMBodyElement.ondrag = function () {};
        objj_msgSend(objj_msgSend(self, "window"), "platformWindow")._DOMBodyElement.onselectstart = function () {};
    }
    objj_msgSend(self, "textDidFocus:", objj_msgSend(CPNotification, "notificationWithName:object:userInfo:", CPTextFieldDidFocusNotification, self, nil));
    return YES;
}
}), new objj_method(sel_getUid("resignFirstResponder"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "unsetThemeState:", CPThemeStateEditing);
    objj_msgSend(self, "_updatePlaceholderState");
    objj_msgSend(self, "setNeedsLayout");
    var element = objj_msgSend(self, "_inputElement");
    objj_msgSend(self, "setObjectValue:", element.value);
    CPTextFieldInputResigning = YES;
    element.blur();
    if (!CPTextFieldInputDidBlur)
        CPTextFieldBlurFunction();
    CPTextFieldInputDidBlur = NO;
    CPTextFieldInputResigning = NO;
    if (element.parentNode == _DOMElement)
        element.parentNode.removeChild(element);
    CPTextFieldInputIsActive = NO;
    if (document.attachEvent)
    {
        CPTextFieldCachedSelectStartFunction = nil;
        CPTextFieldCachedDragFunction = nil;
        objj_msgSend(objj_msgSend(self, "window"), "platformWindow")._DOMBodyElement.ondrag = CPTextFieldCachedDragFunction;
        objj_msgSend(objj_msgSend(self, "window"), "platformWindow")._DOMBodyElement.onselectstart = CPTextFieldCachedSelectStartFunction;
    }
    if (_isEditing)
    {
        _isEditing = NO;
        objj_msgSend(self, "textDidEndEditing:", objj_msgSend(CPNotification, "notificationWithName:object:userInfo:", CPControlTextDidEndEditingNotification, self, nil));
        if (objj_msgSend(self, "sendsActionOnEndEditing"))
            objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
    }
    objj_msgSend(self, "textDidBlur:", objj_msgSend(CPNotification, "notificationWithName:object:userInfo:", CPTextFieldDidBlurNotification, self, nil));
    return YES;
}
}), new objj_method(sel_getUid("needsPanelToBecomeKey"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (objj_msgSend(self, "isEditable") && objj_msgSend(self, "isEnabled"))
        return objj_msgSend(objj_msgSend(self, "window"), "makeFirstResponder:", self);
    else
        return objj_msgSend(objj_msgSend(self, "nextResponder"), "mouseDown:", anEvent);
}
}), new objj_method(sel_getUid("mouseUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(self, "isEditable") || !objj_msgSend(self, "isEnabled"))
        objj_msgSend(objj_msgSend(self, "nextResponder"), "mouseUp:", anEvent);
}
}), new objj_method(sel_getUid("mouseDragged:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(self, "isEditable") || !objj_msgSend(self, "isEnabled"))
        objj_msgSend(objj_msgSend(self, "nextResponder"), "mouseDragged:", anEvent);
}
}), new objj_method(sel_getUid("keyUp:"), function(self, _cmd, anEvent)
{ with(self)
{
    var oldValue = objj_msgSend(self, "stringValue");
    objj_msgSend(self, "_setStringValue:", objj_msgSend(self, "_inputElement").value);
    if (oldValue !== objj_msgSend(self, "stringValue"))
    {
        if (!_isEditing)
        {
            _isEditing = YES;
            objj_msgSend(self, "textDidBeginEditing:", objj_msgSend(CPNotification, "notificationWithName:object:userInfo:", CPControlTextDidBeginEditingNotification, self, nil));
        }
        objj_msgSend(self, "textDidChange:", objj_msgSend(CPNotification, "notificationWithName:object:userInfo:", CPControlTextDidChangeNotification, self, nil));
    }
    objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
}
}), new objj_method(sel_getUid("keyDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (objj_msgSend(anEvent, "keyCode") === CPReturnKeyCode)
    {
        if (_isEditing)
        {
            _isEditing = NO;
            objj_msgSend(self, "textDidEndEditing:", objj_msgSend(CPNotification, "notificationWithName:object:userInfo:", CPControlTextDidEndEditingNotification, self, nil));
        }
        objj_msgSend(self, "sendAction:to:", objj_msgSend(self, "action"), objj_msgSend(self, "target"));
        objj_msgSend(self, "selectText:", nil);
        objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", NO);
    }
    else if (objj_msgSend(anEvent, "keyCode") === CPTabKeyCode)
    {
        if (objj_msgSend(anEvent, "modifierFlags") & CPShiftKeyMask)
            objj_msgSend(objj_msgSend(self, "window"), "selectPreviousKeyView:", self);
        else
            objj_msgSend(objj_msgSend(self, "window"), "selectNextKeyView:", self);
        if (objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "firstResponder"), "respondsToSelector:", sel_getUid("selectText:")))
            objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "firstResponder"), "selectText:", self);
        objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", NO);
    }
    else
        objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "platformWindow"), "_propagateCurrentDOMEvent:", YES);
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("textDidBlur:"), function(self, _cmd, note)
{ with(self)
{
    if(objj_msgSend(note, "object") != self)
        return;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotification:", note);
}
}), new objj_method(sel_getUid("textDidFocus:"), function(self, _cmd, note)
{ with(self)
{
    if(objj_msgSend(note, "object") != self)
        return;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotification:", note);
}
}), new objj_method(sel_getUid("objectValue"), function(self, _cmd)
{ with(self)
{
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "objectValue");
}
}), new objj_method(sel_getUid("_setStringValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSend(self, "willChangeValueForKey:", "objectValue");
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "setObjectValue:", String(aValue));
    objj_msgSend(self, "_updatePlaceholderState");
    objj_msgSend(self, "didChangeValueForKey:", "objectValue");
}
}), new objj_method(sel_getUid("setObjectValue:"), function(self, _cmd, aValue)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "setObjectValue:", aValue);
    if (CPTextFieldInputOwner === self)
        objj_msgSend(self, "_inputElement").value = aValue;
    objj_msgSend(self, "_updatePlaceholderState");
}
}), new objj_method(sel_getUid("_updatePlaceholderState"), function(self, _cmd)
{ with(self)
{
    var string = objj_msgSend(self, "stringValue");
    if ((!string || string.length === 0) && !objj_msgSend(self, "hasThemeState:", CPThemeStateEditing))
        objj_msgSend(self, "setThemeState:", CPTextFieldStatePlaceholder);
    else
        objj_msgSend(self, "unsetThemeState:", CPTextFieldStatePlaceholder);
}
}), new objj_method(sel_getUid("setPlaceholderString:"), function(self, _cmd, aStringValue)
{ with(self)
{
    if (_placeholderString === aStringValue)
        return;
    _placeholderString = aStringValue;
    if (objj_msgSend(self, "hasThemeState:", CPTextFieldStatePlaceholder))
    {
        objj_msgSend(self, "setNeedsLayout");
        objj_msgSend(self, "setNeedsDisplay:", YES);
    }
}
}), new objj_method(sel_getUid("placeholderString"), function(self, _cmd)
{ with(self)
{
    return _placeholderString;
}
}), new objj_method(sel_getUid("sizeToFit"), function(self, _cmd)
{ with(self)
{
    var size = objj_msgSend((objj_msgSend(self, "stringValue") || " "), "sizeWithFont:", objj_msgSend(self, "currentValueForThemeAttribute:", "font")),
        contentInset = objj_msgSend(self, "currentValueForThemeAttribute:", "content-inset"),
        minSize = objj_msgSend(self, "currentValueForThemeAttribute:", "min-size"),
        maxSize = objj_msgSend(self, "currentValueForThemeAttribute:", "max-size");
    size.width = MAX(size.width + contentInset.left + contentInset.right, minSize.width);
    size.height = MAX(size.height + contentInset.top + contentInset.bottom, minSize.height);
    if (maxSize.width >= 0.0)
        size.width = MIN(size.width, maxSize.width);
    if (maxSize.height >= 0.0)
        size.height = MIN(size.height, maxSize.height);
    if (objj_msgSend(self, "isEditable"))
        size.width = CGRectGetWidth(objj_msgSend(self, "frame"));
    objj_msgSend(self, "setFrameSize:", size);
}
}), new objj_method(sel_getUid("selectText:"), function(self, _cmd, sender)
{ with(self)
{
    var element = objj_msgSend(self, "_inputElement");
    if ((objj_msgSend(self, "isEditable") || objj_msgSend(self, "isSelectable")))
    {
        if (objj_msgSend(objj_msgSend(self, "window"), "firstResponder") === self)
            window.setTimeout(function() { element.select(); }, 0);
        else
        {
            objj_msgSend(objj_msgSend(self, "window"), "makeFirstResponder:", self);
            window.setTimeout(function() {objj_msgSend(self, "selectText:", sender);}, 0);
        }
    }
}
}), new objj_method(sel_getUid("copy:"), function(self, _cmd, sender)
{ with(self)
{
    if (!objj_msgSend(CPPlatform, "isBrowser"))
    {
        var selectedRange = objj_msgSend(self, "selectedRange");
        if (selectedRange.length < 1)
            return;
        var pasteboard = objj_msgSend(CPPasteboard, "generalPasteboard"),
            stringValue = objj_msgSend(self, "stringValue"),
            stringForPasting = objj_msgSend(stringValue, "substringWithRange:", selectedRange);
        objj_msgSend(pasteboard, "declareTypes:owner:", [CPStringPboardType], nil);
        objj_msgSend(pasteboard, "setString:forType:", stringForPasting, CPStringPboardType);
    }
}
}), new objj_method(sel_getUid("cut:"), function(self, _cmd, sender)
{ with(self)
{
    if (!objj_msgSend(CPPlatform, "isBrowser"))
    {
        objj_msgSend(self, "copy:", sender);
        objj_msgSend(self, "deleteBackwards:", sender);
    }
}
}), new objj_method(sel_getUid("paste:"), function(self, _cmd, sender)
{ with(self)
{
    if (!objj_msgSend(CPPlatform, "isBrowser"))
    {
        var pasteboard = objj_msgSend(CPPasteboard, "generalPasteboard");
        if (!objj_msgSend(objj_msgSend(pasteboard, "types"), "containsObject:", CPStringPboardType))
            return;
        objj_msgSend(self, "deleteBackwards:", sender);
        var selectedRange = objj_msgSend(self, "selectedRange"),
            stringValue = objj_msgSend(self, "stringValue"),
            pasteString = objj_msgSend(pasteboard, "stringForType:", CPStringPboardType),
            newValue = objj_msgSend(stringValue, "stringByReplacingCharactersInRange:withString:", selectedRange, pasteString);
        objj_msgSend(self, "setStringValue:", newValue);
        objj_msgSend(self, "setSelectedRange:", CPMakeRange(selectedRange.location+pasteString.length, 0));
    }
}
}), new objj_method(sel_getUid("selectedRange"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(objj_msgSend(self, "window"), "firstResponder") !== self)
        return CPMakeRange(0, 0);
    try
    {
        var inputElement = objj_msgSend(self, "_inputElement"),
            selectionStart = inputElement.selectionStart,
            selectionEnd = inputElement.selectionEnd;
        if (objj_msgSend(selectionStart, "isKindOfClass:", CPNumber))
            return CPMakeRange(selectionStart, selectionEnd - selectionStart);
        var theDocument = inputElement.ownerDocument || inputElement.document,
            selectionRange = theDocument.selection.createRange(),
            range = inputElement.createTextRange();
        if (range.inRange(selectionRange))
        {
            range.setEndPoint('EndToStart', selectionRange);
            return CPMakeRange(range.text.length, selectionRange.text.length);
        }
    }
    catch (e)
    {
    }
    return CGMakeRange(0, 0);
}
}), new objj_method(sel_getUid("setSelectedRange:"), function(self, _cmd, aRange)
{ with(self)
{
    if (!objj_msgSend(objj_msgSend(self, "window"), "firstResponder") === self)
        return;
    var inputElement = objj_msgSend(self, "_inputElement");
    try
    {
        if (objj_msgSend(inputElement.selectionStart, "isKindOfClass:", CPNumber))
        {
            inputElement.selectionStart = aRange.location;
            inputElement.selectionEnd = CPMaxRange(aRange);
        }
        else
        {
            var theDocument = inputElement.ownerDocument || inputElement.document,
                existingRange = theDocument.selection.createRange(),
                range = inputElement.createTextRange();
            if (range.inRange(existingRange))
            {
                range.collapse(true);
                range.move('character', aRange.location);
                range.moveEnd('character', aRange.length);
                range.select();
            }
        }
    }
    catch (e)
    {
    }
}
}), new objj_method(sel_getUid("selectAll:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "selectText:", sender);
}
}), new objj_method(sel_getUid("deleteBackwards:"), function(self, _cmd, sender)
{ with(self)
{
    var selectedRange = objj_msgSend(self, "selectedRange"),
        stringValue = objj_msgSend(self, "stringValue"),
        newValue = objj_msgSend(stringValue, "stringByReplacingCharactersInRange:withString:", selectedRange, "");
    objj_msgSend(self, "setStringValue:", newValue);
    objj_msgSend(self, "setSelectedRange:", CPMakeRange(selectedRange.location, 0));
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_delegate)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPControlTextDidBeginEditingNotification, self);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPControlTextDidChangeNotification, self);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPControlTextDidEndEditingNotification, self);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPTextFieldDidFocusNotification, self);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", _delegate, CPTextFieldDidBlurNotification, self);
    }
    _delegate = aDelegate;
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("controlTextDidBeginEditing:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("controlTextDidBeginEditing:"), CPControlTextDidBeginEditingNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("controlTextDidChange:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("controlTextDidChange:"), CPControlTextDidChangeNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("controlTextDidEndEditing:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("controlTextDidEndEditing:"), CPControlTextDidEndEditingNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("controlTextDidFocus:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("controlTextDidFocus:"), CPTextFieldDidFocusNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("controlTextDidBlur:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("controlTextDidBlur:"), CPTextFieldDidBlurNotification, self);
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("contentRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    var contentInset = objj_msgSend(self, "currentValueForThemeAttribute:", "content-inset");
    if (!contentInset)
        return bounds;
    bounds.origin.x += contentInset.left;
    bounds.origin.y += contentInset.top;
    bounds.size.width -= contentInset.left + contentInset.right;
    bounds.size.height -= contentInset.top + contentInset.bottom;
    return bounds;
}
}), new objj_method(sel_getUid("bezelRectForBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    var bezelInset = objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-inset");
    if (((bezelInset).top === 0 && (bezelInset).right === 0 && (bezelInset).bottom === 0 && (bezelInset).left === 0))
        return bounds;
    bounds.origin.x += bezelInset.left;
    bounds.origin.y += bezelInset.top;
    bounds.size.width -= bezelInset.left + bezelInset.right;
    bounds.size.height -= bezelInset.top + bezelInset.bottom;
    return bounds;
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "bezel-view")
        return objj_msgSend(self, "bezelRectForBounds:", objj_msgSend(self, "bounds"));
    else if (aName === "content-view")
        return objj_msgSend(self, "contentRectForBounds:", objj_msgSend(self, "bounds"));
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "rectForEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === "bezel-view")
    {
        var view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
        objj_msgSend(view, "setHitTests:", NO);
        return view;
    }
    else
    {
        var view = objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } });
        objj_msgSend(view, "setHitTests:", NO);
        return view;
    }
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "createEphemeralSubviewNamed:", aName);
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var bezelView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "bezel-view", CPWindowBelow, "content-view");
    if (bezelView)
        objj_msgSend(bezelView, "setBackgroundColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "bezel-color"));
    var contentView = objj_msgSend(self, "layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:", "content-view", CPWindowAbove, "bezel-view");
    if (contentView)
    {
        objj_msgSend(contentView, "setHidden:", objj_msgSend(self, "hasThemeState:", CPThemeStateEditing));
        var string = "";
        if (objj_msgSend(self, "hasThemeState:", CPTextFieldStatePlaceholder))
            string = objj_msgSend(self, "placeholderString");
        else
        {
            string = objj_msgSend(self, "stringValue");
            if (objj_msgSend(self, "isSecure"))
                string = secureStringForString(string);
        }
        objj_msgSend(contentView, "setText:", string);
        objj_msgSend(contentView, "setTextColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "text-color"));
        objj_msgSend(contentView, "setFont:", objj_msgSend(self, "currentValueForThemeAttribute:", "font"));
        objj_msgSend(contentView, "setAlignment:", objj_msgSend(self, "currentValueForThemeAttribute:", "alignment"));
        objj_msgSend(contentView, "setVerticalAlignment:", objj_msgSend(self, "currentValueForThemeAttribute:", "vertical-alignment"));
        objj_msgSend(contentView, "setLineBreakMode:", objj_msgSend(self, "currentValueForThemeAttribute:", "line-break-mode"));
        objj_msgSend(contentView, "setTextShadowColor:", objj_msgSend(self, "currentValueForThemeAttribute:", "text-shadow-color"));
        objj_msgSend(contentView, "setTextShadowOffset:", objj_msgSend(self, "currentValueForThemeAttribute:", "text-shadow-offset"));
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("textFieldWithStringValue:placeholder:width:"), function(self, _cmd, aStringValue, aPlaceholder, aWidth)
{ with(self)
{
    return objj_msgSend(self, "textFieldWithStringValue:placeholder:width:theme:", aStringValue, aPlaceholder, aWidth, objj_msgSend(CPTheme, "defaultTheme"));
}
}), new objj_method(sel_getUid("textFieldWithStringValue:placeholder:width:theme:"), function(self, _cmd, aStringValue, aPlaceholder, aWidth, aTheme)
{ with(self)
{
    var textField = objj_msgSend(objj_msgSend(self, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, aWidth, 29.0));
    objj_msgSend(textField, "setTheme:", aTheme);
    objj_msgSend(textField, "setStringValue:", aStringValue);
    objj_msgSend(textField, "setPlaceholderString:", aPlaceholder);
    objj_msgSend(textField, "setBordered:", YES);
    objj_msgSend(textField, "setBezeled:", YES);
    objj_msgSend(textField, "setEditable:", YES);
    objj_msgSend(textField, "sizeToFit");
    return textField;
}
}), new objj_method(sel_getUid("roundedTextFieldWithStringValue:placeholder:width:"), function(self, _cmd, aStringValue, aPlaceholder, aWidth)
{ with(self)
{
    return objj_msgSend(self, "roundedTextFieldWithStringValue:placeholder:width:theme:", aStringValue, aPlaceholder, aWidth, objj_msgSend(CPTheme, "defaultTheme"));
}
}), new objj_method(sel_getUid("roundedTextFieldWithStringValue:placeholder:width:theme:"), function(self, _cmd, aStringValue, aPlaceholder, aWidth, aTheme)
{ with(self)
{
    var textField = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, aWidth, 29.0));
    objj_msgSend(textField, "setTheme:", aTheme);
    objj_msgSend(textField, "setStringValue:", aStringValue);
    objj_msgSend(textField, "setPlaceholderString:", aPlaceholder);
    objj_msgSend(textField, "setBezelStyle:", CPTextFieldRoundedBezel);
    objj_msgSend(textField, "setBordered:", YES);
    objj_msgSend(textField, "setBezeled:", YES);
    objj_msgSend(textField, "setEditable:", YES);
    objj_msgSend(textField, "sizeToFit");
    return textField;
}
}), new objj_method(sel_getUid("labelWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    return objj_msgSend(self, "labelWithTitle:theme:", aTitle, objj_msgSend(CPTheme, "defaultTheme"));
}
}), new objj_method(sel_getUid("labelWithTitle:theme:"), function(self, _cmd, aTitle, aTheme)
{ with(self)
{
    var textField = objj_msgSend(objj_msgSend(self, "alloc"), "init");
    objj_msgSend(textField, "setStringValue:", aTitle);
    objj_msgSend(textField, "sizeToFit");
    return textField;
}
}), new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return "textfield";
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPDictionary, "dictionaryWithObjects:forKeys:", [{ top:(0), right:(0), bottom:(0), left:(0) }, { top:(2.0), right:(2.0), bottom:(2.0), left:(2.0) }, objj_msgSend(CPNull, "null")], ["bezel-inset", "content-inset", "bezel-color"]);
}
})]);
}
var secureStringForString = function(aString)
{
    if (!aString)
        return "";
    return Array(aString.length+1).join(CPSecureTextFieldCharacter);
}
var CPTextFieldIsEditableKey = "CPTextFieldIsEditableKey",
    CPTextFieldIsSelectableKey = "CPTextFieldIsSelectableKey",
    CPTextFieldIsBorderedKey = "CPTextFieldIsBorderedKey",
    CPTextFieldIsBezeledKey = "CPTextFieldIsBezeledKey",
    CPTextFieldBezelStyleKey = "CPTextFieldBezelStyleKey",
    CPTextFieldDrawsBackgroundKey = "CPTextFieldDrawsBackgroundKey",
    CPTextFieldLineBreakModeKey = "CPTextFieldLineBreakModeKey",
    CPTextFieldBackgroundColorKey = "CPTextFieldBackgroundColorKey",
    CPTextFieldPlaceholderStringKey = "CPTextFieldPlaceholderStringKey";
{
var the_class = objj_getClass("CPTextField")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTextField\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        objj_msgSend(self, "setEditable:", objj_msgSend(aCoder, "decodeBoolForKey:", CPTextFieldIsEditableKey));
        objj_msgSend(self, "setSelectable:", objj_msgSend(aCoder, "decodeBoolForKey:", CPTextFieldIsSelectableKey));
        objj_msgSend(self, "setDrawsBackground:", objj_msgSend(aCoder, "decodeBoolForKey:", CPTextFieldDrawsBackgroundKey));
        objj_msgSend(self, "setTextFieldBackgroundColor:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTextFieldBackgroundColorKey));
        objj_msgSend(self, "setPlaceholderString:", objj_msgSend(aCoder, "decodeObjectForKey:", CPTextFieldPlaceholderStringKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTextField").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isEditable, CPTextFieldIsEditableKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isSelectable, CPTextFieldIsSelectableKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _drawsBackground, CPTextFieldDrawsBackgroundKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _textFieldBackgroundColor, CPTextFieldBackgroundColorKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _placeholderString, CPTextFieldPlaceholderStringKey);
}
})]);
}

p;9;CPTheme.jt;15971;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.jt;15899;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
var CPThemesByName = { },
    CPThemeDefaultTheme = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPTheme"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_name"), new objj_ivar("_attributes")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithName:"), function(self, _cmd, aName)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTheme").super_class }, "init");
    if (self)
    {
        _name = aName;
        _attributes = objj_msgSend(CPDictionary, "dictionary");
        CPThemesByName[_name] = self;
    }
    return self;
}
}), new objj_method(sel_getUid("name"), function(self, _cmd)
{ with(self)
{
    return _name;
}
}), new objj_method(sel_getUid("_attributeWithName:forClass:"), function(self, _cmd, aName, aClass)
{ with(self)
{
    var attributes = objj_msgSend(_attributes, "objectForKey:", aClass);
    if (!attributes)
        return nil;
    return objj_msgSend(attributes, "objectForKey:", aName);
}
}), new objj_method(sel_getUid("takeThemeFromObject:"), function(self, _cmd, anObject)
{ with(self)
{
    var attributes = objj_msgSend(anObject, "_themeAttributeDictionary"),
        attributeName = nil,
        attributeNames = objj_msgSend(attributes, "keyEnumerator"),
        objectThemeClass = objj_msgSend(objj_msgSend(anObject, "class"), "themeClass");
    while (attributeName = objj_msgSend(attributeNames, "nextObject"))
        objj_msgSend(self, "_recordAttribute:forClass:", objj_msgSend(attributes, "objectForKey:", attributeName), objectThemeClass);
}
}), new objj_method(sel_getUid("_recordAttribute:forClass:"), function(self, _cmd, anAttribute, aClass)
{ with(self)
{
    if (!objj_msgSend(anAttribute, "hasValues"))
        return;
    var attributes = objj_msgSend(_attributes, "objectForKey:", aClass);
    if (!attributes)
    {
        attributes = objj_msgSend(CPDictionary, "dictionary");
        objj_msgSend(_attributes, "setObject:forKey:", attributes, aClass);
    }
    var name = objj_msgSend(anAttribute, "name"),
        existingAttribute = objj_msgSend(attributes, "objectForKey:", name);
    if (existingAttribute)
        objj_msgSend(attributes, "setObject:forKey:", objj_msgSend(existingAttribute, "attributeMergedWithAttribute:", anAttribute), name);
    else
        objj_msgSend(attributes, "setObject:forKey:", anAttribute, name);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("setDefaultTheme:"), function(self, _cmd, aTheme)
{ with(self)
{
    CPThemeDefaultTheme = aTheme;
}
}), new objj_method(sel_getUid("defaultTheme"), function(self, _cmd)
{ with(self)
{
    return CPThemeDefaultTheme;
}
}), new objj_method(sel_getUid("themeNamed:"), function(self, _cmd, aName)
{ with(self)
{
    return CPThemesByName[aName];
}
})]);
}
var CPThemeNameKey = "CPThemeNameKey",
    CPThemeAttributesKey = "CPThemeAttributesKey";
{
var the_class = objj_getClass("CPTheme")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTheme\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTheme").super_class }, "init");
    if (self)
    {
        _name = objj_msgSend(aCoder, "decodeObjectForKey:", CPThemeNameKey);
        _attributes = objj_msgSend(aCoder, "decodeObjectForKey:", CPThemeAttributesKey);
        CPThemesByName[_name] = self;
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _name, CPThemeNameKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _attributes, CPThemeAttributesKey);
}
})]);
}
{var the_class = objj_allocateClassPair(CPKeyedUnarchiver, "_CPThemeKeyedUnarchiver"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_bundle")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initForReadingWithData:bundle:"), function(self, _cmd, data, aBundle)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPThemeKeyedUnarchiver").super_class }, "initForReadingWithData:", data);
    if (self)
        _bundle = aBundle;
    return self;
}
}), new objj_method(sel_getUid("bundle"), function(self, _cmd)
{ with(self)
{
    return _bundle;
}
}), new objj_method(sel_getUid("awakenCustomResources"), function(self, _cmd)
{ with(self)
{
    return YES;
}
})]);
}
var CPThemeStates = {},
    CPThemeStateNames = {},
    CPThemeStateCount = 0;
CPThemeState= function(aStateName)
{
    var state = CPThemeStates[aStateName];
    if (state === undefined)
    {
        if (aStateName.indexOf('+') === -1)
            state = 1 << CPThemeStateCount++;
        else
        {
            var state = 0,
                states = aStateName.split('+'),
                count = states.length;
            while (count--)
            {
                var stateName = states[count],
                    individualState = CPThemeStates[stateName];
                if (individualState === undefined)
                {
                    individualState = 1 << CPThemeStateCount++;
                    CPThemeStates[stateName] = individualState;
                    CPThemeStateNames[individualState] = stateName;
                }
                state |= individualState;
            }
        }
        CPThemeStates[aStateName] = state;
        CPThemeStateNames[state] = aStateName;
    }
    return state;
}
CPThemeStateName= function(aState)
{
    var name = CPThemeStateNames[aState];
    if (name !== undefined)
        return name;
    if (!(aState & (aState - 1)))
        return "";
    var state = 1,
        name = "";
    for (; state < aState; state <<= 1)
        if (aState & state)
            name += (name.length === 0 ? '' : '+') + CPThemeStateNames[state];
    CPThemeStateNames[aState] = name;
    return name;
}
CPThemeStateNames[0] = "normal";
CPThemeStateNormal = CPThemeStates["normal"] = 0;
CPThemeStateDisabled = CPThemeState("disabled");
CPThemeStateHighlighted = CPThemeState("highlighted");
CPThemeStateSelected = CPThemeState("selected");
CPThemeStateBezeled = CPThemeState("bezeled");
CPThemeStateBordered = CPThemeState("bordered");
CPThemeStateEditable = CPThemeState("editable");
CPThemeStateEditing = CPThemeState("editing");
CPThemeStateVertical = CPThemeState("vertical");
CPThemeStateDefault = CPThemeState("default");
CPThemeStateCircular = CPThemeState("circular");
{var the_class = objj_allocateClassPair(CPObject, "_CPThemeAttribute"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_name"), new objj_ivar("_defaultValue"), new objj_ivar("_values"), new objj_ivar("_cache"), new objj_ivar("_parentAttribute")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithName:defaultValue:"), function(self, _cmd, aName, aDefaultValue)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPThemeAttribute").super_class }, "init");
    if (self)
    {
        _cache = { };
        _name = aName;
        _defaultValue = aDefaultValue;
        _values = objj_msgSend(CPDictionary, "dictionary");
    }
    return self;
}
}), new objj_method(sel_getUid("name"), function(self, _cmd)
{ with(self)
{
    return _name;
}
}), new objj_method(sel_getUid("defaultValue"), function(self, _cmd)
{ with(self)
{
    return _defaultValue;
}
}), new objj_method(sel_getUid("hasValues"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_values, "count") > 0;
}
}), new objj_method(sel_getUid("isTrivial"), function(self, _cmd)
{ with(self)
{
    return (objj_msgSend(_values, "count") === 1) && (Number(objj_msgSend(_values, "allKeys")[0]) === CPThemeStateNormal);
}
}), new objj_method(sel_getUid("setValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _cache = {};
    if (aValue === undefined || aValue === nil)
        _values = objj_msgSend(CPDictionary, "dictionary");
    else
        _values = objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", aValue, String(CPThemeStateNormal));
}
}), new objj_method(sel_getUid("setValue:forState:"), function(self, _cmd, aValue, aState)
{ with(self)
{
    _cache = { };
    if ((aValue === undefined) || (aValue === nil))
        objj_msgSend(_values, "removeObjectForKey:", String(aState));
    else
        objj_msgSend(_values, "setObject:forKey:", aValue, String(aState));
}
}), new objj_method(sel_getUid("value"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "valueForState:", CPThemeStateNormal);
}
}), new objj_method(sel_getUid("valueForState:"), function(self, _cmd, aState)
{ with(self)
{
    var value = _cache[aState];
    if (value !== undefined)
        return value;
    value = objj_msgSend(_values, "objectForKey:", String(aState));
    if ((value === undefined || value === nil) && aState !== CPThemeStateNormal)
    {
        if (aState & (aState - 1))
        {
            var highestOneCount = 0,
                states = objj_msgSend(_values, "allKeys"),
                count = states.length;
            while (count--)
            {
                var state = Number(states[count]);
                if ((state & aState) === state)
                {
                    var oneCount = cachedNumberOfOnes[state];
                    if (oneCount === undefined)
                        oneCount = numberOfOnes(state);
                    if (oneCount > highestOneCount)
                    {
                        highestOneCount = oneCount;
                        value = objj_msgSend(_values, "objectForKey:", String(state));
                    }
                }
            }
        }
        if (value === undefined || value === nil)
            value = objj_msgSend(_values, "objectForKey:", String(CPThemeStateNormal));
    }
    if (value === undefined || value === nil)
        value = objj_msgSend(_parentAttribute, "valueForState:", aState);
    if (value === undefined || value === nil)
        value = _defaultValue;
    _cache[aState] = value;
    return value;
}
}), new objj_method(sel_getUid("setParentAttribute:"), function(self, _cmd, anAttribute)
{ with(self)
{
    if (_parentAttribute === anAttribute)
        return;
    _cache = { };
    _parentAttribute = anAttribute;
}
}), new objj_method(sel_getUid("attributeMergedWithAttribute:"), function(self, _cmd, anAttribute)
{ with(self)
{
    var mergedAttribute = objj_msgSend(objj_msgSend(_CPThemeAttribute, "alloc"), "initWithName:defaultValue:", _name, _defaultValue);
    mergedAttribute._values = objj_msgSend(_values, "copy");
    objj_msgSend(mergedAttribute._values, "addEntriesFromDictionary:", anAttribute._values);
    return mergedAttribute;
}
})]);
}
{
var the_class = objj_getClass("_CPThemeAttribute")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPThemeAttribute\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPThemeAttribute").super_class }, "init");
    if (self)
    {
        _cache = {};
        _name = objj_msgSend(aCoder, "decodeObjectForKey:", "name");
        _values = objj_msgSend(CPDictionary, "dictionary");
        if (objj_msgSend(aCoder, "containsValueForKey:", "value"))
        {
            var state = CPThemeStateNormal;
            if (objj_msgSend(aCoder, "containsValueForKey:", "state"))
                state = CPThemeState(objj_msgSend(aCoder, "decodeObjectForKey:", "state"));
            objj_msgSend(_values, "setObject:forKey:", objj_msgSend(aCoder, "decodeObjectForKey:", "value"), state);
        }
        else
        {
            var encodedValues = objj_msgSend(aCoder, "decodeObjectForKey:", "values"),
                keys = objj_msgSend(encodedValues, "allKeys"),
                count = keys.length;
            while (count--)
            {
                var key = keys[count];
                objj_msgSend(_values, "setObject:forKey:", objj_msgSend(encodedValues, "objectForKey:", key), CPThemeState(key));
            }
        }
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _name, "name");
    var keys = objj_msgSend(_values, "allKeys"),
        count = keys.length;
    if (count === 1)
    {
        var onlyKey = keys[0];
        if (Number(onlyKey) !== CPThemeStateNormal)
            objj_msgSend(aCoder, "encodeObject:forKey:", CPThemeStateName(Number(onlyKey)), "state");
        objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(_values, "objectForKey:", onlyKey), "value");
    }
    else
    {
        var encodedValues = objj_msgSend(CPDictionary, "dictionary");
        while (count--)
        {
            var key = keys[count];
            objj_msgSend(encodedValues, "setObject:forKey:", objj_msgSend(_values, "objectForKey:", key), CPThemeStateName(Number(key)));
        }
        objj_msgSend(aCoder, "encodeObject:forKey:", encodedValues, "values");
    }
}
})]);
}
var cachedNumberOfOnes = [ 0 , 1 , 1 , 2 , 1 , 2 , 2 ,
                            3 , 1 , 2 , 2 , 3 , 2 , 3 ,
                            3 , 4 , 1 , 2 , 2 , 3 , 2 ,
                            3 , 3 , 4 , 2 , 3 , 3 , 4 ,
                            3 , 4 , 4 , 5 , 1 , 2 , 2 ,
                            3 , 2 , 3 , 3 , 4 , 2 , 3 ,
                            3 , 4 , 3 , 4 , 4 , 5 , 2 ,
                            3 , 3 , 4 , 3 , 4 , 4 , 5 ,
                            3 , 4 , 4 , 5 , 4 , 5 , 5 ,
                            6 ];
var numberOfOnes = function(aNumber)
{
    var count = 0,
        slot = aNumber;
    while (aNumber)
    {
        ++count;
        aNumber &= (aNumber - 1);
    }
    cachedNumberOfOnes[slot] = count;
    return count;
}
numberOfOnes.displayName = "numberOfOnes";
CPThemeAttributeEncode= function(aCoder, aThemeAttribute)
{
    var values = aThemeAttribute._values,
        count = objj_msgSend(values, "count"),
        key = "$a" + objj_msgSend(aThemeAttribute, "name");
    if (count === 1)
    {
        var state = objj_msgSend(values, "allKeys")[0];
        if (Number(state) === 0)
        {
            objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(values, "objectForKey:", state), key);
            return YES;
        }
    }
    if (count >= 1)
    {
        objj_msgSend(aCoder, "encodeObject:forKey:", aThemeAttribute, key);
        return YES;
    }
    return NO;
}
CPThemeAttributeDecode= function(aCoder, anAttributeName, aDefaultValue, aTheme, aClass)
{
    var key = "$a" + anAttributeName;
    if (!objj_msgSend(aCoder, "containsValueForKey:", key))
        var attribute = objj_msgSend(objj_msgSend(_CPThemeAttribute, "alloc"), "initWithName:defaultValue:", anAttributeName, aDefaultValue);
    else
    {
        var attribute = objj_msgSend(aCoder, "decodeObjectForKey:", key);
        if (!attribute.isa || !objj_msgSend(attribute, "isKindOfClass:", objj_msgSend(_CPThemeAttribute, "class")))
        {
            var themeAttribute = objj_msgSend(objj_msgSend(_CPThemeAttribute, "alloc"), "initWithName:defaultValue:", anAttributeName, aDefaultValue);
            objj_msgSend(themeAttribute, "setValue:", attribute);
            attribute = themeAttribute;
        }
    }
    if (aTheme && aClass)
        objj_msgSend(attribute, "setParentAttribute:", objj_msgSend(aTheme, "_attributeWithName:forClass:", anAttributeName, aClass));
    return attribute;
}

p;14;CPThemeBlend.jt;1978;@STATIC;1.0;I;21;Foundation/CPObject.jI;16;AppKit/CPTheme.jI;29;AppKit/_CPCibCustomResource.jI;30;AppKit/_CPCibKeyedUnarchiver.jt;1843;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("AppKit/CPTheme.j", false);
objj_executeFile("AppKit/_CPCibCustomResource.j", false);
objj_executeFile("AppKit/_CPCibKeyedUnarchiver.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPThemeBlend"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_bundle"), new objj_ivar("_themes"), new objj_ivar("_loadDelegate")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("themes"), function(self, _cmd)
{ with(self)
{
return _themes;
}
}), new objj_method(sel_getUid("initWithContentsOfURL:"), function(self, _cmd, aURL)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPThemeBlend").super_class }, "init");
    if (self)
    {
        _bundle = objj_msgSend(objj_msgSend(CPBundle, "alloc"), "initWithPath:", aURL);
    }
    return self;
}
}), new objj_method(sel_getUid("loadWithDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _loadDelegate = aDelegate;
    objj_msgSend(_bundle, "loadWithDelegate:", self);
}
}), new objj_method(sel_getUid("bundleDidFinishLoading:"), function(self, _cmd, aBundle)
{ with(self)
{
    var themes = objj_msgSend(_bundle, "objectForInfoDictionaryKey:", "CPKeyedThemes"),
        count = themes.length;
    while (count--)
    {
        var path = objj_msgSend(aBundle, "pathForResource:", themes[count]),
            unarchiver = objj_msgSend(objj_msgSend(_CPThemeKeyedUnarchiver, "alloc"), "initForReadingWithData:bundle:", objj_msgSend(objj_msgSend(CPURL, "URLWithString:", path), "staticResourceData"), _bundle);
        objj_msgSend(unarchiver, "decodeObjectForKey:", "root");
        objj_msgSend(unarchiver, "finishDecoding");
    }
    objj_msgSend(_loadDelegate, "blendDidFinishLoading:", self);
}
})]);
}

p;11;CPToolbar.jt;33208;@STATIC;1.0;I;21;Foundation/CPObject.ji;15;CPPopUpButton.ji;15;CPToolbarItem.jt;33122;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("CPPopUpButton.j", true);
objj_executeFile("CPToolbarItem.j", true);
CPToolbarDisplayModeDefault = 0;
CPToolbarDisplayModeIconAndLabel = 1;
CPToolbarDisplayModeIconOnly = 2;
CPToolbarDisplayModeLabelOnly = 3;
var CPToolbarsByIdentifier = nil;
var CPToolbarConfigurationsByIdentifier = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPToolbar"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_identifier"), new objj_ivar("_displayMode"), new objj_ivar("_showsBaselineSeparator"), new objj_ivar("_allowsUserCustomization"), new objj_ivar("_isVisible"), new objj_ivar("_delegate"), new objj_ivar("_itemIdentifiers"), new objj_ivar("_identifiedItems"), new objj_ivar("_defaultItems"), new objj_ivar("_allowedItems"), new objj_ivar("_selectableItems"), new objj_ivar("_items"), new objj_ivar("_itemsSortedByVisibilityPriority"), new objj_ivar("_toolbarView"), new objj_ivar("_window")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithIdentifier:", "");
}
}), new objj_method(sel_getUid("initWithIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPToolbar").super_class }, "init");
    if (self)
    {
        _items = [];
        _identifier = anIdentifier;
        _isVisible = YES;
        objj_msgSend(CPToolbar, "_addToolbar:forIdentifier:", self, _identifier);
    }
    return self;
}
}), new objj_method(sel_getUid("setDisplayMode:"), function(self, _cmd, aDisplayMode)
{ with(self)
{
}
}), new objj_method(sel_getUid("identifier"), function(self, _cmd)
{ with(self)
{
    return _identifier;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("isVisible"), function(self, _cmd)
{ with(self)
{
    return _isVisible;
}
}), new objj_method(sel_getUid("setVisible:"), function(self, _cmd, aFlag)
{ with(self)
{
    if (_isVisible === aFlag)
        return;
    _isVisible = aFlag;
    objj_msgSend(_window, "_noteToolbarChanged");
}
}), new objj_method(sel_getUid("_window"), function(self, _cmd)
{ with(self)
{
    return _window;
}
}), new objj_method(sel_getUid("_setWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    _window = aWindow;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    if (_delegate === aDelegate)
        return;
    _delegate = aDelegate;
    objj_msgSend(self, "_reloadToolbarItems");
}
}), new objj_method(sel_getUid("_loadConfiguration"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("_toolbarView"), function(self, _cmd)
{ with(self)
{
    if (!_toolbarView)
    {
        _toolbarView = objj_msgSend(objj_msgSend(_CPToolbarView, "alloc"), "initWithFrame:", CPRectMake(0.0, 0.0, 1200.0, 59.0));
        objj_msgSend(_toolbarView, "setToolbar:", self);
        objj_msgSend(_toolbarView, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_toolbarView, "reloadToolbarItems");
    }
    return _toolbarView;
}
}), new objj_method(sel_getUid("_reloadToolbarItems"), function(self, _cmd)
{ with(self)
{
    _itemIdentifiers = objj_msgSend(_defaultItems, "valueForKey:", "itemIdentifier") || [];
    if (_delegate)
    {
        var itemIdentifiersFromDelegate = objj_msgSend(objj_msgSend(_delegate, "toolbarDefaultItemIdentifiers:", self), "mutableCopy");
        if (itemIdentifiersFromDelegate)
            _itemIdentifiers = objj_msgSend(_itemIdentifiers, "arrayByAddingObjectsFromArray:", itemIdentifiersFromDelegate);
    }
    var index = 0,
        count = objj_msgSend(_itemIdentifiers, "count");
    _items = [];
    for (; index < count; ++index)
    {
        var identifier = _itemIdentifiers[index],
            item = objj_msgSend(CPToolbarItem, "_standardItemWithItemIdentifier:", identifier);
        if (!item)
            item = objj_msgSend(_identifiedItems, "objectForKey:", identifier);
        if (!item && _delegate)
            item = objj_msgSend(_delegate, "toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:", self, identifier, YES);
        item = objj_msgSend(item, "copy");
        if (item === nil)
            objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "Toolbar delegate " + _delegate + " returned nil toolbar item for identifier \"" + identifier + "\"");
        item._toolbar = self;
        objj_msgSend(_items, "addObject:", item);
    }
    _itemsSortedByVisibilityPriority = objj_msgSend(_items, "sortedArrayUsingFunction:context:", _CPToolbarItemVisibilityPriorityCompare, NULL);
    objj_msgSend(_toolbarView, "reloadToolbarItems");
}
}), new objj_method(sel_getUid("items"), function(self, _cmd)
{ with(self)
{
    return _items;
}
}), new objj_method(sel_getUid("visibleItems"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_toolbarView, "visibleItems");
}
}), new objj_method(sel_getUid("itemsSortedByVisibilityPriority"), function(self, _cmd)
{ with(self)
{
    return _itemsSortedByVisibilityPriority;
}
}), new objj_method(sel_getUid("validateVisibleToolbarItems"), function(self, _cmd)
{ with(self)
{
    var toolbarItems = objj_msgSend(self, "visibleItems"),
        count = objj_msgSend(toolbarItems, "count");
    while (count--)
        objj_msgSend(toolbarItems[count], "validate");
}
}), new objj_method(sel_getUid("_itemForItemIdentifier:willBeInsertedIntoToolbar:"), function(self, _cmd, identifier, toolbar)
{ with(self)
{
    var item = objj_msgSend(_identifiedItems, "objectForKey:", identifier);
    if (!item)
    {
        item = objj_msgSend(CPToolbarItem, "_standardItemWithItemIdentifier:", identifier);
        if (_delegate && !item)
        {
            item = objj_msgSend(objj_msgSend(_delegate, "toolbar:itemForItemIdentifier:willBeInsertedIntoToolbar:", self, identifier, toolbar), "copy");
            if (!item)
                objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, sprintf("_delegate %s returned nil toolbar item returned for identifier %s", _delegate, identifier));
        }
        objj_msgSend(_identifiedItems, "setObject:forKey:", item, identifier);
    }
    return item;
}
}), new objj_method(sel_getUid("_itemsWithIdentifiers:"), function(self, _cmd, identifiers)
{ with(self)
{
    var items = [];
    for (var i = 0; i < identifiers.length; i++)
        objj_msgSend(items, "addObject:", objj_msgSend(self, "_itemForItemIdentifier:willBeInsertedIntoToolbar:", identifiers[i], NO));
    return items;
}
}), new objj_method(sel_getUid("_defaultToolbarItems"), function(self, _cmd)
{ with(self)
{
    if (!_defaultItems && objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("toolbarDefaultItemIdentifiers:")))
    {
        _defaultItems = [];
        var identifiers = objj_msgSend(_delegate, "toolbarDefaultItemIdentifiers:", self),
            index = 0,
            count = objj_msgSend(identifiers, "count");
        for (; index < count; ++index)
            objj_msgSend(_defaultItems, "addObject:", objj_msgSend(self, "_itemForItemIdentifier:willBeInsertedIntoToolbar:", identifiers[index], NO));
    }
    return _defaultItems;
}
}), new objj_method(sel_getUid("toolbarItemDidChange:"), function(self, _cmd, anItem)
{ with(self)
{
    if (objj_msgSend(_identifiedItems, "objectForKey:", objj_msgSend(anItem, "itemIdentifier")))
        objj_msgSend(_identifiedItems, "setObject:forKey:", anItem, objj_msgSend(anItem, "itemIdentifier"));
    var index = 0,
        count = objj_msgSend(_items, "count");
    for (; index <= count; ++index)
    {
        var item = _items[index];
        if (objj_msgSend(item, "itemIdentifier") === objj_msgSend(anItem, "itemIdentifier"))
        {
            _items[index] = anItem;
            _itemsSortedByVisibilityPriority = objj_msgSend(_items, "sortedArrayUsingFunction:context:", _CPToolbarItemVisibilityPriorityCompare, NULL);
            objj_msgSend(_toolbarView, "reloadToolbarItems");
        }
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPToolbar, "class"))
        return;
    CPToolbarsByIdentifier = objj_msgSend(CPDictionary, "dictionary");
    CPToolbarConfigurationsByIdentifier = objj_msgSend(CPDictionary, "dictionary");
}
}), new objj_method(sel_getUid("_addToolbar:forIdentifier:"), function(self, _cmd, toolbar, identifier)
{ with(self)
{
    var toolbarsSharingIdentifier = objj_msgSend(CPToolbarsByIdentifier, "objectForKey:", identifier);
    if (!toolbarsSharingIdentifier)
    {
        toolbarsSharingIdentifier = []
        objj_msgSend(CPToolbarsByIdentifier, "setObject:forKey:", toolbarsSharingIdentifier, identifier);
    }
    objj_msgSend(toolbarsSharingIdentifier, "addObject:", toolbar);
}
})]);
}
var CPToolbarIdentifierKey = "CPToolbarIdentifierKey",
    CPToolbarDisplayModeKey = "CPToolbarDisplayModeKey",
    CPToolbarShowsBaselineSeparatorKey = "CPToolbarShowsBaselineSeparatorKey",
    CPToolbarAllowsUserCustomizationKey = "CPToolbarAllowsUserCustomizationKey",
    CPToolbarIsVisibleKey = "CPToolbarIsVisibleKey",
    CPToolbarDelegateKey = "CPToolbarDelegateKey",
    CPToolbarIdentifiedItemsKey = "CPToolbarIdentifiedItemsKey",
    CPToolbarDefaultItemsKey = "CPToolbarDefaultItemsKey",
    CPToolbarAllowedItemsKey = "CPToolbarAllowedItemsKey",
    CPToolbarSelectableItemsKey = "CPToolbarSelectableItemsKey";
{
var the_class = objj_getClass("CPToolbar")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPToolbar\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPToolbar").super_class }, "init");
    if (self)
    {
        _identifier = objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarIdentifierKey);
        _displayMode = objj_msgSend(aCoder, "decodeIntForKey:", CPToolbarDisplayModeKey);
        _showsBaselineSeparator = objj_msgSend(aCoder, "decodeBoolForKey:", CPToolbarShowsBaselineSeparatorKey);
        _allowsUserCustomization = objj_msgSend(aCoder, "decodeBoolForKey:", CPToolbarAllowsUserCustomizationKey);
        _isVisible = objj_msgSend(aCoder, "decodeBoolForKey:", CPToolbarIsVisibleKey);
        _identifiedItems = objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarIdentifiedItemsKey);
        _defaultItems = objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarDefaultItemsKey);
        _allowedItems = objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarAllowedItemsKey);
        _selectableItems = objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarSelectableItemsKey);
        objj_msgSend(objj_msgSend(_identifiedItems, "allValues"), "makeObjectsPerformSelector:withObject:", sel_getUid("_setToolbar:"), self);
        _items = [];
        objj_msgSend(CPToolbar, "_addToolbar:forIdentifier:", self, _identifier);
        objj_msgSend(self, "setDelegate:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarDelegateKey));
        objj_msgSend(self, "_reloadToolbarItems");
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _identifier, CPToolbarIdentifierKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _displayMode, CPToolbarDisplayModeKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _showsBaselineSeparator, CPToolbarShowsBaselineSeparatorKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _allowsUserCustomization, CPToolbarAllowsUserCustomizationKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", _isVisible, CPToolbarIsVisibleKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _identifiedItems, CPToolbarIdentifiedItemsKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _defaultItems, CPToolbarDefaultItemsKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _allowedItems, CPToolbarAllowedItemsKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _selectableItems, CPToolbarSelectableItemsKey);
    objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _delegate, CPToolbarDelegateKey);
}
})]);
}
var _CPToolbarViewBackgroundColor = nil,
    _CPToolbarViewExtraItemsImage = nil,
    _CPToolbarViewExtraItemsAlternateImage = nil;
var TOOLBAR_TOP_MARGIN = 5.0,
    TOOLBAR_ITEM_MARGIN = 10.0,
    TOOLBAR_EXTRA_ITEMS_WIDTH = 20.0;
var _CPToolbarItemInfoMake = function(anIndex, aView, aLabel, aMinWidth)
{
    return { index:anIndex, view:aView, label:aLabel, minWidth:aMinWidth };
}
{var the_class = objj_allocateClassPair(CPView, "_CPToolbarView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_toolbar"), new objj_ivar("_flexibleWidthIndexes"), new objj_ivar("_visibleFlexibleWidthIndexes"), new objj_ivar("_itemInfos"), new objj_ivar("_viewsForToolbarItems"), new objj_ivar("_visibleItems"), new objj_ivar("_invisibleItems"), new objj_ivar("_additionalItemsButton"), new objj_ivar("_labelColor"), new objj_ivar("_labelShadowColor"), new objj_ivar("_minWidth"), new objj_ivar("_FIXME_isHUD")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("visibleItems"), function(self, _cmd)
{ with(self)
{
return _visibleItems;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _minWidth = 0;
        _labelColor = objj_msgSend(CPColor, "blackColor");
        _labelShadowColor = objj_msgSend(CPColor, "colorWithWhite:alpha:", 1.0, 0.75);
        _additionalItemsButton = objj_msgSend(objj_msgSend(CPPopUpButton, "alloc"), "initWithFrame:pullsDown:", CGRectMake(0.0, 0.0, 10.0, 15.0), YES);
        objj_msgSend(_additionalItemsButton, "setBordered:", NO);
        objj_msgSend(_additionalItemsButton, "setImagePosition:", CPImageOnly);
        objj_msgSend(objj_msgSend(_additionalItemsButton, "menu"), "setShowsStateColumn:", NO);
        objj_msgSend(_additionalItemsButton, "setAlternateImage:", _CPToolbarViewExtraItemsAlternateImage);
    }
    return self;
}
}), new objj_method(sel_getUid("setToolbar:"), function(self, _cmd, aToolbar)
{ with(self)
{
    _toolbar = aToolbar;
}
}), new objj_method(sel_getUid("toolbar"), function(self, _cmd)
{ with(self)
{
    return _toolbar;
}
}), new objj_method(sel_getUid("FIXME_setIsHUD:"), function(self, _cmd, shouldBeHUD)
{ with(self)
{
    if (_FIXME_isHUD === shouldBeHUD)
        return;
    _FIXME_isHUD = shouldBeHUD;
    var items = objj_msgSend(_toolbar, "items"),
        count = objj_msgSend(items, "count");
    while (count--)
        objj_msgSend(objj_msgSend(self, "viewForItem:", items[count]), "FIXME_setIsHUD:", shouldBeHUD);
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("viewForItem:"), function(self, _cmd, anItem)
{ with(self)
{
    return _viewsForToolbarItems[objj_msgSend(anItem, "UID")] || nil;
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    var items = objj_msgSend(_toolbar, "items"),
        itemsWidth = CGRectGetWidth(objj_msgSend(self, "bounds")),
        minWidth = _minWidth,
        invisibleItemsSortedByPriority = [];
    _visibleItems = items;
    if (itemsWidth < minWidth)
    {
        itemsWidth -= TOOLBAR_EXTRA_ITEMS_WIDTH;
        _visibleItems = objj_msgSend(_visibleItems, "copy");
        var itemsSortedByVisibilityPriority = objj_msgSend(_toolbar, "itemsSortedByVisibilityPriority"),
            count = itemsSortedByVisibilityPriority.length;
        while (minWidth > itemsWidth && count)
        {
            var item = itemsSortedByVisibilityPriority[--count],
                view = objj_msgSend(self, "viewForItem:", item);
            minWidth -= objj_msgSend(view, "minSize").width + TOOLBAR_ITEM_MARGIN;
            objj_msgSend(_visibleItems, "removeObjectIdenticalTo:", item);
            objj_msgSend(invisibleItemsSortedByPriority, "addObject:", item);
            objj_msgSend(view, "setHidden:", YES);
            objj_msgSend(view, "FIXME_setIsHUD:", _FIXME_isHUD);
        }
    }
    var count = objj_msgSend(items, "count"),
        height = 0.0;
    while (count--)
    {
        var view = objj_msgSend(self, "viewForItem:", items[count]),
            minSize = objj_msgSend(view, "minSize");
        if (height < minSize.height)
            height = minSize.height;
    }
    var count = _visibleItems.length
        flexibleItemIndexes = objj_msgSend(CPIndexSet, "indexSet");
    while (count--)
    {
        var item = _visibleItems[count],
            view = objj_msgSend(self, "viewForItem:", item),
            minSize = objj_msgSend(view, "minSize");
        if (minSize.width !== objj_msgSend(view, "maxSize").width)
            objj_msgSend(flexibleItemIndexes, "addIndex:", count);
        else
            objj_msgSend(view, "setFrameSize:", CGSizeMake(minSize.width, height));
        objj_msgSend(view, "setHidden:", NO);
    }
    var remainingSpace = itemsWidth - minWidth,
        proportionate = 0.0;
    while (remainingSpace && objj_msgSend(flexibleItemIndexes, "count"))
    {
        proportionate += remainingSpace / objj_msgSend(flexibleItemIndexes, "count");
        remainingSpace = 0.0;
        var index = CPNotFound;
        while ((index = objj_msgSend(flexibleItemIndexes, "indexGreaterThanIndex:", index)) !== CPNotFound)
        {
            var item = _visibleItems[index],
                view = objj_msgSend(self, "viewForItem:", item),
                proposedWidth = objj_msgSend(view, "minSize").width + proportionate,
                constrainedWidth = MIN(proposedWidth, objj_msgSend(view, "maxSize").width);
            if (constrainedWidth < proposedWidth)
            {
                objj_msgSend(flexibleItemIndexes, "removeIndex:", index);
                remainingSpace += proposedWidth - constrainedWidth;
            }
            objj_msgSend(view, "setFrameSize:", CGSizeMake(constrainedWidth, height));
        }
    }
    var index = 0,
        count = _visibleItems.length,
        x = TOOLBAR_ITEM_MARGIN;
    for (; index < count; ++index)
    {
        var view = objj_msgSend(self, "viewForItem:", _visibleItems[index]),
            viewWidth = CGRectGetWidth(objj_msgSend(view, "frame"));
        objj_msgSend(view, "setFrame:", CGRectMake(x, 0.0, viewWidth, height));
        x += viewWidth + TOOLBAR_ITEM_MARGIN;
    }
    var needsAdditionalItemsButton = NO;
    if (objj_msgSend(invisibleItemsSortedByPriority, "count"))
    {
        var index = 0,
            count = objj_msgSend(items, "count");
        _invisibleItems = [];
        for (; index < count; ++index)
        {
            var item = items[index];
            if (objj_msgSend(invisibleItemsSortedByPriority, "indexOfObjectIdenticalTo:", item) !== CPNotFound)
            {
                objj_msgSend(_invisibleItems, "addObject:", item);
                var identifier = objj_msgSend(item, "itemIdentifier");
                if (identifier !== CPToolbarSpaceItemIdentifier &&
                    identifier !== CPToolbarFlexibleSpaceItemIdentifier &&
                    identifier !== CPToolbarSeparatorItemIdentifier)
                    needsAdditionalItemsButton = YES;
            }
        }
    }
    if (needsAdditionalItemsButton)
    {
        objj_msgSend(_additionalItemsButton, "setFrameOrigin:", CGPointMake(itemsWidth + 5.0, (CGRectGetHeight(objj_msgSend(self, "bounds")) - CGRectGetHeight(objj_msgSend(_additionalItemsButton, "frame"))) / 2.0));
        objj_msgSend(self, "addSubview:", _additionalItemsButton);
        objj_msgSend(_additionalItemsButton, "removeAllItems");
        objj_msgSend(_additionalItemsButton, "addItemWithTitle:", "Additional Items");
        objj_msgSend(objj_msgSend(_additionalItemsButton, "itemArray")[0], "setImage:", _CPToolbarViewExtraItemsImage);
        var index = 0,
            count = objj_msgSend(_invisibleItems, "count"),
            hasNonSeparatorItem = NO;
        for (; index < count; ++index)
        {
            var item = _invisibleItems[index],
                identifier = objj_msgSend(item, "itemIdentifier");
            if (identifier === CPToolbarSpaceItemIdentifier ||
                identifier === CPToolbarFlexibleSpaceItemIdentifier)
                continue;
            if (identifier === CPToolbarSeparatorItemIdentifier)
            {
                if (hasNonSeparatorItem)
                    objj_msgSend(_additionalItemsButton, "addItem:", objj_msgSend(CPMenuItem, "separatorItem"));
                continue;
            }
            hasNonSeparatorItem = YES;
            objj_msgSend(_additionalItemsButton, "addItemWithTitle:", objj_msgSend(item, "label"));
            var menuItem = objj_msgSend(_additionalItemsButton, "itemArray")[index + 1];
            objj_msgSend(menuItem, "setImage:", objj_msgSend(item, "image"));
            objj_msgSend(menuItem, "setTarget:", objj_msgSend(item, "target"));
            objj_msgSend(menuItem, "setAction:", objj_msgSend(item, "action"));
        }
    }
    else
        objj_msgSend(_additionalItemsButton, "removeFromSuperview");
}
}), new objj_method(sel_getUid("reloadToolbarItems"), function(self, _cmd)
{ with(self)
{
    var subviews = objj_msgSend(self, "subviews"),
        count = subviews.length;
    while (count--)
        objj_msgSend(subviews[count], "removeFromSuperview");
    var items = objj_msgSend(_toolbar, "items"),
        index = 0;
    count = items.length;
    _minWidth = TOOLBAR_ITEM_MARGIN;
    _viewsForToolbarItems = { };
    for (; index < count; ++index)
    {
        var item = items[index],
            view = objj_msgSend(objj_msgSend(_CPToolbarItemView, "alloc"), "initWithToolbarItem:toolbar:", item, self);
        _viewsForToolbarItems[objj_msgSend(item, "UID")] = view;
        objj_msgSend(self, "addSubview:", view);
        _minWidth += objj_msgSend(view, "minSize").width + TOOLBAR_ITEM_MARGIN;
    }
    objj_msgSend(self, "tile");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self !== objj_msgSend(_CPToolbarView, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    _CPToolbarViewExtraItemsImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:",  objj_msgSend(bundle, "pathForResource:", "_CPToolbarView/_CPToolbarViewExtraItemsImage.png"),  CPSizeMake(10.0, 15.0));
    _CPToolbarViewExtraItemsAlternateImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:",  objj_msgSend(bundle, "pathForResource:", "_CPToolbarView/_CPToolbarViewExtraItemsAlternateImage.png"), CGSizeMake(10.0, 15.0));
}
})]);
}
var _CPToolbarItemVisibilityPriorityCompare = function(lhs, rhs)
{
    var lhsVisibilityPriority = objj_msgSend(lhs, "visibilityPriority"),
        rhsVisibilityPriority = objj_msgSend(rhs, "visibilityPriority");
    if (lhsVisibilityPriority == rhsVisibilityPriority)
        return CPOrderedSame;
    if (lhsVisibilityPriority > rhsVisibilityPriority)
        return CPOrderedAscending;
    return CPOrderedDescending;
}
var TOP_MARGIN = 5.0,
    LABEL_MARGIN = 2.0;
{var the_class = objj_allocateClassPair(CPControl, "_CPToolbarItemView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_minSize"), new objj_ivar("_maxSize"), new objj_ivar("_labelSize"), new objj_ivar("_toolbarItem"), new objj_ivar("_toolbar"), new objj_ivar("_imageView"), new objj_ivar("_view"), new objj_ivar("_labelField"), new objj_ivar("_FIXME_isHUD")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("minSize"), function(self, _cmd)
{ with(self)
{
return _minSize;
}
}),
new objj_method(sel_getUid("maxSize"), function(self, _cmd)
{ with(self)
{
return _maxSize;
}
}), new objj_method(sel_getUid("initWithToolbarItem:toolbar:"), function(self, _cmd, aToolbarItem, aToolbar)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarItemView").super_class }, "init");
    if (self)
    {
        _toolbarItem = aToolbarItem;
        _labelField = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMakeZero());
        objj_msgSend(_labelField, "setFont:", objj_msgSend(CPFont, "systemFontOfSize:", 11.0));
        objj_msgSend(_labelField, "setTextColor:", objj_msgSend(self, "FIXME_labelColor"));
        objj_msgSend(_labelField, "setTextShadowColor:", objj_msgSend(self, "FIXME_labelShadowColor"));
        objj_msgSend(_labelField, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
        objj_msgSend(_labelField, "setAutoresizingMask:", CPViewWidthSizable | CPViewMinXMargin);
        objj_msgSend(self, "addSubview:", _labelField);
        objj_msgSend(self, "updateFromItem");
        _toolbar = aToolbar;
        var keyPaths = ["label", "image", "alternateImage", "minSize", "maxSize", "target", "action", "enabled"],
            index = 0,
            count = objj_msgSend(keyPaths, "count");
        for (; index < count; ++index)
            objj_msgSend(_toolbarItem, "addObserver:forKeyPath:options:context:", self, keyPaths[index], 0, NULL);
    }
    return self;
}
}), new objj_method(sel_getUid("FIXME_setIsHUD:"), function(self, _cmd, shouldBeHUD)
{ with(self)
{
    _FIXME_isHUD = shouldBeHUD;
    objj_msgSend(_labelField, "setTextColor:", objj_msgSend(self, "FIXME_labelColor"));
    objj_msgSend(_labelField, "setTextShadowColor:", objj_msgSend(self, "FIXME_labelShadowColor"));
}
}), new objj_method(sel_getUid("updateFromItem"), function(self, _cmd)
{ with(self)
{
    var identifier = objj_msgSend(_toolbarItem, "itemIdentifier");
    if (identifier === CPToolbarSpaceItemIdentifier ||
        identifier === CPToolbarFlexibleSpaceItemIdentifier ||
        identifier === CPToolbarSeparatorItemIdentifier)
    {
        objj_msgSend(_view, "removeFromSuperview");
        objj_msgSend(_imageView, "removeFromSuperview");
        _minSize = objj_msgSend(_toolbarItem, "minSize");
        _maxSize = objj_msgSend(_toolbarItem, "maxSize");
        if (identifier === CPToolbarSeparatorItemIdentifier)
        {
            _view = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 2.0, 32.0));
            sizes = {};
            sizes["CPToolbarItemSeparator"] = [CGSizeMake(2.0, 26.0), CGSizeMake(2.0, 1.0), CGSizeMake(2.0, 26.0)];
            objj_msgSend(_view, "setBackgroundColor:", _CPControlThreePartImagePattern(YES, sizes, "CPToolbarItem", "Separator"));
            objj_msgSend(self, "addSubview:", _view);
        }
        return;
    }
    objj_msgSend(self, "setTarget:", objj_msgSend(_toolbarItem, "target"));
    objj_msgSend(self, "setAction:", objj_msgSend(_toolbarItem, "action"));
    var view = objj_msgSend(_toolbarItem, "view") || nil;
    if (view !== _view)
    {
        if (!view)
            objj_msgSend(_view, "removeFromSuperview");
        else
        {
            objj_msgSend(self, "addSubview:", view);
            objj_msgSend(_imageView, "removeFromSuperview");
        }
        _view = view;
    }
    if (!_view)
    {
        if (!_imageView)
        {
            _imageView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", objj_msgSend(self, "bounds"));
            objj_msgSend(_imageView, "setImageScaling:", CPScaleNone);
            objj_msgSend(self, "addSubview:", _imageView);
        }
        objj_msgSend(_imageView, "setImage:", objj_msgSend(_toolbarItem, "image"));
    }
    var minSize = objj_msgSend(_toolbarItem, "minSize"),
        maxSize = objj_msgSend(_toolbarItem, "maxSize");
    objj_msgSend(_labelField, "setStringValue:", objj_msgSend(_toolbarItem, "label"));
    objj_msgSend(_labelField, "sizeToFit");
    objj_msgSend(self, "setEnabled:", objj_msgSend(_toolbarItem, "isEnabled"));
    _labelSize = objj_msgSend(_labelField, "frame").size;
    _minSize = CGSizeMake(MAX(_labelSize.width, minSize.width), _labelSize.height + minSize.height + LABEL_MARGIN + TOP_MARGIN);
    _maxSize = CGSizeMake(MAX(_labelSize.width, minSize.width), 100000000.0);
    objj_msgSend(_toolbar, "tile");
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
    var identifier = objj_msgSend(_toolbarItem, "itemIdentifier");
    if (identifier === CPToolbarSpaceItemIdentifier ||
        identifier === CPToolbarFlexibleSpaceItemIdentifier)
        return;
    var bounds = objj_msgSend(self, "bounds"),
        width = (bounds.size.width);
    if (identifier === CPToolbarSeparatorItemIdentifier)
        return objj_msgSend(_view, "setFrame:", CGRectMake(ROUND((width - 2.0) / 2.0), 0.0, 2.0, (bounds.size.height)));
    var view = _view || _imageView,
        itemMaxSize = objj_msgSend(_toolbarItem, "maxSize"),
        height = (bounds.size.height) - _labelSize.height - LABEL_MARGIN - TOP_MARGIN,
        viewWidth = MIN(itemMaxSize.width, width),
        viewHeight = MIN(itemMaxSize.height, height);
    objj_msgSend(view, "setFrame:", CGRectMake( ROUND((width - viewWidth) / 2.0),
                                TOP_MARGIN + ROUND((height - viewHeight) / 2.0),
                                viewWidth,
                                viewHeight));
    objj_msgSend(_labelField, "setFrameOrigin:", CGPointMake(ROUND((width - _labelSize.width) / 2.0), TOP_MARGIN + height + LABEL_MARGIN));
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (objj_msgSend(_toolbarItem, "view"))
        return objj_msgSend(objj_msgSend(self, "nextResponder"), "mouseDown:", anEvent);
    var identifier = objj_msgSend(_toolbarItem, "itemIdentifier");
    if (identifier === CPToolbarSpaceItemIdentifier ||
        identifier === CPToolbarFlexibleSpaceItemIdentifier ||
        identifier === CPToolbarSeparatorItemIdentifier)
        return objj_msgSend(objj_msgSend(self, "nextResponder"), "mouseDown:", anEvent);
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarItemView").super_class }, "mouseDown:", anEvent);
}
}), new objj_method(sel_getUid("setEnabled:"), function(self, _cmd, shouldBeEnabled)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarItemView").super_class }, "setEnabled:", shouldBeEnabled);
    if (shouldBeEnabled)
    {
        objj_msgSend(_imageView, "setAlphaValue:", 1.0);
        objj_msgSend(_labelField, "setAlphaValue:", 1.0);
    }
    else
    {
        objj_msgSend(_imageView, "setAlphaValue:", 0.5);
        objj_msgSend(_labelField, "setAlphaValue:", 0.5);
    }
}
}), new objj_method(sel_getUid("FIXME_labelColor"), function(self, _cmd)
{ with(self)
{
    if (_FIXME_isHUD)
        return objj_msgSend(CPColor, "whiteColor");
    return objj_msgSend(CPColor, "blackColor");
}
}), new objj_method(sel_getUid("FIXME_labelShadowColor"), function(self, _cmd)
{ with(self)
{
    if (_FIXME_isHUD)
        return objj_msgSend(self, "isHighlighted") ? objj_msgSend(CPColor, "colorWithWhite:alpha:", 1.0, 0.5) : objj_msgSend(CPColor, "clearColor");
    return objj_msgSend(self, "isHighlighted") ? objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.0, 0.3) : objj_msgSend(CPColor, "colorWithWhite:alpha:", 1.0, 0.75);
}
}), new objj_method(sel_getUid("setHighlighted:"), function(self, _cmd, shouldBeHighlighted)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPToolbarItemView").super_class }, "setHighlighted:", shouldBeHighlighted);
    if (shouldBeHighlighted)
    {
        var alternateImage = objj_msgSend(_toolbarItem, "alternateImage");
        if (alternateImage)
            objj_msgSend(_imageView, "setImage:", alternateImage);
        objj_msgSend(_labelField, "setTextShadowOffset:", CGSizeMakeZero());
    }
    else
    {
        var image = objj_msgSend(_toolbarItem, "image");
        if (image)
            objj_msgSend(_imageView, "setImage:", image);
        objj_msgSend(_labelField, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
    }
    objj_msgSend(_labelField, "setTextShadowColor:", objj_msgSend(self, "FIXME_labelShadowColor"));
}
}), new objj_method(sel_getUid("observeValueForKeyPath:ofObject:change:context:"), function(self, _cmd, aKeyPath, anObject, aChange, aContext)
{ with(self)
{
    if (aKeyPath === "enabled")
        objj_msgSend(self, "setEnabled:", objj_msgSend(anObject, "isEnabled"));
    else if (aKeyPath === "target")
        objj_msgSend(self, "setTarget:", objj_msgSend(anObject, "target"));
    else if (aKeyPath === "action")
        objj_msgSend(self, "setAction:", objj_msgSend(anObject, "action"));
    else
        objj_msgSend(self, "updateFromItem");
}
})]);
}

p;15;CPToolbarItem.jt;17282;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.jI;16;AppKit/CPImage.jI;15;AppKit/CPView.ji;29;_CPToolbarFlexibleSpaceItem.ji;26;_CPToolbarShowColorsItem.ji;25;_CPToolbarSeparatorItem.ji;21;_CPToolbarSpaceItem.jt;17048;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("AppKit/CPImage.j", false);
objj_executeFile("AppKit/CPView.j", false);
CPToolbarItemVisibilityPriorityStandard = 0;
CPToolbarItemVisibilityPriorityLow = -1000;
CPToolbarItemVisibilityPriorityHigh = 1000;
CPToolbarItemVisibilityPriorityUser = 2000;
CPToolbarSeparatorItemIdentifier = "CPToolbarSeparatorItem";
CPToolbarSpaceItemIdentifier = "CPToolbarSpaceItem";
CPToolbarFlexibleSpaceItemIdentifier = "CPToolbarFlexibleSpaceItem";
CPToolbarShowColorsItemIdentifier = "CPToolbarShowColorsItem";
CPToolbarShowFontsItemIdentifier = "CPToolbarShowFontsItem";
CPToolbarCustomizeToolbarItemIdentifier = "CPToolbarCustomizeToolbarItem";
CPToolbarPrintItemIdentifier = "CPToolbarPrintItem";
{var the_class = objj_allocateClassPair(CPObject, "CPToolbarItem"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_itemIdentifier"), new objj_ivar("_toolbar"), new objj_ivar("_label"), new objj_ivar("_paletteLabel"), new objj_ivar("_toolTip"), new objj_ivar("_tag"), new objj_ivar("_target"), new objj_ivar("_action"), new objj_ivar("_isEnabled"), new objj_ivar("_image"), new objj_ivar("_alternateImage"), new objj_ivar("_view"), new objj_ivar("_minSize"), new objj_ivar("_maxSize"), new objj_ivar("_visibilityPriority"), new objj_ivar("_autovalidates")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithItemIdentifier:", "");
}
}), new objj_method(sel_getUid("initWithItemIdentifier:"), function(self, _cmd, anItemIdentifier)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPToolbarItem").super_class }, "init");
    if (self)
    {
        _itemIdentifier = anItemIdentifier;
        _tag = 0;
        _isEnabled = YES;
        _minSize = CGSizeMakeZero();
        _maxSize = CGSizeMakeZero();
        _visibilityPriority = CPToolbarItemVisibilityPriorityStandard;
        _autovalidates = YES;
    }
    return self;
}
}), new objj_method(sel_getUid("itemIdentifier"), function(self, _cmd)
{ with(self)
{
    return _itemIdentifier;
}
}), new objj_method(sel_getUid("toolbar"), function(self, _cmd)
{ with(self)
{
    return _toolbar;
}
}), new objj_method(sel_getUid("_setToolbar:"), function(self, _cmd, aToolbar)
{ with(self)
{
    _toolbar = aToolbar;
}
}), new objj_method(sel_getUid("label"), function(self, _cmd)
{ with(self)
{
    return _label;
}
}), new objj_method(sel_getUid("setLabel:"), function(self, _cmd, aLabel)
{ with(self)
{
    _label = aLabel;
}
}), new objj_method(sel_getUid("paletteLabel"), function(self, _cmd)
{ with(self)
{
    return _paletteLabel;
}
}), new objj_method(sel_getUid("setPaletteLabel:"), function(self, _cmd, aPaletteLabel)
{ with(self)
{
    _paletteLabel = aPaletteLabel;
}
}), new objj_method(sel_getUid("toolTip"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("toolTip")))
        return objj_msgSend(_view, "toolTip");
    return _toolTip;
}
}), new objj_method(sel_getUid("setToolTip:"), function(self, _cmd, aToolTip)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setToolTip:")))
        objj_msgSend(_view, "setToolTip:", aToolTip);
    _toolTip = aToolTip;
}
}), new objj_method(sel_getUid("tag"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("tag")))
        return objj_msgSend(_view, "tag");
    return _tag;
}
}), new objj_method(sel_getUid("setTag:"), function(self, _cmd, aTag)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setTag:")))
        objj_msgSend(_view, "setTag:", aTag);
    _tag = aTag;
}
}), new objj_method(sel_getUid("target"), function(self, _cmd)
{ with(self)
{
    if (_view)
        return objj_msgSend(_view, "respondsToSelector:", sel_getUid("target")) ? objj_msgSend(_view, "target") : nil;
    return _target;
}
}), new objj_method(sel_getUid("setTarget:"), function(self, _cmd, aTarget)
{ with(self)
{
    if (!_view)
        _target = aTarget;
    else if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setTarget:")))
        objj_msgSend(_view, "setTarget:", aTarget);
}
}), new objj_method(sel_getUid("action"), function(self, _cmd)
{ with(self)
{
    if (_view)
        return objj_msgSend(_view, "respondsToSelector:", sel_getUid("action")) ? objj_msgSend(_view, "action") : nil;
    return _action;
}
}), new objj_method(sel_getUid("setAction:"), function(self, _cmd, anAction)
{ with(self)
{
    if (!_view)
        _action = anAction;
    else if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setAction:")))
        objj_msgSend(_view, "setAction:", anAction);
}
}), new objj_method(sel_getUid("isEnabled"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("isEnabled")))
        return objj_msgSend(_view, "isEnabled");
    return _isEnabled;
}
}), new objj_method(sel_getUid("setEnabled:"), function(self, _cmd, shouldBeEnabled)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setEnabled:")))
        objj_msgSend(_view, "setEnabled:", shouldBeEnabled);
    _isEnabled = shouldBeEnabled;
}
}), new objj_method(sel_getUid("image"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("image")))
        return objj_msgSend(_view, "image");
    return _image;
}
}), new objj_method(sel_getUid("setImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setImage:")))
        objj_msgSend(_view, "setImage:", anImage);
    _image = anImage;
    if (!_image)
        return;
    if (_minSize.width === 0 && _minSize.height === 0 &&
        _maxSize.width === 0 && _maxSize.height === 0)
    {
        var imageSize = objj_msgSend(_image, "size");
        if (imageSize.width > 0 || imageSize.height > 0)
        {
            objj_msgSend(self, "setMinSize:", imageSize);
            objj_msgSend(self, "setMaxSize:", imageSize);
        }
    }
}
}), new objj_method(sel_getUid("setAlternateImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setAlternateImage:")))
        objj_msgSend(_view, "setAlternateImage:", anImage);
    _alternateImage = anImage;
}
}), new objj_method(sel_getUid("alternateImage"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("alternateIamge")))
        return objj_msgSend(_view, "alternateImage");
    return _alternateImage;
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return _view;
}
}), new objj_method(sel_getUid("setView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_view == aView)
        return;
    _view = aView;
    if (_view)
    {
        if (_tag !== 0 && objj_msgSend(_view, "respondsToSelector:", sel_getUid("setTag:")))
            objj_msgSend(_view, "setTag:", _tag);
        _target = nil;
        _action = nil;
    }
}
}), new objj_method(sel_getUid("minSize"), function(self, _cmd)
{ with(self)
{
    return _minSize;
}
}), new objj_method(sel_getUid("setMinSize:"), function(self, _cmd, aMinSize)
{ with(self)
{
    if(!aMinSize.height || !aMinSize.width)
        return;
    _minSize = CGSizeMakeCopy(aMinSize);
    _maxSize = CGSizeMake(MAX(_minSize.width, _maxSize.width), MAX(_minSize.height, _maxSize.height));
}
}), new objj_method(sel_getUid("maxSize"), function(self, _cmd)
{ with(self)
{
    return _maxSize;
}
}), new objj_method(sel_getUid("setMaxSize:"), function(self, _cmd, aMaxSize)
{ with(self)
{
    if(!aMaxSize.height || !aMaxSize.width)
        return;
    _maxSize = CGSizeMakeCopy(aMaxSize);
    _minSize = CGSizeMake(MIN(_minSize.width, _maxSize.width), MIN(_minSize.height, _maxSize.height));
}
}), new objj_method(sel_getUid("visibilityPriority"), function(self, _cmd)
{ with(self)
{
    return _visibilityPriority;
}
}), new objj_method(sel_getUid("setVisibilityPriority:"), function(self, _cmd, aVisibilityPriority)
{ with(self)
{
    _visibilityPriority = aVisibilityPriority;
}
}), new objj_method(sel_getUid("validate"), function(self, _cmd)
{ with(self)
{
    if (_view)
    {
        if (objj_msgSend(target, "respondsToSelector:", sel_getUid("validateToolbarItem:")))
            objj_msgSend(self, "setEnabled:", objj_msgSend(target, "validateToolbarItem:", self));
        return;
    }
    var action = objj_msgSend(self, "action");
    if (!action)
        return objj_msgSend(self, "setEnabled:", NO);
    var target = objj_msgSend(self, "target");
    if (target && !objj_msgSend(target, "respondsToSelector:", action))
        return objj_msgSend(self, "setEnabled:", NO);
    target = objj_msgSend(CPApp, "targetForAction:to:from:", action, target, self);
    if (!target)
        return objj_msgSend(self, "setEnabled:", NO);
    if (objj_msgSend(target, "respondsToSelector:", sel_getUid("validateToolbarItem:")))
        objj_msgSend(self, "setEnabled:", objj_msgSend(target, "validateToolbarItem:", self));
    else
        objj_msgSend(self, "setEnabled:", YES);
}
}), new objj_method(sel_getUid("autovalidates"), function(self, _cmd)
{ with(self)
{
    return _autovalidates;
}
}), new objj_method(sel_getUid("setAutovalidates:"), function(self, _cmd, shouldAutovalidate)
{ with(self)
{
    _autovalidates = !!shouldAutovalidate;
}
})]);
}
var CPToolbarItemItemIdentifierKey = "CPToolbarItemItemIdentifierKey",
    CPToolbarItemLabelKey = "CPToolbarItemLabelKey",
    CPToolbarItemPaletteLabelKey = "CPToolbarItemPaletteLabelKey",
    CPToolbarItemToolTipKey = "CPToolbarItemToolTipKey",
    CPToolbarItemTagKey = "CPToolbarItemTagKey",
    CPToolbarItemTargetKey = "CPToolbarItemTargetKey",
    CPToolbarItemActionKey = "CPToolbarItemActionKey",
    CPToolbarItemEnabledKey = "CPToolbarItemEnabledKey",
    CPToolbarItemImageKey = "CPToolbarItemImageKey",
    CPToolbarItemAlternateImageKey = "CPToolbarItemAlternateImageKey",
    CPToolbarItemViewKey = "CPToolbarItemViewKey",
    CPToolbarItemMinSizeKey = "CPToolbarItemMinSizeKey",
    CPToolbarItemMaxSizeKey = "CPToolbarItemMaxSizeKey",
    CPToolbarItemVisibilityPriorityKey = "CPToolbarItemVisibilityPriorityKey",
    CPToolbarItemAutovalidatesKey = "CPToolbarItemAutovalidatesKey";
{
var the_class = objj_getClass("CPToolbarItem")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPToolbarItem\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPToolbarItem").super_class }, "init");
    if (self)
    {
        _itemIdentifier = objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemItemIdentifierKey);
        _minSize = objj_msgSend(aCoder, "decodeSizeForKey:", CPToolbarItemMinSizeKey);
        _maxSize = objj_msgSend(aCoder, "decodeSizeForKey:", CPToolbarItemMaxSizeKey);
        objj_msgSend(self, "setLabel:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemLabelKey));
        objj_msgSend(self, "setPaletteLabel:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemPaletteLabelKey));
        objj_msgSend(self, "setToolTip:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemToolTipKey));
        objj_msgSend(self, "setTag:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemTagKey));
        objj_msgSend(self, "setTarget:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemTargetKey));
        objj_msgSend(self, "setAction:", CPSelectorFromString(objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemActionKey)));
        objj_msgSend(self, "setEnabled:", objj_msgSend(aCoder, "decodeBoolForKey:", CPToolbarItemEnabledKey));
        objj_msgSend(self, "setImage:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemImageKey));
        objj_msgSend(self, "setAlternateImage:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemAlternateImageKey));
        objj_msgSend(self, "setView:", objj_msgSend(aCoder, "decodeObjectForKey:", CPToolbarItemViewKey));
        objj_msgSend(self, "setVisibilityPriority:", objj_msgSend(aCoder, "decodeIntForKey:", CPToolbarItemVisibilityPriorityKey));
        objj_msgSend(self, "setAutovalidates:", objj_msgSend(aCoder, "decodeBoolForKey:", CPToolbarItemAutovalidatesKey));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _itemIdentifier, CPToolbarItemItemIdentifierKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "label"), CPToolbarItemLabelKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "paletteLabel"), CPToolbarItemPaletteLabelKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "toolTip"), CPToolbarItemToolTipKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "tag"), CPToolbarItemTagKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "target"), CPToolbarItemTargetKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "action"), CPToolbarItemActionKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "isEnabled"), CPToolbarItemEnabledKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "image"), CPToolbarItemImageKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "alternateImage"), CPToolbarItemAlternateImageKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "view"), CPToolbarItemViewKey);
    objj_msgSend(aCoder, "encodeSize:forKey:", objj_msgSend(self, "minSize"), CPToolbarItemMinSizeKey);
    objj_msgSend(aCoder, "encodeSize:forKey:", objj_msgSend(self, "maxSize"), CPToolbarItemMaxSizeKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(self, "visibilityPriority"), CPToolbarItemVisibilityPriorityKey);
    objj_msgSend(aCoder, "encodeBool:forKey:", objj_msgSend(self, "autovalidates"), CPToolbarItemAutovalidatesKey);
}
})]);
}
{
var the_class = objj_getClass("CPToolbarItem")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPToolbarItem\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("copy"), function(self, _cmd)
{ with(self)
{
    var copy = objj_msgSend(objj_msgSend(objj_msgSend(self, "class"), "alloc"), "initWithItemIdentifier:", _itemIdentifier);
    if (_view)
        objj_msgSend(copy, "setView:", objj_msgSend(CPKeyedUnarchiver, "unarchiveObjectWithData:", objj_msgSend(CPKeyedArchiver, "archivedDataWithRootObject:", _view)));
    objj_msgSend(copy, "_setToolbar:", _toolbar);
    objj_msgSend(copy, "setLabel:", _label);
    objj_msgSend(copy, "setPaletteLabel:", _paletteLabel);
    objj_msgSend(copy, "setToolTip:", objj_msgSend(self, "toolTip"));
    objj_msgSend(copy, "setTag:", objj_msgSend(self, "tag"));
    objj_msgSend(copy, "setTarget:", objj_msgSend(self, "target"));
    objj_msgSend(copy, "setAction:", objj_msgSend(self, "action"));
    objj_msgSend(copy, "setEnabled:", objj_msgSend(self, "isEnabled"));
    objj_msgSend(copy, "setImage:", objj_msgSend(self, "image"));
    objj_msgSend(copy, "setAlternateImage:", objj_msgSend(self, "alternateImage"));
    objj_msgSend(copy, "setMinSize:", _minSize);
    objj_msgSend(copy, "setMaxSize:", _maxSize);
    objj_msgSend(copy, "setVisibilityPriority:", objj_msgSend(self, "visibilityPriority"));
    objj_msgSend(copy, "setAutovalidates:", objj_msgSend(self, "autovalidates"));
    return copy;
}
})]);
}
{
var the_class = objj_getClass("CPToolbarItem")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPToolbarItem\"");
var meta_class = the_class.isa;class_addMethods(meta_class, [new objj_method(sel_getUid("_standardItemWithItemIdentifier:"), function(self, _cmd, anItemIdentifier)
{ with(self)
{
    switch (anItemIdentifier)
    {
        case CPToolbarSeparatorItemIdentifier: return objj_msgSend(_CPToolbarSeparatorItem, "new");
        case CPToolbarSpaceItemIdentifier: return objj_msgSend(_CPToolbarSpaceItem, "new");
        case CPToolbarFlexibleSpaceItemIdentifier: return objj_msgSend(_CPToolbarFlexibleSpaceItem, "new");
        case CPToolbarShowColorsItemIdentifier: return objj_msgSend(_CPToolbarShowColorsItem, "new");
        case CPToolbarShowFontsItemIdentifier: return nil;
        case CPToolbarCustomizeToolbarItemIdentifier: return nil;
        case CPToolbarPrintItemIdentifier: return nil;
    }
    return nil;
}
})]);
}
objj_executeFile("_CPToolbarFlexibleSpaceItem.j", true);
objj_executeFile("_CPToolbarShowColorsItem.j", true);
objj_executeFile("_CPToolbarSeparatorItem.j", true);
objj_executeFile("_CPToolbarSpaceItem.j", true);

p;12;CPTreeNode.jt;10636;@STATIC;1.0;I;21;Foundation/CPObject.jt;10590;


objj_executeFile("Foundation/CPObject.j", false);


{var the_class = objj_allocateClassPair(CPObject, "CPTreeNode"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_representedObject"), new objj_ivar("_parentNode"), new objj_ivar("_childNodes")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("representedObject"), function(self, _cmd)
{ with(self)
{
return _representedObject;
}
}),
new objj_method(sel_getUid("parentNode"), function(self, _cmd)
{ with(self)
{
return _parentNode;
}
}), new objj_method(sel_getUid("initWithRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTreeNode").super_class }, "init");

    if (self)
    {
        _representedObject = anObject;
        _childNodes = [];
    }

    return self;
}
}), new objj_method(sel_getUid("isLeaf"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_childNodes, "count") <= 0;
}
}), new objj_method(sel_getUid("childNodes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_childNodes, "copy");
}
}), new objj_method(sel_getUid("mutableChildNodes"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "mutableArrayValueForKey:", "childNodes");
}
}), new objj_method(sel_getUid("insertObject:inChildNodesAtIndex:"), function(self, _cmd, aTreeNode, anIndex)
{ with(self)
{
    objj_msgSend(objj_msgSend(aTreeNode._parentNode, "mutableChildNodes"), "removeObjectIdenticalTo:", aTreeNode);

    aTreeNode._parentNode = self;

    objj_msgSend(_childNodes, "insertObject:atIndex:", aTreeNode, anIndex);
}
}), new objj_method(sel_getUid("removeObjectFromChildNodesAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    objj_msgSend(_childNodes, "objectAtIndex:", anIndex)._parentNode = nil;

    objj_msgSend(_childNodes, "removeObjectAtIndex:", anIndex);
}
}), new objj_method(sel_getUid("replaceObjectFromChildNodesAtIndex:withObject:"), function(self, _cmd, anIndex, aTreeNode)
{ with(self)
{
    var oldTreeNode = objj_msgSend(_childNodes, "objectAtIndex:", anIndex);

    oldTreeNode._parentNode = nil;
    aTreeNode._parentNode = self;

    objj_msgSend(_childNodes, "replaceObjectAtIndex:withObject:", anIndex, aTreeNode);
}
}), new objj_method(sel_getUid("objectInChildNodesAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return _childNodes[anIndex];
}
}), new objj_method(sel_getUid("sortWithSortDescriptors:recursively:"), function(self, _cmd, sortDescriptors, shouldSortRecursively)
{ with(self)
{
    objj_msgSend(_childNodes, "sortUsingDescriptors:", sortDescriptors);

    if (!shouldSortRecursively)
        return;

    var count = objj_msgSend(_childNodes, "count");

    while (count--)
        objj_msgSend(_childNodes[count], "sortWithSortDescriptors:recursively:", sortDescriptors, YES);
}
}), new objj_method(sel_getUid("preOrder"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_CPTreeNodeEnumerator, "enumeratorWithTreeNode:order:", self, _CPTreeNodeEnumeratorPreOrder);
}
}), new objj_method(sel_getUid("inOrder"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_CPTreeNodeEnumerator, "enumeratorWithTreeNode:order:", self, _CPTreeNodeEnumeratorInOrder);
}
}), new objj_method(sel_getUid("postOrder"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_CPTreeNodeEnumerator, "enumeratorWithTreeNode:order:", self, _CPTreeNodeEnumeratorPostOrder);
}
}), new objj_method(sel_getUid("levelOrder"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_CPTreeNodeEnumerator, "enumeratorWithTreeNode:order:", self, _CPTreeNodeEnumeratorLevelOrder);
}
}), new objj_method(sel_getUid("countByEnumeratingWithState:objects:count:"), function(self, _cmd, aState, objects, aCount)
{ with(self)
{
    if (aState.state !== 0)
        return 0;


    var count = objj_msgSend(objj_msgSend(self, "preOrder"), "countByEnumeratingWithState:objects:count:", aState, objects, aCount);


    aState.state = YES;

    return count;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("treeNodeWithRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithRepresentedObject:", anObject);
}
})]);
}

var CPTreeNodeRepresentedObjectKey = "CPTreeNodeRepresentedObjectKey",
    CPTreeNodeParentNodeKey = "CPTreeNodeParentNodeKey",
    CPTreeNodeChildNodesKey = "CPTreeNodeChildNodesKey";

{
var the_class = objj_getClass("CPTreeNode")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPTreeNode\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPTreeNode").super_class }, "init");

    if (self)
    {
        _representedObject = objj_msgSend(aCoder, "decodeObjectForKey:", CPTreeNodeRepresentedObjectKey);
        _parentNode = objj_msgSend(aCoder, "decodeObjectForKey:", CPTreeNodeParentNodeKey);
        _childNodes = objj_msgSend(aCoder, "decodeObjectForKey:", CPTreeNodeChildNodesKey);
    }

    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _representedObject, CPTreeNodeRepresentedObjectKey);
    objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _parentNode, CPTreeNodeParentNodeKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _childNodes, CPTreeNodeChildNodesKey);
}
})]);
}

var _CPTreeNodeEnumeratorPreOrder = 0,
    _CPTreeNodeEnumeratorInOrder = 1,
    _CPTreeNodeEnumeratorPostOrder = 2,
    _CPTreeNodeEnumeratorLevelOrder = 3;

{var the_class = objj_allocateClassPair(CPEnumerator, "_CPTreeNodeEnumerator"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_order"), new objj_ivar("_state"), new objj_ivar("_treeNode")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithTreeNode:order:"), function(self, _cmd, aTreeNode, anOrder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTreeNodeEnumerator").super_class }, "init");

    if (self)
    {
        _order = anOrder
        _state = objj_msgSend(self, "_newState");
        _treeNode = aTreeNode;
    }

    return self;
}
}), new objj_method(sel_getUid("_newState"), function(self, _cmd)
{ with(self)
{
    return { stack:[_treeNode], visited:objj_msgSend(CPSet, "set") };
}
}), new objj_method(sel_getUid("_preOrderFromState:allObjects:"), function(self, _cmd, state, shouldReturnAllObjects)
{ with(self)
{
    var stack = state.stack;

    if (stack.length <= 0)
        return nil;

    if (shouldReturnAllObjects)
        var allObjects = [];

    while (stack.length)
    {
        var currentNode = stack.pop(),
            childNodes = currentNode._childNodes,
            count = childNodes.length;

        while (count--)
            stack.push(childNodes[count]);

        if (shouldReturnAllObjects)
            allObjects.push(currentNode);
        else
            return currentNode;
    }

    return allObjects;
}
}), new objj_method(sel_getUid("_inOrderFromState:allObjects:"), function(self, _cmd, state, shouldReturnAllObjects)
{ with(self)
{

}
}), new objj_method(sel_getUid("_postOrderFromState:allObjects:"), function(self, _cmd, state, shouldReturnAllObjects)
{ with(self)
{
    var stack = state.stack;

    if (stack.length <= 0)
        return nil;

    var visited = state.visited;

    if (shouldReturnAllObjects)
        var allObjects = [];

    while (stack.length)
    {
        var currentNode = objj_msgSend(stack, "lastObject"),
            childNodes = currentNode._childNodes,
            originalCount = stack.length,
            count = childNodes.length;

        while (count--)
        {
            var treeNode = childNodes[count];

            if (objj_msgSend(visited, "containsObject:", treeNode))
                continue;
            else
                stack.push(treeNode);
        }

        if (originalCount === stack.length)
        {
            objj_msgSend(visited, "addObject:", currentNode);

            if (shouldReturnAllObjects)
                allObjects.push(stack.pop());
            else
                return stack.pop();
        }
    }

    return allObjects;
}
}), new objj_method(sel_getUid("_levelOrderFromState:allObjects:"), function(self, _cmd, state, shouldReturnAllObjects)
{ with(self)
{

}
}), new objj_method(sel_getUid("nextObject"), function(self, _cmd)
{ with(self)
{
    if (_order === _CPTreeNodeEnumeratorPreOrder)
        return objj_msgSend(self, "_preOrderFromState:allObjects:", objj_msgSend(self, "_newState"), NO);

    else if (_order === _CPTreeNodeEnumeratorInOrder)
        return objj_msgSend(self, "_inOrderFromState:allObjects:", objj_msgSend(self, "_newState"), NO);

    else if (_order === _CPTreeNodeEnumeratorPostOrder)
        return objj_msgSend(self, "_postOrderFromState:allObjects:", objj_msgSend(self, "_newState"), NO);


        return objj_msgSend(self, "_levelOrderFromState:allObjects:", objj_msgSend(self, "_newState"), NO);

}
}), new objj_method(sel_getUid("allObjects"), function(self, _cmd)
{ with(self)
{
    if (_order === _CPTreeNodeEnumeratorPreOrder)
        return objj_msgSend(self, "_preOrderFromState:allObjects:", objj_msgSend(self, "_newState"), YES);

    else if (_order === _CPTreeNodeEnumeratorInOrder)
        return objj_msgSend(self, "_inOrderFromState:allObjects:", objj_msgSend(self, "_newState"), YES);

    else if (_order === _CPTreeNodeEnumeratorPostOrder)
        return objj_msgSend(self, "_postOrderFromState:allObjects:", objj_msgSend(self, "_newState"), YES);


        return objj_msgSend(self, "_levelOrderFromState:allObjects:", objj_msgSend(self, "_newState"), NO);
}
}), new objj_method(sel_getUid("countByEnumeratingWithState:objects:count:"), function(self, _cmd, aState, objects, aCount)
{ with(self)
{
    if (aState.state !== 0)
        return 0;

    var count = objj_msgSend(objj_msgSend(self, "allObjects"), "countByEnumeratingWithState:objects:count:", aState, objects, aCount);


    aState.state = YES;

    return count;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("enumeratorWithTreeNode:order:"), function(self, _cmd, aTreeNode, anOrder)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithTreeNode:order:", aTreeNode, anOrder);
}
})]);
}

p;8;CPView.jt;75258;@STATIC;1.0;I;20;Foundation/CPArray.jI;26;Foundation/CPObjJRuntime.ji;19;CGAffineTransform.ji;12;CGGeometry.ji;9;CPColor.ji;12;CPGeometry.ji;19;CPGraphicsContext.ji;13;CPResponder.ji;9;CPTheme.ji;18;_CPDisplayServer.jt;75033;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPObjJRuntime.j", false);
objj_executeFile("CGAffineTransform.j", true);
objj_executeFile("CGGeometry.j", true);
objj_executeFile("CPColor.j", true);
objj_executeFile("CPGeometry.j", true);
objj_executeFile("CPGraphicsContext.j", true);
objj_executeFile("CPResponder.j", true);
objj_executeFile("CPTheme.j", true);
objj_executeFile("_CPDisplayServer.j", true);
CPViewNotSizable = 0;
CPViewMinXMargin = 1;
CPViewWidthSizable = 2;
CPViewMaxXMargin = 4;
CPViewMinYMargin = 8;
CPViewHeightSizable = 16;
CPViewMaxYMargin = 32;
CPViewBoundsDidChangeNotification = "CPViewBoundsDidChangeNotification";
CPViewFrameDidChangeNotification = "CPViewFrameDidChangeNotification";
var CachedNotificationCenter = nil,
    CachedThemeAttributes = nil;
var DOMElementPrototype = nil,
    BackgroundTrivialColor = 0,
    BackgroundVerticalThreePartImage = 1,
    BackgroundHorizontalThreePartImage = 2,
    BackgroundNinePartImage = 3;
var CPViewFlags = { },
    CPViewHasCustomDrawRect = 1 << 0,
    CPViewHasCustomLayoutSubviews = 1 << 1;
{var the_class = objj_allocateClassPair(CPResponder, "CPView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_window"), new objj_ivar("_superview"), new objj_ivar("_subviews"), new objj_ivar("_graphicsContext"), new objj_ivar("_tag"), new objj_ivar("_frame"), new objj_ivar("_bounds"), new objj_ivar("_boundsTransform"), new objj_ivar("_inverseBoundsTransform"), new objj_ivar("_registeredDraggedTypes"), new objj_ivar("_registeredDraggedTypesArray"), new objj_ivar("_isHidden"), new objj_ivar("_hitTests"), new objj_ivar("_postsFrameChangedNotifications"), new objj_ivar("_postsBoundsChangedNotifications"), new objj_ivar("_inhibitFrameAndBoundsChangedNotifications"), new objj_ivar("_DOMElement"), new objj_ivar("_DOMContentsElement"), new objj_ivar("_DOMImageParts"), new objj_ivar("_DOMImageSizes"), new objj_ivar("_backgroundType"), new objj_ivar("_dirtyRect"), new objj_ivar("_opacity"), new objj_ivar("_backgroundColor"), new objj_ivar("_autoresizesSubviews"), new objj_ivar("_autoresizingMask"), new objj_ivar("_layer"), new objj_ivar("_wantsLayer"), new objj_ivar("_isInFullScreenMode"), new objj_ivar("_fullScreenModeState"), new objj_ivar("_needsLayout"), new objj_ivar("_ephemeralSubviews"), new objj_ivar("_theme"), new objj_ivar("_themeAttributes"), new objj_ivar("_themeState"), new objj_ivar("_ephemeralSubviewsForNames"), new objj_ivar("_ephereralSubviews"), new objj_ivar("_nextKeyView"), new objj_ivar("_previousKeyView"), new objj_ivar("_viewClassFlags")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setupViewFlags"), function(self, _cmd)
{ with(self)
{
    var theClass = objj_msgSend(self, "class"),
        classUID = objj_msgSend(theClass, "UID");
    if (CPViewFlags[classUID] === undefined)
    {
        var flags = 0;
        if (objj_msgSend(theClass, "instanceMethodForSelector:", sel_getUid("drawRect:")) !== objj_msgSend(CPView, "instanceMethodForSelector:", sel_getUid("drawRect:")))
            flags |= CPViewHasCustomDrawRect;
        if (objj_msgSend(theClass, "instanceMethodForSelector:", sel_getUid("layoutSubviews")) !== objj_msgSend(CPView, "instanceMethodForSelector:", sel_getUid("layoutSubviews")))
            flags |= CPViewHasCustomLayoutSubviews;
        CPViewFlags[classUID] = flags;
    }
    _viewClassFlags = CPViewFlags[classUID];
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithFrame:", CGRectMakeZero());
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPView").super_class }, "init");
    if (self)
    {
        var width = (aFrame.size.width),
            height = (aFrame.size.height);
        _subviews = [];
        _registeredDraggedTypes = objj_msgSend(CPSet, "set");
        _registeredDraggedTypesArray = [];
        _tag = -1;
        _frame = { origin: { x:aFrame.origin.x, y:aFrame.origin.y }, size: { width:aFrame.size.width, height:aFrame.size.height } };
        _bounds = { origin: { x:0.0, y:0.0 }, size: { width:width, height:height } };
        _autoresizingMask = CPViewNotSizable;
        _autoresizesSubviews = YES;
        _opacity = 1.0;
        _isHidden = NO;
        _hitTests = YES;
        _DOMElement = DOMElementPrototype.cloneNode(false);
        if (NULL) var ____p = { x:CGPointMake((aFrame.origin.x), (aFrame.origin.y)).x * NULL.a + CGPointMake((aFrame.origin.x), (aFrame.origin.y)).y * NULL.c + NULL.tx, y:CGPointMake((aFrame.origin.x), (aFrame.origin.y)).x * NULL.b + CGPointMake((aFrame.origin.x), (aFrame.origin.y)).y * NULL.d + NULL.ty }; else var ____p = { x:(aFrame.origin.x), y:(aFrame.origin.y) }; _DOMElement.style.left = ROUND(____p.x) + "px";_DOMElement.style.top = ROUND(____p.y) + "px";;
        _DOMElement.style.width = MAX(0.0, ROUND(width)) + "px"; _DOMElement.style.height = MAX(0.0, ROUND(height)) + "px";;
        _DOMImageParts = [];
        _DOMImageSizes = [];
        _theme = objj_msgSend(CPTheme, "defaultTheme");
        _themeState = CPThemeStateNormal;
        objj_msgSend(self, "setupViewFlags");
        objj_msgSend(self, "_loadThemeAttributes");
    }
    return self;
}
}), new objj_method(sel_getUid("superview"), function(self, _cmd)
{ with(self)
{
    return _superview;
}
}), new objj_method(sel_getUid("subviews"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_subviews, "copy");
}
}), new objj_method(sel_getUid("window"), function(self, _cmd)
{ with(self)
{
    return _window;
}
}), new objj_method(sel_getUid("addSubview:"), function(self, _cmd, aSubview)
{ with(self)
{
    objj_msgSend(self, "_insertSubview:atIndex:", aSubview, CPNotFound);
}
}), new objj_method(sel_getUid("addSubview:positioned:relativeTo:"), function(self, _cmd, aSubview, anOrderingMode, anotherView)
{ with(self)
{
    var index = anotherView ? objj_msgSend(_subviews, "indexOfObjectIdenticalTo:", anotherView) : CPNotFound;
    if (index === CPNotFound)
        index = (anOrderingMode === CPWindowAbove) ? objj_msgSend(_subviews, "count") : 0;
    else if (anOrderingMode === CPWindowAbove)
        ++index;
    objj_msgSend(self, "_insertSubview:atIndex:", aSubview, index);
}
}), new objj_method(sel_getUid("_insertSubview:atIndex:"), function(self, _cmd, aSubview, anIndex)
{ with(self)
{
    var count = _subviews.length;
    objj_msgSend(objj_msgSend(self, "window"), "_dirtyKeyViewLoop");
    if (aSubview._superview == self)
    {
        var index = objj_msgSend(_subviews, "indexOfObjectIdenticalTo:", aSubview);
        if (index === anIndex || index === count - 1 && anIndex === count)
            return;
        objj_msgSend(_subviews, "removeObjectAtIndex:", index);
        _DOMElement.removeChild(aSubview._DOMElement);
        if (anIndex > index)
            --anIndex;
        --count;
    }
    else
    {
        objj_msgSend(aSubview, "removeFromSuperview");
        objj_msgSend(aSubview, "_setWindow:", _window);
        objj_msgSend(aSubview, "viewWillMoveToSuperview:", self);
        aSubview._superview = self;
    }
    if (anIndex === CPNotFound || anIndex >= count)
    {
        _subviews.push(aSubview);
        _DOMElement.appendChild(aSubview._DOMElement);
    }
    else
    {
        _subviews.splice(anIndex, 0, aSubview);
        _DOMElement.insertBefore(aSubview._DOMElement, _subviews[anIndex + 1]._DOMElement);
    }
    objj_msgSend(aSubview, "setNextResponder:", self);
    objj_msgSend(aSubview, "viewDidMoveToSuperview");
    objj_msgSend(self, "didAddSubview:", aSubview);
}
}), new objj_method(sel_getUid("didAddSubview:"), function(self, _cmd, aSubview)
{ with(self)
{
}
}), new objj_method(sel_getUid("removeFromSuperview"), function(self, _cmd)
{ with(self)
{
    if (!_superview)
        return;
    objj_msgSend(objj_msgSend(self, "window"), "_dirtyKeyViewLoop");
    objj_msgSend(_superview, "willRemoveSubview:", self);
    objj_msgSend(_superview._subviews, "removeObject:", self);
        _superview._DOMElement.removeChild(_DOMElement);
    _superview = nil;
    objj_msgSend(self, "_setWindow:", nil);
}
}), new objj_method(sel_getUid("replaceSubview:with:"), function(self, _cmd, aSubview, aView)
{ with(self)
{
    if (aSubview._superview != self)
        return;
    var index = objj_msgSend(_subviews, "indexOfObjectIdenticalTo:", aSubview);
    objj_msgSend(aSubview, "removeFromSuperview");
    objj_msgSend(self, "_insertSubview:atIndex:", aView, index);
}
}), new objj_method(sel_getUid("setSubviews:"), function(self, _cmd, newSubviews)
{ with(self)
{
    if (!newSubviews)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "newSubviews cannot be nil in -[CPView setSubviews:]");
    if (objj_msgSend(_subviews, "isEqual:", newSubviews))
        return;
    if (objj_msgSend(_subviews, "count") === 0)
    {
        var index = 0,
            count = objj_msgSend(newSubviews, "count");
        for (; index < count; ++index)
            objj_msgSend(self, "addSubview:", newSubviews[index]);
        return;
    }
    if (objj_msgSend(newSubviews, "count") === 0)
    {
        var count = objj_msgSend(_subviews, "count");
        while (count--)
            objj_msgSend(_subviews[count], "removeFromSuperview");
        return;
    }
    var removedSubviews = objj_msgSend(CPMutableSet, "setWithArray:", _subviews);
    objj_msgSend(removedSubviews, "removeObjectsInArray:", newSubviews);
    objj_msgSend(removedSubviews, "makeObjectsPerformSelector:", sel_getUid("removeFromSuperview"));
    var addedSubviews = objj_msgSend(CPMutableSet, "setWithArray:", newSubviews);
    objj_msgSend(addedSubviews, "removeObjectsInArray:", _subviews);
    var addedSubview = nil,
        addedSubviewEnumerator = objj_msgSend(addedSubviews, "objectEnumerator");
    while (addedSubview = objj_msgSend(addedSubviewEnumerator, "nextObject"))
        objj_msgSend(self, "addSubview:", addedSubview);
    if (objj_msgSend(_subviews, "isEqual:", newSubviews))
        return;
    _subviews = objj_msgSend(newSubviews, "copy");
    var index = 0,
        count = objj_msgSend(_subviews, "count");
    for (; index < count; ++index)
    {
        var subview = _subviews[index];
        _DOMElement.removeChild(subview._DOMElement);
        _DOMElement.appendChild(subview._DOMElement);
    }
}
}), new objj_method(sel_getUid("_setWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    if (_window === aWindow)
        return;
    objj_msgSend(objj_msgSend(self, "window"), "_dirtyKeyViewLoop");
    if (objj_msgSend(_window, "firstResponder") === self)
        objj_msgSend(_window, "makeFirstResponder:", nil);
    objj_msgSend(self, "viewWillMoveToWindow:", aWindow);
    if (_registeredDraggedTypes)
    {
        objj_msgSend(_window, "_noteUnregisteredDraggedTypes:", _registeredDraggedTypes);
        objj_msgSend(aWindow, "_noteRegisteredDraggedTypes:", _registeredDraggedTypes);
    }
    _window = aWindow;
    var count = objj_msgSend(_subviews, "count");
    while (count--)
        objj_msgSend(_subviews[count], "_setWindow:", aWindow);
    objj_msgSend(self, "viewDidMoveToWindow");
    objj_msgSend(objj_msgSend(self, "window"), "_dirtyKeyViewLoop");
}
}), new objj_method(sel_getUid("isDescendantOf:"), function(self, _cmd, aView)
{ with(self)
{
    var view = self;
    do
    {
        if (view == aView)
            return YES;
    } while(view = objj_msgSend(view, "superview"))
    return NO;
}
}), new objj_method(sel_getUid("viewDidMoveToSuperview"), function(self, _cmd)
{ with(self)
{
        objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("viewDidMoveToWindow"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("viewWillMoveToSuperview:"), function(self, _cmd, aView)
{ with(self)
{
}
}), new objj_method(sel_getUid("viewWillMoveToWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
}
}), new objj_method(sel_getUid("willRemoveSubview:"), function(self, _cmd, aView)
{ with(self)
{
}
}), new objj_method(sel_getUid("enclosingMenuItem"), function(self, _cmd)
{ with(self)
{
    var view = self;
    while (view && !objj_msgSend(view, "isKindOfClass:", objj_msgSend(_CPMenuItemView, "class")))
        view = objj_msgSend(view, "superview");
    if (view)
        return view._menuItem;
    return nil;
}
}), new objj_method(sel_getUid("setTag:"), function(self, _cmd, aTag)
{ with(self)
{
    _tag = aTag;
}
}), new objj_method(sel_getUid("tag"), function(self, _cmd)
{ with(self)
{
    return _tag;
}
}), new objj_method(sel_getUid("viewWithTag:"), function(self, _cmd, aTag)
{ with(self)
{
    if (objj_msgSend(self, "tag") == aTag)
        return self;
    var index = 0,
        count = _subviews.length;
    for (; index < count; ++index)
    {
        var view = objj_msgSend(_subviews[index], "viewWithTag:", aTag);
        if (view)
            return view;
    }
    return nil;
}
}), new objj_method(sel_getUid("isFlipped"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("setFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    if (((_frame.origin.x == aFrame.origin.x && _frame.origin.y == aFrame.origin.y) && (_frame.size.width == aFrame.size.width && _frame.size.height == aFrame.size.height)))
        return;
    _inhibitFrameAndBoundsChangedNotifications = YES;
    objj_msgSend(self, "setFrameOrigin:", aFrame.origin);
    objj_msgSend(self, "setFrameSize:", aFrame.size);
    _inhibitFrameAndBoundsChangedNotifications = NO;
    if (_postsFrameChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewFrameDidChangeNotification, self);
}
}), new objj_method(sel_getUid("frame"), function(self, _cmd)
{ with(self)
{
    return { origin: { x:_frame.origin.x, y:_frame.origin.y }, size: { width:_frame.size.width, height:_frame.size.height } };
}
}), new objj_method(sel_getUid("frameOrigin"), function(self, _cmd)
{ with(self)
{
    return { x:_frame.origin.x, y:_frame.origin.y };
}
}), new objj_method(sel_getUid("frameSize"), function(self, _cmd)
{ with(self)
{
    return { width:_frame.size.width, height:_frame.size.height };
}
}), new objj_method(sel_getUid("setCenter:"), function(self, _cmd, aPoint)
{ with(self)
{
    objj_msgSend(self, "setFrameOrigin:", CGPointMake(aPoint.x - _frame.size.width / 2.0, aPoint.y - _frame.size.height / 2.0));
}
}), new objj_method(sel_getUid("center"), function(self, _cmd)
{ with(self)
{
    return CGPointMake(_frame.size.width / 2.0 + _frame.origin.x, _frame.size.height / 2.0 + _frame.origin.y);
}
}), new objj_method(sel_getUid("setFrameOrigin:"), function(self, _cmd, aPoint)
{ with(self)
{
    var origin = _frame.origin;
    if (!aPoint || (origin.x == aPoint.x && origin.y == aPoint.y))
        return;
    origin.x = aPoint.x;
    origin.y = aPoint.y;
    if (_postsFrameChangedNotifications && !_inhibitFrameAndBoundsChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewFrameDidChangeNotification, self);
    var transform = _superview ? _superview._boundsTransform : NULL;
    if (transform) var ____p = { x:CGPointMake(origin.x, origin.y).x * transform.a + CGPointMake(origin.x, origin.y).y * transform.c + transform.tx, y:CGPointMake(origin.x, origin.y).x * transform.b + CGPointMake(origin.x, origin.y).y * transform.d + transform.ty }; else var ____p = { x:origin.x, y:origin.y }; _DOMElement.style.left = ROUND(____p.x) + "px";_DOMElement.style.top = ROUND(____p.y) + "px";;
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var size = _frame.size;
    if (!aSize || (size.width == aSize.width && size.height == aSize.height))
        return;
    var oldSize = { width:size.width, height:size.height };
    size.width = aSize.width;
    size.height = aSize.height;
    if (YES)
    {
        _bounds.size.width = aSize.width;
        _bounds.size.height = aSize.height;
    }
    if (_layer)
        objj_msgSend(_layer, "_owningViewBoundsChanged");
    if (_autoresizesSubviews)
        objj_msgSend(self, "resizeSubviewsWithOldSize:", oldSize);
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
    _DOMElement.style.width = MAX(0.0, ROUND(size.width)) + "px"; _DOMElement.style.height = MAX(0.0, ROUND(size.height)) + "px";;
    if (_DOMContentsElement)
    {
        _DOMContentsElement.width = MAX(0.0, ROUND(size.width)); _DOMContentsElement.height = MAX(0.0, ROUND(size.height));;
        _DOMContentsElement.style.width = MAX(0.0, ROUND(size.width)) + "px"; _DOMContentsElement.style.height = MAX(0.0, ROUND(size.height)) + "px";;
    }
    if (_backgroundType !== BackgroundTrivialColor)
    {
        var images = objj_msgSend(objj_msgSend(_backgroundColor, "patternImage"), "imageSlices");
        if (_backgroundType === BackgroundVerticalThreePartImage)
        {
            _DOMImageParts[1].style.width = MAX(0.0, ROUND(size.width)) + "px"; _DOMImageParts[1].style.height = MAX(0.0, ROUND(size.height - _DOMImageSizes[0].height - _DOMImageSizes[2].height)) + "px";;
        }
        else if (_backgroundType === BackgroundHorizontalThreePartImage)
        {
            _DOMImageParts[1].style.width = MAX(0.0, ROUND(size.width - _DOMImageSizes[0].width - _DOMImageSizes[2].width)) + "px"; _DOMImageParts[1].style.height = MAX(0.0, ROUND(size.height)) + "px";;
        }
        else if (_backgroundType === BackgroundNinePartImage)
        {
            var width = size.width - _DOMImageSizes[0].width - _DOMImageSizes[2].width,
                height = size.height - _DOMImageSizes[0].height - _DOMImageSizes[6].height;
            _DOMImageParts[1].style.width = MAX(0.0, ROUND(width)) + "px"; _DOMImageParts[1].style.height = MAX(0.0, ROUND(_DOMImageSizes[0].height)) + "px";;
            _DOMImageParts[3].style.width = MAX(0.0, ROUND(_DOMImageSizes[3].width)) + "px"; _DOMImageParts[3].style.height = MAX(0.0, ROUND(height)) + "px";;
            _DOMImageParts[4].style.width = MAX(0.0, ROUND(width)) + "px"; _DOMImageParts[4].style.height = MAX(0.0, ROUND(height)) + "px";;
            _DOMImageParts[5].style.width = MAX(0.0, ROUND(_DOMImageSizes[5].width)) + "px"; _DOMImageParts[5].style.height = MAX(0.0, ROUND(height)) + "px";;
            _DOMImageParts[7].style.width = MAX(0.0, ROUND(width)) + "px"; _DOMImageParts[7].style.height = MAX(0.0, ROUND(_DOMImageSizes[7].height)) + "px";;
        }
    }
    if (_postsFrameChangedNotifications && !_inhibitFrameAndBoundsChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewFrameDidChangeNotification, self);
}
}), new objj_method(sel_getUid("setBounds:"), function(self, _cmd, bounds)
{ with(self)
{
    if (((_bounds.origin.x == bounds.origin.x && _bounds.origin.y == bounds.origin.y) && (_bounds.size.width == bounds.size.width && _bounds.size.height == bounds.size.height)))
        return;
    _inhibitFrameAndBoundsChangedNotifications = YES;
    objj_msgSend(self, "setBoundsOrigin:", bounds.origin);
    objj_msgSend(self, "setBoundsSize:", bounds.size);
    _inhibitFrameAndBoundsChangedNotifications = NO;
    if (_postsBoundsChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewBoundsDidChangeNotification, self);
}
}), new objj_method(sel_getUid("bounds"), function(self, _cmd)
{ with(self)
{
    return { origin: { x:_bounds.origin.x, y:_bounds.origin.y }, size: { width:_bounds.size.width, height:_bounds.size.height } };
}
}), new objj_method(sel_getUid("boundsOrigin"), function(self, _cmd)
{ with(self)
{
    return { x:_bounds.origin.x, y:_bounds.origin.y };
}
}), new objj_method(sel_getUid("boundsSize"), function(self, _cmd)
{ with(self)
{
    return { width:_bounds.size.width, height:_bounds.size.height };
}
}), new objj_method(sel_getUid("setBoundsOrigin:"), function(self, _cmd, aPoint)
{ with(self)
{
    var origin = _bounds.origin;
    if ((origin.x == aPoint.x && origin.y == aPoint.y))
        return;
    origin.x = aPoint.x;
    origin.y = aPoint.y;
    if (origin.x != 0 || origin.y != 0)
    {
        _boundsTransform = { a:1.0, b:0.0, c:0.0, d:1.0, tx:-origin.x, ty:-origin.y };
        _inverseBoundsTransform = CGAffineTransformInvert(_boundsTransform);
    }
    else
    {
        _boundsTransform = nil;
        _inverseBoundsTransform = nil;
    }
    var index = _subviews.length;
    while (index--)
    {
        var view = _subviews[index],
            origin = view._frame.origin;
        if (_boundsTransform) var ____p = { x:CGPointMake(origin.x, origin.y).x * _boundsTransform.a + CGPointMake(origin.x, origin.y).y * _boundsTransform.c + _boundsTransform.tx, y:CGPointMake(origin.x, origin.y).x * _boundsTransform.b + CGPointMake(origin.x, origin.y).y * _boundsTransform.d + _boundsTransform.ty }; else var ____p = { x:origin.x, y:origin.y }; view._DOMElement.style.left = ROUND(____p.x) + "px";view._DOMElement.style.top = ROUND(____p.y) + "px";;
    }
    if (_postsBoundsChangedNotifications && !_inhibitFrameAndBoundsChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewBoundsDidChangeNotification, self);
}
}), new objj_method(sel_getUid("setBoundsSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var size = _bounds.size;
    if ((size.width == aSize.width && size.height == aSize.height))
        return;
    var frameSize = _frame.size;
    if (!(size.width == frameSize.width && size.height == frameSize.height))
    {
        var origin = _bounds.origin;
        origin.x /= size.width / frameSize.width;
        origin.y /= size.height / frameSize.height;
    }
    size.width = aSize.width;
    size.height = aSize.height;
    if (!(size.width == frameSize.width && size.height == frameSize.height))
    {
        var origin = _bounds.origin;
        origin.x *= size.width / frameSize.width;
        origin.y *= size.height / frameSize.height;
    }
    if (_postsBoundsChangedNotifications && !_inhibitFrameAndBoundsChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewBoundsDidChangeNotification, self);
}
}), new objj_method(sel_getUid("resizeWithOldSuperviewSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var mask = objj_msgSend(self, "autoresizingMask");
    if(mask == CPViewNotSizable)
        return;
    var frame = _superview._frame,
        newFrame = { origin: { x:_frame.origin.x, y:_frame.origin.y }, size: { width:_frame.size.width, height:_frame.size.height } },
        dX = ((frame.size.width) - aSize.width) /
            (((mask & CPViewMinXMargin) ? 1 : 0) + (mask & CPViewWidthSizable ? 1 : 0) + (mask & CPViewMaxXMargin ? 1 : 0)),
        dY = ((frame.size.height) - aSize.height) /
            ((mask & CPViewMinYMargin ? 1 : 0) + (mask & CPViewHeightSizable ? 1 : 0) + (mask & CPViewMaxYMargin ? 1 : 0));
    if (mask & CPViewMinXMargin)
        newFrame.origin.x += dX;
    if (mask & CPViewWidthSizable)
        newFrame.size.width += dX;
    if (mask & CPViewMinYMargin)
        newFrame.origin.y += dY;
    if (mask & CPViewHeightSizable)
        newFrame.size.height += dY;
    objj_msgSend(self, "setFrame:", newFrame);
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var count = _subviews.length;
    while (count--)
        objj_msgSend(_subviews[count], "resizeWithOldSuperviewSize:", aSize);
}
}), new objj_method(sel_getUid("setAutoresizesSubviews:"), function(self, _cmd, aFlag)
{ with(self)
{
    _autoresizesSubviews = !!aFlag;
}
}), new objj_method(sel_getUid("autoresizesSubviews"), function(self, _cmd)
{ with(self)
{
    return _autoresizesSubviews;
}
}), new objj_method(sel_getUid("setAutoresizingMask:"), function(self, _cmd, aMask)
{ with(self)
{
    _autoresizingMask = aMask;
}
}), new objj_method(sel_getUid("autoresizingMask"), function(self, _cmd)
{ with(self)
{
    return _autoresizingMask;
}
}), new objj_method(sel_getUid("enterFullScreenMode"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "enterFullScreenMode:withOptions:", nil, nil);
}
}), new objj_method(sel_getUid("enterFullScreenMode:withOptions:"), function(self, _cmd, aScreen, options)
{ with(self)
{
    _fullScreenModeState = _CPViewFullScreenModeStateMake(self);
    var fullScreenWindow = objj_msgSend(objj_msgSend(CPWindow, "alloc"), "initWithContentRect:styleMask:", objj_msgSend(objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"), "contentBounds"), CPBorderlessWindowMask);
    objj_msgSend(fullScreenWindow, "setLevel:", CPScreenSaverWindowLevel);
    objj_msgSend(fullScreenWindow, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
    var contentView = objj_msgSend(fullScreenWindow, "contentView");
    objj_msgSend(contentView, "setBackgroundColor:", objj_msgSend(CPColor, "blackColor"));
    objj_msgSend(contentView, "addSubview:", self);
    objj_msgSend(self, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
    objj_msgSend(self, "setFrame:", CGRectMakeCopy(objj_msgSend(contentView, "bounds")));
    objj_msgSend(fullScreenWindow, "makeKeyAndOrderFront:", self);
    objj_msgSend(fullScreenWindow, "makeFirstResponder:", self);
    _isInFullScreenMode = YES;
    return YES;
}
}), new objj_method(sel_getUid("exitFullScreenMode"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "exitFullScreenModeWithOptions:", nil);
}
}), new objj_method(sel_getUid("exitFullScreenModeWithOptions:"), function(self, _cmd, options)
{ with(self)
{
    if (!_isInFullScreenMode)
        return;
    _isInFullScreenMode = NO;
    objj_msgSend(self, "setFrame:", _fullScreenModeState.frame);
    objj_msgSend(self, "setAutoresizingMask:", _fullScreenModeState.autoresizingMask);
    objj_msgSend(_fullScreenModeState.superview, "_insertSubview:atIndex:", self, _fullScreenModeState.index);
    objj_msgSend(objj_msgSend(self, "window"), "orderOut:", self);
}
}), new objj_method(sel_getUid("isInFullScreenMode"), function(self, _cmd)
{ with(self)
{
    return _isInFullScreenMode;
}
}), new objj_method(sel_getUid("setHidden:"), function(self, _cmd, aFlag)
{ with(self)
{
    aFlag = !!aFlag;
    if(_isHidden === aFlag)
        return;
    _isHidden = aFlag;
    _DOMElement.style.display = _isHidden ? "none" : "block";
    if (aFlag)
    {
        var view = objj_msgSend(_window, "firstResponder");
        if (objj_msgSend(view, "isKindOfClass:", objj_msgSend(CPView, "class")))
        {
            do
            {
               if (self == view)
               {
                  objj_msgSend(_window, "makeFirstResponder:", objj_msgSend(self, "nextValidKeyView"));
                  break;
               }
            }
            while (view = objj_msgSend(view, "superview"));
        }
    }
}
}), new objj_method(sel_getUid("isHidden"), function(self, _cmd)
{ with(self)
{
    return _isHidden;
}
}), new objj_method(sel_getUid("setAlphaValue:"), function(self, _cmd, anAlphaValue)
{ with(self)
{
    if (_opacity == anAlphaValue)
        return;
    _opacity = anAlphaValue;
    if (CPFeatureIsCompatible(CPOpacityRequiresFilterFeature))
    {
        if (anAlphaValue == 1.0)
            try { _DOMElement.style.removeAttribute("filter") } catch (anException) { }
        else
            _DOMElement.style.filter = "alpha(opacity=" + anAlphaValue * 100 + ")";
    }
    else
        _DOMElement.style.opacity = anAlphaValue;
}
}), new objj_method(sel_getUid("alphaValue"), function(self, _cmd)
{ with(self)
{
    return _opacity;
}
}), new objj_method(sel_getUid("isHiddenOrHasHiddenAncestor"), function(self, _cmd)
{ with(self)
{
    var view = self;
    while (view && !objj_msgSend(view, "isHidden"))
        view = objj_msgSend(view, "superview");
    return view !== nil;
}
}), new objj_method(sel_getUid("acceptsFirstMouse:"), function(self, _cmd, anEvent)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("hitTests"), function(self, _cmd)
{ with(self)
{
    return _hitTests;
}
}), new objj_method(sel_getUid("setHitTests:"), function(self, _cmd, shouldHitTest)
{ with(self)
{
    _hitTests = !!shouldHitTest;
}
}), new objj_method(sel_getUid("hitTest:"), function(self, _cmd, aPoint)
{ with(self)
{
    if(_isHidden || !_hitTests || !CPRectContainsPoint(_frame, aPoint))
        return nil;
    var view = nil,
        i = _subviews.length,
        adjustedPoint = { x:aPoint.x - (_frame.origin.x), y:aPoint.y - (_frame.origin.y) };
    if (_inverseBoundsTransform)
        adjustedPoint = { x:adjustedPoint.x * _inverseBoundsTransform.a + adjustedPoint.y * _inverseBoundsTransform.c + _inverseBoundsTransform.tx, y:adjustedPoint.x * _inverseBoundsTransform.b + adjustedPoint.y * _inverseBoundsTransform.d + _inverseBoundsTransform.ty };
    while (i--)
        if (view = objj_msgSend(_subviews[i], "hitTest:", adjustedPoint))
            return view;
    return self;
}
}), new objj_method(sel_getUid("needsPanelToBecomeKey"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("mouseDownCanMoveWindow"), function(self, _cmd)
{ with(self)
{
    return !objj_msgSend(self, "isOpaque");
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (objj_msgSend(self, "mouseDownCanMoveWindow"))
        objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPView").super_class }, "mouseDown:", anEvent);
}
}), new objj_method(sel_getUid("setBackgroundColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_backgroundColor == aColor)
        return;
    _backgroundColor = aColor;
    var patternImage = objj_msgSend(_backgroundColor, "patternImage"),
        amount = 0;
    if (objj_msgSend(patternImage, "isThreePartImage"))
    {
        _backgroundType = objj_msgSend(patternImage, "isVertical") ? BackgroundVerticalThreePartImage : BackgroundHorizontalThreePartImage;
        amount = 3 - _DOMImageParts.length;
    }
    else if (objj_msgSend(patternImage, "isNinePartImage"))
    {
        _backgroundType = BackgroundNinePartImage;
        amount = 9 - _DOMImageParts.length;
    }
    else
    {
        _backgroundType = BackgroundTrivialColor;
        amount = 0 - _DOMImageParts.length;
    }
    if (amount > 0)
        while (amount--)
        {
            var DOMElement = DOMElementPrototype.cloneNode(false);
            DOMElement.style.zIndex = -1000;
            _DOMImageParts.push(DOMElement);
            _DOMElement.appendChild(DOMElement);
        }
    else
    {
        amount = -amount;
        while (amount--)
            _DOMElement.removeChild(_DOMImageParts.pop());
    }
    if (_backgroundType == BackgroundTrivialColor)
        _DOMElement.style.background = _backgroundColor ? objj_msgSend(_backgroundColor, "cssString") : "";
    else
    {
        var slices = objj_msgSend(patternImage, "imageSlices"),
            count = MIN(_DOMImageParts.length, slices.length),
            frameSize = _frame.size;
        while (count--)
        {
            var image = slices[count],
                size = _DOMImageSizes[count] = image ? objj_msgSend(image, "size") : { width:0.0, height:0.0 };
            _DOMImageParts[count].style.width = MAX(0.0, ROUND(size.width)) + "px"; _DOMImageParts[count].style.height = MAX(0.0, ROUND(size.height)) + "px";;
            _DOMImageParts[count].style.background = image ? "url(\"" + objj_msgSend(image, "filename") + "\")" : "";
        }
        if (_backgroundType == BackgroundNinePartImage)
        {
            var width = frameSize.width - _DOMImageSizes[0].width - _DOMImageSizes[2].width,
                height = frameSize.height - _DOMImageSizes[0].height - _DOMImageSizes[6].height;
            _DOMImageParts[1].style.width = MAX(0.0, ROUND(width)) + "px"; _DOMImageParts[1].style.height = MAX(0.0, ROUND(_DOMImageSizes[0].height)) + "px";;
            _DOMImageParts[3].style.width = MAX(0.0, ROUND(_DOMImageSizes[3].width)) + "px"; _DOMImageParts[3].style.height = MAX(0.0, ROUND(height)) + "px";;
            _DOMImageParts[4].style.width = MAX(0.0, ROUND(width)) + "px"; _DOMImageParts[4].style.height = MAX(0.0, ROUND(height)) + "px";;
            _DOMImageParts[5].style.width = MAX(0.0, ROUND(_DOMImageSizes[5].width)) + "px"; _DOMImageParts[5].style.height = MAX(0.0, ROUND(height)) + "px";;
            _DOMImageParts[7].style.width = MAX(0.0, ROUND(width)) + "px"; _DOMImageParts[7].style.height = MAX(0.0, ROUND(_DOMImageSizes[7].height)) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[0].style.left = ROUND(____p.x) + "px";_DOMImageParts[0].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(_DOMImageSizes[0].width, 0.0).x * NULL.a + CGPointMake(_DOMImageSizes[0].width, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(_DOMImageSizes[0].width, 0.0).x * NULL.b + CGPointMake(_DOMImageSizes[0].width, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:_DOMImageSizes[0].width, y:0.0 }; _DOMImageParts[1].style.left = ROUND(____p.x) + "px";_DOMImageParts[1].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[2].style.right = ROUND(____p.x) + "px";_DOMImageParts[2].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, _DOMImageSizes[1].height).x * NULL.a + CGPointMake(0.0, _DOMImageSizes[1].height).y * NULL.c + NULL.tx, y:CGPointMake(0.0, _DOMImageSizes[1].height).x * NULL.b + CGPointMake(0.0, _DOMImageSizes[1].height).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:_DOMImageSizes[1].height }; _DOMImageParts[3].style.left = ROUND(____p.x) + "px";_DOMImageParts[3].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(_DOMImageSizes[0].width, _DOMImageSizes[0].height).x * NULL.a + CGPointMake(_DOMImageSizes[0].width, _DOMImageSizes[0].height).y * NULL.c + NULL.tx, y:CGPointMake(_DOMImageSizes[0].width, _DOMImageSizes[0].height).x * NULL.b + CGPointMake(_DOMImageSizes[0].width, _DOMImageSizes[0].height).y * NULL.d + NULL.ty }; else var ____p = { x:_DOMImageSizes[0].width, y:_DOMImageSizes[0].height }; _DOMImageParts[4].style.left = ROUND(____p.x) + "px";_DOMImageParts[4].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, _DOMImageSizes[1].height).x * NULL.a + CGPointMake(0.0, _DOMImageSizes[1].height).y * NULL.c + NULL.tx, y:CGPointMake(0.0, _DOMImageSizes[1].height).x * NULL.b + CGPointMake(0.0, _DOMImageSizes[1].height).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:_DOMImageSizes[1].height }; _DOMImageParts[5].style.right = ROUND(____p.x) + "px";_DOMImageParts[5].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[6].style.left = ROUND(____p.x) + "px";_DOMImageParts[6].style.bottom = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(_DOMImageSizes[6].width, 0.0).x * NULL.a + CGPointMake(_DOMImageSizes[6].width, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(_DOMImageSizes[6].width, 0.0).x * NULL.b + CGPointMake(_DOMImageSizes[6].width, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:_DOMImageSizes[6].width, y:0.0 }; _DOMImageParts[7].style.left = ROUND(____p.x) + "px";_DOMImageParts[7].style.bottom = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[8].style.right = ROUND(____p.x) + "px";_DOMImageParts[8].style.bottom = ROUND(____p.y) + "px";;
        }
        else if (_backgroundType == BackgroundVerticalThreePartImage)
        {
            _DOMImageParts[1].style.width = MAX(0.0, ROUND(frameSize.width)) + "px"; _DOMImageParts[1].style.height = MAX(0.0, ROUND(frameSize.height - _DOMImageSizes[0].height - _DOMImageSizes[2].height)) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[0].style.left = ROUND(____p.x) + "px";_DOMImageParts[0].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, _DOMImageSizes[0].height).x * NULL.a + CGPointMake(0.0, _DOMImageSizes[0].height).y * NULL.c + NULL.tx, y:CGPointMake(0.0, _DOMImageSizes[0].height).x * NULL.b + CGPointMake(0.0, _DOMImageSizes[0].height).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:_DOMImageSizes[0].height }; _DOMImageParts[1].style.left = ROUND(____p.x) + "px";_DOMImageParts[1].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[2].style.left = ROUND(____p.x) + "px";_DOMImageParts[2].style.bottom = ROUND(____p.y) + "px";;
        }
        else if (_backgroundType == BackgroundHorizontalThreePartImage)
        {
            _DOMImageParts[1].style.width = MAX(0.0, ROUND(frameSize.width - _DOMImageSizes[0].width - _DOMImageSizes[2].width)) + "px"; _DOMImageParts[1].style.height = MAX(0.0, ROUND(frameSize.height)) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[0].style.left = ROUND(____p.x) + "px";_DOMImageParts[0].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(_DOMImageSizes[0].width, 0.0).x * NULL.a + CGPointMake(_DOMImageSizes[0].width, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(_DOMImageSizes[0].width, 0.0).x * NULL.b + CGPointMake(_DOMImageSizes[0].width, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:_DOMImageSizes[0].width, y:0.0 }; _DOMImageParts[1].style.left = ROUND(____p.x) + "px";_DOMImageParts[1].style.top = ROUND(____p.y) + "px";;
            if (NULL) var ____p = { x:CGPointMake(0.0, 0.0).x * NULL.a + CGPointMake(0.0, 0.0).y * NULL.c + NULL.tx, y:CGPointMake(0.0, 0.0).x * NULL.b + CGPointMake(0.0, 0.0).y * NULL.d + NULL.ty }; else var ____p = { x:0.0, y:0.0 }; _DOMImageParts[2].style.right = ROUND(____p.x) + "px";_DOMImageParts[2].style.top = ROUND(____p.y) + "px";;
        }
    }
}
}), new objj_method(sel_getUid("backgroundColor"), function(self, _cmd)
{ with(self)
{
    return _backgroundColor;
}
}), new objj_method(sel_getUid("convertPoint:fromView:"), function(self, _cmd, aPoint, aView)
{ with(self)
{
    return CGPointApplyAffineTransform(aPoint, _CPViewGetTransform(aView, self));
}
}), new objj_method(sel_getUid("convertPoint:toView:"), function(self, _cmd, aPoint, aView)
{ with(self)
{
    return CGPointApplyAffineTransform(aPoint, _CPViewGetTransform(self, aView));
}
}), new objj_method(sel_getUid("convertSize:fromView:"), function(self, _cmd, aSize, aView)
{ with(self)
{
    return CGSizeApplyAffineTransform(aSize, _CPViewGetTransform(aView, self));
}
}), new objj_method(sel_getUid("convertSize:toView:"), function(self, _cmd, aSize, aView)
{ with(self)
{
    return CGSizeApplyAffineTransform(aSize, _CPViewGetTransform(self, aView));
}
}), new objj_method(sel_getUid("convertRect:fromView:"), function(self, _cmd, aRect, aView)
{ with(self)
{
    return CGRectApplyAffineTransform(aRect, _CPViewGetTransform(aView, self));
}
}), new objj_method(sel_getUid("convertRect:toView:"), function(self, _cmd, aRect, aView)
{ with(self)
{
    return CGRectApplyAffineTransform(aRect, _CPViewGetTransform(self, aView));
}
}), new objj_method(sel_getUid("setPostsFrameChangedNotifications:"), function(self, _cmd, shouldPostFrameChangedNotifications)
{ with(self)
{
    shouldPostFrameChangedNotifications = !!shouldPostFrameChangedNotifications;
    if (_postsFrameChangedNotifications === shouldPostFrameChangedNotifications)
        return;
    _postsFrameChangedNotifications = shouldPostFrameChangedNotifications;
    if (_postsFrameChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewFrameDidChangeNotification, self);
}
}), new objj_method(sel_getUid("postsFrameChangedNotifications"), function(self, _cmd)
{ with(self)
{
    return _postsFrameChangedNotifications;
}
}), new objj_method(sel_getUid("setPostsBoundsChangedNotifications:"), function(self, _cmd, shouldPostBoundsChangedNotifications)
{ with(self)
{
    shouldPostBoundsChangedNotifications = !!shouldPostBoundsChangedNotifications;
    if (_postsBoundsChangedNotifications === shouldPostBoundsChangedNotifications)
        return;
    _postsBoundsChangedNotifications = shouldPostBoundsChangedNotifications;
    if (_postsBoundsChangedNotifications)
        objj_msgSend(CachedNotificationCenter, "postNotificationName:object:", CPViewBoundsDidChangeNotification, self);
}
}), new objj_method(sel_getUid("postsBoundsChangedNotifications"), function(self, _cmd)
{ with(self)
{
    return _postsBoundsChangedNotifications;
}
}), new objj_method(sel_getUid("dragImage:at:offset:event:pasteboard:source:slideBack:"), function(self, _cmd, anImage, aLocation, mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack)
{ with(self)
{
    objj_msgSend(_window, "dragImage:at:offset:event:pasteboard:source:slideBack:", anImage, objj_msgSend(self, "convertPoint:toView:", aLocation, nil), mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack);
}
}), new objj_method(sel_getUid("dragView:at:offset:event:pasteboard:source:slideBack:"), function(self, _cmd, aView, aLocation, mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack)
{ with(self)
{
    objj_msgSend(_window, "dragView:at:offset:event:pasteboard:source:slideBack:", aView, objj_msgSend(self, "convertPoint:toView:", aLocation, nil), mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack);
}
}), new objj_method(sel_getUid("registerForDraggedTypes:"), function(self, _cmd, pasteboardTypes)
{ with(self)
{
    if (!pasteboardTypes || !objj_msgSend(pasteboardTypes, "count"))
        return;
    var theWindow = objj_msgSend(self, "window");
    objj_msgSend(theWindow, "_noteUnregisteredDraggedTypes:", _registeredDraggedTypes);
    objj_msgSend(_registeredDraggedTypes, "addObjectsFromArray:", pasteboardTypes)
    objj_msgSend(theWindow, "_noteRegisteredDraggedTypes:", _registeredDraggedTypes);
    _registeredDraggedTypesArray = nil;
}
}), new objj_method(sel_getUid("registeredDraggedTypes"), function(self, _cmd)
{ with(self)
{
    if (!_registeredDraggedTypesArray)
        _registeredDraggedTypesArray = objj_msgSend(_registeredDraggedTypes, "allObjects");
    return _registeredDraggedTypesArray;
}
}), new objj_method(sel_getUid("unregisterDraggedTypes"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "window"), "_noteUnregisteredDraggedTypes:", _registeredDraggedTypes);
    _registeredDraggedTypes = objj_msgSend(CPSet, "set");
    _registeredDraggedTypesArray = [];
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
}
}), new objj_method(sel_getUid("setNeedsDisplay:"), function(self, _cmd, aFlag)
{ with(self)
{
    if (aFlag)
        objj_msgSend(self, "setNeedsDisplayInRect:", objj_msgSend(self, "bounds"));
}
}), new objj_method(sel_getUid("setNeedsDisplayInRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if (!(_viewClassFlags & CPViewHasCustomDrawRect))
        return;
    if ((aRect.size.width <= 0.0 || aRect.size.height <= 0.0))
        return;
    if (_dirtyRect && !(_dirtyRect.size.width <= 0.0 || _dirtyRect.size.height <= 0.0))
        _dirtyRect = CGRectUnion(aRect, _dirtyRect);
    else
        _dirtyRect = { origin: { x:aRect.origin.x, y:aRect.origin.y }, size: { width:aRect.size.width, height:aRect.size.height } };
    _CPDisplayServerAddDisplayObject(self);
}
}), new objj_method(sel_getUid("needsDisplay"), function(self, _cmd)
{ with(self)
{
    return _dirtyRect && !(_dirtyRect.size.width <= 0.0 || _dirtyRect.size.height <= 0.0);
}
}), new objj_method(sel_getUid("displayIfNeeded"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(self, "needsDisplay"))
        objj_msgSend(self, "displayRect:", _dirtyRect);
}
}), new objj_method(sel_getUid("display"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "displayRect:", objj_msgSend(self, "visibleRect"));
}
}), new objj_method(sel_getUid("displayIfNeededInRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if (objj_msgSend(self, "needsDisplay"))
        objj_msgSend(self, "displayRect:", aRect);
}
}), new objj_method(sel_getUid("displayRect:"), function(self, _cmd, aRect)
{ with(self)
{
    objj_msgSend(self, "viewWillDraw");
    objj_msgSend(self, "displayRectIgnoringOpacity:inContext:", aRect, nil);
    _dirtyRect = NULL;
}
}), new objj_method(sel_getUid("displayRectIgnoringOpacity:inContext:"), function(self, _cmd, aRect, aGraphicsContext)
{ with(self)
{
    objj_msgSend(self, "lockFocus");
    CGContextClearRect(objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"), aRect);
    objj_msgSend(self, "drawRect:", aRect);
    objj_msgSend(self, "unlockFocus");
}
}), new objj_method(sel_getUid("viewWillDraw"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("lockFocus"), function(self, _cmd)
{ with(self)
{
    if (!_graphicsContext)
    {
        var graphicsPort = CGBitmapGraphicsContextCreate();
        _DOMContentsElement = graphicsPort.DOMElement;
        _DOMContentsElement.style.zIndex = -100;
        _DOMContentsElement.style.overflow = "hidden";
        _DOMContentsElement.style.position = "absolute";
        _DOMContentsElement.style.visibility = "visible";
        _DOMContentsElement.width = ROUND((_frame.size.width));
        _DOMContentsElement.height = ROUND((_frame.size.height));
        _DOMContentsElement.style.top = "0px";
        _DOMContentsElement.style.left = "0px";
        _DOMContentsElement.style.width = ROUND((_frame.size.width)) + "px";
        _DOMContentsElement.style.height = ROUND((_frame.size.height)) + "px";
        _DOMElement.appendChild(_DOMContentsElement);
        _graphicsContext = objj_msgSend(CPGraphicsContext, "graphicsContextWithGraphicsPort:flipped:", graphicsPort, YES);
    }
    objj_msgSend(CPGraphicsContext, "setCurrentContext:", _graphicsContext);
    CGContextSaveGState(objj_msgSend(_graphicsContext, "graphicsPort"));
}
}), new objj_method(sel_getUid("unlockFocus"), function(self, _cmd)
{ with(self)
{
    CGContextRestoreGState(objj_msgSend(_graphicsContext, "graphicsPort"));
    objj_msgSend(CPGraphicsContext, "setCurrentContext:", nil);
}
}), new objj_method(sel_getUid("setNeedsLayout"), function(self, _cmd)
{ with(self)
{
    if (!(_viewClassFlags & CPViewHasCustomLayoutSubviews))
        return;
    _needsLayout = YES;
    _CPDisplayServerAddLayoutObject(self);
}
}), new objj_method(sel_getUid("layoutIfNeeded"), function(self, _cmd)
{ with(self)
{
    if (_needsLayout)
    {
        _needsLayout = NO;
        objj_msgSend(self, "layoutSubviews");
    }
}
}), new objj_method(sel_getUid("layoutSubviews"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("isOpaque"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("visibleRect"), function(self, _cmd)
{ with(self)
{
    if (!_superview)
        return _bounds;
    return CGRectIntersection(objj_msgSend(self, "convertRect:fromView:", objj_msgSend(_superview, "visibleRect"), _superview), _bounds);
}
}), new objj_method(sel_getUid("_enclosingClipView"), function(self, _cmd)
{ with(self)
{
    var superview = _superview,
        clipViewClass = objj_msgSend(CPClipView, "class");
    while(superview && !objj_msgSend(superview, "isKindOfClass:", clipViewClass))
        superview = superview._superview;
    return superview;
}
}), new objj_method(sel_getUid("scrollPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var clipView = objj_msgSend(self, "_enclosingClipView");
    if (!clipView)
        return;
    objj_msgSend(clipView, "scrollToPoint:", objj_msgSend(self, "convertPoint:toView:", aPoint, clipView));
}
}), new objj_method(sel_getUid("scrollRectToVisible:"), function(self, _cmd, aRect)
{ with(self)
{
    var visibleRect = objj_msgSend(self, "visibleRect");
    aRect = CGRectIntersection(aRect, _bounds);
    if ((aRect.size.width <= 0.0 || aRect.size.height <= 0.0) || CGRectContainsRect(visibleRect, aRect))
        return NO;
    var enclosingClipView = objj_msgSend(self, "_enclosingClipView");
    if (!enclosingClipView)
        return NO;
    var scrollPoint = { x:visibleRect.origin.x, y:visibleRect.origin.y };
    if ((aRect.origin.x) <= (visibleRect.origin.x))
        scrollPoint.x = (aRect.origin.x);
    else if ((aRect.origin.x + aRect.size.width) > (visibleRect.origin.x + visibleRect.size.width))
        scrollPoint.x += (aRect.origin.x + aRect.size.width) - (visibleRect.origin.x + visibleRect.size.width);
    if ((aRect.origin.y) <= (visibleRect.origin.y))
        scrollPoint.y = CGRectGetMinY(aRect);
    else if ((aRect.origin.y + aRect.size.height) > (visibleRect.origin.y + visibleRect.size.height))
        scrollPoint.y += (aRect.origin.y + aRect.size.height) - (visibleRect.origin.y + visibleRect.size.height);
    objj_msgSend(enclosingClipView, "scrollToPoint:", CGPointMake(scrollPoint.x, scrollPoint.y));
    return YES;
}
}), new objj_method(sel_getUid("autoscroll:"), function(self, _cmd, anEvent)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "superview"), "autoscroll:", anEvent);
}
}), new objj_method(sel_getUid("adjustScroll:"), function(self, _cmd, proposedVisibleRect)
{ with(self)
{
    return proposedVisibleRect;
}
}), new objj_method(sel_getUid("scrollRect:by:"), function(self, _cmd, aRect, anAmount)
{ with(self)
{
}
}), new objj_method(sel_getUid("enclosingScrollView"), function(self, _cmd)
{ with(self)
{
    var superview = _superview,
        scrollViewClass = objj_msgSend(CPScrollView, "class");
    while(superview && !objj_msgSend(superview, "isKindOfClass:", scrollViewClass))
        superview = superview._superview;
    return superview;
}
}), new objj_method(sel_getUid("scrollClipView:toPoint:"), function(self, _cmd, aClipView, aPoint)
{ with(self)
{
    objj_msgSend(aClipView, "scrollToPoint:", aPoint);
}
}), new objj_method(sel_getUid("reflectScrolledClipView:"), function(self, _cmd, aClipView)
{ with(self)
{
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self !== objj_msgSend(CPView, "class"))
        return;
    DOMElementPrototype = document.createElement("div");
    var style = DOMElementPrototype.style;
    style.overflow = "hidden";
    style.position = "absolute";
    style.visibility = "visible";
    style.zIndex = 0;
    CachedNotificationCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
}
}), new objj_method(sel_getUid("keyPathsForValuesAffectingFrame"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPSet, "setWithObjects:", "frameOrigin", "frameSize");
}
}), new objj_method(sel_getUid("keyPathsForValuesAffectingBounds"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPSet, "setWithObjects:", "boundsOrigin", "boundsSize");
}
})]);
}
{
var the_class = objj_getClass("CPView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("performKeyEquivalent:"), function(self, _cmd, anEvent)
{ with(self)
{
    var count = objj_msgSend(_subviews, "count");
    while (count--)
        if (objj_msgSend(_subviews[count], "performKeyEquivalent:", anEvent))
            return YES;
    return NO;
}
}), new objj_method(sel_getUid("canBecomeKeyView"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "acceptsFirstResponder") && !objj_msgSend(self, "isHiddenOrHasHiddenAncestor");
}
}), new objj_method(sel_getUid("nextKeyView"), function(self, _cmd)
{ with(self)
{
    return _nextKeyView;
}
}), new objj_method(sel_getUid("nextValidKeyView"), function(self, _cmd)
{ with(self)
{
    var result = objj_msgSend(self, "nextKeyView");
    while (result && !objj_msgSend(result, "canBecomeKeyView"))
        result = objj_msgSend(result, "nextKeyView");
    return result;
}
}), new objj_method(sel_getUid("previousKeyView"), function(self, _cmd)
{ with(self)
{
    return _previousKeyView;
}
}), new objj_method(sel_getUid("previousValidKeyView"), function(self, _cmd)
{ with(self)
{
    var result = objj_msgSend(self, "previousKeyView");
    while (result && !objj_msgSend(result, "canBecomeKeyView"))
        result = objj_msgSend(result, "previousKeyView");
    return result;
}
}), new objj_method(sel_getUid("_setPreviousKeyView:"), function(self, _cmd, previous)
{ with(self)
{
    _previousKeyView = previous;
}
}), new objj_method(sel_getUid("setNextKeyView:"), function(self, _cmd, next)
{ with(self)
{
    _nextKeyView = next;
    objj_msgSend(_nextKeyView, "_setPreviousKeyView:", self);
}
})]);
}
{
var the_class = objj_getClass("CPView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("setLayer:"), function(self, _cmd, aLayer)
{ with(self)
{
    if (_layer == aLayer)
        return;
    if (_layer)
    {
        _layer._owningView = nil;
        _DOMElement.removeChild(_layer._DOMElement);
    }
    _layer = aLayer;
    if (_layer)
    {
        var bounds = CGRectMakeCopy(objj_msgSend(self, "bounds"));
        objj_msgSend(_layer, "_setOwningView:", self);
        _layer._DOMElement.style.zIndex = 100;
        _DOMElement.appendChild(_layer._DOMElement);
    }
}
}), new objj_method(sel_getUid("layer"), function(self, _cmd)
{ with(self)
{
    return _layer;
}
}), new objj_method(sel_getUid("setWantsLayer:"), function(self, _cmd, aFlag)
{ with(self)
{
    _wantsLayer = !!aFlag;
}
}), new objj_method(sel_getUid("wantsLayer"), function(self, _cmd)
{ with(self)
{
    return _wantsLayer;
}
})]);
}
{
var the_class = objj_getClass("CPView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("themeState"), function(self, _cmd)
{ with(self)
{
    return _themeState;
}
}), new objj_method(sel_getUid("hasThemeState:"), function(self, _cmd, aState)
{ with(self)
{
    return !!(_themeState & ((typeof aState === "string") ? CPThemeState(aState) : aState));
}
}), new objj_method(sel_getUid("setThemeState:"), function(self, _cmd, aState)
{ with(self)
{
    var newState = (typeof aState === "string") ? CPThemeState(aState) : aState;
    if (_themeState & newState)
        return NO;
    _themeState |= newState;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
    return YES;
}
}), new objj_method(sel_getUid("unsetThemeState:"), function(self, _cmd, aState)
{ with(self)
{
    var newState = ((typeof aState === "string") ? CPThemeState(aState) : aState);
    if (!(_themeState & newState))
        return NO;
    _themeState &= ~newState;
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
    return YES;
}
}), new objj_method(sel_getUid("_loadThemeAttributes"), function(self, _cmd)
{ with(self)
{
    var theClass = objj_msgSend(self, "class"),
        attributes = objj_msgSend(theClass, "_themeAttributes"),
        count = attributes.length;
    if (!count)
        return;
    var theme = objj_msgSend(self, "theme"),
        themeClass = objj_msgSend(theClass, "themeClass");
    _themeAttributes = {};
    while (count--)
    {
        var attributeName = attributes[count--],
            attribute = objj_msgSend(objj_msgSend(_CPThemeAttribute, "alloc"), "initWithName:defaultValue:", attributeName, attributes[count]);
        objj_msgSend(attribute, "setParentAttribute:", objj_msgSend(theme, "_attributeWithName:forClass:", attributeName, themeClass));
        _themeAttributes[attributeName] = attribute;
    }
}
}), new objj_method(sel_getUid("setTheme:"), function(self, _cmd, aTheme)
{ with(self)
{
    if (_theme === aTheme)
        return;
    _theme = aTheme;
    objj_msgSend(self, "viewDidChangeTheme");
}
}), new objj_method(sel_getUid("theme"), function(self, _cmd)
{ with(self)
{
    return _theme;
}
}), new objj_method(sel_getUid("viewDidChangeTheme"), function(self, _cmd)
{ with(self)
{
    if (!_themeAttributes)
        return;
    var theme = objj_msgSend(self, "theme"),
        themeClass = objj_msgSend(objj_msgSend(self, "class"), "themeClass");
    for (var attributeName in _themeAttributes)
        if (_themeAttributes.hasOwnProperty(attributeName))
            objj_msgSend(_themeAttributes[attributeName], "setParentAttribute:", objj_msgSend(theme, "_attributeWithName:forClass:", attributeName, themeClass));
    objj_msgSend(self, "setNeedsLayout");
    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("_themeAttributeDictionary"), function(self, _cmd)
{ with(self)
{
    var dictionary = objj_msgSend(CPDictionary, "dictionary");
    if (_themeAttributes)
    {
        var theme = objj_msgSend(self, "theme");
        for (var attributeName in _themeAttributes)
            if (_themeAttributes.hasOwnProperty(attributeName))
                objj_msgSend(dictionary, "setObject:forKey:", _themeAttributes[attributeName], attributeName);
    }
    return dictionary;
}
}), new objj_method(sel_getUid("setValue:forThemeAttribute:inState:"), function(self, _cmd, aValue, aName, aState)
{ with(self)
{
    if (!_themeAttributes || !_themeAttributes[aName])
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, objj_msgSend(self, "className") + " does not contain theme attribute '" + aName + "'");
    var currentValue = objj_msgSend(self, "currentValueForThemeAttribute:", aName);
    objj_msgSend(_themeAttributes[aName], "setValue:forState:", aValue, aState);
    if (objj_msgSend(self, "currentValueForThemeAttribute:", aName) === currentValue)
        return;
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("setValue:forThemeAttribute:"), function(self, _cmd, aValue, aName)
{ with(self)
{
    if (!_themeAttributes || !_themeAttributes[aName])
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, objj_msgSend(self, "className") + " does not contain theme attribute '" + aName + "'");
    var currentValue = objj_msgSend(self, "currentValueForThemeAttribute:", aName);
    objj_msgSend(_themeAttributes[aName], "setValue:", aValue);
    if (objj_msgSend(self, "currentValueForThemeAttribute:", aName) === currentValue)
        return;
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "setNeedsLayout");
}
}), new objj_method(sel_getUid("valueForThemeAttribute:inState:"), function(self, _cmd, aName, aState)
{ with(self)
{
    if (!_themeAttributes || !_themeAttributes[aName])
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, objj_msgSend(self, "className") + " does not contain theme attribute '" + aName + "'");
    return objj_msgSend(_themeAttributes[aName], "valueForState:", aState);
}
}), new objj_method(sel_getUid("valueForThemeAttribute:"), function(self, _cmd, aName)
{ with(self)
{
    if (!_themeAttributes || !_themeAttributes[aName])
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, objj_msgSend(self, "className") + " does not contain theme attribute '" + aName + "'");
    return objj_msgSend(_themeAttributes[aName], "value");
}
}), new objj_method(sel_getUid("currentValueForThemeAttribute:"), function(self, _cmd, aName)
{ with(self)
{
    if (!_themeAttributes || !_themeAttributes[aName])
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, objj_msgSend(self, "className") + " does not contain theme attribute '" + aName + "'");
    return objj_msgSend(_themeAttributes[aName], "valueForState:", _themeState);
}
}), new objj_method(sel_getUid("createEphemeralSubviewNamed:"), function(self, _cmd, aViewName)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("rectForEphemeralSubviewNamed:"), function(self, _cmd, aViewName)
{ with(self)
{
    return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
}
}), new objj_method(sel_getUid("layoutEphemeralSubviewNamed:positioned:relativeToEphemeralSubviewNamed:"), function(self, _cmd, aViewName, anOrderingMode, relativeToViewName)
{ with(self)
{
    if (!_ephemeralSubviewsForNames)
    {
        _ephemeralSubviewsForNames = {};
        _ephemeralSubviews = objj_msgSend(CPSet, "set");
    }
    var frame = objj_msgSend(self, "rectForEphemeralSubviewNamed:", aViewName);
    if (frame && !(frame.size.width <= 0.0 || frame.size.height <= 0.0))
    {
        if (!_ephemeralSubviewsForNames[aViewName])
        {
            _ephemeralSubviewsForNames[aViewName] = objj_msgSend(self, "createEphemeralSubviewNamed:", aViewName);
            objj_msgSend(_ephemeralSubviews, "addObject:", _ephemeralSubviewsForNames[aViewName]);
            if (_ephemeralSubviewsForNames[aViewName])
                objj_msgSend(self, "addSubview:positioned:relativeTo:", _ephemeralSubviewsForNames[aViewName], anOrderingMode, _ephemeralSubviewsForNames[relativeToViewName]);
        }
        if (_ephemeralSubviewsForNames[aViewName])
            objj_msgSend(_ephemeralSubviewsForNames[aViewName], "setFrame:", frame);
    }
    else if (_ephemeralSubviewsForNames[aViewName])
    {
        objj_msgSend(_ephemeralSubviewsForNames[aViewName], "removeFromSuperview");
        objj_msgSend(_ephemeralSubviews, "removeObject:", _ephemeralSubviewsForNames[aViewName]);
        delete _ephemeralSubviewsForNames[aViewName];
    }
    return _ephemeralSubviewsForNames[aViewName];
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("themeClass"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("themeAttributes"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("_themeAttributes"), function(self, _cmd)
{ with(self)
{
    if (!CachedThemeAttributes)
        CachedThemeAttributes = {};
    var theClass = objj_msgSend(self, "class"),
        CPViewClass = objj_msgSend(CPView, "class"),
        attributes = [],
        nullValue = objj_msgSend(CPNull, "null");
    for (; theClass && theClass !== CPViewClass; theClass = objj_msgSend(theClass, "superclass"))
    {
        var cachedAttributes = CachedThemeAttributes[class_getName(theClass)];
        if (cachedAttributes)
        {
            attributes = attributes.length ? attributes.concat(cachedAttributes) : attributes;
            CachedThemeAttributes[objj_msgSend(self, "className")] = attributes;
            break;
        }
        var attributeDictionary = objj_msgSend(theClass, "themeAttributes");
        if (!attributeDictionary)
            continue;
        var attributeKeys = objj_msgSend(attributeDictionary, "allKeys"),
            attributeCount = attributeKeys.length;
        while (attributeCount--)
        {
            var attributeName = attributeKeys[attributeCount],
                attributeValue = objj_msgSend(attributeDictionary, "objectForKey:", attributeName);
            attributes.push(attributeValue === nullValue ? nil : attributeValue);
            attributes.push(attributeName);
        }
    }
    return attributes;
}
})]);
}
var CPViewAutoresizingMaskKey = "CPViewAutoresizingMask",
    CPViewAutoresizesSubviewsKey = "CPViewAutoresizesSubviews",
    CPViewBackgroundColorKey = "CPViewBackgroundColor",
    CPViewBoundsKey = "CPViewBoundsKey",
    CPViewFrameKey = "CPViewFrameKey",
    CPViewHitTestsKey = "CPViewHitTestsKey",
    CPViewIsHiddenKey = "CPViewIsHiddenKey",
    CPViewOpacityKey = "CPViewOpacityKey",
    CPViewSubviewsKey = "CPViewSubviewsKey",
    CPViewSuperviewKey = "CPViewSuperviewKey",
    CPViewTagKey = "CPViewTagKey",
    CPViewThemeStateKey = "CPViewThemeStateKey",
    CPViewWindowKey = "CPViewWindowKey",
    CPViewNextKeyViewKey = "CPViewNextKeyViewKey",
    CPViewPreviousKeyViewKey = "CPViewPreviousKeyViewKey";
{
var the_class = objj_getClass("CPView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    _DOMElement = DOMElementPrototype.cloneNode(false);
    _frame = objj_msgSend(aCoder, "decodeRectForKey:", CPViewFrameKey);
    _bounds = objj_msgSend(aCoder, "decodeRectForKey:", CPViewBoundsKey);
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPView").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _tag = objj_msgSend(aCoder, "containsValueForKey:", CPViewTagKey) ? objj_msgSend(aCoder, "decodeIntForKey:", CPViewTagKey) : -1;
        _window = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewWindowKey);
        _subviews = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewSubviewsKey) || [];
        _superview = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewSuperviewKey);
        _registeredDraggedTypes = objj_msgSend(CPSet, "set");
        _registeredDraggedTypesArray = [];
        _autoresizingMask = objj_msgSend(aCoder, "decodeIntForKey:", CPViewAutoresizingMaskKey) || CPViewNotSizable;
        _autoresizesSubviews = !objj_msgSend(aCoder, "containsValueForKey:", CPViewAutoresizesSubviewsKey) || objj_msgSend(aCoder, "decodeBoolForKey:", CPViewAutoresizesSubviewsKey);
        _hitTests = !objj_msgSend(aCoder, "containsValueForKey:", CPViewHitTestsKey) || objj_msgSend(aCoder, "decodeObjectForKey:", CPViewHitTestsKey);
        _DOMImageParts = [];
        _DOMImageSizes = [];
        if (NULL) var ____p = { x:CGPointMake((_frame.origin.x), (_frame.origin.y)).x * NULL.a + CGPointMake((_frame.origin.x), (_frame.origin.y)).y * NULL.c + NULL.tx, y:CGPointMake((_frame.origin.x), (_frame.origin.y)).x * NULL.b + CGPointMake((_frame.origin.x), (_frame.origin.y)).y * NULL.d + NULL.ty }; else var ____p = { x:(_frame.origin.x), y:(_frame.origin.y) }; _DOMElement.style.left = ROUND(____p.x) + "px";_DOMElement.style.top = ROUND(____p.y) + "px";;
        _DOMElement.style.width = MAX(0.0, ROUND((_frame.size.width))) + "px"; _DOMElement.style.height = MAX(0.0, ROUND((_frame.size.height))) + "px";;
        var index = 0,
            count = _subviews.length;
        for (; index < count; ++index)
        {
            _DOMElement.appendChild(_subviews[index]._DOMElement);
        }
        if (objj_msgSend(aCoder, "containsValueForKey:", CPViewIsHiddenKey))
            objj_msgSend(self, "setHidden:", objj_msgSend(aCoder, "decodeBoolForKey:", CPViewIsHiddenKey));
        else
            _isHidden = NO;
        if (objj_msgSend(aCoder, "containsValueForKey:", CPViewOpacityKey))
            objj_msgSend(self, "setAlphaValue:", objj_msgSend(aCoder, "decodeIntForKey:", CPViewOpacityKey));
        else
            _opacity = 1.0;
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(aCoder, "decodeObjectForKey:", CPViewBackgroundColorKey));
        objj_msgSend(self, "setupViewFlags");
        _theme = objj_msgSend(CPTheme, "defaultTheme");
        _themeState = CPThemeState(objj_msgSend(aCoder, "decodeIntForKey:", CPViewThemeStateKey));
        _themeAttributes = {};
        var theClass = objj_msgSend(self, "class"),
            themeClass = objj_msgSend(theClass, "themeClass"),
            attributes = objj_msgSend(theClass, "_themeAttributes"),
            count = attributes.length;
        while (count--)
        {
            var attributeName = attributes[count--];
            _themeAttributes[attributeName] = CPThemeAttributeDecode(aCoder, attributeName, attributes[count], _theme, themeClass);
        }
        objj_msgSend(self, "setNeedsDisplay:", YES);
        objj_msgSend(self, "setNeedsLayout");
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPView").super_class }, "encodeWithCoder:", aCoder);
    if (_tag !== -1)
        objj_msgSend(aCoder, "encodeInt:forKey:", _tag, CPViewTagKey);
    objj_msgSend(aCoder, "encodeRect:forKey:", _frame, CPViewFrameKey);
    objj_msgSend(aCoder, "encodeRect:forKey:", _bounds, CPViewBoundsKey);
    if (_window !== nil)
        objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _window, CPViewWindowKey);
    var count = objj_msgSend(_subviews, "count"),
        encodedSubviews = _subviews;
    if (count > 0 && objj_msgSend(_ephemeralSubviews, "count") > 0)
    {
        encodedSubviews = objj_msgSend(encodedSubviews, "copy");
        while (count--)
            if (objj_msgSend(_ephemeralSubviews, "containsObject:", encodedSubviews[count]))
                encodedSubviews.splice(count, 1);
    }
    if (encodedSubviews.length > 0)
        objj_msgSend(aCoder, "encodeObject:forKey:", encodedSubviews, CPViewSubviewsKey);
    if (_superview !== nil)
        objj_msgSend(aCoder, "encodeConditionalObject:forKey:", _superview, CPViewSuperviewKey);
    if (_autoresizingMask !== CPViewNotSizable)
        objj_msgSend(aCoder, "encodeInt:forKey:", _autoresizingMask, CPViewAutoresizingMaskKey);
    if (!_autoresizesSubviews)
        objj_msgSend(aCoder, "encodeBool:forKey:", _autoresizesSubviews, CPViewAutoresizesSubviewsKey);
    if (_backgroundColor !== nil)
        objj_msgSend(aCoder, "encodeObject:forKey:", _backgroundColor, CPViewBackgroundColorKey);
    if (_hitTests !== YES)
        objj_msgSend(aCoder, "encodeBool:forKey:", _hitTests, CPViewHitTestsKey);
    if (_opacity !== 1.0)
        objj_msgSend(aCoder, "encodeFloat:forKey:", _opacity, CPViewOpacityKey);
    if (_isHidden)
        objj_msgSend(aCoder, "encodeBool:forKey:", _isHidden, CPViewIsHiddenKey);
    var nextKeyView = objj_msgSend(self, "nextKeyView");
    if (nextKeyView !== nil)
        objj_msgSend(aCoder, "encodeConditionalObject:forKey:", nextKeyView, CPViewNextKeyViewKey);
    var previousKeyView = objj_msgSend(self, "previousKeyView");
    if (previousKeyView !== nil)
        objj_msgSend(aCoder, "encodeConditionalObject:forKey:", previousKeyView, CPViewPreviousKeyViewKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", CPThemeStateName(_themeState), CPViewThemeStateKey);
    for (var attributeName in _themeAttributes)
        if (_themeAttributes.hasOwnProperty(attributeName))
            CPThemeAttributeEncode(aCoder, _themeAttributes[attributeName]);
}
})]);
}
var _CPViewFullScreenModeStateMake = function(aView)
{
    var superview = aView._superview;
    return { autoresizingMask:aView._autoresizingMask, frame:CGRectMakeCopy(aView._frame), index:(superview ? objj_msgSend(superview._subviews, "indexOfObjectIdenticalTo:", aView) : 0), superview:superview };
}
var _CPViewGetTransform = function( fromView, toView)
{
    var transform = CGAffineTransformMakeIdentity(),
        sameWindow = YES,
        fromWindow = nil,
        toWindow = nil;
    if (fromView)
    {
        var view = fromView;
        while (view && view != toView)
        {
            var frame = view._frame;
            transform.tx += (frame.origin.x);
            transform.ty += (frame.origin.y);
            if (view._boundsTransform)
            {
                var tx = transform.tx * view._boundsTransform.a + transform.ty * view._boundsTransform.c + view._boundsTransform.tx;transform.ty = transform.tx * view._boundsTransform.b + transform.ty * view._boundsTransform.d + view._boundsTransform.ty;transform.tx = tx;var a = transform.a * view._boundsTransform.a + transform.b * view._boundsTransform.c, b = transform.a * view._boundsTransform.b + transform.b * view._boundsTransform.d, c = transform.c * view._boundsTransform.a + transform.d * view._boundsTransform.c;transform.d = transform.c * view._boundsTransform.b + transform.d * view._boundsTransform.d;transform.a = a;transform.b = b;transform.c = c;;
            }
            view = view._superview;
        }
        if (view === toView)
            return transform;
        else if (fromView && toView)
        {
            fromWindow = objj_msgSend(fromView, "window");
            toWindow = objj_msgSend(toView, "window");
            if (fromWindow && toWindow && fromWindow !== toWindow)
            {
                sameWindow = NO;
                var frame = objj_msgSend(fromWindow, "frame");
                transform.tx += (frame.origin.x);
                transform.ty += (frame.origin.y);
            }
        }
    }
    var view = toView;
    while (view)
    {
        var frame = view._frame;
        transform.tx -= (frame.origin.x);
        transform.ty -= (frame.origin.y);
        if (view._boundsTransform)
        {
            var tx = transform.tx * view._inverseBoundsTransform.a + transform.ty * view._inverseBoundsTransform.c + view._inverseBoundsTransform.tx;transform.ty = transform.tx * view._inverseBoundsTransform.b + transform.ty * view._inverseBoundsTransform.d + view._inverseBoundsTransform.ty;transform.tx = tx;var a = transform.a * view._inverseBoundsTransform.a + transform.b * view._inverseBoundsTransform.c, b = transform.a * view._inverseBoundsTransform.b + transform.b * view._inverseBoundsTransform.d, c = transform.c * view._inverseBoundsTransform.a + transform.d * view._inverseBoundsTransform.c;transform.d = transform.c * view._inverseBoundsTransform.b + transform.d * view._inverseBoundsTransform.d;transform.a = a;transform.b = b;transform.c = c;;
        }
        view = view._superview;
    }
    if (!sameWindow)
    {
        var frame = objj_msgSend(toWindow, "frame");
        transform.tx -= (frame.origin.x);
        transform.ty -= (frame.origin.y);
    }
    return transform;
}

p;17;CPViewAnimation.jt;6595;@STATIC;1.0;I;20;AppKit/CPAnimation.jt;6551;objj_executeFile("AppKit/CPAnimation.j", false);
CPViewAnimationTargetKey = "CPViewAnimationTarget";
CPViewAnimationStartFrameKey = "CPViewAnimationStartFrame";
CPViewAnimationEndFrameKey = "CPViewAnimationEndFrame";
CPViewAnimationEffectKey = "CPViewAnimationEffect";
CPViewAnimationFadeInEffect = "CPViewAnimationFadeIn";
CPViewAnimationFadeOutEffect = "CPViewAnimationFadeOut";
{var the_class = objj_allocateClassPair(CPAnimation, "CPViewAnimation"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_viewAnimations")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithViewAnimations:"), function(self, _cmd, viewAnimations)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewAnimation").super_class }, "initWithDuration:animationCurve:", 0.5, CPAnimationLinear))
    {
        objj_msgSend(self, "setViewAnimations:", viewAnimations);
    }
    return self;
}
}), new objj_method(sel_getUid("startAnimation"), function(self, _cmd)
{ with(self)
{
    var animationIndex = objj_msgSend(_viewAnimations, "count");
    while (animationIndex--)
    {
        var dictionary = objj_msgSend(_viewAnimations, "objectAtIndex:", animationIndex),
            view = objj_msgSend(self, "_targetView:", dictionary),
            startFrame = objj_msgSend(self, "_startFrame:", dictionary);
        objj_msgSend(view, "setFrame:", startFrame);
        var effect = objj_msgSend(self, "_effect:", dictionary);
        if (effect === CPViewAnimationFadeInEffect)
        {
            objj_msgSend(view, "setAlphaValue:", 0.0);
            objj_msgSend(view, "setHidden:", NO);
        }
        else if (effect === CPViewAnimationFadeOutEffect)
            objj_msgSend(view, "setAlphaValue:", 1.0);
    }
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewAnimation").super_class }, "startAnimation");
}
}), new objj_method(sel_getUid("setCurrentProgress:"), function(self, _cmd, progress)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewAnimation").super_class }, "setCurrentProgress:", progress);
    var animationIndex = objj_msgSend(_viewAnimations, "count");
    while (animationIndex--)
    {
        var dictionary = objj_msgSend(_viewAnimations, "objectAtIndex:", animationIndex),
            view = objj_msgSend(self, "_targetView:", dictionary)
            startFrame = objj_msgSend(self, "_startFrame:", dictionary)
            endFrame = objj_msgSend(self, "_endFrame:", dictionary)
            differenceFrame = CPRectMakeZero();
        differenceFrame.origin.x = endFrame.origin.x - startFrame.origin.x;
        differenceFrame.origin.y = endFrame.origin.y - startFrame.origin.y;
        differenceFrame.size.width = endFrame.size.width - startFrame.size.width;
        differenceFrame.size.height = endFrame.size.height - startFrame.size.height;
        var intermediateFrame = CPRectMakeZero();
        intermediateFrame.origin.x = startFrame.origin.x + differenceFrame.origin.x * progress;
        intermediateFrame.origin.y = startFrame.origin.y + differenceFrame.origin.y * progress;
        intermediateFrame.size.width = startFrame.size.width + differenceFrame.size.width * progress;
        intermediateFrame.size.height = startFrame.size.height + differenceFrame.size.height * progress;
        objj_msgSend(view, "setFrame:", intermediateFrame);
        var effect = objj_msgSend(self, "_effect:", dictionary);
        if (effect === CPViewAnimationFadeInEffect)
            objj_msgSend(view, "setAlphaValue:", 1.0 * progress);
        else if (effect === CPViewAnimationFadeOutEffect)
            objj_msgSend(view, "setAlphaValue:", 1.0 + ( 0.0 - 1.0 ) * progress);
        if (progress === 1.0)
            objj_msgSend(view, "setHidden:", CPRectIsNull(endFrame) || objj_msgSend(view, "alphaValue") === 0.0);
    }
}
}), new objj_method(sel_getUid("stopAnimation"), function(self, _cmd)
{ with(self)
{
    var animationIndex = objj_msgSend(_viewAnimations, "count");
    while (animationIndex--)
    {
        var dictionary = objj_msgSend(_viewAnimations, "objectAtIndex:", animationIndex),
            view = objj_msgSend(self, "_targetView:", dictionary),
            endFrame = objj_msgSend(self, "_endFrame:", dictionary);
        objj_msgSend(view, "setFrame:", endFrame);
        var effect = objj_msgSend(self, "_effect:", dictionary);
        if (effect === CPViewAnimationFadeInEffect)
            objj_msgSend(view, "setAlphaValue:", 1.0);
        else if (effect === CPViewAnimationFadeOutEffect)
            objj_msgSend(view, "setAlphaValue:", 0.0);
        objj_msgSend(view, "setHidden:", CPRectIsNull(endFrame) || objj_msgSend(view, "alphaValue") === 0.0);
    }
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewAnimation").super_class }, "stopAnimation");
}
}), new objj_method(sel_getUid("_targetView:"), function(self, _cmd, dictionary)
{ with(self)
{
    var targetView = objj_msgSend(dictionary, "valueForKey:", CPViewAnimationTargetKey);
    if (!targetView)
        objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, objj_msgSend(CPString, "stringWithFormat:", "view animation: %@ does not have a target view", objj_msgSend(dictionary, "description")));
    return targetView;
}
}), new objj_method(sel_getUid("_startFrame:"), function(self, _cmd, dictionary)
{ with(self)
{
    var startFrame = objj_msgSend(dictionary, "valueForKey:", CPViewAnimationStartFrameKey);
    if (!startFrame)
        return objj_msgSend(objj_msgSend(self, "_targetView:", dictionary), "frame");
    return startFrame;
}
}), new objj_method(sel_getUid("_endFrame:"), function(self, _cmd, dictionary)
{ with(self)
{
    var endFrame = objj_msgSend(dictionary, "valueForKey:", CPViewAnimationEndFrameKey);
    if (!endFrame)
        return objj_msgSend(objj_msgSend(self, "_targetView:", dictionary), "frame");
    return endFrame;
}
}), new objj_method(sel_getUid("_effect:"), function(self, _cmd, dictionary)
{ with(self)
{
    return objj_msgSend(dictionary, "valueForKey:", CPViewAnimationEffectKey);
}
}), new objj_method(sel_getUid("viewAnimations"), function(self, _cmd)
{ with(self)
{
    return _viewAnimations;
}
}), new objj_method(sel_getUid("setViewAnimations:"), function(self, _cmd, viewAnimations)
{ with(self)
{
    if (viewAnimations != _viewAnimations)
    {
        objj_msgSend(self, "stopAnimation");
        _viewAnimations = objj_msgSend(viewAnimations, "copy");
    }
}
})]);
}

p;18;CPViewController.jt;6189;@STATIC;1.0;I;20;AppKit/CPResponder.jt;6145;objj_executeFile("AppKit/CPResponder.j", false);
var CPViewControllerCachedCibs;
{var the_class = objj_allocateClassPair(CPResponder, "CPViewController"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_view"), new objj_ivar("_representedObject"), new objj_ivar("_title"), new objj_ivar("_cibName"), new objj_ivar("_cibBundle"), new objj_ivar("_cibExternalNameTable")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("representedObject"), function(self, _cmd)
{ with(self)
{
return _representedObject;
}
}),
new objj_method(sel_getUid("setRepresentedObject:"), function(self, _cmd, newValue)
{ with(self)
{
_representedObject = newValue;
}
}),
new objj_method(sel_getUid("title"), function(self, _cmd)
{ with(self)
{
return _title;
}
}),
new objj_method(sel_getUid("setTitle:"), function(self, _cmd, newValue)
{ with(self)
{
_title = newValue;
}
}),
new objj_method(sel_getUid("cibName"), function(self, _cmd)
{ with(self)
{
return _cibName;
}
}),
new objj_method(sel_getUid("cibBundle"), function(self, _cmd)
{ with(self)
{
return _cibBundle;
}
}),
new objj_method(sel_getUid("cibExternalNameTable"), function(self, _cmd)
{ with(self)
{
return _cibExternalNameTable;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithCibName:bundle:", nil, nil);
}
}), new objj_method(sel_getUid("initWithCibName:bundle:"), function(self, _cmd, aCibNameOrNil, aCibBundleOrNil)
{ with(self)
{
    return objj_msgSend(self, "initWithCibName:bundle:externalNameTable:", aCibNameOrNil, aCibBundleOrNil, nil);
}
}), new objj_method(sel_getUid("initWithCibName:bundle:owner:"), function(self, _cmd, aCibNameOrNil, aCibBundleOrNil, anOwner)
{ with(self)
{
    return objj_msgSend(self, "initWithCibName:bundle:externalNameTable:", aCibNameOrNil, aCibBundleOrNil, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", anOwner, CPCibOwner));
}
}), new objj_method(sel_getUid("initWithCibName:bundle:externalNameTable:"), function(self, _cmd, aCibNameOrNil, aCibBundleOrNil, anExternalNameTable)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewController").super_class }, "init");
    if (self)
    {
        _cibName = aCibNameOrNil;
        _cibBundle = aCibBundleOrNil || objj_msgSend(CPBundle, "mainBundle");
        _cibExternalNameTable = anExternalNameTable || objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", self, CPCibOwner);
    }
    return self;
}
}), new objj_method(sel_getUid("loadView"), function(self, _cmd)
{ with(self)
{
    if (_view)
        return;
    var cib = objj_msgSend(CPViewControllerCachedCibs, "objectForKey:", _cibName);
    if (!cib)
    {
        cib = objj_msgSend(objj_msgSend(CPCib, "alloc"), "initWithContentsOfURL:", objj_msgSend(_cibBundle, "pathForResource:", _cibName + ".cib"));
        objj_msgSend(CPViewControllerCachedCibs, "setObject:forKey:", cib, _cibName);
    }
    objj_msgSend(cib, "instantiateCibWithExternalNameTable:", _cibExternalNameTable);
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    if (!_view)
    {
        var cibOwner = objj_msgSend(_cibExternalNameTable, "objectForKey:", CPCibOwner);
        if (objj_msgSend(cibOwner, "respondsToSelector:", sel_getUid("viewControllerWillLoadCib:")))
            objj_msgSend(cibOwner, "viewControllerWillLoadCib:", self);
        objj_msgSend(self, "loadView");
        if (_view === nil && objj_msgSend(cibOwner, "isKindOfClass:", objj_msgSend(CPDocument, "class")))
            objj_msgSend(self, "setView:", objj_msgSend(cibOwner, "valueForKey:", "view"));
        if (objj_msgSend(cibOwner, "respondsToSelector:", sel_getUid("viewControllerDidLoadCib:")))
            objj_msgSend(cibOwner, "viewControllerDidLoadCib:", self);
    }
    return _view;
}
}), new objj_method(sel_getUid("setView:"), function(self, _cmd, aView)
{ with(self)
{
    _view = aView;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self === CPViewController)
        CPViewControllerCachedCibs = objj_msgSend(CPDictionary, "dictionary");
}
})]);
}
var CPViewControllerViewKey = "CPViewControllerViewKey",
    CPViewControllerTitleKey = "CPViewControllerTitleKey",
    CPViewControllerCibNameKey = "CPViewControllerCibNameKey",
    CPViewControllerBundleKey = "CPViewControllerBundleKey";
{
var the_class = objj_getClass("CPViewController")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPViewController\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewController").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _view = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewControllerViewKey);
        _title = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewControllerTitleKey);
        _cibName = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewControllerCibNameKey);
        var bundlePath = objj_msgSend(aCoder, "decodeObjectForKey:", CPViewControllerBundleKey);
        _cibBundle = bundlePath ? objj_msgSend(CPBundle, "bundleWithPath:", bundlePath) : objj_msgSend(CPBundle, "mainBundle");
        _cibExternalNameTable = objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", self, CPCibOwner);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPViewController").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _view, CPViewControllerViewKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _title, CPViewControllerTitleKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _cibName, CPViewControllerCibNameKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", objj_msgSend(_cibBundle, "bundlePath"), CPViewControllerBundleKey);
}
})]);
}

p;11;CPWebView.jt;16128;@STATIC;1.0;I;15;AppKit/CPView.jt;16088;objj_executeFile("AppKit/CPView.j", false);
CPWebViewProgressStartedNotification = "CPWebViewProgressStartedNotification";
CPWebViewProgressFinishedNotification = "CPWebViewProgressFinishedNotification";
CPWebViewScrollAppKit = 1;
CPWebViewScrollNative = 2;
{var the_class = objj_allocateClassPair(CPView, "CPWebView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_scrollView"), new objj_ivar("_frameView"), new objj_ivar("_iframe"), new objj_ivar("_mainFrameURL"), new objj_ivar("_backwardStack"), new objj_ivar("_forwardStack"), new objj_ivar("_ignoreLoadStart"), new objj_ivar("_ignoreLoadEnd"), new objj_ivar("_downloadDelegate"), new objj_ivar("_frameLoadDelegate"), new objj_ivar("_policyDelegate"), new objj_ivar("_resourceLoadDelegate"), new objj_ivar("_UIDelegate"), new objj_ivar("_wso"), new objj_ivar("_url"), new objj_ivar("_html"), new objj_ivar("_loadCallback"), new objj_ivar("_scrollMode"), new objj_ivar("_scrollSize")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:frameName:groupName:"), function(self, _cmd, frameRect, frameName, groupName)
{ with(self)
{
    if (self = objj_msgSend(self, "initWithFrame:", frameRect))
    {
        _iframe.name = frameName;
    }
    return self
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWebView").super_class }, "initWithFrame:", aFrame))
    {
        _mainFrameURL = nil;
        _backwardStack = [];
        _forwardStack = [];
        _scrollMode = CPWebViewScrollNative;
        objj_msgSend(self, "_initDOMWithFrame:", aFrame);
    }
    return self;
}
}), new objj_method(sel_getUid("_initDOMWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    _ignoreLoadStart = YES;
    _ignoreLoadEnd = YES;
    _iframe = document.createElement("iframe");
    _iframe.name = "iframe_" + Math.floor(Math.random()*10000);
    _iframe.style.width = "100%";
    _iframe.style.height = "100%";
    _iframe.style.borderWidth = "0px";
    objj_msgSend(self, "setDrawsBackground:", YES);
    _loadCallback = function() {
     if (!_ignoreLoadStart)
     {
         objj_msgSend(self, "_startedLoading");
         if (_mainFrameURL)
             objj_msgSend(_backwardStack, "addObject:", _mainFrameURL);
            _mainFrameURL = _iframe.src;
            _mainFrameURL = _iframe.src;
         objj_msgSend(_forwardStack, "removeAllObjects");
     }
     else
            _ignoreLoadStart = NO;
     if (!_ignoreLoadEnd)
     {
            objj_msgSend(self, "_finishedLoading");
     }
     else
         _ignoreLoadEnd = NO;
        objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
 }
 if (_iframe.addEventListener)
     _iframe.addEventListener("load", _loadCallback, false);
 else if (_iframe.attachEvent)
  _iframe.attachEvent("onload", _loadCallback);
    _frameView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", objj_msgSend(self, "bounds"));
    objj_msgSend(_frameView, "setAutoresizingMask:", CPViewWidthSizable|CPViewHeightSizable);
    _scrollView = objj_msgSend(objj_msgSend(CPScrollView, "alloc"), "initWithFrame:", objj_msgSend(self, "bounds"));
    objj_msgSend(_scrollView, "setAutohidesScrollers:", YES);
    objj_msgSend(_scrollView, "setAutoresizingMask:", CPViewWidthSizable|CPViewHeightSizable);
    objj_msgSend(_scrollView, "setDocumentView:", _frameView);
    _frameView._DOMElement.appendChild(_iframe);
    objj_msgSend(self, "_setScrollMode:", _scrollMode);
    objj_msgSend(self, "addSubview:", _scrollView);
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWebView").super_class }, "setFrameSize:", aSize);
    objj_msgSend(self, "_resizeWebFrame");
}
}), new objj_method(sel_getUid("_resizeWebFrame"), function(self, _cmd)
{ with(self)
{
    if (_scrollMode === CPWebViewScrollAppKit)
    {
        if (_scrollSize)
        {
            objj_msgSend(_frameView, "setFrameSize:", _scrollSize);
        }
        else
        {
            objj_msgSend(_frameView, "setFrameSize:", objj_msgSend(_scrollView, "contentSize"));
            var win = null;
            try { win = objj_msgSend(self, "DOMWindow"); } catch (e) {}
            if (win && win.document)
            {
                var width = win.document.body.scrollWidth,
                    height = win.document.body.scrollHeight;
                _iframe.setAttribute("width", width);
                _iframe.setAttribute("height", height);
                objj_msgSend(_frameView, "setFrameSize:", CGSizeMake(width, height));
            }
            else
            {
                CPLog.warn("using default size 800*1600");
                objj_msgSend(_frameView, "setFrameSize:", CGSizeMake(800, 1600));
            }
        }
    }
}
}), new objj_method(sel_getUid("setScrollMode:"), function(self, _cmd, aScrollMode)
{ with(self)
{
    if (_scrollMode == aScrollMode)
        return;
    objj_msgSend(self, "_setScrollMode:", aScrollMode);
}
}), new objj_method(sel_getUid("_setScrollMode:"), function(self, _cmd, aScrollMode)
{ with(self)
{
    _scrollMode = aScrollMode;
    _ignoreLoadStart = YES;
    _ignoreLoadEnd = YES;
    var parent = _iframe.parentNode;
    parent.removeChild(_iframe);
    if (_scrollMode === CPWebViewScrollAppKit)
    {
        objj_msgSend(_scrollView, "setHasHorizontalScroller:", YES);
        objj_msgSend(_scrollView, "setHasVerticalScroller:", YES);
        _iframe.setAttribute("scrolling", "no");
    }
    else
    {
        objj_msgSend(_scrollView, "setHasHorizontalScroller:", NO);
        objj_msgSend(_scrollView, "setHasVerticalScroller:", NO);
        _iframe.setAttribute("scrolling", "auto");
        objj_msgSend(_frameView, "setFrameSize:", objj_msgSend(_scrollView, "bounds").size);
    }
    parent.appendChild(_iframe);
}
}), new objj_method(sel_getUid("loadHTMLString:"), function(self, _cmd, aString)
{ with(self)
{
    objj_msgSend(self, "loadHTMLString:baseURL:", aString, nil);
}
}), new objj_method(sel_getUid("loadHTMLString:baseURL:"), function(self, _cmd, aString, URL)
{ with(self)
{
    objj_msgSend(self, "_setScrollMode:", CPWebViewScrollAppKit);
    objj_msgSend(self, "_startedLoading");
    _ignoreLoadStart = YES;
    _ignoreLoadEnd = NO;
    _url = null;
    _html = aString;
    objj_msgSend(self, "_load");
}
}), new objj_method(sel_getUid("_loadMainFrameURL"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_setScrollMode:", CPWebViewScrollNative);
    objj_msgSend(self, "_startedLoading");
    _ignoreLoadStart = YES;
    _ignoreLoadEnd = NO;
    _url = _mainFrameURL;
    _html = null;
    objj_msgSend(self, "_load");
}
}), new objj_method(sel_getUid("_load"), function(self, _cmd)
{ with(self)
{
    if (_url)
    {
        _iframe.src = _url;
    }
    else if (_html)
    {
        _iframe.src = "";
        window.setTimeout(function() {
            var win = objj_msgSend(self, "DOMWindow");
            win.document.write(_html);
            window.setTimeout(_loadCallback, 1);
        }, 0);
    }
}
}), new objj_method(sel_getUid("_startedLoading"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWebViewProgressStartedNotification, self);
    if (objj_msgSend(_frameLoadDelegate, "respondsToSelector:", sel_getUid("webView:didStartProvisionalLoadForFrame:")))
        objj_msgSend(_frameLoadDelegate, "webView:didStartProvisionalLoadForFrame:", self, nil);
}
}), new objj_method(sel_getUid("_finishedLoading"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_resizeWebFrame");
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWebViewProgressFinishedNotification, self);
    if (objj_msgSend(_frameLoadDelegate, "respondsToSelector:", sel_getUid("webView:didFinishLoadForFrame:")))
        objj_msgSend(_frameLoadDelegate, "webView:didFinishLoadForFrame:", self, nil);
}
}), new objj_method(sel_getUid("mainFrameURL"), function(self, _cmd)
{ with(self)
{
    return _mainFrameURL;
}
}), new objj_method(sel_getUid("setMainFrameURL:"), function(self, _cmd, URLString)
{ with(self)
{
    if (_mainFrameURL)
        objj_msgSend(_backwardStack, "addObject:", _mainFrameURL);
    _mainFrameURL = URLString;
    objj_msgSend(_forwardStack, "removeAllObjects");
    objj_msgSend(self, "_loadMainFrameURL");
}
}), new objj_method(sel_getUid("goBack"), function(self, _cmd)
{ with(self)
{
    if (_backwardStack.length > 0)
    {
        if (_mainFrameURL)
            objj_msgSend(_forwardStack, "addObject:", _mainFrameURL);
        _mainFrameURL = objj_msgSend(_backwardStack, "lastObject");
        objj_msgSend(_backwardStack, "removeLastObject");
        objj_msgSend(self, "_loadMainFrameURL");
        return YES;
    }
    return NO;
}
}), new objj_method(sel_getUid("goForward"), function(self, _cmd)
{ with(self)
{
    if (_forwardStack.length > 0)
    {
        if (_mainFrameURL)
            objj_msgSend(_backwardStack, "addObject:", _mainFrameURL);
        _mainFrameURL = objj_msgSend(_forwardStack, "lastObject");
        objj_msgSend(_forwardStack, "removeLastObject");
        objj_msgSend(self, "_loadMainFrameURL");
        return YES;
    }
    return NO;
}
}), new objj_method(sel_getUid("canGoBack"), function(self, _cmd)
{ with(self)
{
    return (_backwardStack.length > 0);
}
}), new objj_method(sel_getUid("canGoForward"), function(self, _cmd)
{ with(self)
{
    return (_forwardStack.length > 0);
}
}), new objj_method(sel_getUid("backForwardList"), function(self, _cmd)
{ with(self)
{
    return { back: _backwardStack, forward: _forwardStack };
}
}), new objj_method(sel_getUid("close"), function(self, _cmd)
{ with(self)
{
    _iframe.parentNode.removeChild(_iframe);
}
}), new objj_method(sel_getUid("DOMWindow"), function(self, _cmd)
{ with(self)
{
    return (_iframe.contentDocument && _iframe.contentDocument.defaultView) || _iframe.contentWindow;
}
}), new objj_method(sel_getUid("windowScriptObject"), function(self, _cmd)
{ with(self)
{
    var win = objj_msgSend(self, "DOMWindow");
    if (!_wso || win != objj_msgSend(_wso, "window"))
    {
        if (win)
            _wso = objj_msgSend(objj_msgSend(CPWebScriptObject, "alloc"), "initWithWindow:", win);
        else
            _wso = nil;
    }
    return _wso;
}
}), new objj_method(sel_getUid("stringByEvaluatingJavaScriptFromString:"), function(self, _cmd, script)
{ with(self)
{
    var result = objj_msgSend(self, "objectByEvaluatingJavaScriptFromString:", script);
    return result ? String(result) : nil;
}
}), new objj_method(sel_getUid("objectByEvaluatingJavaScriptFromString:"), function(self, _cmd, script)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "windowScriptObject"), "evaluateWebScript:", script);
}
}), new objj_method(sel_getUid("computedStyleForElement:pseudoElement:"), function(self, _cmd, element, pseudoElement)
{ with(self)
{
    var win = objj_msgSend(objj_msgSend(self, "windowScriptObject"), "window");
    if (win)
    {
        return win.document.defaultView.getComputedStyle(element, pseudoElement);
    }
    return nil;
}
}), new objj_method(sel_getUid("drawsBackground"), function(self, _cmd)
{ with(self)
{
    return _iframe.style.backgroundColor != "";
}
}), new objj_method(sel_getUid("setDrawsBackground:"), function(self, _cmd, drawsBackround)
{ with(self)
{
    _iframe.style.backgroundColor = drawsBackround ? "white" : "";
}
}), new objj_method(sel_getUid("takeStringURLFrom:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "setMainFrameURL:", objj_msgSend(sender, "stringValue"));
}
}), new objj_method(sel_getUid("goBack:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "goBack");
}
}), new objj_method(sel_getUid("goForward:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "goForward");
}
}), new objj_method(sel_getUid("stopLoading:"), function(self, _cmd, sender)
{ with(self)
{
}
}), new objj_method(sel_getUid("reload:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "_loadMainFrameURL");
}
}), new objj_method(sel_getUid("print:"), function(self, _cmd, sender)
{ with(self)
{
    try
    {
        objj_msgSend(self, "DOMWindow").print();
    }
    catch (e)
    {
        alert('Please click the webpage and select "Print" from the "File" menu');
    }
}
}), new objj_method(sel_getUid("downloadDelegate"), function(self, _cmd)
{ with(self)
{
    return _downloadDelegate;
}
}), new objj_method(sel_getUid("setDownloadDelegate:"), function(self, _cmd, anObject)
{ with(self)
{
    _downloadDelegate = anObject;
}
}), new objj_method(sel_getUid("frameLoadDelegate"), function(self, _cmd)
{ with(self)
{
    return _frameLoadDelegate;
}
}), new objj_method(sel_getUid("setFrameLoadDelegate:"), function(self, _cmd, anObject)
{ with(self)
{
    _frameLoadDelegate = anObject;
}
}), new objj_method(sel_getUid("policyDelegate"), function(self, _cmd)
{ with(self)
{
    return _policyDelegate;
}
}), new objj_method(sel_getUid("setPolicyDelegate:"), function(self, _cmd, anObject)
{ with(self)
{
    _policyDelegate = anObject;
}
}), new objj_method(sel_getUid("resourceLoadDelegate"), function(self, _cmd)
{ with(self)
{
    return _resourceLoadDelegate;
}
}), new objj_method(sel_getUid("setResourceLoadDelegate:"), function(self, _cmd, anObject)
{ with(self)
{
    _resourceLoadDelegate = anObject;
}
}), new objj_method(sel_getUid("UIDelegate"), function(self, _cmd)
{ with(self)
{
    return _UIDelegate;
}
}), new objj_method(sel_getUid("setUIDelegate:"), function(self, _cmd, anObject)
{ with(self)
{
    _UIDelegate = anObject;
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "CPWebScriptObject"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_window")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    if (self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWebScriptObject").super_class }, "init"))
    {
        _window = aWindow;
    }
    return self;
}
}), new objj_method(sel_getUid("callWebScriptMethod:withArguments:"), function(self, _cmd, methodName, args)
{ with(self)
{
    if (typeof _window[methodName] == "function")
    {
        try {
            return _window[methodName].apply(args);
        } catch (e) {
        }
    }
    return undefined;
}
}), new objj_method(sel_getUid("evaluateWebScript:"), function(self, _cmd, script)
{ with(self)
{
    try {
        return _window.eval(script);
    } catch (e) {
    }
    return undefined;
}
}), new objj_method(sel_getUid("window"), function(self, _cmd)
{ with(self)
{
    return _window;
}
})]);
}
{
var the_class = objj_getClass("CPWebView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPWebView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWebView").super_class }, "initWithCoder:", aCoder);
    if (self)
    {
        _mainFrameURL = nil;
        _backwardStack = [];
        _forwardStack = [];
        _scrollMode = CPWebViewScrollNative;
        objj_msgSend(self, "_initDOMWithFrame:", objj_msgSend(self, "frame"));
        objj_msgSend(self, "setBackgroundColor:", objj_msgSend(CPColor, "whiteColor"));
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    var actualSubviews = _subviews;
    _subviews = [];
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWebView").super_class }, "encodeWithCoder:", aCoder);
    _subviews = actualSubviews;
}
})]);
}

p;20;CPWindowController.jt;11867;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.ji;13;CPResponder.ji;10;CPWindow.ji;12;CPDocument.jt;11745;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPResponder.j", true);
objj_executeFile("CPWindow.j", true);
objj_executeFile("CPDocument.j", true);
{var the_class = objj_allocateClassPair(CPResponder, "CPWindowController"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_window"), new objj_ivar("_documents"), new objj_ivar("_document"), new objj_ivar("_shouldCloseDocument"), new objj_ivar("_supportsMultipleDocuments"), new objj_ivar("_cibOwner"), new objj_ivar("_windowCibName"), new objj_ivar("_windowCibPath"), new objj_ivar("_viewController"), new objj_ivar("_viewControllerContainerView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithWindow:", nil);
}
}), new objj_method(sel_getUid("initWithWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWindowController").super_class }, "init");
    if (self)
    {
        objj_msgSend(self, "setWindow:", aWindow);
        objj_msgSend(self, "setShouldCloseDocument:", NO);
        objj_msgSend(self, "setNextResponder:", CPApp);
        _documents = [];
    }
    return self;
}
}), new objj_method(sel_getUid("initWithWindowCibName:"), function(self, _cmd, aWindowCibName)
{ with(self)
{
    return objj_msgSend(self, "initWithWindowCibName:owner:", aWindowCibName, self);
}
}), new objj_method(sel_getUid("initWithWindowCibName:owner:"), function(self, _cmd, aWindowCibName, anOwner)
{ with(self)
{
    self = objj_msgSend(self, "initWithWindow:", nil);
    if (self)
    {
        _cibOwner = anOwner;
        _windowCibName = aWindowCibName;
    }
    return self;
}
}), new objj_method(sel_getUid("initWithWindowCibPath:owner:"), function(self, _cmd, aWindowCibPath, anOwner)
{ with(self)
{
    self = objj_msgSend(self, "initWithWindow:", nil);
    if (self)
    {
        _cibOwner = anOwner;
        _windowCibPath = aWindowCibPath;
    }
    return self;
}
}), new objj_method(sel_getUid("loadWindow"), function(self, _cmd)
{ with(self)
{
    if (_window)
        return;
    objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(_cibOwner, "class")), "loadCibFile:externalNameTable:", objj_msgSend(self, "windowCibPath"), objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", _cibOwner, CPCibOwner));
}
}), new objj_method(sel_getUid("showWindow:"), function(self, _cmd, aSender)
{ with(self)
{
    var theWindow = objj_msgSend(self, "window");
    if (objj_msgSend(theWindow, "respondsToSelector:", sel_getUid("becomesKeyOnlyIfNeeded")) && objj_msgSend(theWindow, "becomesKeyOnlyIfNeeded"))
        objj_msgSend(theWindow, "orderFront:", aSender);
    else
        objj_msgSend(theWindow, "makeKeyAndOrderFront:", aSender);
}
}), new objj_method(sel_getUid("isWindowLoaded"), function(self, _cmd)
{ with(self)
{
    return _window !== nil;
}
}), new objj_method(sel_getUid("window"), function(self, _cmd)
{ with(self)
{
    if (!_window)
    {
        objj_msgSend(self, "windowWillLoad");
        objj_msgSend(_document, "windowControllerWillLoadCib:", self);
        objj_msgSend(self, "loadWindow");
        if (_window === nil && objj_msgSend(_cibOwner, "isKindOfClass:", objj_msgSend(CPDocument, "class")))
            objj_msgSend(self, "setWindow:", objj_msgSend(_cibOwner, "valueForKey:", "window"));
        if (!_window)
        {
            var reason = objj_msgSend(CPString, "stringWithFormat:", "Window for %@ could not be loaded from Cib or no window specified.                                                         Override loadWindow to load the window manually.", self);
            objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, reason);
        }
        objj_msgSend(self, "windowDidLoad");
        objj_msgSend(_document, "windowControllerDidLoadCib:", self);
        objj_msgSend(self, "synchronizeWindowTitleWithDocumentName");
    }
    return _window;
}
}), new objj_method(sel_getUid("setWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    objj_msgSend(_window, "setWindowController:", nil);
    _window = aWindow;
    objj_msgSend(_window, "setWindowController:", self);
    objj_msgSend(_window, "setNextResponder:", self);
}
}), new objj_method(sel_getUid("windowDidLoad"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("windowWillLoad"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("setDocument:"), function(self, _cmd, aDocument)
{ with(self)
{
    if (_document === aDocument)
        return;
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (_document)
    {
        if (!objj_msgSend(self, "supportsMultipleDocuments"))
            objj_msgSend(self, "removeDocument:", _document);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPDocumentWillSaveNotification, _document);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPDocumentDidSaveNotification, _document);
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPDocumentDidFailToSaveNotification, _document);
    }
    _document = aDocument;
    if (_document)
    {
        objj_msgSend(self, "addDocument:", _document);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("_documentWillSave:"), CPDocumentWillSaveNotification, _document);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("_documentDidSave:"), CPDocumentDidSaveNotification, _document);
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("_documentDidFailToSave:"), CPDocumentDidFailToSaveNotification, _document);
        objj_msgSend(self, "setDocumentEdited:", objj_msgSend(_document, "isDocumentEdited"));
    }
    var viewController = objj_msgSend(_document, "viewControllerForWindowController:", self);
    if (viewController)
        objj_msgSend(self, "setViewController:", viewController);
    objj_msgSend(self, "synchronizeWindowTitleWithDocumentName");
}
}), new objj_method(sel_getUid("setSupportsMultipleDocuments:"), function(self, _cmd, shouldSupportMultipleDocuments)
{ with(self)
{
    _supportsMultipleDocuments = shouldSupportMultipleDocuments;
}
}), new objj_method(sel_getUid("supportsMultipleDocuments"), function(self, _cmd)
{ with(self)
{
    return _supportsMultipleDocuments;
}
}), new objj_method(sel_getUid("addDocument:"), function(self, _cmd, aDocument)
{ with(self)
{
    if (aDocument && !objj_msgSend(_documents, "containsObject:", aDocument))
        objj_msgSend(_documents, "addObject:", aDocument);
}
}), new objj_method(sel_getUid("removeDocument:"), function(self, _cmd, aDocument)
{ with(self)
{
    var index = objj_msgSend(_documents, "indexOfObjectIdenticalTo:", aDocument);
    if (index === CPNotFound)
        return;
    objj_msgSend(_documents, "removeObjectAtIndex:", index);
    if (_document === aDocument && objj_msgSend(_documents, "count"))
        objj_msgSend(self, "setDocument:", objj_msgSend(_documents, "objectAtIndex:", MIN(index, objj_msgSend(_documents, "count") - 1)));
}
}), new objj_method(sel_getUid("removeDocumentAndCloseIfNecessary:"), function(self, _cmd, aDocument)
{ with(self)
{
    objj_msgSend(self, "removeDocument:", aDocument);
    if (!objj_msgSend(_documents, "count"))
        objj_msgSend(self, "close");
}
}), new objj_method(sel_getUid("documents"), function(self, _cmd)
{ with(self)
{
    return _documents;
}
}), new objj_method(sel_getUid("setViewController:"), function(self, _cmd, aViewController)
{ with(self)
{
    var containerView = objj_msgSend(self, "viewControllerContainerView") || objj_msgSend(objj_msgSend(self, "window"), "contentView"),
        view = objj_msgSend(_viewController, "view"),
        frame = view ? objj_msgSend(view, "frame") : objj_msgSend(containerView, "bounds");
    objj_msgSend(view, "removeFromSuperview");
    _viewController = aViewController;
    view = objj_msgSend(_viewController, "view");
    if (view)
    {
        objj_msgSend(view, "setFrame:", frame);
        objj_msgSend(containerView, "addSubview:", view);
    }
}
}), new objj_method(sel_getUid("setViewControllerContainerView:"), function(self, _cmd, aView)
{ with(self)
{
    _viewControllerContainerView = aView;
}
}), new objj_method(sel_getUid("viewControllerContainerView"), function(self, _cmd)
{ with(self)
{
    return _viewControllerContainerView;
}
}), new objj_method(sel_getUid("setViewController:"), function(self, _cmd, aViewController)
{ with(self)
{
    var containerView = objj_msgSend(self, "viewControllerContainerView") || objj_msgSend(objj_msgSend(self, "window"), "contentView"),
        view = objj_msgSend(_viewController, "view"),
        frame = view ? objj_msgSend(view, "frame") : objj_msgSend(containerView, "bounds");
    objj_msgSend(view, "removeFromSuperview");
    _viewController = aViewController;
    view = objj_msgSend(_viewController, "view");
    if (view)
    {
        objj_msgSend(view, "setFrame:", frame);
        objj_msgSend(containerView, "addSubview:", view);
    }
}
}), new objj_method(sel_getUid("viewController"), function(self, _cmd)
{ with(self)
{
    return _viewController;
}
}), new objj_method(sel_getUid("_documentWillSave:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "window"), "setDocumentSaving:", YES);
}
}), new objj_method(sel_getUid("_documentDidSave:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "window"), "setDocumentSaving:", NO);
}
}), new objj_method(sel_getUid("_documentDidFailToSave:"), function(self, _cmd, aNotification)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "window"), "setDocumentSaving:", NO);
}
}), new objj_method(sel_getUid("document"), function(self, _cmd)
{ with(self)
{
    return _document;
}
}), new objj_method(sel_getUid("setDocumentEdited:"), function(self, _cmd, isEdited)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "window"), "setDocumentEdited:", isEdited);
}
}), new objj_method(sel_getUid("close"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "window"), "close");
}
}), new objj_method(sel_getUid("setShouldCloseDocument:"), function(self, _cmd, shouldCloseDocument)
{ with(self)
{
    _shouldCloseDocument = shouldCloseDocument;
}
}), new objj_method(sel_getUid("shouldCloseDocument"), function(self, _cmd)
{ with(self)
{
    return _shouldCloseDocument;
}
}), new objj_method(sel_getUid("owner"), function(self, _cmd)
{ with(self)
{
    return _cibOwner;
}
}), new objj_method(sel_getUid("windowCibName"), function(self, _cmd)
{ with(self)
{
    if (_windowCibName)
        return _windowCibName;
    return objj_msgSend(objj_msgSend(_windowCibPath, "lastPathComponent"), "stringByDeletingPathExtension");
}
}), new objj_method(sel_getUid("windowCibPath"), function(self, _cmd)
{ with(self)
{
    if (_windowCibPath)
        return _windowCibPath;
    return objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(_cibOwner, "class")), "pathForResource:", _windowCibName + ".cib");
}
}), new objj_method(sel_getUid("synchronizeWindowTitleWithDocumentName"), function(self, _cmd)
{ with(self)
{
    if (!_document || !_window)
        return;
    objj_msgSend(_window, "setTitle:", objj_msgSend(self, "windowTitleForDocumentDisplayName:", objj_msgSend(_document, "displayName")));
}
}), new objj_method(sel_getUid("windowTitleForDocumentDisplayName:"), function(self, _cmd, aDisplayName)
{ with(self)
{
    return aDisplayName;
}
})]);
}

p;20;_CPCibClassSwapper.jt;2014;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.jt;1943;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
var _CPCibClassSwapperClassNameKey = "_CPCibClassSwapperClassNameKey",
    _CPCibClassSwapperOriginalClassNameKey = "_CPCibClassSwapperOriginalClassNameKey";
{var the_class = objj_allocateClassPair(CPObject, "_CPCibClassSwapper"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("allocObjectWithCoder:className:"), function(self, _cmd, aCoder, aClassName)
{ with(self)
{
    var theClass = objj_msgSend(aCoder, "classForClassName:", aClassName);
    if (!theClass)
    {
        theClass = objj_lookUpClass(aClassName);
        if (!theClass)
            return nil;
    }
    return objj_msgSend(theClass, "alloc");
}
}), new objj_method(sel_getUid("allocWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (objj_msgSend(aCoder, "respondsToSelector:", sel_getUid("usesOriginalClasses")) && objj_msgSend(aCoder, "usesOriginalClasses"))
    {
        var theClassName = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibClassSwapperOriginalClassNameKey),
            object = objj_msgSend(self, "allocObjectWithCoder:className:", aCoder, theClassName);
    }
    else
    {
        var theClassName = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibClassSwapperClassNameKey),
            object = objj_msgSend(self, "allocObjectWithCoder:className:", aCoder, theClassName);
        if (!object)
        {
            CPLog.error("Unable to find class " + theClassName + " in cib file.");
            object = objj_msgSend(self, "allocObjectWithCoder:className:", aCoder, objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibClassSwapperOriginalClassNameKey));
        }
    }
    if (!object)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "Unable to find class " + theClassName + " in cib file.");
    return object;
}
})]);
}

p;20;_CPCibCustomObject.jt;2259;@STATIC;1.0;I;21;Foundation/CPObject.jt;2214;


objj_executeFile("Foundation/CPObject.j", false);


var _CPCibCustomObjectClassName = "_CPCibCustomObjectClassName";

{var the_class = objj_allocateClassPair(CPObject, "_CPCibCustomObject"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_className")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("customClassName"), function(self, _cmd)
{ with(self)
{
    return _className;
}
}), new objj_method(sel_getUid("setCustomClassName:"), function(self, _cmd, aClassName)
{ with(self)
{
    _className = aClassName;
}
}), new objj_method(sel_getUid("description"), function(self, _cmd)
{ with(self)
{
    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibCustomObject").super_class }, "description") + " (" + objj_msgSend(self, "customClassName") + ')';
}
})]);
}

{
var the_class = objj_getClass("_CPCibCustomObject")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPCibCustomObject\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibCustomObject").super_class }, "init");

    if (self)
        _className = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibCustomObjectClassName);

    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _className, _CPCibCustomObjectClassName);
}
}), new objj_method(sel_getUid("_cibInstantiate"), function(self, _cmd)
{ with(self)
{
    var theClass = CPClassFromString(_className);


    if (theClass === objj_msgSend(self, "class"))
    {
        _className = "CPObject";

        return self;
    }

    if (!theClass)
    {

        CPLog("Unknown class \"" + _className + "\" in cib file");

        theClass = objj_msgSend(CPObject, "class");
    }

    if (theClass === objj_msgSend(CPApplication, "class"))
        return objj_msgSend(CPApplication, "sharedApplication");

    return objj_msgSend(objj_msgSend(theClass, "alloc"), "init");
}
})]);
}

p;22;_CPCibCustomResource.jt;3799;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.jt;3728;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
var _CPCibCustomResourceClassNameKey = "_CPCibCustomResourceClassNameKey",
    _CPCibCustomResourceResourceNameKey = "_CPCibCustomResourceResourceNameKey",
    _CPCibCustomResourcePropertiesKey = "_CPCibCustomResourcePropertiesKey";
{var the_class = objj_allocateClassPair(CPObject, "_CPCibCustomResource"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_className"), new objj_ivar("_resourceName"), new objj_ivar("_properties")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithClassName:resourceName:properties:"), function(self, _cmd, aClassName, aResourceName, properties)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibCustomResource").super_class }, "init");
    if (self)
    {
        _className = aClassName;
        _resourceName = aResourceName;
        _properties = properties;
    }
    return self;
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibCustomResource").super_class }, "init");
    if (self)
    {
        _className = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibCustomResourceClassNameKey);
        _resourceName = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibCustomResourceResourceNameKey);
        _properties = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibCustomResourcePropertiesKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _className, _CPCibCustomResourceClassNameKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _resourceName, _CPCibCustomResourceResourceNameKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _properties, _CPCibCustomResourcePropertiesKey);
}
}), new objj_method(sel_getUid("awakeAfterUsingCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (objj_msgSend(aCoder, "respondsToSelector:", sel_getUid("bundle")) &&
        (!objj_msgSend(aCoder, "respondsToSelector:", sel_getUid("awakenCustomResources")) || objj_msgSend(aCoder, "awakenCustomResources")))
        if (_className === "CPImage")
            return objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(aCoder, "bundle"), "pathForResource:", _resourceName), objj_msgSend(_properties, "objectForKey:", "size"));
    return self;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("imageResourceWithName:size:"), function(self, _cmd, aResourceName, aSize)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithClassName:resourceName:properties:", "CPImage", aResourceName, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", aSize, "size"));
}
})]);
}
{
var the_class = objj_getClass("_CPCibCustomResource")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPCibCustomResource\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("filename"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "pathForResource:", _resourceName);
}
}), new objj_method(sel_getUid("size"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_properties, "objectForKey:", "size");
}
}), new objj_method(sel_getUid("isThreePartImage"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("isNinePartImage"), function(self, _cmd)
{ with(self)
{
    return NO;
}
})]);
}

p;18;_CPCibCustomView.jt;3197;@STATIC;1.0;i;8;CPView.jt;3166;objj_executeFile("CPView.j", true);
{var the_class = objj_allocateClassPair(CPView, "_CPCibCustomView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_className")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("customClassName"), function(self, _cmd)
{ with(self)
{
    return _className;
}
}), new objj_method(sel_getUid("setCustomClassName:"), function(self, _cmd, aClassName)
{ with(self)
{
    if (_className === aClassName)
        return;
    _className = aClassName;
    objj_msgSend(self, "setNeedsDisplay:", YES);
    objj_msgSend(self, "setNeedsLayout");
}
})]);
}
var _CPCibCustomViewClassNameKey = "_CPCibCustomViewClassNameKey";
{
var the_class = objj_getClass("_CPCibCustomView")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPCibCustomView\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibCustomView").super_class }, "initWithCoder:", aCoder);
    if (self)
        _className = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibCustomViewClassNameKey);
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibCustomView").super_class }, "encodeWithCoder:", aCoder);
    objj_msgSend(aCoder, "encodeObject:forKey:", _className, _CPCibCustomViewClassNameKey);
}
}), new objj_method(sel_getUid("customClassName"), function(self, _cmd)
{ with(self)
{
    return _className;
}
}), new objj_method(sel_getUid("_cibInstantiate"), function(self, _cmd)
{ with(self)
{
    var theClass = CPClassFromString(_className);
    if (!theClass)
    {
        CPLog("Unknown class \"" + _className + "\" in cib file, using CPView instead.");
        theClass = objj_msgSend(CPView, "class");
    }
    if (theClass === objj_msgSend(self, "class"))
    {
        _className = "CPView";
        return self;
    }
    var view = objj_msgSend(objj_msgSend(theClass, "alloc"), "initWithFrame:", objj_msgSend(self, "frame"));
    if (view)
    {
        objj_msgSend(view, "setBounds:", objj_msgSend(self, "bounds"));
        var subviews = objj_msgSend(self, "subviews"),
            index = 0,
            count = subviews.length;
        for (; index < count; ++index)
            objj_msgSend(view, "addSubview:", subviews[index]);
        objj_msgSend(view, "setAutoresizingMask:", objj_msgSend(self, "autoresizingMask"));
        objj_msgSend(view, "setAutoresizesSubviews:", objj_msgSend(self, "autoresizesSubviews"));
        objj_msgSend(view, "setHitTests:", objj_msgSend(self, "hitTests"));
        objj_msgSend(view, "setHidden:", objj_msgSend(self, "isHidden"));
        objj_msgSend(view, "setAlphaValue:", objj_msgSend(self, "alphaValue"));
        objj_msgSend(_superview, "replaceSubview:with:", self, view);
        objj_msgSend(view, "setBackgroundColor:", objj_msgSend(self, "backgroundColor"));
    }
    return view;
}
})]);
}

p;23;_CPCibKeyedUnarchiver.jt;1890;@STATIC;1.0;I;30;Foundation/CPKeyedUnarchiver.jt;1836;


objj_executeFile("Foundation/CPKeyedUnarchiver.j", false);


{var the_class = objj_allocateClassPair(CPKeyedUnarchiver, "_CPCibKeyedUnarchiver"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_bundle"), new objj_ivar("_awakenCustomResources"), new objj_ivar("_externalObjectsForProxyIdentifiers")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initForReadingWithData:bundle:awakenCustomResources:"), function(self, _cmd, data, aBundle, shouldAwakenCustomResources)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibKeyedUnarchiver").super_class }, "initForReadingWithData:", data);

    if (self)
    {
        _bundle = aBundle;
        _awakenCustomResources = shouldAwakenCustomResources;

        objj_msgSend(self, "setDelegate:", self);
    }

    return self;
}
}), new objj_method(sel_getUid("bundle"), function(self, _cmd)
{ with(self)
{
    return _bundle;
}
}), new objj_method(sel_getUid("awakenCustomResources"), function(self, _cmd)
{ with(self)
{
    return _awakenCustomResources;
}
}), new objj_method(sel_getUid("setExternalObjectsForProxyIdentifiers:"), function(self, _cmd, externalObjectsForProxyIdentifiers)
{ with(self)
{
    _externalObjectsForProxyIdentifiers = externalObjectsForProxyIdentifiers;
}
}), new objj_method(sel_getUid("externalObjectForProxyIdentifier:"), function(self, _cmd, anIdentifier)
{ with(self)
{
    return objj_msgSend(_externalObjectsForProxyIdentifiers, "objectForKey:", anIdentifier);
}
}), new objj_method(sel_getUid("replaceObjectAtUID:withObject:"), function(self, _cmd, aUID, anObject)
{ with(self)
{
    _objects[aUID] = anObject;
}
}), new objj_method(sel_getUid("objectAtUID:"), function(self, _cmd, aUID)
{ with(self)
{
    return _objects[aUID];
}
})]);
}

p;18;_CPCibObjectData.jt;9296;@STATIC;1.0;I;20;Foundation/CPArray.jI;21;Foundation/CPObject.jI;21;Foundation/CPString.ji;7;CPCib.ji;16;CPCibConnector.ji;23;CPCibControlConnector.ji;22;CPCibOutletConnector.jt;9113;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPCib.j", true);
objj_executeFile("CPCibConnector.j", true);
objj_executeFile("CPCibControlConnector.j", true);
objj_executeFile("CPCibOutletConnector.j", true);
{var the_class = objj_allocateClassPair(CPObject, "_CPCibObjectData"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_namesKeys"), new objj_ivar("_namesValues"), new objj_ivar("_accessibilityConnectors"), new objj_ivar("_accessibilityOidsKeys"), new objj_ivar("_accessibilityOidsValues"), new objj_ivar("_classesKeys"), new objj_ivar("_classesValues"), new objj_ivar("_connections"), new objj_ivar("_fontManager"), new objj_ivar("_framework"), new objj_ivar("_nextOid"), new objj_ivar("_objectsKeys"), new objj_ivar("_objectsValues"), new objj_ivar("_oidKeys"), new objj_ivar("_oidValues"), new objj_ivar("_fileOwner"), new objj_ivar("_visibleWindows"), new objj_ivar("_replacementObjects")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibObjectData").super_class }, "init");
    if (self)
    {
        _namesKeys = [];
        _namesValues = [];
        _classesKeys = [];
        _classesValues = [];
        _connections = [];
        _framework = "";
        _nextOid = [];
        _objectsKeys = [];
        _objectsValues = [];
        _oidKeys = [];
        _oidValues = [];
        _fileOwner = nil;
        _visibleWindows = objj_msgSend(CPSet, "set");
    }
    return self;
}
}), new objj_method(sel_getUid("displayVisibleWindows"), function(self, _cmd)
{ with(self)
{
    var object = nil,
        objectEnumerator = objj_msgSend(_visibleWindows, "objectEnumerator");
    while (object = objj_msgSend(objectEnumerator, "nextObject"))
        objj_msgSend(_replacementObjects[objj_msgSend(object, "UID")], "makeKeyAndOrderFront:", self);
}
})]);
}
var _CPCibObjectDataNamesKeysKey = "_CPCibObjectDataNamesKeysKey",
    _CPCibObjectDataNamesValuesKey = "_CPCibObjectDataNamesValuesKey",
    _CPCibObjectDataAccessibilityConnectorsKey = "_CPCibObjectDataAccessibilityConnectors",
    _CPCibObjectDataAccessibilityOidsKeysKey = "_CPCibObjectDataAccessibilityOidsKeys",
    _CPCibObjectDataAccessibilityOidsValuesKey = "_CPCibObjectDataAccessibilityOidsValues",
    _CPCibObjectDataClassesKeysKey = "_CPCibObjectDataClassesKeysKey",
    _CPCibObjectDataClassesValuesKey = "_CPCibObjectDataClassesValuesKey",
    _CPCibObjectDataConnectionsKey = "_CPCibObjectDataConnectionsKey",
    _CPCibObjectDataFontManagerKey = "_CPCibObjectDataFontManagerKey",
    _CPCibObjectDataFrameworkKey = "_CPCibObjectDataFrameworkKey",
    _CPCibObjectDataNextOidKey = "_CPCibObjectDataNextOidKey",
    _CPCibObjectDataObjectsKeysKey = "_CPCibObjectDataObjectsKeysKey",
    _CPCibObjectDataObjectsValuesKey = "_CPCibObjectDataObjectsValuesKey",
    _CPCibObjectDataOidKeysKey = "_CPCibObjectDataOidKeysKey",
    _CPCibObjectDataOidValuesKey = "_CPCibObjectDataOidValuesKey",
    _CPCibObjectDataFileOwnerKey = "_CPCibObjectDataFileOwnerKey",
    _CPCibObjectDataVisibleWindowsKey = "_CPCibObjectDataVisibleWindowsKey";
{
var the_class = objj_getClass("_CPCibObjectData")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPCibObjectData\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibObjectData").super_class }, "init");
    if (self)
    {
        _replacementObjects = {};
        _namesKeys = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataNamesKeysKey);
        _namesValues = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataNamesValuesKey);
        _classesKeys = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataClassesKeysKey);
        _classesValues = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataClassesValuesKey);
        _connections = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataConnectionsKey);
        _framework = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataFrameworkKey);
        _nextOid = objj_msgSend(aCoder, "decodeIntForKey:", _CPCibObjectDataNextOidKey);
        _objectsKeys = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataObjectsKeysKey);
        _objectsValues = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataObjectsValuesKey);
        _oidKeys = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataOidKeysKey);
        _oidValues = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataOidValuesKey);
        _fileOwner = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataFileOwnerKey);
        _visibleWindows = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibObjectDataVisibleWindowsKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _namesKeys, _CPCibObjectDataNamesKeysKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _namesValues, _CPCibObjectDataNamesValuesKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _classesKeys, _CPCibObjectDataClassesKeysKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _classesValues, _CPCibObjectDataClassesValuesKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _connections, _CPCibObjectDataConnectionsKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _framework, _CPCibObjectDataFrameworkKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _nextOid, _CPCibObjectDataNextOidKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _objectsKeys, _CPCibObjectDataObjectsKeysKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _objectsValues, _CPCibObjectDataObjectsValuesKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _oidKeys, _CPCibObjectDataOidKeysKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _oidValues, _CPCibObjectDataOidValuesKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _fileOwner, _CPCibObjectDataFileOwnerKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _visibleWindows, _CPCibObjectDataVisibleWindowsKey);
}
}), new objj_method(sel_getUid("instantiateWithOwner:topLevelObjects:"), function(self, _cmd, anOwner, topLevelObjects)
{ with(self)
{
    var count = objj_msgSend(_objectsKeys, "count");
    while (count--)
    {
        var object = _objectsKeys[count],
            parent = _objectsValues[count],
            instantiatedObject = object;
        if (objj_msgSend(object, "respondsToSelector:", sel_getUid("_cibInstantiate")))
        {
            var instantiatedObject = objj_msgSend(object, "_cibInstantiate");
            if (instantiatedObject !== object)
            {
                _replacementObjects[objj_msgSend(object, "UID")] = instantiatedObject;
                if (objj_msgSend(instantiatedObject, "isKindOfClass:", objj_msgSend(CPView, "class")))
                {
                    var clipView = objj_msgSend(instantiatedObject, "superview");
                    if (objj_msgSend(clipView, "isKindOfClass:", objj_msgSend(CPClipView, "class")))
                    {
                        var scrollView = objj_msgSend(clipView, "superview");
                        if (objj_msgSend(scrollView, "isKindOfClass:", objj_msgSend(CPScrollView, "class")))
                            objj_msgSend(scrollView, "setDocumentView:", instantiatedObject);
                    }
                }
            }
        }
        if (topLevelObjects && parent === _fileOwner && object !== _fileOwner)
            topLevelObjects.push(instantiatedObject);
    }
}
}), new objj_method(sel_getUid("establishConnectionsWithOwner:topLevelObjects:"), function(self, _cmd, anOwner, topLevelObjects)
{ with(self)
{
    _replacementObjects[objj_msgSend(_fileOwner, "UID")] = anOwner;
    var index = 0,
        count = _connections.length;
    for (; index < count; ++index)
    {
        var connection = _connections[index];
        objj_msgSend(connection, "replaceObjects:", _replacementObjects);
        objj_msgSend(connection, "establishConnection");
    }
}
}), new objj_method(sel_getUid("awakeWithOwner:topLevelObjects:"), function(self, _cmd, anOwner, topLevelObjects)
{ with(self)
{
    var count = objj_msgSend(_objectsKeys, "count");
    while (count--)
    {
        var object = _objectsKeys[count],
            instantiatedObject = _replacementObjects[objj_msgSend(object, "UID")];
        if (instantiatedObject)
            object = instantiatedObject;
        if (object !== anOwner && objj_msgSend(object, "respondsToSelector:", sel_getUid("awakeFromCib")))
            objj_msgSend(object, "awakeFromCib");
    }
    if (objj_msgSend(anOwner, "respondsToSelector:", sel_getUid("awakeFromCib")))
        objj_msgSend(anOwner, "awakeFromCib");
}
})]);
}

p;19;_CPCibProxyObject.jt;1299;@STATIC;1.0;I;21;Foundation/CPObject.jt;1254;


objj_executeFile("Foundation/CPObject.j", false);


{var the_class = objj_allocateClassPair(CPObject, "_CPCibProxyObject"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_identifier")]);
objj_registerClassPair(the_class);
}

var _CPCibProxyObjectIdentifierKey = "CPIdentifier";

{
var the_class = objj_getClass("_CPCibProxyObject")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPCibProxyObject\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibProxyObject").super_class }, "init");

    if (self)
        _identifier = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibProxyObjectIdentifierKey);

    if (objj_msgSend(aCoder, "respondsToSelector:", sel_getUid("externalObjectForProxyIdentifier:")))
        return objj_msgSend(aCoder, "externalObjectForProxyIdentifier:", _identifier);

    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _identifier, _CPCibProxyObjectIdentifierKey);
}
})]);
}

p;22;_CPCibWindowTemplate.jt;6383;@STATIC;1.0;I;21;Foundation/CPObject.jt;6338;


objj_executeFile("Foundation/CPObject.j", false);


var _CPCibWindowTemplateMinSizeKey = "_CPCibWindowTemplateMinSizeKey",
    _CPCibWindowTemplateMaxSizeKey = "_CPCibWindowTemplateMaxSizeKey",

    _CPCibWindowTemplateViewClassKey = "_CPCibWindowTemplateViewClassKey",
    _CPCibWindowTemplateWindowClassKey = "_CPCibWindowTemplateWindowClassKey",

    _CPCibWindowTemplateWindowRectKey = "_CPCibWindowTemplateWindowRectKey",
    _CPCibWindowTemplateWindowStyleMaskKey = "_CPCibWindowTempatStyleMaskKey",
    _CPCibWindowTemplateWindowTitleKey = "_CPCibWindowTemplateWindowTitleKey",
    _CPCibWindowTemplateWindowViewKey = "_CPCibWindowTemplateWindowViewKey",

    _CPCibWindowTemplateWindowAutorecalculatesKeyViewLoop = "_CPCibWindowTemplateWindowAutorecalculatesKeyViewLoop";
    _CPCibWindowTemplateWindowIsFullPlatformWindowKey = "_CPCibWindowTemplateWindowIsFullPlatformWindowKey";

{var the_class = objj_allocateClassPair(CPObject, "_CPCibWindowTemplate"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_minSize"), new objj_ivar("_maxSize"), new objj_ivar("_viewClass"), new objj_ivar("_windowClass"), new objj_ivar("_windowRect"), new objj_ivar("_windowStyleMask"), new objj_ivar("_windowTitle"), new objj_ivar("_windowView"), new objj_ivar("_windowAutorecalculatesKeyViewLoop"), new objj_ivar("_windowIsFullPlatformWindow")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibWindowTemplate").super_class }, "init");

    if (self)
    {
        _windowClass = "CPWindow";
        _windowRect = CGRectMake(0.0, 0.0, 400.0, 200.0);
        _windowStyleMask = CPTitledWindowMask | CPClosableWindowMask | CPMiniaturizableWindowMask | CPResizableWindowMask;

        _windowTitle = "Window";
        _windowView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 400.0, 200.0));

        _windowIsFullPlatformWindow = NO;
    }

    return self;
}
}), new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPCibWindowTemplate").super_class }, "init");

    if (self)
    {
        if (objj_msgSend(aCoder, "containsValueForKey:", _CPCibWindowTemplateMinSizeKey))
            _minSize = objj_msgSend(aCoder, "decodeSizeForKey:", _CPCibWindowTemplateMinSizeKey);
        if (objj_msgSend(aCoder, "containsValueForKey:", _CPCibWindowTemplateMaxSizeKey))
            _maxSize = objj_msgSend(aCoder, "decodeSizeForKey:", _CPCibWindowTemplateMaxSizeKey);

        _viewClass = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibWindowTemplateViewClassKey);

        _windowClass = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibWindowTemplateWindowClassKey);
        _windowRect = objj_msgSend(aCoder, "decodeRectForKey:", _CPCibWindowTemplateWindowRectKey);
        _windowStyleMask = objj_msgSend(aCoder, "decodeIntForKey:", _CPCibWindowTemplateWindowStyleMaskKey);

        _windowTitle = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibWindowTemplateWindowTitleKey);
        _windowView = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibWindowTemplateWindowViewKey);

        _windowAutorecalculatesKeyViewLoop = !!objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibWindowTemplateWindowAutorecalculatesKeyViewLoop);
        _windowIsFullPlatformWindow = !!objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibWindowTemplateWindowIsFullPlatformWindowKey);
    }

    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (_minSize)
        objj_msgSend(aCoder, "encodeSize:forKey:", _minSize, _CPCibWindowTemplateMinSizeKey);
    if (_maxSize)
        objj_msgSend(aCoder, "encodeSize:forKey:", _maxSize, _CPCibWindowTemplateMaxSizeKey);

    objj_msgSend(aCoder, "encodeObject:forKey:", _viewClass, _CPCibWindowTemplateViewClassKey);

    objj_msgSend(aCoder, "encodeObject:forKey:", _windowClass, _CPCibWindowTemplateWindowClassKey);
    objj_msgSend(aCoder, "encodeRect:forKey:", _windowRect, _CPCibWindowTemplateWindowRectKey);
    objj_msgSend(aCoder, "encodeInt:forKey:", _windowStyleMask, _CPCibWindowTemplateWindowStyleMaskKey);

    objj_msgSend(aCoder, "encodeObject:forKey:", _windowTitle, _CPCibWindowTemplateWindowTitleKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _windowView, _CPCibWindowTemplateWindowViewKey);

    if (_windowAutorecalculatesKeyViewLoop)
        objj_msgSend(aCoder, "encodeObject:forKey:", _windowAutorecalculatesKeyViewLoop, _CPCibWindowTemplateWindowAutorecalculatesKeyViewLoop);

    if (_windowIsFullPlatformWindow)
        objj_msgSend(aCoder, "encodeObject:forKey:", _windowIsFullPlatformWindow, _CPCibWindowTemplateWindowIsFullPlatformWindowKey);
}
}), new objj_method(sel_getUid("customClassName"), function(self, _cmd)
{ with(self)
{
    return _windowClass;
}
}), new objj_method(sel_getUid("setCustomClassName:"), function(self, _cmd, aClassName)
{ with(self)
{
    _windowClass = aClassName;
}
}), new objj_method(sel_getUid("windowClass"), function(self, _cmd)
{ with(self)
{
    return _windowClass;
}
}), new objj_method(sel_getUid("_cibInstantiate"), function(self, _cmd)
{ with(self)
{
    var windowClass = CPClassFromString(objj_msgSend(self, "windowClass"));





    var theWindow = objj_msgSend(objj_msgSend(windowClass, "alloc"), "initWithContentRect:styleMask:", _windowRect, _windowStyleMask);

    if (_minSize)
        objj_msgSend(theWindow, "setMinSize:", _minSize);
    if (_maxSize)
        objj_msgSend(theWindow, "setMaxSize:", _maxSize);


    objj_msgSend(theWindow, "setTitle:", _windowTitle);


    objj_msgSend(_windowView, "setAutoresizesSubviews:", NO);

    objj_msgSend(theWindow, "setContentView:", _windowView);

    objj_msgSend(_windowView, "setAutoresizesSubviews:", YES);

    if (objj_msgSend(_viewClass, "isKindOfClass:", objj_msgSend(CPToolbar, "class")))
    {
       objj_msgSend(theWindow, "setToolbar:", _viewClass);
    }

    objj_msgSend(theWindow, "setAutorecalculatesKeyViewLoop:", _windowAutorecalculatesKeyViewLoop);
    objj_msgSend(theWindow, "setFullBridge:", _windowIsFullPlatformWindow);

    return theWindow;
}
})]);
}

p;7;CPCib.jt;6575;@STATIC;1.0;I;21;Foundation/CPObject.jI;28;Foundation/CPURLConnection.jI;25;Foundation/CPURLRequest.ji;20;_CPCibClassSwapper.ji;20;_CPCibCustomObject.ji;22;_CPCibCustomResource.ji;18;_CPCibCustomView.ji;23;_CPCibKeyedUnarchiver.ji;18;_CPCibObjectData.ji;19;_CPCibProxyObject.ji;22;_CPCibWindowTemplate.jt;6265;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPURLConnection.j", false);
objj_executeFile("Foundation/CPURLRequest.j", false);
objj_executeFile("_CPCibClassSwapper.j", true);
objj_executeFile("_CPCibCustomObject.j", true);
objj_executeFile("_CPCibCustomResource.j", true);
objj_executeFile("_CPCibCustomView.j", true);
objj_executeFile("_CPCibKeyedUnarchiver.j", true);
objj_executeFile("_CPCibObjectData.j", true);
objj_executeFile("_CPCibProxyObject.j", true);
objj_executeFile("_CPCibWindowTemplate.j", true);
CPCibOwner = "CPCibOwner",
CPCibTopLevelObjects = "CPCibTopLevelObjects",
CPCibReplacementClasses = "CPCibReplacementClasses",
CPCibExternalObjects = "CPCibExternalObjects";
var CPCibObjectDataKey = "CPCibObjectDataKey";
{var the_class = objj_allocateClassPair(CPObject, "CPCib"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_data"), new objj_ivar("_bundle"), new objj_ivar("_awakenCustomResources"), new objj_ivar("_loadDelegate")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithContentsOfURL:"), function(self, _cmd, aURL)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCib").super_class }, "init");
    if (self)
    {
        _data = objj_msgSend(CPURLConnection, "sendSynchronousRequest:returningResponse:error:", objj_msgSend(CPURLRequest, "requestWithURL:", aURL), nil, nil);
        _awakenCustomResources = YES;
    }
    return self;
}
}), new objj_method(sel_getUid("initWithContentsOfURL:loadDelegate:"), function(self, _cmd, aURL, aLoadDelegate)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCib").super_class }, "init");
    if (self)
    {
        objj_msgSend(CPURLConnection, "connectionWithRequest:delegate:", objj_msgSend(CPURLRequest, "requestWithURL:", aURL), self);
        _awakenCustomResources = YES;
        _loadDelegate = aLoadDelegate;
    }
    return self;
}
}), new objj_method(sel_getUid("initWithCibNamed:bundle:"), function(self, _cmd, aName, aBundle)
{ with(self)
{
    if (!objj_msgSend(aName, "hasSuffix:", ".cib"))
        aName = objj_msgSend(aName, "stringByAppendingString:", ".cib");
    self = objj_msgSend(self, "initWithContentsOfURL:", objj_msgSend(aBundle || objj_msgSend(CPBundle, "mainBundle"), "pathForResource:", aName));
    if (self)
        _bundle = aBundle;
    return self;
}
}), new objj_method(sel_getUid("initWithCibNamed:bundle:loadDelegate:"), function(self, _cmd, aName, aBundle, aLoadDelegate)
{ with(self)
{
    if (!objj_msgSend(aName, "hasSuffix:", ".cib"))
        aName = objj_msgSend(aName, "stringByAppendingString:", ".cib");
    self = objj_msgSend(self, "initWithContentsOfURL:loadDelegate:", objj_msgSend(aBundle || objj_msgSend(CPBundle, "mainBundle"), "pathForResource:", aName), aLoadDelegate);
    if (self)
        _bundle = aBundle;
    return self;
}
}), new objj_method(sel_getUid("_setAwakenCustomResources:"), function(self, _cmd, shouldAwakenCustomResources)
{ with(self)
{
    _awakenCustomResources = shouldAwakenCustomResources;
}
}), new objj_method(sel_getUid("_awakenCustomResources"), function(self, _cmd)
{ with(self)
{
    return _awakenCustomResources;
}
}), new objj_method(sel_getUid("instantiateCibWithExternalNameTable:"), function(self, _cmd, anExternalNameTable)
{ with(self)
{
    var bundle = _bundle,
        owner = objj_msgSend(anExternalNameTable, "objectForKey:", CPCibOwner);
    if (!bundle && owner)
        bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(owner, "class"));
    var unarchiver = objj_msgSend(objj_msgSend(_CPCibKeyedUnarchiver, "alloc"), "initForReadingWithData:bundle:awakenCustomResources:", _data, bundle, _awakenCustomResources),
        replacementClasses = objj_msgSend(anExternalNameTable, "objectForKey:", CPCibReplacementClasses);
    if (replacementClasses)
    {
        var key = nil,
            keyEnumerator = objj_msgSend(replacementClasses, "keyEnumerator");
        while (key = objj_msgSend(keyEnumerator, "nextObject"))
            objj_msgSend(unarchiver, "setClass:forClassName:", objj_msgSend(replacementClasses, "objectForKey:", key), key);
    }
    objj_msgSend(unarchiver, "setExternalObjectsForProxyIdentifiers:", objj_msgSend(anExternalNameTable, "objectForKey:", CPCibExternalObjects));
    var objectData = objj_msgSend(unarchiver, "decodeObjectForKey:", CPCibObjectDataKey);
    if (!objectData || !objj_msgSend(objectData, "isKindOfClass:", objj_msgSend(_CPCibObjectData, "class")))
        return NO;
    var topLevelObjects = objj_msgSend(anExternalNameTable, "objectForKey:", CPCibTopLevelObjects);
    objj_msgSend(objectData, "instantiateWithOwner:topLevelObjects:", owner, topLevelObjects)
    objj_msgSend(objectData, "establishConnectionsWithOwner:topLevelObjects:", owner, topLevelObjects);
    objj_msgSend(objectData, "awakeWithOwner:topLevelObjects:", owner, topLevelObjects);
    objj_msgSend(objectData, "displayVisibleWindows");
    return YES;
}
}), new objj_method(sel_getUid("instantiateCibWithOwner:topLevelObjects:"), function(self, _cmd, anOwner, topLevelObjects)
{ with(self)
{
    return objj_msgSend(self, "instantiateCibWithExternalNameTable:", objj_msgSend(CPDictionary, "dictionaryWithObjectsAndKeys:", anOwner, CPCibOwner, topLevelObjects, CPCibTopLevelObjects));
}
})]);
}
{
var the_class = objj_getClass("CPCib")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPCib\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("connection:didReceiveData:"), function(self, _cmd, aConnection, data)
{ with(self)
{
    _data = objj_msgSend(CPData, "dataWithEncodedString:", data);
}
}), new objj_method(sel_getUid("connection:didFailWithError:"), function(self, _cmd, aConnection, anError)
{ with(self)
{
    alert("cib: connection failed.");
    _loadDelegate = nil;
}
}), new objj_method(sel_getUid("connectionDidFinishLoading:"), function(self, _cmd, aConnection)
{ with(self)
{
    if (objj_msgSend(_loadDelegate, "respondsToSelector:", sel_getUid("cibDidFinishLoading:")))
        objj_msgSend(_loadDelegate, "cibDidFinishLoading:", self);
    _loadDelegate = nil;
}
})]);
}

p;16;CPCibConnector.jt;3188;@STATIC;1.0;I;21;Foundation/CPObject.jI;29;Foundation/CPKeyValueCoding.jt;3109;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPKeyValueCoding.j", false);
var _CPCibConnectorSourceKey = "_CPCibConnectorSourceKey",
    _CPCibConnectorDestinationKey = "_CPCibConnectorDestinationKey",
    _CPCibConnectorLabelKey = "_CPCibConnectorLabelKey";
{var the_class = objj_allocateClassPair(CPObject, "CPCibConnector"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_source"), new objj_ivar("_destination"), new objj_ivar("_label")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("source"), function(self, _cmd)
{ with(self)
{
return _source;
}
}),
new objj_method(sel_getUid("setSource:"), function(self, _cmd, newValue)
{ with(self)
{
_source = newValue;
}
}),
new objj_method(sel_getUid("destination"), function(self, _cmd)
{ with(self)
{
return _destination;
}
}),
new objj_method(sel_getUid("setDestination:"), function(self, _cmd, newValue)
{ with(self)
{
_destination = newValue;
}
}),
new objj_method(sel_getUid("label"), function(self, _cmd)
{ with(self)
{
return _label;
}
}),
new objj_method(sel_getUid("setLabel:"), function(self, _cmd, newValue)
{ with(self)
{
_label = newValue;
}
}), new objj_method(sel_getUid("replaceObject:withObject:"), function(self, _cmd, anObject, anotherObject)
{ with(self)
{
    if (_source === anObject)
        _source = anotherObject;
    if (_destination === anObject)
        _destination = anotherObject;
}
}), new objj_method(sel_getUid("replaceObjects:"), function(self, _cmd, replacementObjects)
{ with(self)
{
    var replacement = replacementObjects[objj_msgSend(_source, "UID")];
    if (replacement !== undefined)
        _source = replacement;
    replacement = replacementObjects[objj_msgSend(_destination, "UID")];
    if (replacement !== undefined)
        _destination = replacement;
}
})]);
}
{
var the_class = objj_getClass("CPCibConnector")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPCibConnector\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPCibConnector").super_class }, "init");
    if (self)
    {
        _source = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibConnectorSourceKey);
        _destination = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibConnectorDestinationKey);
        _label = objj_msgSend(aCoder, "decodeObjectForKey:", _CPCibConnectorLabelKey);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _source, _CPCibConnectorSourceKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _destination, _CPCibConnectorDestinationKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _label, _CPCibConnectorLabelKey);
}
})]);
}
{var the_class = objj_allocateClassPair(CPCibConnector, "_CPCibConnector"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
}

p;23;CPCibControlConnector.jt;1969;@STATIC;1.0;i;16;CPCibConnector.jt;1929;objj_executeFile("CPCibConnector.j", true);
{var the_class = objj_allocateClassPair(CPCibConnector, "CPCibControlConnector"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("establishConnection"), function(self, _cmd)
{ with(self)
{
    var selectorName = _label,
        selectorNameLength = objj_msgSend(selectorName, "length");
    if (selectorNameLength && selectorName.charAt(selectorNameLength - 1) !== ':')
        selectorName += ':';
    var selector = CPSelectorFromString(selectorName);
    if (!selector)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "-[" + objj_msgSend(self, "className") + ' ' + _cmd + "] selector " + selectorName + " does not exist.");
    if (_destination && !objj_msgSend(_destination, "respondsToSelector:", selector))
    {
        CPLog.warn("Could not connect the action " + selector + " to target of class " + objj_msgSend(_destination, "className"));
        return;
    }
    if (objj_msgSend(_source, "respondsToSelector:", sel_getUid("setAction:")))
        objj_msgSend(_source, sel_getUid("setAction:"), selector);
    else
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "-[" + objj_msgSend(self, "className") + ' ' + _cmd + "] " + objj_msgSend(_source, "description") + " does not respond to setAction:");
    if (objj_msgSend(_source, "respondsToSelector:", sel_getUid("setTarget:")))
        objj_msgSend(_source, sel_getUid("setTarget:"), _destination);
    else
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "-[" + objj_msgSend(self, "className") + ' ' + _cmd + "] " + objj_msgSend(_source, "description") + " does not respond to setTarget:");
}
})]);
}
{var the_class = objj_allocateClassPair(CPCibControlConnector, "_CPCibControlConnector"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
}

p;14;CPCibLoading.jt;4186;@STATIC;1.0;I;21;Foundation/CPBundle.jI;25;Foundation/CPDictionary.jI;21;Foundation/CPString.jt;4085;objj_executeFile("Foundation/CPBundle.j", false);
objj_executeFile("Foundation/CPDictionary.j", false);
objj_executeFile("Foundation/CPString.j", false);
var CPCibOwner = "CPCibOwner";
{
var the_class = objj_getClass("CPObject")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPObject\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("awakeFromCib"), function(self, _cmd)
{ with(self)
{
}
})]);
}
{
var the_class = objj_getClass("CPBundle")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPBundle\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("loadCibFile:externalNameTable:"), function(self, _cmd, aFileName, aNameTable)
{ with(self)
{
    objj_msgSend(objj_msgSend(objj_msgSend(CPCib, "alloc"), "initWithContentsOfURL:", aFileName), "instantiateCibWithExternalNameTable:", aNameTable);
}
}), new objj_method(sel_getUid("loadCibFile:externalNameTable:loadDelegate:"), function(self, _cmd, aFileName, aNameTable, aDelegate)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPCib, "alloc"), "initWithCibNamed:bundle:loadDelegate:", aFileName, self, objj_msgSend(objj_msgSend(_CPCibLoadDelegate, "alloc"), "initWithLoadDelegate:externalNameTable:", aDelegate, aNameTable));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("loadCibFile:externalNameTable:"), function(self, _cmd, anAbsolutePath, aNameTable)
{ with(self)
{
    objj_msgSend(objj_msgSend(objj_msgSend(CPCib, "alloc"), "initWithContentsOfURL:", anAbsolutePath), "instantiateCibWithExternalNameTable:", aNameTable);
}
}), new objj_method(sel_getUid("loadCibNamed:owner:"), function(self, _cmd, aName, anOwner)
{ with(self)
{
    if (!objj_msgSend(aName, "hasSuffix:", ".cib"))
        aName = objj_msgSend(aName, "stringByAppendingString:", ".cib");
    var bundle = anOwner ? objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(anOwner, "class")) : objj_msgSend(CPBundle, "mainBundle"),
        path = objj_msgSend(bundle, "pathForResource:", aName);
    objj_msgSend(self, "loadCibFile:externalNameTable:", path, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", anOwner, CPCibOwner));
}
}), new objj_method(sel_getUid("loadCibFile:externalNameTable:loadDelegate:"), function(self, _cmd, anAbsolutePath, aNameTable, aDelegate)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPCib, "alloc"), "initWithContentsOfURL:loadDelegate:", anAbsolutePath, objj_msgSend(objj_msgSend(_CPCibLoadDelegate, "alloc"), "initWithLoadDelegate:externalNameTable:", aDelegate, aNameTable));
}
}), new objj_method(sel_getUid("loadCibNamed:owner:loadDelegate:"), function(self, _cmd, aName, anOwner, aDelegate)
{ with(self)
{
    if (!objj_msgSend(aName, "hasSuffix:", ".cib"))
        aName = objj_msgSend(aName, "stringByAppendingString:", ".cib");
    var bundle = anOwner ? objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(anOwner, "class")) : objj_msgSend(CPBundle, "mainBundle"),
        path = objj_msgSend(bundle, "pathForResource:", aName);
    objj_msgSend(self, "loadCibFile:externalNameTable:loadDelegate:", path, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", anOwner, CPCibOwner), aDelegate);
}
})]);
}
{var the_class = objj_allocateClassPair(CPObject, "_CPCibLoadDelegate"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_loadDelegate"), new objj_ivar("_externalNameTable")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithLoadDelegate:externalNameTable:"), function(self, _cmd, aLoadDelegate, anExternalNameTable)
{ with(self)
{
    self = objj_msgSend(self, "init");
    if (self)
    {
        _loadDelegate = aLoadDelegate;
        _externalNameTable = anExternalNameTable;
    }
    return self;
}
}), new objj_method(sel_getUid("cibDidFinishLoading:"), function(self, _cmd, aCib)
{ with(self)
{
    objj_msgSend(aCib, "instantiateCibWithExternalNameTable:", _externalNameTable);
    objj_msgSend(_loadDelegate, "cibDidFinishLoading:", aCib);
}
})]);
}

p;22;CPCibOutletConnector.jt;881;@STATIC;1.0;i;16;CPCibConnector.jt;842;objj_executeFile("CPCibConnector.j", true);
{var the_class = objj_allocateClassPair(CPCibConnector, "CPCibOutletConnector"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("establishConnection"), function(self, _cmd)
{ with(self)
{
    try
    {
        objj_msgSend(_source, "setValue:forKey:", _destination, _label);
    }
    catch (anException)
    {
        if (objj_msgSend(anException, "name") === CPUndefinedKeyException)
            CPLog.warn("Could not connect the outlet " + _label + " of target of class " + objj_msgSend(_source, "className"));
        else
            throw anException;
    }
}
})]);
}
{var the_class = objj_allocateClassPair(CPCibOutletConnector, "_CPCibOutletConnector"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
}

p;13;CAAnimation.jt;4570;@STATIC;1.0;I;21;Foundation/CPObject.jI;21;Foundation/CPString.ji;23;CAMediaTimingFunction.jt;4471;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CAMediaTimingFunction.j", true);
{var the_class = objj_allocateClassPair(CPObject, "CAAnimation"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_isRemovedOnCompletion"), new objj_ivar("_delegate")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CAAnimation").super_class }, "init");
    if (self)
        _isRemovedOnCompletion = YES;
    return self;
}
}), new objj_method(sel_getUid("shouldArchiveValueForKey:"), function(self, _cmd, aKey)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("setRemovedOnCompletion:"), function(self, _cmd, isRemovedOnCompletion)
{ with(self)
{
    _isRemovedOnCompletion = isRemovedOnCompletion;
}
}), new objj_method(sel_getUid("removedOnCompletion"), function(self, _cmd)
{ with(self)
{
    return _isRemovedOnCompletion;
}
}), new objj_method(sel_getUid("isRemovedOnCompletion"), function(self, _cmd)
{ with(self)
{
    return _isRemovedOnCompletion;
}
}), new objj_method(sel_getUid("timingFunction"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("runActionForKey:object:arguments:"), function(self, _cmd, aKey, anObject, arguments)
{ with(self)
{
    objj_msgSend(anObject, "addAnimation:forKey:", self, aKey);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("animation"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "init");
}
}), new objj_method(sel_getUid("defaultValueForKey:"), function(self, _cmd, aKey)
{ with(self)
{
    return nil;
}
})]);
}
{var the_class = objj_allocateClassPair(CAAnimation, "CAPropertyAnimation"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_keyPath"), new objj_ivar("_isCumulative"), new objj_ivar("_isAdditive")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setKeyPath:"), function(self, _cmd, aKeyPath)
{ with(self)
{
    _keyPath = aKeyPath;
}
}), new objj_method(sel_getUid("keyPath"), function(self, _cmd)
{ with(self)
{
    return _keyPath;
}
}), new objj_method(sel_getUid("setCumulative:"), function(self, _cmd, isCumulative)
{ with(self)
{
    _isCumulative = isCumulative;
}
}), new objj_method(sel_getUid("cumulative"), function(self, _cmd)
{ with(self)
{
    return _isCumulative;
}
}), new objj_method(sel_getUid("isCumulative"), function(self, _cmd)
{ with(self)
{
    return _isCumulative;
}
}), new objj_method(sel_getUid("setAdditive:"), function(self, _cmd, isAdditive)
{ with(self)
{
    _isAdditive = isAdditive;
}
}), new objj_method(sel_getUid("additive"), function(self, _cmd)
{ with(self)
{
    return _isAdditive;
}
}), new objj_method(sel_getUid("isAdditive"), function(self, _cmd)
{ with(self)
{
    return _isAdditive;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("animationWithKeyPath:"), function(self, _cmd, aKeyPath)
{ with(self)
{
    var animation = objj_msgSend(self, "animation");
    objj_msgSend(animation, "setKeyPath:", aKeyPath);
    return animation;
}
})]);
}
{var the_class = objj_allocateClassPair(CAPropertyAnimation, "CABasicAnimation"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_fromValue"), new objj_ivar("_toValue"), new objj_ivar("_byValue")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setFromValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _fromValue = aValue;
}
}), new objj_method(sel_getUid("fromValue"), function(self, _cmd)
{ with(self)
{
    return _fromValue;
}
}), new objj_method(sel_getUid("setToValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _toValue = aValue;
}
}), new objj_method(sel_getUid("toValue"), function(self, _cmd)
{ with(self)
{
    return _toValue;
}
}), new objj_method(sel_getUid("setByValue:"), function(self, _cmd, aValue)
{ with(self)
{
    _byValue = aValue;
}
}), new objj_method(sel_getUid("byValue"), function(self, _cmd)
{ with(self)
{
    return _byValue;
}
})]);
}

p;16;CABackingStore.jt;982;@STATIC;1.0;i;12;CGGeometry.ji;17;CPCompatibility.jt;925;objj_executeFile("CGGeometry.j", true);
objj_executeFile("CPCompatibility.j", true);
CABackingStoreGetContext= function(aBackingStore)
{
    return aBackingStore.context;
}
if (CPFeatureIsCompatible(CPHTMLCanvasFeature))
{
CABackingStoreCreate = function()
{
    var DOMElement = document.createElement("canvas");
    DOMElement.style.position = "absolute";
    return { context:DOMElement.getContext("2d"), buffer:DOMElement, _image:DOMElement };
}
CABackingStoreSetSize = function(aBackingStore, aSize)
{
    var buffer = aBackingStore.buffer;
    buffer.width = aSize.width;
    buffer.height = aSize.height;
    buffer.style.width = aSize.width + "px";;
    buffer.style.height = aSize.height + "px";;
}
}
else
{
CABackingStoreCreate = function()
{
    var context = CGBitmapGraphicsContextCreate();
    context.buffer = "";
    return { context:context };
}
CABackingStoreSetSize = function(aBackingStore, aSize)
{
}
}

p;14;CAFlashLayer.jt;1096;@STATIC;1.0;i;9;CALayer.ji;14;CPFlashMovie.jt;1045;objj_executeFile("CALayer.j", true);
objj_executeFile("CPFlashMovie.j", true);
{var the_class = objj_allocateClassPair(CALayer, "CAFlashLayer"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_flashMovie")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setFlashMovie:"), function(self, _cmd, aFlashMovie)
{ with(self)
{
    if (_flashMovie == aFlashMovie)
        return;
    _flashMovie = aFlashMovie;
    _DOMElement.innerHTML = "<object width = \"100%\" height = \"100%\"><param name = \"movie\" value = \"" +
                            aFlashMovie._fileName +
                            "\"></param><param name = \"wmode\" value = \"transparent\"></param><embed src = \"" +
                            aFlashMovie._fileName + "\" type = \"application/x-shockwave-flash\" wmode = \"transparent\" width = \"100%\" height = \"100%\"></embed></object>";
}
}), new objj_method(sel_getUid("flashMovie"), function(self, _cmd)
{ with(self)
{
    return _flashMovie;
}
})]);
}

p;9;CALayer.jt;35245;@STATIC;1.0;I;21;Foundation/CPObject.jI;23;AppKit/CABackingStore.jI;18;AppKit/CGContext.jI;19;AppKit/CGGeometry.ji;12;CGGeometry.jt;35107;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("AppKit/CABackingStore.j", false);
objj_executeFile("AppKit/CGContext.j", false);
objj_executeFile("AppKit/CGGeometry.j", false);
objj_executeFile("CGGeometry.j", true);
CGAffineTransformMake= function(a, b, c, d, tx, ty) { return { a:a, b:b, c:c, d:d, tx:tx, ty:ty }; }
CGAffineTransformMakeIdentity= function() { return { a:1.0, b:0.0, c:0.0, d:1.0, tx:0.0, ty:0.0 }; }
CGAffineTransformMakeCopy= function(anAffineTransform) { return { a:anAffineTransform.a, b:anAffineTransform.b, c:anAffineTransform.c, d:anAffineTransform.d, tx:anAffineTransform.tx, ty:anAffineTransform.ty }; }
CGAffineTransformMakeScale= function(sx, sy) { return { a:sx, b:0.0, c:0.0, d:sy, tx:0.0, ty:0.0 }; }
CGAffineTransformMakeTranslation= function(tx, ty) { return { a:1.0, b:0.0, c:0.0, d:1.0, tx:tx, ty:ty }; }
CGAffineTransformTranslate= function(aTransform, tx, ty) { return { a:aTransform.a, b:aTransform.b, c:aTransform.c, d:aTransform.d, tx:aTransform.tx + aTransform.a * tx + aTransform.c * ty, ty:aTransform.ty + aTransform.b * tx + aTransform.d * ty }; }
CGAffineTransformScale= function(aTransform, sx, sy) { return { a:aTransform.a * sx, b:aTransform.b * sx, c:aTransform.c * sy, d:aTransform.d * sy, tx:aTransform.tx, ty:aTransform.ty }; }
CGAffineTransformConcat= function(lhs, rhs) { return { a:lhs.a * rhs.a + lhs.b * rhs.c, b:lhs.a * rhs.b + lhs.b * rhs.d, c:lhs.c * rhs.a + lhs.d * rhs.c, d:lhs.c * rhs.b + lhs.d * rhs.d, tx:lhs.tx * rhs.a + lhs.ty * rhs.c + rhs.tx, ty:lhs.tx * rhs.b + lhs.ty * rhs.d + rhs.ty }; }
CGPointApplyAffineTransform= function(aPoint, aTransform) { return { x:aPoint.x * aTransform.a + aPoint.y * aTransform.c + aTransform.tx, y:aPoint.x * aTransform.b + aPoint.y * aTransform.d + aTransform.ty }; }
CGSizeApplyAffineTransform= function(aSize, aTransform) { return { width:aSize.width * aTransform.a + aSize.height * aTransform.c, height:aSize.width * aTransform.b + aSize.height * aTransform.d }; }
CGAffineTransformIsIdentity= function(aTransform) { return (aTransform.a == 1 && aTransform.b == 0 && aTransform.c == 0 && aTransform.d == 1 && aTransform.tx == 0 && aTransform.ty == 0); }
CGAffineTransformEqualToTransform= function(lhs, rhs) { return (lhs.a == rhs.a && lhs.b == rhs.b && lhs.c == rhs.c && lhs.d == rhs.d && lhs.tx == rhs.tx && lhs.ty == rhs.ty); }
CGStringCreateWithCGAffineTransform= function(aTransform) { return (" [[ " + aTransform.a + ", " + aTransform.b + ", 0 ], [ " + aTransform.c + ", " + aTransform.d + ", 0 ], [ " + aTransform.tx + ", " + aTransform.ty + ", 1]]"); }
CGAffineTransformCreateCopy= function(aTransform)
{
    return { a:aTransform.a, b:aTransform.b, c:aTransform.c, d:aTransform.d, tx:aTransform.tx, ty:aTransform.ty };
}
CGAffineTransformMakeRotation= function(anAngle)
{
    var sin = SIN(anAngle),
        cos = COS(anAngle);
    return { a:cos, b:sin, c:-sin, d:cos, tx:0.0, ty:0.0 };
}
CGAffineTransformRotate= function(aTransform, anAngle)
{
    var sin = SIN(anAngle),
        cos = COS(anAngle);
    return {
            a:aTransform.a * cos + aTransform.c * sin,
            b:aTransform.b * cos + aTransform.d * sin,
            c:aTransform.c * cos - aTransform.a * sin,
            d:aTransform.d * cos - aTransform.b * sin,
            tx:aTransform.tx,
            ty:aTransform.ty
        };
}
CGAffineTransformInvert= function(aTransform)
{
    var determinant = 1 / (aTransform.a * aTransform.d - aTransform.b * aTransform.c);
    return {
        a:determinant * aTransform.d,
        b:-determinant * aTransform.b,
        c:-determinant * aTransform.c,
        d:determinant * aTransform.a,
        tx:determinant * (aTransform.c * aTransform.ty - aTransform.d * aTransform.tx),
        ty:determinant * (aTransform.b * aTransform.tx - aTransform.a * aTransform.ty)
    };
}
CGRectApplyAffineTransform= function(aRect, anAffineTransform)
{
    var top = (aRect.origin.y),
        left = (aRect.origin.x),
        right = (aRect.origin.x + aRect.size.width),
        bottom = (aRect.origin.y + aRect.size.height),
        topLeft = CGPointApplyAffineTransform({ x:left, y:top }, anAffineTransform),
        topRight = CGPointApplyAffineTransform({ x:right, y:top }, anAffineTransform),
        bottomLeft = CGPointApplyAffineTransform({ x:left, y:bottom }, anAffineTransform),
        bottomRight = CGPointApplyAffineTransform({ x:right, y:bottom }, anAffineTransform),
        minX = MIN(topLeft.x, topRight.x, bottomLeft.x, bottomRight.x),
        maxX = MAX(topLeft.x, topRight.x, bottomLeft.x, bottomRight.x),
        minY = MIN(topLeft.y, topRight.y, bottomLeft.y, bottomRight.y),
        maxY = MAX(topLeft.y, topRight.y, bottomLeft.y, bottomRight.y);
    return { origin: { x:minX, y:minY }, size: { width:(maxX - minX), height:(maxY - minY) } };
}
CPStringFromCGAffineTransform= function(anAffineTransform)
{
    return '{' + anAffineTransform.a + ", " + anAffineTransform.b + ", " + anAffineTransform.c + ", " + anAffineTransform.d + ", " + anAffineTransform.tx + ", " + anAffineTransform.ty + '}';
}
var CALayerGeometryBoundsMask = 1,
    CALayerGeometryPositionMask = 2,
    CALayerGeometryAnchorPointMask = 4,
    CALayerGeometryAffineTransformMask = 8,
    CALayerGeometryParentSublayerTransformMask = 16;
var USE_BUFFER = NO;
var CALayerFrameOriginUpdateMask = 1,
    CALayerFrameSizeUpdateMask = 2,
    CALayerZPositionUpdateMask = 4,
    CALayerDisplayUpdateMask = 8,
    CALayerCompositeUpdateMask = 16,
    CALayerDOMUpdateMask = CALayerZPositionUpdateMask | CALayerFrameOriginUpdateMask | CALayerFrameSizeUpdateMask;
var CALayerRegisteredRunLoopUpdates = nil;
{var the_class = objj_allocateClassPair(CPObject, "CALayer"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_frame"), new objj_ivar("_bounds"), new objj_ivar("_position"), new objj_ivar("_zPosition"), new objj_ivar("_anchorPoint"), new objj_ivar("_affineTransform"), new objj_ivar("_sublayerTransform"), new objj_ivar("_sublayerTransformForSublayers"), new objj_ivar("_backingStoreFrame"), new objj_ivar("_standardBackingStoreFrame"), new objj_ivar("_hasSublayerTransform"), new objj_ivar("_hasCustomBackingStoreFrame"), new objj_ivar("_opacity"), new objj_ivar("_isHidden"), new objj_ivar("_backgroundColor"), new objj_ivar("_superlayer"), new objj_ivar("_sublayers"), new objj_ivar("_runLoopUpdateMask"), new objj_ivar("_needsDisplayOnBoundsChange"), new objj_ivar("_delegate"), new objj_ivar("_delegateRespondsToDisplayLayerSelector"), new objj_ivar("_delegateRespondsToDrawLayerInContextSelector"), new objj_ivar("_DOMElement"), new objj_ivar("_DOMContentsElement"), new objj_ivar("_contents"), new objj_ivar("_context"), new objj_ivar("_owningView"), new objj_ivar("_transformToLayer"), new objj_ivar("_transformFromLayer")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CALayer").super_class }, "init");

    if (self)
    {
        _frame = CGRectMakeZero();

        _backingStoreFrame = CGRectMakeZero();
        _standardBackingStoreFrame = CGRectMakeZero();

        _bounds = CGRectMakeZero();
        _position = CGPointMakeZero();
        _zPosition = 0.0;
        _anchorPoint = CGPointMake(0.5, 0.5);
        _affineTransform = CGAffineTransformMakeIdentity();
        _sublayerTransform = CGAffineTransformMakeIdentity();

        _transformToLayer = CGAffineTransformMakeIdentity();
        _transformFromLayer = CGAffineTransformMakeIdentity();

        _opacity = 1.0;
        _isHidden = NO;
        _masksToBounds = NO;

        _sublayers = [];

        _DOMElement = document.createElement("div");

        _DOMElement.style.overflow = "visible";
        _DOMElement.style.position = "absolute";
        _DOMElement.style.visibility = "visible";
        _DOMElement.style.top = "0px";
        _DOMElement.style.left = "0px";
        _DOMElement.style.zIndex = 0;
        _DOMElement.style.width = "0px";
        _DOMElement.style.height = "0px";
    }

    return self;
}
}), new objj_method(sel_getUid("setBounds:"), function(self, _cmd, aBounds)
{ with(self)
{
    if (CGRectEqualToRect(_bounds, aBounds))
        return;

    var oldOrigin = _bounds.origin;

    _bounds = { origin: { x:aBounds.origin.x, y:aBounds.origin.y }, size: { width:aBounds.size.width, height:aBounds.size.height } };

    if (_hasSublayerTransform)
        _CALayerUpdateSublayerTransformForSublayers(self);
    _CALayerRecalculateGeometry(self, CALayerGeometryBoundsMask);
}
}), new objj_method(sel_getUid("bounds"), function(self, _cmd)
{ with(self)
{
    return _bounds;
}
}), new objj_method(sel_getUid("setPosition:"), function(self, _cmd, aPosition)
{ with(self)
{
    if (CGPointEqualToPoint(_position, aPosition))
        return;
    _position = { x:aPosition.x, y:aPosition.y };
    _CALayerRecalculateGeometry(self, CALayerGeometryPositionMask);
}
}), new objj_method(sel_getUid("position"), function(self, _cmd)
{ with(self)
{
    return _position;
}
}), new objj_method(sel_getUid("setZPosition:"), function(self, _cmd, aZPosition)
{ with(self)
{
    if (_zPosition == aZPosition)
        return;
    _zPosition = aZPosition;
    objj_msgSend(self, "registerRunLoopUpdateWithMask:", CALayerZPositionUpdateMask);
}
}), new objj_method(sel_getUid("setAnchorPoint:"), function(self, _cmd, anAnchorPoint)
{ with(self)
{
    anAnchorPoint = { x:anAnchorPoint.x, y:anAnchorPoint.y };
    anAnchorPoint.x = MIN(1.0, MAX(0.0, anAnchorPoint.x));
    anAnchorPoint.y = MIN(1.0, MAX(0.0, anAnchorPoint.y));
    if (CGPointEqualToPoint(_anchorPoint, anAnchorPoint))
        return;
    _anchorPoint = anAnchorPoint;
    if (_hasSublayerTransform)
        _CALayerUpdateSublayerTransformForSublayers(self);
    if (_owningView)
        _position = CGPointMake((_bounds.size.width) * _anchorPoint.x, (_bounds.size.height) * _anchorPoint.y);
    _CALayerRecalculateGeometry(self, CALayerGeometryAnchorPointMask);
}
}), new objj_method(sel_getUid("anchorPoint"), function(self, _cmd)
{ with(self)
{
    return _anchorPoint;
}
}), new objj_method(sel_getUid("setAffineTransform:"), function(self, _cmd, anAffineTransform)
{ with(self)
{
    if (CGAffineTransformEqualToTransform(_affineTransform, anAffineTransform))
        return;
    _affineTransform = { a:anAffineTransform.a, b:anAffineTransform.b, c:anAffineTransform.c, d:anAffineTransform.d, tx:anAffineTransform.tx, ty:anAffineTransform.ty };
    _CALayerRecalculateGeometry(self, CALayerGeometryAffineTransformMask);
}
}), new objj_method(sel_getUid("affineTransform"), function(self, _cmd)
{ with(self)
{
    return _affineTransform;
}
}), new objj_method(sel_getUid("setSublayerTransform:"), function(self, _cmd, anAffineTransform)
{ with(self)
{
    if (CGAffineTransformEqualToTransform(_sublayerTransform, anAffineTransform))
        return;
    var hadSublayerTransform = _hasSublayerTransform;
    _sublayerTransform = { a:anAffineTransform.a, b:anAffineTransform.b, c:anAffineTransform.c, d:anAffineTransform.d, tx:anAffineTransform.tx, ty:anAffineTransform.ty };
    _hasSublayerTransform = !(_sublayerTransform.a == 1 && _sublayerTransform.b == 0 && _sublayerTransform.c == 0 && _sublayerTransform.d == 1 && _sublayerTransform.tx == 0 && _sublayerTransform.ty == 0);
    if (_hasSublayerTransform)
    {
        _CALayerUpdateSublayerTransformForSublayers(self);
        var index = _sublayers.length;
        while (index--)
            _CALayerRecalculateGeometry(_sublayers[index], CALayerGeometryParentSublayerTransformMask);
    }
}
}), new objj_method(sel_getUid("sublayerTransform"), function(self, _cmd)
{ with(self)
{
    return _sublayerTransform;
}
}), new objj_method(sel_getUid("transformToLayer"), function(self, _cmd)
{ with(self)
{
    return _transformToLayer;
}
}), new objj_method(sel_getUid("setFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    alert("FIXME IMPLEMENT");
}
}), new objj_method(sel_getUid("frame"), function(self, _cmd)
{ with(self)
{
    if (!_frame)
        _frame = objj_msgSend(self, "convertRect:toLayer:", _bounds, _superlayer);
    return _frame;
}
}), new objj_method(sel_getUid("backingStoreFrame"), function(self, _cmd)
{ with(self)
{
    return _backingStoreFrame;
}
}), new objj_method(sel_getUid("setBackingStoreFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    _hasCustomBackingStoreFrame = (aFrame != nil);
    if (aFrame == nil)
        aFrame = CGRectMakeCopy(_standardBackingStoreFrame);
    else
    {
        if (_superlayer)
        {
            aFrame = objj_msgSend(_superlayer, "convertRect:toLayer:", aFrame, nil);
            var bounds = objj_msgSend(_superlayer, "bounds"),
                frame = objj_msgSend(_superlayer, "convertRect:toLayer:", bounds, nil);
            aFrame.origin.x -= (frame.origin.x);
            aFrame.origin.y -= (frame.origin.y);
        }
        else
            aFrame = CGRectMakeCopy(aFrame);
    }
    if (!CGPointEqualToPoint(_backingStoreFrame.origin, aFrame.origin))
        objj_msgSend(self, "registerRunLoopUpdateWithMask:", CALayerFrameOriginUpdateMask);
    if (!CGSizeEqualToSize(_backingStoreFrame.size, aFrame.size))
        objj_msgSend(self, "registerRunLoopUpdateWithMask:", CALayerFrameSizeUpdateMask);
    _backingStoreFrame = aFrame;
}
}), new objj_method(sel_getUid("contents"), function(self, _cmd)
{ with(self)
{
    return _contents;
}
}), new objj_method(sel_getUid("setContents:"), function(self, _cmd, contents)
{ with(self)
{
    if (_contents == contents)
        return;
    _contents = contents;
    objj_msgSend(self, "composite");
}
}), new objj_method(sel_getUid("composite"), function(self, _cmd)
{ with(self)
{
    if (USE_BUFFER && !_contents || !_context)
        return;
    CGContextClearRect(_context, { origin: { x:0.0, y:0.0 }, size: { width:(_backingStoreFrame.size.width), height:(_backingStoreFrame.size.height) } });
    var transform = _transformFromLayer;
    if (_superlayer)
    {
        var superlayerTransform = _CALayerGetTransform(_superlayer, nil),
            superlayerOrigin = CGPointApplyAffineTransform(_superlayer._bounds.origin, superlayerTransform);
        transform = CGAffineTransformConcat(transform, superlayerTransform);
        transform.tx -= superlayerOrigin.x;
        transform.ty -= superlayerOrigin.y;
    }
    transform.tx -= (_backingStoreFrame.origin.x);
    transform.ty -= (_backingStoreFrame.origin.y);
    CGContextSaveGState(_context);
    CGContextConcatCTM(_context, transform);
    if (USE_BUFFER)
    {
        _context.drawImage(_contents.buffer, (_bounds.origin.x), (_bounds.origin.y));
    }
    else
        objj_msgSend(self, "drawInContext:", _context);
    CGContextRestoreGState(_context);
}
}), new objj_method(sel_getUid("display"), function(self, _cmd)
{ with(self)
{
    if (!_context)
    {
        _context = CGBitmapGraphicsContextCreate();
        _DOMContentsElement = _context.DOMElement;
        _DOMContentsElement.style.zIndex = -100;
        _DOMContentsElement.style.overflow = "hidden";
        _DOMContentsElement.style.position = "absolute";
        _DOMContentsElement.style.visibility = "visible";
        _DOMContentsElement.width = ROUND((_backingStoreFrame.size.width));
        _DOMContentsElement.height = ROUND((_backingStoreFrame.size.height));
        _DOMContentsElement.style.top = "0px";
        _DOMContentsElement.style.left = "0px";
        _DOMContentsElement.style.width = ROUND((_backingStoreFrame.size.width)) + "px";
        _DOMContentsElement.style.height = ROUND((_backingStoreFrame.size.height)) + "px";
        _DOMElement.appendChild(_DOMContentsElement);
    }
    if (USE_BUFFER)
    {
        if (_delegateRespondsToDisplayLayerSelector)
            return objj_msgSend(_delegate, "displayInLayer:", self);
        if ((_backingStoreFrame.size.width) == 0.0 || (_backingStoreFrame.size.height) == 0.0)
            return;
        if (!_contents)
            _contents = CABackingStoreCreate();
        CABackingStoreSetSize(_contents, _bounds.size);
        objj_msgSend(self, "drawInContext:", CABackingStoreGetContext(_contents));
    }
    objj_msgSend(self, "composite");
}
}), new objj_method(sel_getUid("drawInContext:"), function(self, _cmd, aContext)
{ with(self)
{
    if (_backgroundColor)
    {
        CGContextSetFillColor(aContext, _backgroundColor);
        CGContextFillRect(aContext, _bounds);
    }
    if (_delegateRespondsToDrawLayerInContextSelector)
        objj_msgSend(_delegate, "drawLayer:inContext:", self, aContext);
}
}), new objj_method(sel_getUid("opacity"), function(self, _cmd)
{ with(self)
{
    return _opacity;
}
}), new objj_method(sel_getUid("setOpacity:"), function(self, _cmd, anOpacity)
{ with(self)
{
    if (_opacity == anOpacity)
        return;
    _opacity = anOpacity;
    _DOMElement.style.opacity = anOpacity;
    _DOMElement.style.filter = "alpha(opacity=" + anOpacity * 100 + ")";
}
}), new objj_method(sel_getUid("setHidden:"), function(self, _cmd, isHidden)
{ with(self)
{
    _isHidden = isHidden;
    _DOMElement.style.display = isHidden ? "none" : "block";
}
}), new objj_method(sel_getUid("hidden"), function(self, _cmd)
{ with(self)
{
    return _isHidden;
}
}), new objj_method(sel_getUid("isHidden"), function(self, _cmd)
{ with(self)
{
    return _isHidden;
}
}), new objj_method(sel_getUid("setMasksToBounds:"), function(self, _cmd, masksToBounds)
{ with(self)
{
    if (_masksToBounds == masksToBounds)
        return;
    _masksToBounds = masksToBounds;
    _DOMElement.style.overflow = _masksToBounds ? "hidden" : "visible";
}
}), new objj_method(sel_getUid("setBackgroundColor:"), function(self, _cmd, aColor)
{ with(self)
{
    _backgroundColor = aColor;
    objj_msgSend(self, "setNeedsDisplay");
}
}), new objj_method(sel_getUid("backgroundColor"), function(self, _cmd)
{ with(self)
{
    return _backgroundColor;
}
}), new objj_method(sel_getUid("sublayers"), function(self, _cmd)
{ with(self)
{
    return _sublayers;
}
}), new objj_method(sel_getUid("superlayer"), function(self, _cmd)
{ with(self)
{
    return _superlayer;
}
}), new objj_method(sel_getUid("addSublayer:"), function(self, _cmd, aLayer)
{ with(self)
{
    objj_msgSend(self, "insertSublayer:atIndex:", aLayer, _sublayers.length);
    return;
    if (_DOMContentsElement && aLayer._zPosition > _DOMContentsElement.style.zIndex) _DOMContentsElement.style.zIndex -= 100.0;;
    objj_msgSend(_sublayers, "addObject:", aLayer);
    _DOMElement.appendChild(aLayer._DOMElement);
}
}), new objj_method(sel_getUid("removeFromSuperlayer"), function(self, _cmd)
{ with(self)
{
    if (_owningView)
        objj_msgSend(_owningView, "setLayer:", nil);
    if (!_superlayer)
        return;
    _superlayer._DOMElement.removeChild(_DOMElement);
    objj_msgSend(_superlayer._sublayers, "removeObject:", self);
    _superlayer = nil;
}
}), new objj_method(sel_getUid("insertSublayer:atIndex:"), function(self, _cmd, aLayer, anIndex)
{ with(self)
{
    if (!aLayer)
        return;
    var superlayer = objj_msgSend(aLayer, "superlayer");
    if (superlayer == self)
    {
        var index = objj_msgSend(_sublayers, "indexOfObjectIdenticalTo:", aLayer);
        if (index == anIndex)
            return;
        objj_msgSend(_sublayers, "removeObjectAtIndex:", index);
        if (index < anIndex)
            --anIndex;
    }
    else if (superlayer != nil)
        objj_msgSend(aLayer, "removeFromSuperlayer");
    if (_DOMContentsElement && aLayer._zPosition > _DOMContentsElement.style.zIndex) _DOMContentsElement.style.zIndex -= 100.0;;
    objj_msgSend(_sublayers, "insertObject:atIndex:", aLayer, anIndex);
    if (anIndex >= _sublayers.length - 1)
        _DOMElement.appendChild(aLayer._DOMElement);
    else
        _DOMElement.insertBefore(aLayer._DOMElement, _sublayers[anIndex + 1]._DOMElement);
    aLayer._superlayer = self;
    if (self != superlayer)
        _CALayerRecalculateGeometry(aLayer, 0xFFFFFFF);
}
}), new objj_method(sel_getUid("insertSublayer:below:"), function(self, _cmd, aLayer, aSublayer)
{ with(self)
{
    var index = aSublayer ? objj_msgSend(_sublayers, "indexOfObjectIdenticalTo:", aSublayer) : 0;
    objj_msgSend(self, "insertSublayer:atIndex:", aLayer, index == CPNotFound ? _sublayers.length : index);
}
}), new objj_method(sel_getUid("insertSublayer:above:"), function(self, _cmd, aLayer, aSublayer)
{ with(self)
{
    var index = aSublayer ? objj_msgSend(_sublayers, "indexOfObjectIdenticalTo:", aSublayer) : _sublayers.length;
    if (index == CPNotFound)
        objj_msgSend(CPException, "raise:reason:", "CALayerNotFoundException", "aSublayer is not a sublayer of this layer");
    objj_msgSend(_sublayers, "insertObject:atIndex:", aLayer, index == CPNotFound ? _sublayers.length : index + 1);
}
}), new objj_method(sel_getUid("replaceSublayer:with:"), function(self, _cmd, aSublayer, aLayer)
{ with(self)
{
    if (aSublayer == aLayer)
        return;
    if (aSublayer._superlayer != self)
    {
        alert("EXCEPTION");
        return;
    }
    if (_DOMContentsElement && aLayer._zPosition > _DOMContentsElement.style.zIndex) _DOMContentsElement.style.zIndex -= 100.0;;
    objj_msgSend(_sublayers, "replaceObjectAtIndex:withObject:", objj_msgSend(_sublayers, "indexOfObjectIdenticalTo:", aSublayer), aLayer);
    _DOMElement.replaceChild(aSublayer._DOMElement, aLayer._DOMElement);
}
}), new objj_method(sel_getUid("registerRunLoopUpdateWithMask:"), function(self, _cmd, anUpdateMask)
{ with(self)
{
    if (CALayerRegisteredRunLoopUpdates == nil)
    {
        CALayerRegisteredRunLoopUpdates = {};
        objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "performSelector:target:argument:order:modes:", sel_getUid("runLoopUpdateLayers"), CALayer, nil, 0, [CPDefaultRunLoopMode]);
    }
    _runLoopUpdateMask |= anUpdateMask;
    CALayerRegisteredRunLoopUpdates[objj_msgSend(self, "UID")] = self;
}
}), new objj_method(sel_getUid("setNeedsComposite"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "registerRunLoopUpdateWithMask:", CALayerCompositeUpdateMask);
}
}), new objj_method(sel_getUid("setNeedsDisplay"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "registerRunLoopUpdateWithMask:", CALayerDisplayUpdateMask);
}
}), new objj_method(sel_getUid("setNeedsDisplayOnBoundsChange:"), function(self, _cmd, needsDisplayOnBoundsChange)
{ with(self)
{
    _needsDisplayOnBoundsChange = needsDisplayOnBoundsChange;
}
}), new objj_method(sel_getUid("needsDisplayOnBoundsChange"), function(self, _cmd)
{ with(self)
{
    return _needsDisplayOnBoundsChange;
}
}), new objj_method(sel_getUid("setNeedsDisplayInRect:"), function(self, _cmd, aRect)
{ with(self)
{
    _dirtyRect = aRect;
    objj_msgSend(self, "display");
}
}), new objj_method(sel_getUid("convertPoint:fromLayer:"), function(self, _cmd, aPoint, aLayer)
{ with(self)
{
    return CGPointApplyAffineTransform(aPoint, _CALayerGetTransform(aLayer, self));
}
}), new objj_method(sel_getUid("convertPoint:toLayer:"), function(self, _cmd, aPoint, aLayer)
{ with(self)
{
    return CGPointApplyAffineTransform(aPoint, _CALayerGetTransform(self, aLayer));
}
}), new objj_method(sel_getUid("convertRect:fromLayer:"), function(self, _cmd, aRect, aLayer)
{ with(self)
{
    return CGRectApplyAffineTransform(aRect, _CALayerGetTransform(aLayer, self));
}
}), new objj_method(sel_getUid("convertRect:toLayer:"), function(self, _cmd, aRect, aLayer)
{ with(self)
{
    return CGRectApplyAffineTransform(aRect, _CALayerGetTransform(self, aLayer));
}
}), new objj_method(sel_getUid("containsPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    return (aPoint.x >= (_bounds.origin.x) && aPoint.y >= (_bounds.origin.y) && aPoint.x < (_bounds.origin.x + _bounds.size.width) && aPoint.y < (_bounds.origin.y + _bounds.size.height));
}
}), new objj_method(sel_getUid("hitTest:"), function(self, _cmd, aPoint)
{ with(self)
{
    if (_isHidden)
        return nil;
    var point = CGPointApplyAffineTransform(aPoint, _transformToLayer);
    if (!(point.x >= (_bounds.origin.x) && point.y >= (_bounds.origin.y) && point.x < (_bounds.origin.x + _bounds.size.width) && point.y < (_bounds.origin.y + _bounds.size.height)))
        return nil;
    var layer = nil,
        index = _sublayers.length;
    while (index--)
        if (layer = objj_msgSend(_sublayers[index], "hitTest:", point))
            return layer;
    return self;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    if (_delegate == aDelegate)
        return;
    _delegate = aDelegate;
    _delegateRespondsToDisplayLayerSelector = objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("displayLayer:"));
    _delegateRespondsToDrawLayerInContextSelector = objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("drawLayer:inContext:"));
    if (_delegateRespondsToDisplayLayerSelector || _delegateRespondsToDrawLayerInContextSelector)
        objj_msgSend(self, "setNeedsDisplay");
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("_setOwningView:"), function(self, _cmd, anOwningView)
{ with(self)
{
    _owningView = anOwningView;
    if (_owningView)
    {
        _owningView = anOwningView;
        _bounds.size = CGSizeMakeCopy(objj_msgSend(_owningView, "bounds").size);
        _position = CGPointMake((_bounds.size.width) * _anchorPoint.x, (_bounds.size.height) * _anchorPoint.y);
    }
    _CALayerRecalculateGeometry(self, CALayerGeometryPositionMask | CALayerGeometryBoundsMask);
}
}), new objj_method(sel_getUid("_owningViewBoundsChanged"), function(self, _cmd)
{ with(self)
{
    _bounds.size = CGSizeMakeCopy(objj_msgSend(_owningView, "bounds").size);
    _position = CGPointMake((_bounds.size.width) * _anchorPoint.x, (_bounds.size.height) * _anchorPoint.y);
    _CALayerRecalculateGeometry(self, CALayerGeometryPositionMask | CALayerGeometryBoundsMask);
}
}), new objj_method(sel_getUid("_update"), function(self, _cmd)
{ with(self)
{
    window.loop = true;
    var mask = _runLoopUpdateMask;
    if (mask & CALayerDOMUpdateMask)
        _CALayerUpdateDOM(self, mask);
    if (mask & CALayerDisplayUpdateMask)
        objj_msgSend(self, "display");
    else if (mask & CALayerFrameSizeUpdateMask || mask & CALayerCompositeUpdateMask)
        objj_msgSend(self, "composite");
    _runLoopUpdateMask = 0;
    window.loop = false;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("layer"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(objj_msgSend(self, "class"), "alloc"), "init");
}
}), new objj_method(sel_getUid("runLoopUpdateLayers"), function(self, _cmd)
{ with(self)
{if (window.oops) {alert(window.latest); objj_debug_print_backtrace();}
    window.loop = true;
    for (UID in CALayerRegisteredRunLoopUpdates)
    {
        var layer = CALayerRegisteredRunLoopUpdates[UID],
            mask = layer._runLoopUpdateMask;
        if (mask & CALayerDOMUpdateMask)
            _CALayerUpdateDOM(layer, mask);
        if (mask & CALayerDisplayUpdateMask)
            objj_msgSend(layer, "display");
        else if (mask & CALayerFrameSizeUpdateMask || mask & CALayerCompositeUpdateMask)
            objj_msgSend(layer, "composite");
        layer._runLoopUpdateMask = 0;
    }
    window.loop= false;
    CALayerRegisteredRunLoopUpdates = nil;
}
})]);
}
_CALayerUpdateSublayerTransformForSublayers= function(aLayer)
{
    var bounds = aLayer._bounds,
        anchorPoint = aLayer._anchorPoint,
        translateX = (bounds.size.width) * anchorPoint.x,
        translateY = (bounds.size.height) * anchorPoint.y;
    aLayer._sublayerTransformForSublayers = CGAffineTransformConcat(
        CGAffineTransformMakeTranslation(-translateX, -translateY),
        CGAffineTransformConcat(aLayer._sublayerTransform,
        CGAffineTransformMakeTranslation(translateX, translateY)));
}
_CALayerUpdateDOM= function(aLayer, aMask)
{
    var DOMElementStyle = aLayer._DOMElement.style;
    if (aMask & CALayerZPositionUpdateMask)
        DOMElementStyle.zIndex = aLayer._zPosition;
    var frame = aLayer._backingStoreFrame;
    if (aMask & CALayerFrameOriginUpdateMask)
    {
        DOMElementStyle.top = ROUND((frame.origin.y)) + "px";
        DOMElementStyle.left = ROUND((frame.origin.x)) + "px";
    }
    if (aMask & CALayerFrameSizeUpdateMask)
    {
        var width = MAX(0.0, ROUND((frame.size.width))),
            height = MAX(0.0, ROUND((frame.size.height))),
            DOMContentsElement = aLayer._DOMContentsElement;
        DOMElementStyle.width = width + "px";
        DOMElementStyle.height = height + "px";
        if (DOMContentsElement)
        {
            DOMContentsElement.width = width;
            DOMContentsElement.height = height;
            DOMContentsElement.style.width = width + "px";
            DOMContentsElement.style.height = height + "px";
        }
    }
}
_CALayerRecalculateGeometry= function(aLayer, aGeometryChange)
{
    var bounds = aLayer._bounds,
        superlayer = aLayer._superlayer,
        width = (bounds.size.width),
        height = (bounds.size.height),
        position = aLayer._position,
        anchorPoint = aLayer._anchorPoint,
        affineTransform = aLayer._affineTransform,
        backingStoreFrameSize = { width:aLayer._backingStoreFrame.width, height:aLayer._backingStoreFrame.height },
        hasCustomBackingStoreFrame = aLayer._hasCustomBackingStoreFrame;
    aLayer._transformFromLayer = CGAffineTransformConcat(
        CGAffineTransformMakeTranslation(-width * anchorPoint.x - (aLayer._bounds.origin.x), -height * anchorPoint.y - (aLayer._bounds.origin.y)),
        CGAffineTransformConcat(affineTransform,
        CGAffineTransformMakeTranslation(position.x, position.y)));
    if (superlayer && superlayer._hasSublayerTransform)
    {
        var tx = aLayer._transformFromLayer.tx * superlayer._sublayerTransformForSublayers.a + aLayer._transformFromLayer.ty * superlayer._sublayerTransformForSublayers.c + superlayer._sublayerTransformForSublayers.tx;aLayer._transformFromLayer.ty = aLayer._transformFromLayer.tx * superlayer._sublayerTransformForSublayers.b + aLayer._transformFromLayer.ty * superlayer._sublayerTransformForSublayers.d + superlayer._sublayerTransformForSublayers.ty;aLayer._transformFromLayer.tx = tx;var a = aLayer._transformFromLayer.a * superlayer._sublayerTransformForSublayers.a + aLayer._transformFromLayer.b * superlayer._sublayerTransformForSublayers.c, b = aLayer._transformFromLayer.a * superlayer._sublayerTransformForSublayers.b + aLayer._transformFromLayer.b * superlayer._sublayerTransformForSublayers.d, c = aLayer._transformFromLayer.c * superlayer._sublayerTransformForSublayers.a + aLayer._transformFromLayer.d * superlayer._sublayerTransformForSublayers.c;aLayer._transformFromLayer.d = aLayer._transformFromLayer.c * superlayer._sublayerTransformForSublayers.b + aLayer._transformFromLayer.d * superlayer._sublayerTransformForSublayers.d;aLayer._transformFromLayer.a = a;aLayer._transformFromLayer.b = b;aLayer._transformFromLayer.c = c;;
    }
    aLayer._transformToLayer = CGAffineTransformInvert(aLayer._transformFromLayer);
    aLayer._frame = nil;
    aLayer._standardBackingStoreFrame = objj_msgSend(aLayer, "convertRect:toLayer:", bounds, nil);
    if (superlayer)
    {
        var bounds = objj_msgSend(superlayer, "bounds"),
            frame = objj_msgSend(superlayer, "convertRect:toLayer:", bounds, nil);
        aLayer._standardBackingStoreFrame.origin.x -= (frame.origin.x);
        aLayer._standardBackingStoreFrame.origin.y -= (frame.origin.y);
    }
    var origin = aLayer._standardBackingStoreFrame.origin,
        size = aLayer._standardBackingStoreFrame.size;
    origin.x = FLOOR(origin.x);
    origin.y = FLOOR(origin.y);
    size.width = CEIL(size.width) + 1.0;
    size.height = CEIL(size.height) + 1.0;
    if (!hasCustomBackingStoreFrame)
    {
        var backingStoreFrame = CGRectMakeCopy(aLayer._standardBackingStoreFrame);
        if (ROUND((backingStoreFrame.origin.x)) != ROUND((aLayer._backingStoreFrame.origin.x)) ||
            ROUND((backingStoreFrame.origin.y)) != ROUND((aLayer._backingStoreFrame.origin.y)))
            objj_msgSend(aLayer, "registerRunLoopUpdateWithMask:", CALayerFrameOriginUpdateMask);
        if (((backingStoreFrame.size.width) != ROUND((aLayer._backingStoreFrame.size.width)) ||
            (backingStoreFrame.size.height) != ROUND((aLayer._backingStoreFrame.size.height))))
            objj_msgSend(aLayer, "registerRunLoopUpdateWithMask:", CALayerFrameSizeUpdateMask);
        aLayer._backingStoreFrame = backingStoreFrame;
    }
    if (aGeometryChange & CALayerGeometryBoundsMask && aLayer._needsDisplayOnBoundsChange)
        objj_msgSend(aLayer, "setNeedsDisplay");
    else if (hasCustomBackingStoreFrame || (aGeometryChange & ~(CALayerGeometryPositionMask | CALayerGeometryAnchorPointMask)))
        objj_msgSend(aLayer, "setNeedsComposite");
    var sublayers = aLayer._sublayers,
        index = 0,
        count = sublayers.length;
    for (; index < count; ++index)
        _CALayerRecalculateGeometry(sublayers[index], aGeometryChange);
}
_CALayerGetTransform= function(fromLayer, toLayer)
{
    var transform = CGAffineTransformMakeIdentity();
    if (fromLayer)
    {
        var layer = fromLayer;
        while (layer && layer != toLayer)
        {
            var transformFromLayer = layer._transformFromLayer;
            var tx = transform.tx * transformFromLayer.a + transform.ty * transformFromLayer.c + transformFromLayer.tx;transform.ty = transform.tx * transformFromLayer.b + transform.ty * transformFromLayer.d + transformFromLayer.ty;transform.tx = tx;var a = transform.a * transformFromLayer.a + transform.b * transformFromLayer.c, b = transform.a * transformFromLayer.b + transform.b * transformFromLayer.d, c = transform.c * transformFromLayer.a + transform.d * transformFromLayer.c;transform.d = transform.c * transformFromLayer.b + transform.d * transformFromLayer.d;transform.a = a;transform.b = b;transform.c = c;;
            layer = layer._superlayer;
        }
        if (layer == toLayer)
            return transform;
    }
    var layers = [],
        layer = toLayer;
    while (layer)
    {
        layers.push(layer);
        layer = layer._superlayer;
    }
    var index = layers.length;
    while (index--)
    {
        var transformToLayer = layers[index]._transformToLayer;
        var tx = transform.tx * transformToLayer.a + transform.ty * transformToLayer.c + transformToLayer.tx;transform.ty = transform.tx * transformToLayer.b + transform.ty * transformToLayer.d + transformToLayer.ty;transform.tx = tx;var a = transform.a * transformToLayer.a + transform.b * transformToLayer.c, b = transform.a * transformToLayer.b + transform.b * transformToLayer.d, c = transform.c * transformToLayer.a + transform.d * transformToLayer.c;transform.d = transform.c * transformToLayer.b + transform.d * transformToLayer.d;transform.a = a;transform.b = b;transform.c = c;;
    }
    return transform;
}

p;23;CAMediaTimingFunction.jt;3058;@STATIC;1.0;I;21;Foundation/CPObject.jI;25;Foundation/CPDictionary.jI;21;Foundation/CPString.jt;2957;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPDictionary.j", false);
objj_executeFile("Foundation/CPString.j", false);
kCAMediaTimingFunctionLinear = "kCAMediaTimingFunctionLinear";
kCAMediaTimingFunctionEaseIn = "kCAMediaTimingFunctionEaseIn";
kCAMediaTimingFunctionEaseOut = "kCAMediaTimingFunctionEaseOut";
kCAMediaTimingFunctionEaseInEaseOut = "kCAMediaTimingFunctionEaseInEaseOut";
var CAMediaNamedTimingFunctions = nil;
{var the_class = objj_allocateClassPair(CPObject, "CAMediaTimingFunction"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_c1x"), new objj_ivar("_c1y"), new objj_ivar("_c2x"), new objj_ivar("_c2y")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithControlPoints::::"), function(self, _cmd, c1x, c1y, c2x, c2y)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CAMediaTimingFunction").super_class }, "init");
    if (self)
    {
        _c1x = c1x;
        _c1y = c1y;
        _c2x = c2x;
        _c2y = c2y;
    }
    return self;
}
}), new objj_method(sel_getUid("getControlPointAtIndex:values:"), function(self, _cmd, anIndex, reference)
{ with(self)
{
    if (anIndex == 0)
    {
        reference[0] = 0;
        reference[1] = 0;
    }
    else if (anIndex == 1)
    {
        reference[0] = _c1x;
        reference[1] = _c1y;
    }
    else if (anIndex == 2)
    {
        reference[0] = _c2x;
        reference[1] = _c2y;
    }
    else
    {
        reference[0] = 1.0;
        reference[1] = 1.0;
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("functionWithName:"), function(self, _cmd, aName)
{ with(self)
{
    if (!CAMediaNamedTimingFunctions)
    {
        CAMediaNamedTimingFunctions = objj_msgSend(CPDictionary, "dictionary");
        objj_msgSend(CAMediaNamedTimingFunctions, "setObject:forKey:", objj_msgSend(CAMediaTimingFunction, "functionWithControlPoints::::", 0.0 , 0.0 , 1.0 , 1.0), kCAMediaTimingFunctionLinear);
        objj_msgSend(CAMediaNamedTimingFunctions, "setObject:forKey:", objj_msgSend(CAMediaTimingFunction, "functionWithControlPoints::::", 0.42 , 0.0 , 1.0 , 1.0), kCAMediaTimingFunctionEaseIn);
        objj_msgSend(CAMediaNamedTimingFunctions, "setObject:forKey:", objj_msgSend(CAMediaTimingFunction, "functionWithControlPoints::::", 0.0 , 0.0 , 0.58 , 1.0), kCAMediaTimingFunctionEaseOut);
        objj_msgSend(CAMediaNamedTimingFunctions, "setObject:forKey:", objj_msgSend(CAMediaTimingFunction, "functionWithControlPoints::::", 0.42 , 0.0 , 0.58 , 1.0), kCAMediaTimingFunctionEaseInEaseOut);
    }
    return objj_msgSend(CAMediaNamedTimingFunctions, "objectForKey:", aName);
}
}), new objj_method(sel_getUid("functionWithControlPoints::::"), function(self, _cmd, c1x, c1y, c2x, c2y)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithControlPoints::::", c1x , c1y , c2x , c2y);
}
})]);
}

p;19;CGAffineTransform.jt;4905;@STATIC;1.0;i;12;CGGeometry.jt;4869;objj_executeFile("CGGeometry.j", true);
CGAffineTransformMake= function(a, b, c, d, tx, ty) { return { a:a, b:b, c:c, d:d, tx:tx, ty:ty }; }
CGAffineTransformMakeIdentity= function() { return { a:1.0, b:0.0, c:0.0, d:1.0, tx:0.0, ty:0.0 }; }
CGAffineTransformMakeCopy= function(anAffineTransform) { return { a:anAffineTransform.a, b:anAffineTransform.b, c:anAffineTransform.c, d:anAffineTransform.d, tx:anAffineTransform.tx, ty:anAffineTransform.ty }; }
CGAffineTransformMakeScale= function(sx, sy) { return { a:sx, b:0.0, c:0.0, d:sy, tx:0.0, ty:0.0 }; }
CGAffineTransformMakeTranslation= function(tx, ty) { return { a:1.0, b:0.0, c:0.0, d:1.0, tx:tx, ty:ty }; }
CGAffineTransformTranslate= function(aTransform, tx, ty) { return { a:aTransform.a, b:aTransform.b, c:aTransform.c, d:aTransform.d, tx:aTransform.tx + aTransform.a * tx + aTransform.c * ty, ty:aTransform.ty + aTransform.b * tx + aTransform.d * ty }; }
CGAffineTransformScale= function(aTransform, sx, sy) { return { a:aTransform.a * sx, b:aTransform.b * sx, c:aTransform.c * sy, d:aTransform.d * sy, tx:aTransform.tx, ty:aTransform.ty }; }
CGAffineTransformConcat= function(lhs, rhs) { return { a:lhs.a * rhs.a + lhs.b * rhs.c, b:lhs.a * rhs.b + lhs.b * rhs.d, c:lhs.c * rhs.a + lhs.d * rhs.c, d:lhs.c * rhs.b + lhs.d * rhs.d, tx:lhs.tx * rhs.a + lhs.ty * rhs.c + rhs.tx, ty:lhs.tx * rhs.b + lhs.ty * rhs.d + rhs.ty }; }
CGPointApplyAffineTransform= function(aPoint, aTransform) { return { x:aPoint.x * aTransform.a + aPoint.y * aTransform.c + aTransform.tx, y:aPoint.x * aTransform.b + aPoint.y * aTransform.d + aTransform.ty }; }
CGSizeApplyAffineTransform= function(aSize, aTransform) { return { width:aSize.width * aTransform.a + aSize.height * aTransform.c, height:aSize.width * aTransform.b + aSize.height * aTransform.d }; }
CGAffineTransformIsIdentity= function(aTransform) { return (aTransform.a == 1 && aTransform.b == 0 && aTransform.c == 0 && aTransform.d == 1 && aTransform.tx == 0 && aTransform.ty == 0); }
CGAffineTransformEqualToTransform= function(lhs, rhs) { return (lhs.a == rhs.a && lhs.b == rhs.b && lhs.c == rhs.c && lhs.d == rhs.d && lhs.tx == rhs.tx && lhs.ty == rhs.ty); }
CGStringCreateWithCGAffineTransform= function(aTransform) { return (" [[ " + aTransform.a + ", " + aTransform.b + ", 0 ], [ " + aTransform.c + ", " + aTransform.d + ", 0 ], [ " + aTransform.tx + ", " + aTransform.ty + ", 1]]"); }
CGAffineTransformCreateCopy= function(aTransform)
{
    return { a:aTransform.a, b:aTransform.b, c:aTransform.c, d:aTransform.d, tx:aTransform.tx, ty:aTransform.ty };
}
CGAffineTransformMakeRotation= function(anAngle)
{
    var sin = SIN(anAngle),
        cos = COS(anAngle);
    return { a:cos, b:sin, c:-sin, d:cos, tx:0.0, ty:0.0 };
}
CGAffineTransformRotate= function(aTransform, anAngle)
{
    var sin = SIN(anAngle),
        cos = COS(anAngle);
    return {
            a:aTransform.a * cos + aTransform.c * sin,
            b:aTransform.b * cos + aTransform.d * sin,
            c:aTransform.c * cos - aTransform.a * sin,
            d:aTransform.d * cos - aTransform.b * sin,
            tx:aTransform.tx,
            ty:aTransform.ty
        };
}
CGAffineTransformInvert= function(aTransform)
{
    var determinant = 1 / (aTransform.a * aTransform.d - aTransform.b * aTransform.c);
    return {
        a:determinant * aTransform.d,
        b:-determinant * aTransform.b,
        c:-determinant * aTransform.c,
        d:determinant * aTransform.a,
        tx:determinant * (aTransform.c * aTransform.ty - aTransform.d * aTransform.tx),
        ty:determinant * (aTransform.b * aTransform.tx - aTransform.a * aTransform.ty)
    };
}
CGRectApplyAffineTransform= function(aRect, anAffineTransform)
{
    var top = (aRect.origin.y),
        left = (aRect.origin.x),
        right = (aRect.origin.x + aRect.size.width),
        bottom = (aRect.origin.y + aRect.size.height),
        topLeft = CGPointApplyAffineTransform({ x:left, y:top }, anAffineTransform),
        topRight = CGPointApplyAffineTransform({ x:right, y:top }, anAffineTransform),
        bottomLeft = CGPointApplyAffineTransform({ x:left, y:bottom }, anAffineTransform),
        bottomRight = CGPointApplyAffineTransform({ x:right, y:bottom }, anAffineTransform),
        minX = MIN(topLeft.x, topRight.x, bottomLeft.x, bottomRight.x),
        maxX = MAX(topLeft.x, topRight.x, bottomLeft.x, bottomRight.x),
        minY = MIN(topLeft.y, topRight.y, bottomLeft.y, bottomRight.y),
        maxY = MAX(topLeft.y, topRight.y, bottomLeft.y, bottomRight.y);
    return { origin: { x:minX, y:minY }, size: { width:(maxX - minX), height:(maxY - minY) } };
}
CPStringFromCGAffineTransform= function(anAffineTransform)
{
    return '{' + anAffineTransform.a + ", " + anAffineTransform.b + ", " + anAffineTransform.c + ", " + anAffineTransform.d + ", " + anAffineTransform.tx + ", " + anAffineTransform.ty + '}';
}

p;9;CGColor.jt;3107;@STATIC;1.0;i;14;CGColorSpace.jt;3069;objj_executeFile("CGColorSpace.j", true);
var CFTypeGlobalCount = 0;
CFHashCode= function(aCFObject)
{
    if (!aCFObject.hash)
        aCFObject.hash = ++CFTypeGlobalCount;
    return aCFObject;
}
kCGColorWhite = "kCGColorWhite";
kCGColorBlack = "kCGColorBlack";
kCGColorClear = "kCGColorClear";
var _CGColorMap = { };
CGColorGetConstantColor= function(aColorName)
{
    alert("FIX ME");
}
CGColorRetain= function(aColor)
{
    return aColor;
}
CGColorRelease= function()
{
}
CGColorCreate= function(aColorSpace, components)
{
    if (!aColorSpace || !components)
        return NULL;
    var components = components.slice();
    CGColorSpaceStandardizeComponents(aColorSpace, components);
    var UID = CFHashCode(aColorSpace) + components.join("");
    if (_CGColorMap[UID])
        return _CGColorMap[UID];
    return _CGColorMap[UID] = { colorspace:aColorSpace, pattern:NULL, components:components };
}
CGColorCreateCopy= function(aColor)
{
    return aColor;
}
CGColorCreateGenericGray= function(gray, alpha)
{
    return CGColorCreate(0, [gray, alpha]);
}
CGColorCreateGenericRGB= function(red, green, blue, alpha)
{
    return CGColorCreate(0, [red, green, blue, alpha]);
}
CGColorCreateGenericCMYK= function(cyan, magenta, yellow, black, alpha)
{
    return CGColorCreate(0, [cyan, magenta, yellow, black, alpha]);
}
CGColorCreateCopyWithAlpha= function(aColor, anAlpha)
{
    var components = aColor.components;
    if (!aColor || anAlpha == components[components.length - 1])
     return aColor;
    if (aColor.pattern)
        var copy = CGColorCreateWithPattern(aColor.colorspace, aColor.pattern, components);
    else
        var copy = CGColorCreate(aColor.colorspace, components);
    copy.components[components.length - 1] = anAlpha;
    return copy;
}
CGColorCreateWithPattern= function(aColorSpace, aPattern, components)
{
    if (!aColorSpace || !aPattern || !components)
        return NULL;
    return { colorspace:aColorSpace, pattern:aPattern, components:components.slice() };
}
CGColorEqualToColor= function(lhs, rhs)
{
    if (lhs == rhs)
        return true;
    if (!lhs || !rhs)
        return false;
    var lhsComponents = lhs.components,
        rhsComponents = rhs.components,
        lhsComponentCount = lhsComponents.length;
    if (lhsComponentCount != rhsComponents.length)
        return false;
    while (lhsComponentCount--)
        if (lhsComponents[lhsComponentCount] != rhsComponents[lhsComponentCount])
            return false;
    if (lhs.pattern != rhs.pattern)
        return false;
    if (CGColorSpaceEqualToColorSpace(lhs.colorspace, rhs.colorspace))
        return false;
    return true;
}
CGColorGetAlpha= function(aColor)
{
    var components = aColor.components;
    return components[components.length - 1];
}
CGColorGetColorSpace= function(aColor)
{
    return aColor.colorspace;
}
CGColorGetComponents= function(aColor)
{
    return aColor.components;
}
CGColorGetNumberOfComponents= function(aColor)
{
    return aColor.components.length;
}
CGColorGetPattern= function(aColor)
{
    return aColor.pattern;
}

p;14;CGColorSpace.jt;4691;@STATIC;1.0;t;4672;kCGColorSpaceModelUnknown = -1;
kCGColorSpaceModelMonochrome = 0;
kCGColorSpaceModelRGB = 1;
kCGColorSpaceModelCMYK = 2;
kCGColorSpaceModelLab = 3;
kCGColorSpaceModelDeviceN = 4;
kCGColorSpaceModelIndexed = 5;
kCGColorSpaceModelPattern = 6;
kCGColorSpaceGenericGray = "CGColorSpaceGenericGray";
kCGColorSpaceGenericRGB = "CGColorSpaceGenericRGB";
kCGColorSpaceGenericCMYK = "CGColorSpaceGenericCMYK";
kCGColorSpaceGenericRGBLinear = "CGColorSpaceGenericRGBLinear";
kCGColorSpaceGenericRGBHDR = "CGColorSpaceGenericRGBHDR";
kCGColorSpaceAdobeRGB1998 = "CGColorSpaceAdobeRGB1998";
kCGColorSpaceSRGB = "CGColorSpaceSRGB";
var _CGNamedColorSpaces = {};
CGColorSpaceCreateCalibratedGray= function(aWhitePoint, aBlackPoint, gamma)
{
    return { model:kCGColorSpaceModelMonochrome, count:1, base:NULL };
}
CGColorSpaceCreateCalibratedRGB= function(aWhitePoint, aBlackPoint, gamma)
{
    return { model:kCGColorSpaceModelRGB, count:1, base:NULL };
}
CGColorSpaceCreateICCBased= function(aComponentCount, range, profile, alternate)
{
    return NULL;
}
CGColorSpaceCreateLab= function(aWhitePoint, aBlackPoint, aRange)
{
    return NULL;
}
CGColorSpaceCreateDeviceCMYK= function()
{
    return CGColorSpaceCreateWithName(kCGColorSpaceGenericCMYK);
}
CGColorSpaceCreateDeviceGray= function()
{
    return CGColorSpaceCreateWithName(kCGColorSpaceGenericGray);
}
CGColorSpaceCreateDeviceRGB= function()
{
    return CGColorSpaceCreateWithName(kCGColorSpaceGenericRGB);
}
CGColorSpaceCreateWithPlatformColorSpace= function()
{
    return NULL;
}
CGColorSpaceCreateIndexed= function(aBaseColorSpace, lastIndex, colorTable)
{
    return NULL;
}
CGColorSpaceCreatePattern= function(aBaseColorSpace)
{
    if (aBaseColorSpace)
        return { model:kCGColorSpaceModelPattern, count:aBaseColorSpace.count, base:aBaseColorSpace };
    return { model:kCGColorSpaceModelPattern, count:0, base:NULL };
}
CGColorSpaceCreateWithName= function(aName)
{
    var colorSpace = _CGNamedColorSpaces[aName];
    if (colorSpace)
        return colorSpace;
    switch (aName)
    {
        case kCGColorSpaceGenericGray: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelMonochrome, count:1, base:NULL };
        case kCGColorSpaceGenericRGB: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelRGB, count:3, base:NULL };
        case kCGColorSpaceGenericCMYK: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelCMYK, count:4, base:NULL };
        case kCGColorSpaceGenericRGBLinear: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelRGB, count:3, base:NULL };
        case kCGColorSpaceGenericRGBHDR: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelRGB, count:3, base:NULL };
        case kCGColorSpaceAdobeRGB1998: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelRGB, count:3, base:NULL };
        case kCGColorSpaceSRGB: return _CGNamedColorSpaces[aName] = { model:kCGColorSpaceModelRGB, count:3, base:NULL };
    }
    return NULL;
}
CGColorSpaceCopyICCProfile= function(aColorSpace)
{
    return NULL;
}
CGColorSpaceGetNumberOfComponents= function(aColorSpace)
{
    return aColorSpace.count;
}
CGColorSpaceGetTypeID= function(aColorSpace)
{
}
CGColorSpaceGetModel= function(aColorSpace)
{
    return aColorSpace.model;
}
CGColorSpaceGetBaseColorSpace= function(aColorSpace)
{
}
CGColorSpaceGetColorTableCount= function(aColorSpace)
{
}
CGColorSpaceGetColorTable= function(aColorSpace)
{
}
CGColorSpaceRelease= function(aColorSpace)
{
}
CGColorSpaceRetain= function(aColorSpace)
{
    return aColorSpace;
}
CGColorSpaceStandardizeComponents= function(aColorSpace, components)
{
    var count = aColorSpace.count;
    { if (count > components.length) { components[count] = 1; return; } var component = components[count]; if (component < 0) components[count] = 0; else if (component > 1) components[count] = 1; else components[count] = ROUND(component * 1000) / 1000; };
    if (aColorSpace.base)
        aColorSpace = aColorSpace.base;
    switch (aColorSpace.model)
    {
        case kCGColorSpaceModelMonochrome:
        case kCGColorSpaceModelRGB:
        case kCGColorSpaceModelCMYK:
        case kCGColorSpaceModelDeviceN: while (count--)
                                                { if (count > components.length) { components[count] = 1; return; } var component = components[count]; if (component < 0) components[count] = 0; else if (component > 1) components[count] = 1; else components[count] = ROUND(component * 255) / 255; };
                                            break;
        case kCGColorSpaceModelIndexed:
        case kCGColorSpaceModelLab:
        case kCGColorSpaceModelPattern: break;
    }
}

p;11;CGContext.jt;31564;@STATIC;1.0;i;12;CGGeometry.ji;19;CGAffineTransform.ji;8;CGPath.jt;31491;objj_executeFile("CGGeometry.j", true);
objj_executeFile("CGAffineTransform.j", true);
objj_executeFile("CGPath.j", true);
kCGLineCapButt = 0;
kCGLineCapRound = 1;
kCGLineCapSquare = 2;
kCGLineJoinMiter = 0;
kCGLineJoinRound = 1;
kCGLineJoinBevel = 2;
kCGPathFill = 0;
kCGPathEOFill = 1;
kCGPathStroke = 2;
kCGPathFillStroke = 3;
kCGPathEOFillStroke = 4;
kCGBlendModeNormal = 0;
kCGBlendModeMultiply = 1;
kCGBlendModeScreen = 2;
kCGBlendModeOverlay = 3;
kCGBlendModeDarken = 4;
kCGBlendModeLighten = 5;
kCGBlendModeColorDodge = 6;
kCGBlendModeColorBurn = 7;
kCGBlendModeSoftLight = 8;
kCGBlendModeHardLight = 9;
kCGBlendModeDifference = 10;
kCGBlendModeExclusion = 11;
kCGBlendModeHue = 12;
kCGBlendModeSaturation = 13;
kCGBlendModeColor = 14;
kCGBlendModeLuminosity = 15;
kCGBlendModeClear = 16;
kCGBlendModeCopy = 17;
kCGBlendModeSourceIn = 18;
kCGBlendModeSourceOut = 19;
kCGBlendModeSourceAtop = 20;
kCGBlendModeDestinationOver = 21;
kCGBlendModeDestinationIn = 22;
kCGBlendModeDestinationOut = 23;
kCGBlendModeDestinationAtop = 24;
kCGBlendModeXOR = 25;
kCGBlendModePlusDarker = 26;
kCGBlendModePlusLighter = 27;
CGContextRelease= function()
{
}
CGContextRetain= function(aContext)
{
    return aContext;
}
if (!CPFeatureIsCompatible(CPHTMLCanvasFeature))
{
CGGStateCreate= function()
{
    return { alpha:1.0, strokeStyle:"#000", fillStyle:"#ccc", lineWidth:1.0, lineJoin:kCGLineJoinMiter, lineCap:kCGLineCapButt, miterLimit:10.0, globalAlpha:1.0,
        blendMode:kCGBlendModeNormal,
        shadowOffset:{ width:0.0, height:0.0 }, shadowBlur:0.0, shadowColor:NULL, CTM:{ a:1.0, b:0.0, c:0.0, d:1.0, tx:0.0, ty:0.0 } };
}
CGGStateCreateCopy= function(aGState)
{
    return { alpha:aGState.alpha, strokeStyle:aGState.strokeStyle, fillStyle:aGState.fillStyle, lineWidth:aGState.lineWidth,
        lineJoin:aGState.lineJoin, lineCap:aGState.lineCap, miterLimit:aGState.miterLimit, globalAlpha:aGState.globalAlpha,
        blendMode:aGState.blendMode,
        shadowOffset:aGState.shadowOffset, shadowBlur:aGState.shadowBlur, shadowColor:aGState.shadowColor, CTM:{ a:aGState.CTM.a, b:aGState.CTM.b, c:aGState.CTM.c, d:aGState.CTM.d, tx:aGState.CTM.tx, ty:aGState.CTM.ty } };
}
CGBitmapGraphicsContextCreate= function()
{
    return { DOMElement:document.createElement("div"), path:NULL, gState:CGGStateCreate(), gStateStack:[] };
}
CGContextSaveGState= function(aContext)
{
    aContext.gStateStack.push(CGGStateCreateCopy(aContext.gState));
}
CGContextRestoreGState= function(aContext)
{
    aContext.gState = aContext.gStateStack.pop();
}
CGContextSetLineCap= function(aContext, aLineCap)
{
    aContext.gState.lineCap = aLineCap;
}
CGContextSetLineJoin= function(aContext, aLineJoin)
{
    aContext.gState.lineJoin = aLineJoin;
}
CGContextSetLineWidth= function(aContext, aLineWidth)
{
    aContext.gState.lineWidth = aLineWidth;
}
CGContextSetMiterLimit= function(aContext, aMiterLimit)
{
    aContext.gState.miterLimit = aMiterLimit;
}
CGContextSetBlendMode= function(aContext, aBlendMode)
{
    aContext.gState.blendMode = aBlendMode;
}
CGContextAddArc= function(aContext, x, y, radius, startAngle, endAngle, clockwise)
{
    CGPathAddArc(aContext.path, aContext.gState.CTM, x, y, radius, startAngle, endAngle, clockwise);
}
CGContextAddArcToPoint= function(aContext, x1, y1, x2, y2, radius)
{
    CGPathAddArcToPoint(aContext.path, aContext.gState.CTM, x1, y1, x2, y2, radius);
}
CGContextAddCurveToPoint= function(aContext, cp1x, cp1y, cp2x, cp2y, x, y)
{
    CGPathAddCurveToPoint(aContext.path, aContext.gState.CTM, cp1x, cp1y, cp2x, cp2y, x, y);
}
CGContextAddLines= function(aContext, points, count)
{
    CGPathAddLines(aContext.path, aContext.gState.CTM, points, count);
}
CGContextAddLineToPoint= function(aContext, x, y)
{
    CGPathAddLineToPoint(aContext.path, aContext.gState.CTM, x, y);
}
CGContextAddPath= function(aContext, aPath)
{
    if (!aContext || CGPathIsEmpty(aPath))
        return;
    if (!aContext.path)
        aContext.path = CGPathCreateMutable();
    CGPathAddPath(aContext.path, aContext.gState.CTM, aPath);
}
CGContextAddQuadCurveToPoint= function(aContext, cpx, cpy, x, y)
{
    CGPathAddQuadCurveToPoint(aContext.path, aContext.gState.CTM, cpx, cpy, x, y);
}
CGContextAddRect= function(aContext, aRect)
{
    CGPathAddRect(aContext.path, aContext.gState.CTM, aRect);
}
CGContextAddRects= function(aContext, rects, count)
{
    CGPathAddRects(aContext.path, aContext.gState.CTM, rects, count);
}
CGContextBeginPath= function(aContext)
{
    aContext.path = CGPathCreateMutable();
}
CGContextClosePath= function(aContext)
{
    CGPathCloseSubpath(aContext.path);
}
CGContextMoveToPoint= function(aContext, x, y)
{
    if (!aContext.path)
        aContext.path = CGPathCreateMutable();
    CGPathMoveToPoint(aContext.path, aContext.gState.CTM, x, y);
}
CGContextFillRect= function(aContext, aRect)
{
    CGContextFillRects(aContext, [aRect], 1);
}
CGContextFillRects= function(aContext, rects, count)
{
    if (arguments[2] === undefined)
        var count = rects.length;
    CGContextBeginPath(aContext);
    CGContextAddRects(aContext, rects, count);
    CGContextClosePath(aContext);
    CGContextDrawPath(aContext, kCGPathFill);
}
CGContextStrokeRect= function(aContext, aRect)
{
    CGContextBeginPath(aContext);
    CGContextAddRect(aContext, aRect);
    CGContextClosePath(aContext);
    CGContextDrawPath(aContext, kCGPathStroke);
}
CGContextStrokeRectWithWidth= function(aContext, aRect, aWidth)
{
    CGContextSaveGState(aContext);
    CGContextSetLineWidth(aContext, aWidth);
    CGContextStrokeRect(aContext, aRect);
    CGContextRestoreGState(aContext);
}
CGContextConcatCTM= function(aContext, aTransform)
{
    var CTM = aContext.gState.CTM;
    var tx = CTM.tx * aTransform.a + CTM.ty * aTransform.c + aTransform.tx;CTM.ty = CTM.tx * aTransform.b + CTM.ty * aTransform.d + aTransform.ty;CTM.tx = tx;var a = CTM.a * aTransform.a + CTM.b * aTransform.c, b = CTM.a * aTransform.b + CTM.b * aTransform.d, c = CTM.c * aTransform.a + CTM.d * aTransform.c;CTM.d = CTM.c * aTransform.b + CTM.d * aTransform.d;CTM.a = a;CTM.b = b;CTM.c = c;;
}
CGContextGetCTM= function(aContext)
{
    return aContext.gState.CTM;
}
CGContextRotateCTM= function(aContext, anAngle)
{
    var gState = aContext.gState;
    gState.CTM = CGAffineTransformRotate(gState.CTM, anAngle);
}
CGContextScaleCTM= function(aContext, sx, sy)
{
    var gState = aContext.gState;
    gState.CTM = { a:gState.CTM.a * sx, b:gState.CTM.b * sx, c:gState.CTM.c * sy, d:gState.CTM.d * sy, tx:gState.CTM.tx, ty:gState.CTM.ty };
}
CGContextTranslateCTM= function(aContext, tx, ty)
{
    var gState = aContext.gState;
    gState.CTM = { a:gState.CTM.a, b:gState.CTM.b, c:gState.CTM.c, d:gState.CTM.d, tx:gState.CTM.tx + gState.CTM.a * tx + gState.CTM.c * ty, ty:gState.CTM.ty + gState.CTM.b * tx + gState.CTM.d * ty };
}
CGContextSetShadow= function(aContext, aSize, aBlur)
{
    var gState = aContext.gState;
    gState.shadowOffset = { width:aSize.width, height:aSize.height };
    gState.shadowBlur = aBlur;
    gState.shadowColor = objj_msgSend(CPColor, "shadowColor");
}
CGContextSetShadowWithColor= function(aContext, aSize, aBlur, aColor)
{
    var gState = aContext.gState;
    gState.shadowOffset = { width:aSize.width, height:aSize.height };
    gState.shadowBlur = aBlur;
    gState.shadowColor = aColor;
}
CGContextSetAlpha= function(aContext, anAlpha)
{
    aContext.gState.alpha = MAX(MIN(anAlpha, 1.0), 0.0);
}
}
CGContextEOFillPath= function(aContext)
{
    CGContextDrawPath(aContext, kCGPathEOFill);
}
CGContextFillPath= function(aContext)
{
    CGContextDrawPath(aContext, kCGPathFill);
}
var KAPPA = 4.0 * ((SQRT2 - 1.0) / 3.0);
CGContextAddEllipseInRect= function(aContext, aRect)
{
    CGContextBeginPath(aContext);
    CGContextAddPath(aContext, CGPathWithEllipseInRect(aRect));
    CGContextClosePath(aContext);
}
CGContextFillEllipseInRect= function(aContext, aRect)
{
    CGContextBeginPath(aContext);
    CGContextAddEllipseInRect(aContext, aRect);
    CGContextClosePath(aContext);
    CGContextFillPath(aContext);
}
CGContextStrokeEllipseInRect= function(aContext, aRect)
{
    CGContextBeginPath(aContext);
    CGContextAddEllipseInRect(aContext, aRect);
    CGContextClosePath(aContext);
    CGContextStrokePath(aContext);
}
CGContextStrokePath= function(aContext)
{
    CGContextDrawPath(aContext, kCGPathStroke);
}
CGContextStrokeLineSegments= function(aContext, points, count)
{
    var i = 0;
    if (arguments["count"] == NULL)
        var count = points.length;
    CGContextBeginPath(aContext);
    for (; i < count; i += 2)
    {
        CGContextMoveToPoint(aContext, points[i].x, points[i].y);
        CGContextAddLineToPoint(aContext, points[i + 1].x, points[i + 1].y);
    }
    CGContextStrokePath(aContext);
}
CGContextSetFillColor= function(aContext, aColor)
{
    if (aColor)
        aContext.gState.fillStyle = objj_msgSend(aColor, "cssString");
}
CGContextSetStrokeColor= function(aContext, aColor)
{
    if (aColor)
        aContext.gState.strokeStyle = objj_msgSend(aColor, "cssString");
}
CGContextFillRoundedRectangleInRect= function(aContext, aRect, aRadius, ne, se, sw, nw)
{
    CGContextBeginPath(aContext);
    CGContextAddPath(aContext, CGPathWithRoundedRectangleInRect(aRect, aRadius, aRadius, ne, se, sw, nw));
    CGContextClosePath(aContext);
    CGContextFillPath(aContext);
}
CGContextStrokeRoundedRectangleInRect= function(aContext, aRect, aRadius, ne, se, sw, nw)
{
    CGContextBeginPath(aContext);
    CGContextAddPath(aContext, CGPathWithRoundedRectangleInRect(aRect, aRadius, aRadius, ne, se, sw, nw));
    CGContextClosePath(aContext);
    CGContextStrokePath(aContext);
}
if (CPFeatureIsCompatible(CPHTMLCanvasFeature))
{
var CANVAS_LINECAP_TABLE = [ "butt", "round", "square" ],
    CANVAS_LINEJOIN_TABLE = [ "miter", "round", "bevel" ],
    CANVAS_COMPOSITE_TABLE = [ "source-over", "source-over", "source-over", "source-over", "darker",
                                "lighter", "source-over", "source-over", "source-over", "source-over",
                                "source-over", "source-over", "source-over", "source-over", "source-over",
                                "source-over", "source-over",
                                "copy", "source-in", "source-out", "source-atop",
                                "destination-over", "destination-in", "destination-out", "destination-atop",
                                "xor", "source-over", "source-over" ];
CGContextSaveGState= function(aContext)
{
    aContext.save();
}
CGContextRestoreGState= function(aContext)
{
    aContext.restore();
}
CGContextSetLineCap= function(aContext, aLineCap)
{
    aContext.lineCap = CANVAS_LINECAP_TABLE[aLineCap];
}
CGContextSetLineJoin= function(aContext, aLineJoin)
{
    aContext.lineJoin = CANVAS_LINEJOIN_TABLE[aLineJoin];
}
CGContextSetLineWidth= function(aContext, aLineWidth)
{
    aContext.lineWidth = aLineWidth;
}
CGContextSetMiterLimit= function(aContext, aMiterLimit)
{
    aContext.miterLimit = aMiterLimit;
}
CGContextSetBlendMode= function(aContext, aBlendMode)
{
    aContext.globalCompositeOperation = CANVAS_COMPOSITE_TABLE[aBlendMode];
}
CGContextAddArc= function(aContext, x, y, radius, startAngle, endAngle, clockwise)
{
    aContext.arc(x, y, radius, startAngle, endAngle, !clockwise);
}
CGContextAddArcToPoint= function(aContext, x1, y1, x2, y2, radius)
{
    aContext.arcTo(x1, y1, x2, y2, radius);
}
CGContextAddCurveToPoint= function(aContext, cp1x, cp1y, cp2x, cp2y, x, y)
{
    aContext.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);
}
CGContextAddLineToPoint= function(aContext, x, y)
{
    aContext.lineTo(x, y);
}
CGContextAddPath= function(aContext, aPath)
{
    if (!aContext || CGPathIsEmpty(aPath))
        return;
    var elements = aPath.elements,
        i = 0,
        count = aPath.count;
    for (; i < count; ++i)
    {
        var element = elements[i],
            type = element.type;
        switch (type)
        {
            case kCGPathElementMoveToPoint: aContext.moveTo(element.x, element.y);
                                                    break;
            case kCGPathElementAddLineToPoint: aContext.lineTo(element.x, element.y);
                                                    break;
            case kCGPathElementAddQuadCurveToPoint: aContext.quadraticCurveTo(element.cpx, element.cpy, element.x, element.y);
                                                    break;
            case kCGPathElementAddCurveToPoint: aContext.bezierCurveTo(element.cp1x, element.cp1y, element.cp2x, element.cp2y, element.x, element.y);
                                                    break;
            case kCGPathElementCloseSubpath: aContext.closePath();
                                                    break;
            case kCGPathElementAddArc: aContext.arc(element.x, element.y, element.radius, element.startAngle, element.endAngle, element.clockwise);
                                                    break;
            case kCGPathElementAddArcTo:
                                                    break;
        }
    }
}
CGContextAddRect= function(aContext, aRect)
{
    aContext.rect((aRect.origin.x), (aRect.origin.y), (aRect.size.width), (aRect.size.height));
}
CGContextAddRects= function(aContext, rects, count)
{
    var i = 0;
    if (arguments["count"] == NULL)
        var count = rects.length;
    for (; i < count; ++i)
    {
        var rect = rects[i];
        aContext.rect((rect.origin.x), (rect.origin.y), (rect.size.width), (rect.size.height));
    }
}
CGContextBeginPath= function(aContext)
{
    aContext.beginPath();
}
CGContextClosePath= function(aContext)
{
    aContext.closePath();
}
CGContextMoveToPoint= function(aContext, x, y)
{
    aContext.moveTo(x, y);
}
CGContextClearRect= function(aContext, aRect)
{
    aContext.clearRect((aRect.origin.x), (aRect.origin.y), (aRect.size.width), (aRect.size.height));
}
CGContextDrawPath= function(aContext, aMode)
{
    if (aMode == kCGPathFill || aMode == kCGPathFillStroke)
        aContext.fill();
    else if (aMode == kCGPathEOFill || aMode == kCGPathEOFillStroke)
        alert("not implemented!!!");
    if (aMode == kCGPathStroke || aMode == kCGPathFillStroke || aMode == kCGPathEOFillStroke)
        aContext.stroke();
}
CGContextFillRect= function(aContext, aRect)
{
    aContext.fillRect((aRect.origin.x), (aRect.origin.y), (aRect.size.width), (aRect.size.height));
}
CGContextFillRects= function(aContext, rects, count)
{
    var i = 0;
    if (arguments["count"] == NULL)
        var count = rects.length;
    for (; i < count; ++i)
    {
        var rect = rects[i];
        aContext.fillRect((rect.origin.x), (rect.origin.y), (rect.size.width), (rect.size.height));
    }
}
CGContextStrokeRect= function(aContext, aRect)
{
    aContext.strokeRect((aRect.origin.x), (aRect.origin.y), (aRect.size.width), (aRect.size.height));
}
CGContextClip= function(aContext)
{
    aContext.clip();
}
CGContextClipToRect= function(aContext, aRect)
{
    aContext.beginPath();
    aContext.rect((aRect.origin.x), (aRect.origin.y), (aRect.size.width), (aRect.size.height));
    aContext.closePath();
    aContext.clip();
}
CGContextClipToRects= function(aContext, rects, count)
{
    if (arguments["count"] == NULL)
        var count = rects.length;
    aContext.beginPath();
    CGContextAddRects(aContext, rects, count);
    aContext.clip();
}
CGContextSetAlpha= function(aContext, anAlpha)
{
    aContext.globalAlpha = anAlpha;
}
CGContextSetFillColor= function(aContext, aColor)
{
    aContext.fillStyle = objj_msgSend(aColor, "cssString");
}
CGContextSetStrokeColor= function(aContext, aColor)
{
    aContext.strokeStyle = objj_msgSend(aColor, "cssString");
}
CGContextSetShadow= function(aContext, aSize, aBlur)
{
    aContext.shadowOffsetX = aSize.width;
    aContext.shadowOffsetY = aSize.height;
    aContext.shadowBlur = aBlur;
}
CGContextSetShadowWithColor= function(aContext, aSize, aBlur, aColor)
{
    aContext.shadowOffsetX = aSize.width;
    aContext.shadowOffsetY = aSize.height;
    aContext.shadowBlur = aBlur;
    aContext.shadowColor = objj_msgSend(aColor, "cssString");
}
CGContextRotateCTM= function(aContext, anAngle)
{
    aContext.rotate(anAngle);
}
CGContextScaleCTM= function(aContext, sx, sy)
{
    aContext.scale(sx, sy);
}
CGContextTranslateCTM= function(aContext, tx, ty)
{
    aContext.translate(tx, ty);
}
eigen= function(anAffineTransform)
{
    alert("IMPLEMENT ME!");
}
if (CPFeatureIsCompatible(CPJavaScriptCanvasTransformFeature))
{
CGContextConcatCTM = function(aContext, anAffineTransform)
{
    aContext.transform(anAffineTransform.a, anAffineTransform.b, anAffineTransform.c, anAffineTransform.d, anAffineTransform.tx, anAffineTransform.ty);
}
}
else
{
CGContextConcatCTM = function(aContext, anAffineTransform)
{
    var a = anAffineTransform.a,
        b = anAffineTransform.b,
        c = anAffineTransform.c,
        d = anAffineTransform.d,
        tx = anAffineTransform.tx,
        ty = anAffineTransform.ty,
        sx = 1.0,
        sy = 1.0,
        a1 = 0.0,
        a2 = 0.0;
    if (b == 0.0 && c == 0.0)
    {
        sx = a;
        sy = d;
    }
    else if (a * b == -c * d)
    {
        var sign = (a * d < 0.0 || b * c > 0.0) ? -1.0 : 1.0, a2 = (ATAN2(b, d) + ATAN2(-sign * c, sign * a)) / 2.0, cos = COS(a2), sin = SIN(a2); if (cos == 0) { sx = -c / sin; sy = b / sin; } else if (sin == 0) { sx = a / cos; sy = d / cos; } else { abs_cos = ABS(cos); abs_sin = ABS(sin); sx = (abs_cos * a / cos + abs_sin * -c / sin) / (abs_cos + abs_sin); sy = (abs_cos * d / cos + abs_sin * b / sin) / (abs_cos + abs_sin); }
    }
    else if (a * c == -b * d)
    {
        var sign = (a * d < 0.0 || b * c > 0.0) ? -1.0 : 1.0; a1 = (Math.atan2(sign * b, sign * a) + Math.atan2(-c, d)) / 2.0, cos = COS(a1), sin = SIN(a1); if (cos == 0) { sx = b / sin; sy = -c / sin; } else if (sin == 0) { sx = a / cos; sy = d / cos; } else { abs_cos = ABS(cos); abs_sin = ABS(sin); sx = (abs_cos * a / cos + abs_sin * b / sin) / (abs_cos + abs_sin); sy = (abs_cos * d / cos + abs_sin * -c / sin) / (abs_cos + abs_sin); }
    }
    else
    {
        var transpose = CGAffineTransformMake(a, c, b, d, 0.0, 0.0),
            u = eigen(CGAffineTransformConcat(anAffineTransform, transpose)),
            v = eigen(CGAffineTransformConcat(transpose, anAffineTransform)),
            U = CGAffineTransformMake(u.vector_1.x, u.vector_2.x, u.vector_1.y, u.vector_2.y, 0.0, 0.0),
            VT = CGAffineTransformMake(v.vector_1.x, v.vector_1.y, v.vector_2.x, v.vector_2.y, 0.0, 0.0),
            S = CGAffineTransformConcat(CGAffineTransformConcat(CGAffineTransformInvert(U), anAffineTransform), CGAffineTransformInvert(VT));
        a = VT.a;
        b = VT.b;
        c = VT.c;
        d = VT.d;
        var sign = (a * d < 0.0 || b * c > 0.0) ? -1.0 : 1.0, a2 = (ATAN2(b, d) + ATAN2(-sign * c, sign * a)) / 2.0, cos = COS(a2), sin = SIN(a2); if (cos == 0) { sx = -c / sin; sy = b / sin; } else if (sin == 0) { sx = a / cos; sy = d / cos; } else { abs_cos = ABS(cos); abs_sin = ABS(sin); sx = (abs_cos * a / cos + abs_sin * -c / sin) / (abs_cos + abs_sin); sy = (abs_cos * d / cos + abs_sin * b / sin) / (abs_cos + abs_sin); }
        S.a *= sx;
        S.d *= sy;
        a = U.a;
        b = U.b;
        c = U.c;
        d = U.d;
        var sign = (a * d < 0.0 || b * c > 0.0) ? -1.0 : 1.0; a1 = (Math.atan2(sign * b, sign * a) + Math.atan2(-c, d)) / 2.0, cos = COS(a1), sin = SIN(a1); if (cos == 0) { sx = b / sin; sy = -c / sin; } else if (sin == 0) { sx = a / cos; sy = d / cos; } else { abs_cos = ABS(cos); abs_sin = ABS(sin); sx = (abs_cos * a / cos + abs_sin * b / sin) / (abs_cos + abs_sin); sy = (abs_cos * d / cos + abs_sin * -c / sin) / (abs_cos + abs_sin); }
        sx = S.a * sx;
        sy = S.d * sy;
    }
    if (tx != 0 || ty != 0)
        CGContextTranslateCTM(aContext, tx, ty);
    if (a1 != 0.0)
        CGContextRotateCTM(aContext, a1);
    if (sx != 1.0 || sy != 1.0)
        CGContextScaleCTM(aContext, sx, sy);
    if (a2 != 0.0)
        CGContextRotateCTM(aContext, a2);
}
}
CGContextDrawImage= function(aContext, aRect, anImage)
{
    aContext.drawImage(anImage._image, (aRect.origin.x), (aRect.origin.y), (aRect.size.width), (aRect.size.height));
}
to_string= function(aColor)
{
    return "rgba(" + ROUND(aColor.components[0] * 255) + ", " + ROUND(aColor.components[1] * 255) + ", " + ROUND(255 * aColor.components[2]) + ", " + aColor.components[3] + ")";
}
CGContextDrawLinearGradient= function(aContext, aGradient, aStartPoint, anEndPoint, options)
{
    var colors = aGradient.colors,
        count = colors.length,
        linearGradient = aContext.createLinearGradient(aStartPoint.x, aStartPoint.y, anEndPoint.x, anEndPoint.y);
    while (count--)
        linearGradient.addColorStop(aGradient.locations[count], to_string(colors[count]));
    aContext.fillStyle = linearGradient;
    aContext.fill();
}
CGBitmapGraphicsContextCreate= function()
{
    var DOMElement = document.createElement("canvas"),
        context = DOMElement.getContext("2d");
    context.DOMElement = DOMElement;
    return context;
}
}
else if (CPFeatureIsCompatible(CPVMLFeature))
{
var VML_TRUTH_TABLE = [ "f", "t"],
    VML_LINECAP_TABLE = [ "flat", "round", "square" ],
    VML_LINEJOIN_TABLE = [ "miter", "round", "bevel" ],
    VML_ELEMENT_TABLE = [ " m ", " l ", "qb", " c ", " x ", [" at ", " wa "]];
var _CGBitmapGraphicsContextCreate = CGBitmapGraphicsContextCreate;
CGBitmapGraphicsContextCreate= function()
{
    document.namespaces.add("cg_vml_", "urn:schemas-microsoft-com:vml");
    document.createStyleSheet().cssText = "cg_vml_\\:*{behavior:url(#default#VML)}";
    CGBitmapGraphicsContextCreate = _CGBitmapGraphicsContextCreate;
    return _CGBitmapGraphicsContextCreate();
}
CGContextClearRect= function(aContext, aRect)
{
    if (aContext.buffer != nil)
        aContext.buffer = "";
    else
        aContext.DOMElement.innerHTML = "";
    aContext.path = NULL;
}
var W = 10.0,
    H = 10.0,
    Z = 10.0,
    Z_2 = Z / 2.0;
CGContextDrawImage= function(aContext, aRect, anImage)
{
    var string = "";
    if (anImage.buffer != nil)
        string = anImage.buffer;
    else
    {
        var ctm = aContext.gState.CTM,
            origin = CGPointApplyAffineTransform(aRect.origin, ctm),
            similarity = ctm.a == ctm.d && ctm.b == -ctm.c,
            vml = ["<cg_vml_:group coordsize=\"1,1\" coordorigin=\"0,0\" style=\"width:1;height:1;position:absolute"];
        {
            var transformedRect = CGRectApplyAffineTransform(aRect, ctm);
            vml.push( ";padding:0 ", ROUND((transformedRect.origin.x + transformedRect.size.width)), "px ", ROUND((transformedRect.origin.y + transformedRect.size.height)),
                        "px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",
                        "M11='", ctm.a, "',M12='", ctm.c, "',M21='", ctm.b, "',M22='", ctm.d, "',",
                        "Dx='", ROUND(origin.x), "', Dy='", ROUND(origin.y), "', sizingmethod='clip');");
        }
        vml.push( "\"><cg_vml_:image src=\"", anImage._image.src,
                    "\" style=\"width:", (aRect.size.width), "px;height:", (aRect.size.height),
                    "px;\"/></g_vml_:group>");
        string = vml.join("");
    }
    if (aContext.buffer != nil)
        aContext.buffer += string;
    else
        aContext.DOMElement.insertAdjacentHTML("BeforeEnd", string);
}
CGContextDrawPath= function(aContext, aMode)
{
    if (!aContext || CGPathIsEmpty(aContext.path))
        return;
    var elements = aContext.path.elements,
        i = 0,
        count = aContext.path.count,
        gState = aContext.gState,
        fill = (aMode == kCGPathFill || aMode == kCGPathFillStroke) ? 1 : 0,
        stroke = (aMode == kCGPathStroke || aMode == kCGPathFillStroke) ? 1 : 0,
        opacity = gState.alpha,
        vml = [ "<cg_vml_:shape",
                " fillcolor=\"", gState.fillStyle,
                "\" filled=\"", VML_TRUTH_TABLE[fill],
                "\" style=\"position:absolute;width:", W, ";height:", H,
                ";\" coordorigin=\"0 0\" coordsize=\"", Z * W, " ", Z * H,
                "\" stroked=\"", VML_TRUTH_TABLE[stroke],
                "\" strokeweight=\"", gState.lineWidth,
                "\" strokecolor=\"", gState.strokeStyle,
                "\" path=\""];
    for (; i < count; ++i)
    {
        var element = elements[i],
            type = element.type;
        switch(type)
        {
            case kCGPathElementMoveToPoint:
            case kCGPathElementAddLineToPoint: vml.push(VML_ELEMENT_TABLE[type], (ROUND(Z * (element.x) - Z_2)), ',', (ROUND(Z * (element.y) - Z_2)));
                                                    break;
            case kCGPathElementAddQuadCurveToPoint: vml.push(VML_ELEMENT_TABLE[type],
                                                        (ROUND(Z * (element.cpx) - Z_2)), ',', (ROUND(Z * (element.cpy) - Z_2)), ',',
                                                        (ROUND(Z * (element.x) - Z_2)), ',', (ROUND(Z * (element.y) - Z_2)));
                                                    break;
            case kCGPathElementAddCurveToPoint: vml.push(VML_ELEMENT_TABLE[type],
                                                        (ROUND(Z * (element.cp1x) - Z_2)), ',', (ROUND(Z * (element.cp1y) - Z_2)), ',',
                                                        (ROUND(Z * (element.cp2x) - Z_2)), ',', (ROUND(Z * (element.cp2y) - Z_2)), ',',
                                                        (ROUND(Z * (element.x) - Z_2)), ',', (ROUND(Z * (element.y) - Z_2)));
                                                    break;
            case kCGPathElementCloseSubpath: vml.push(VML_ELEMENT_TABLE[type]);
                                                    break;
            case kCGPathElementAddArc: var x = element.x,
                                                        y = element.y,
                                                        radius = element.radius,
                                                        clockwise = element.clockwise ? 1 : 0,
                                                        endAngle = element.endAngle,
                                                        startAngle = element.startAngle,
                                                        start = { x:x + radius * COS(startAngle), y:y + radius * SIN(startAngle) };
                                                    if (startAngle == endAngle && !clockwise)
                                                    {
                                                        vml.push(VML_ELEMENT_TABLE[kCGPathElementMoveToPoint], (ROUND(Z * (start.x) - Z_2)), ',', (ROUND(Z * (start.y) - Z_2)));
                                                        continue;
                                                    }
                                                    var end = { x:x + radius * COS(endAngle), y:y + radius * SIN(endAngle) };
                                                    if (clockwise && startAngle != endAngle && (start.x == end.x && start.y == end.y))
                                                        if (start.x >= x)
                                                        {
                                                            if (start.y < y)
                                                                start.x += 0.125;
                                                            else
                                                                start.y += 0.125;
                                                        }
                                                        else
                                                        {
                                                            if (end.y <= y)
                                                                end.x += 0.125;
                                                            else
                                                                end.y += 0.125;
                                                        }
                                                    vml.push(VML_ELEMENT_TABLE[type][clockwise],
                                                        (ROUND(Z * (x - radius) - Z_2)), ',', (ROUND(Z * (y - radius) - Z_2)), " ",
                                                        (ROUND(Z * (x + radius) - Z_2)), ',', (ROUND(Z * (y + radius) - Z_2)), " ",
                                                        (ROUND(Z * (start.x) - Z_2)), ',', (ROUND(Z * (start.y) - Z_2)), " ",
                                                        (ROUND(Z * (end.x) - Z_2)), ',', (ROUND(Z * (end.y) - Z_2)));
                                                    break;
            case kCGPathElementAddArcTo: break;
        }
    }
    vml.push("\">");
    if (gState.gradient)
        vml.push(gState.gradient)
    else if (fill)
        vml.push("<cg_vml_:fill color=\"", gState.fillStyle, "\" opacity=\"", opacity, "\" />");
    if (stroke)
        vml.push( "<cg_vml_:stroke opacity=\"", opacity,
                    "\" joinstyle=\"", VML_LINEJOIN_TABLE[gState.lineJoin],
                    "\" miterlimit=\"", gState.miterLimit,
                    "\" endcap=\"", VML_LINECAP_TABLE[gState.lineCap],
                    "\" weight=\"", gState.lineWidth, "",
                    "px\" color=\"", gState.strokeStyle,"\" />");
    var shadowColor = gState.shadowColor;
    if (shadowColor)
    {
        var shadowOffset = gState.shadowOffset;
        vml.push("<cg_vml_:shadow on=\"t\" offset=\"",
            shadowOffset.width, "pt ", shadowOffset.height, "pt\" opacity=\"", objj_msgSend(shadowColor, "alphaComponent"), "\" color=black />");
    }
    vml.push("</cg_vml_:shape>");
    aContext.path = NULL;
    if (aContext.buffer != nil)
        aContext.buffer += vml.join("");
    else
        aContext.DOMElement.insertAdjacentHTML("BeforeEnd", vml.join(""));
}
to_string= function(aColor)
{
    return "rgb(" + ROUND(aColor.components[0] * 255) + ", " + ROUND(aColor.components[1] * 255) + ", " + ROUND(255 * aColor.components[2]) + ")";
}
CGContextDrawLinearGradient= function(aContext, aGradient, aStartPoint, anEndPoint, options)
{
    if (!aContext || !aGradient)
        return;
    var vml = nil;
    if (aGradient.vml_gradient)
    {
        var stops = objj_msgSend(objj_msgSend(aGradient.vml_gradient, "stops"), "sortedArrayUsingSelector:", sel_getUid("comparePosition:")),
            count = objj_msgSend(stops, "count");
        vml = ["<cg_vml_:fill type=\"gradient\" method=\"linear sigma\" "];
        vml.push("angle=\"" + (objj_msgSend(aGradient.vml_gradient, "angle") + 90) +"\" ");
        vml.push("colors=\"");
        for (var i = 0; i < count; i++)
        {
            vml.push((objj_msgSend(stops[i], "position")*100).toFixed(0)+"% ");
            vml.push(objj_msgSend(objj_msgSend(objj_msgSend(stops[i], "color"), "colorForSlideBase:", nil), "cssString"));
            if (i < count-1)
                vml.push(",");
        }
        vml.push("\" />");
    }
    else
    {
        var colors = aGradient.colors,
            count = colors.length;
        vml = ["<cg_vml_:fill type=\"gradient\" "];
        vml.push("colors=\"");
        for (var i = 0; i < count; i++)
            vml.push((aGradient.locations[i]*100).toFixed(0)+"% "+to_string(colors[i])+(i<count-1 ? "," : ""));
        vml.push("\" />");
    }
    aContext.gState.gradient = vml.join("");
}
}

p;12;CGGeometry.jt;7792;@STATIC;1.0;t;7773;CGPointMake= function(x, y) { return { x:x, y:y }; }
CGPointMakeZero= function() { return { x:0.0, y:0.0 }; }
CGPointMakeCopy= function(aPoint) { return { x:aPoint.x, y:aPoint.y }; }
CGPointCreateCopy= function(aPoint) { return { x:aPoint.x, y:aPoint.y }; }
CGPointEqualToPoint= function(lhsPoint, rhsPoint) { return (lhsPoint.x == rhsPoint.x && lhsPoint.y == rhsPoint.y); }
CGStringFromPoint= function(aPoint) { return ("{" + aPoint.x + ", " + aPoint.y + "}"); }
CGSizeMake= function(width, height) { return { width:width, height:height }; }
CGSizeMakeZero= function() { return { width:0.0, height:0.0 }; }
CGSizeMakeCopy= function(aSize) { return { width:aSize.width, height:aSize.height }; }
CGSizeCreateCopy= function(aSize) { return { width:aSize.width, height:aSize.height }; }
CGSizeEqualToSize= function(lhsSize, rhsSize) { return (lhsSize.width == rhsSize.width && lhsSize.height == rhsSize.height); }
CGStringFromSize= function(aSize) { return ("{" + aSize.width + ", " + aSize.height + "}"); }
CGRectMake= function(x, y, width, height) { return { origin: { x:x, y:y }, size: { width:width, height:height } }; }
CGRectMakeZero= function() { return { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } }; }
CGRectMakeCopy= function(aRect) { return { origin: { x:aRect.origin.x, y:aRect.origin.y }, size: { width:aRect.size.width, height:aRect.size.height } }; }
CGRectCreateCopy= function(aRect) { return { origin: { x:aRect.origin.x, y:aRect.origin.y }, size: { width:aRect.size.width, height:aRect.size.height } }; }
CGRectEqualToRect= function(lhsRect, rhsRect) { return ((lhsRect.origin.x == rhsRect.origin.x && lhsRect.origin.y == rhsRect.origin.y) && (lhsRect.size.width == rhsRect.size.width && lhsRect.size.height == rhsRect.size.height)); }
CGStringFromRect= function(aRect) { return ("{" + ("{" + aRect.origin.x + ", " + aRect.origin.y + "}") + ", " + ("{" + aRect.size.width + ", " + aRect.size.height + "}") + "}"); }
CGRectOffset= function(aRect, dX, dY) { return { origin: { x:aRect.origin.x + dX, y:aRect.origin.y + dY }, size: { width:aRect.size.width, height:aRect.size.height } }; }
CGRectInset= function(aRect, dX, dY) { return { origin: { x:aRect.origin.x + dX, y:aRect.origin.y + dY }, size: { width:aRect.size.width - 2 * dX, height:aRect.size.height - 2 * dY } }; }
CGRectGetHeight= function(aRect) { return (aRect.size.height); }
CGRectGetMaxX= function(aRect) { return (aRect.origin.x + aRect.size.width); }
CGRectGetMaxY= function(aRect) { return (aRect.origin.y + aRect.size.height); }
CGRectGetMidX= function(aRect) { return (aRect.origin.x + (aRect.size.width) / 2.0); }
CGRectGetMidY= function(aRect) { return (aRect.origin.y + (aRect.size.height) / 2.0); }
CGRectGetMinX= function(aRect) { return (aRect.origin.x); }
CGRectGetMinY= function(aRect) { return (aRect.origin.y); }
CGRectGetWidth= function(aRect) { return (aRect.size.width); }
CGRectIsEmpty= function(aRect) { return (aRect.size.width <= 0.0 || aRect.size.height <= 0.0); }
CGRectIsNull= function(aRect) { return (aRect.size.width <= 0.0 || aRect.size.height <= 0.0); }
CGRectContainsPoint= function(aRect, aPoint) { return (aPoint.x >= (aRect.origin.x) && aPoint.y >= (aRect.origin.y) && aPoint.x < (aRect.origin.x + aRect.size.width) && aPoint.y < (aRect.origin.y + aRect.size.height)); }
CGInsetMake= function(top, right, bottom, left) { return { top:(top), right:(right), bottom:(bottom), left:(left) }; }
CGInsetMakeZero= function() { return { top:(0), right:(0), bottom:(0), left:(0) }; }
CGInsetMakeCopy= function(anInset) { return { top:(anInset.top), right:(anInset.right), bottom:(anInset.bottom), left:(anInset.left) }; }
CGInsetIsEmpty= function(anInset) { return ((anInset).top === 0 && (anInset).right === 0 && (anInset).bottom === 0 && (anInset).left === 0); }
CGRectNull = { origin: { x:Infinity, y:Infinity }, size: { width:0.0, height:0.0 } };
CGRectContainsRect= function(lhsRect, rhsRect)
{
    var union = CGRectUnion(lhsRect, rhsRect);
    return ((union.origin.x == lhsRect.origin.x && union.origin.y == lhsRect.origin.y) && (union.size.width == lhsRect.size.width && union.size.height == lhsRect.size.height));
}
CGRectIntersectsRect= function(lhsRect, rhsRect)
{
    var intersection = CGRectIntersection(lhsRect, rhsRect);
    return !(intersection.size.width <= 0.0 || intersection.size.height <= 0.0);
}
CGRectIntegral= function(aRect)
{
    aRect = CGRectStandardize(aRect);
    var x = FLOOR((aRect.origin.x)),
        y = FLOOR((aRect.origin.y));
    aRect.size.width = CEIL((aRect.origin.x + aRect.size.width)) - x;
    aRect.size.height = CEIL((aRect.origin.y + aRect.size.height)) - y;
    aRect.origin.x = x;
    aRect.origin.y = y;
    return aRect;
}
CGRectIntersection= function(lhsRect, rhsRect)
{
    var intersection = { origin: { x:MAX((lhsRect.origin.x), (rhsRect.origin.x)), y:MAX((lhsRect.origin.y), (rhsRect.origin.y)) }, size: { width:0, height:0 } };
    intersection.size.width = MIN((lhsRect.origin.x + lhsRect.size.width), (rhsRect.origin.x + rhsRect.size.width)) - (intersection.origin.x);
    intersection.size.height = MIN((lhsRect.origin.y + lhsRect.size.height), (rhsRect.origin.y + rhsRect.size.height)) - (intersection.origin.y);
    return (intersection.size.width <= 0.0 || intersection.size.height <= 0.0) ? { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } } : intersection;
}
CGRectStandardize= function(aRect)
{
    var width = (aRect.size.width),
        height = (aRect.size.height),
        standardized = { origin: { x:aRect.origin.x, y:aRect.origin.y }, size: { width:aRect.size.width, height:aRect.size.height } };
    if (width < 0.0)
    {
        standardized.origin.x += width;
        standardized.size.width = -width;
    }
    if (height < 0.0)
    {
        standardized.origin.y += height;
        standardized.size.height = -height;
    }
    return standardized;
}
CGRectUnion= function(lhsRect, rhsRect)
{
    var lhsRectIsNull = !lhsRect || lhsRect === CGRectNull,
        rhsRectIsNull = !rhsRect || rhsRect === CGRectNull;
    if (lhsRectIsNull)
        return rhsRectIsNull ? CGRectNull : rhsRect;
    if (rhsRectIsNull)
        return lhsRectIsNull ? CGRectNull : lhsRect;
    var minX = MIN((lhsRect.origin.x), (rhsRect.origin.x)),
        minY = MIN((lhsRect.origin.y), (rhsRect.origin.y)),
        maxX = MAX((lhsRect.origin.x + lhsRect.size.width), (rhsRect.origin.x + rhsRect.size.width)),
        maxY = MAX((lhsRect.origin.y + lhsRect.size.height), (rhsRect.origin.y + rhsRect.size.height));
    return { origin: { x:minX, y:minY }, size: { width:maxX - minX, height:maxY - minY } };
}
CGPointFromString= function(aString)
{
    var comma = aString.indexOf(',');
    return { x:parseInt(aString.substr(1, comma - 1)), y:parseInt(aString.substring(comma + 1, aString.length)) };
}
CGSizeFromString= function(aString)
{
    var comma = aString.indexOf(',');
    return { width:parseInt(aString.substr(1, comma - 1)), height:parseInt(aString.substring(comma + 1, aString.length)) };
}
CGRectFromString= function(aString)
{
    var comma = aString.indexOf(',', aString.indexOf(',') + 1);
    return { origin:CGPointFromString(aString.substr(1, comma - 1)), size:CGSizeFromString(aString.substring(comma + 2, aString.length)) };
}
CGPointFromEvent= function(anEvent)
{
    return { x:anEvent.clientX, y:anEvent.clientY };
}
CGInsetFromString= function(aString)
{
    var numbers = aString.substr(1, aString.length - 2).split(',');
    return { top:(parseFloat(numbers[0])), right:(parseFloat(numbers[1])), bottom:(parseFloat(numbers[2])), left:(parseFloat(numbers[3])) };
}
CGInsetFromCPString = CGInsetFromString;
CPStringFromCGInset= function(anInset)
{
    return '{' + anInset.top + ", " + anInset.left + ", " + anInset.bottom + ", " + anInset.right + '}';
}

p;12;CGGradient.jt;878;@STATIC;1.0;i;9;CGColor.ji;14;CGColorSpace.jt;828;objj_executeFile("CGColor.j", true);
objj_executeFile("CGColorSpace.j", true);
kCGGradientDrawsBeforeStartLocation = 1 << 0;
kCGGradientDrawsAfterEndLocation = 1 << 1;
CGGradientCreateWithColorComponents= function(aColorSpace, components, locations, count)
{
    if (arguments["count"] == NULL)
        var count = locations.length;
    var colors = [];
    while (count--)
    {
        var offset = count * 4;
        colors[count] = CGColorCreate(aColorSpace, components.slice(offset, offset + 4));
    }
    return CGGradientCreateWithColors(aColorSpace, colors, locations);
}
CGGradientCreateWithColors= function(aColorSpace, colors, locations)
{
    return { colorspace:aColorSpace, colors:colors, locations:locations };
}
CGGradientRelease= function()
{
}
CGGradientRetain= function(aGradient)
{
    return aGradient;
}

p;8;CGPath.jt;12271;@STATIC;1.0;i;12;CGGeometry.ji;19;CGAffineTransform.jt;12210;objj_executeFile("CGGeometry.j", true);
objj_executeFile("CGAffineTransform.j", true);
kCGPathElementMoveToPoint = 0;
kCGPathElementAddLineToPoint = 1;
kCGPathElementAddQuadCurveToPoint = 2;
kCGPathElementAddCurveToPoint = 3;
kCGPathElementCloseSubpath = 4;
kCGPathElementAddArc = 5;
kCGPathElementAddArcToPoint = 6;
CGPathCreateMutable= function()
{
    return { count:0, start:NULL, current:NULL, elements:[] };
}
CGPathCreateMutableCopy= function(aPath)
{
    var path = CGPathCreateMutable();
    CGPathAddPath(path, aPath);
    return path;
}
CGPathCreateCopy= function(aPath)
{
    return CGPathCreateMutableCopy(aPath);
}
CGPathRelease= function(aPath)
{
}
CGPathRetain= function(aPath)
{
    return aPath;
}
CGPathAddArc= function(aPath, aTransform, x, y, aRadius, aStartAngle, anEndAngle, isClockwise)
{
    if (aTransform && !(aTransform.a == 1 && aTransform.b == 0 && aTransform.c == 0 && aTransform.d == 1 && aTransform.tx == 0 && aTransform.ty == 0))
    {
        var center = { x:x, y:y },
            end = { x:COS(anEndAngle), y:SIN(anEndAngle) },
            start = { x:COS(aStartAngle), y:SIN(aStartAngle) };
        end = { x:end.x * aTransform.a + end.y * aTransform.c + aTransform.tx, y:end.x * aTransform.b + end.y * aTransform.d + aTransform.ty };
        start = { x:start.x * aTransform.a + start.y * aTransform.c + aTransform.tx, y:start.x * aTransform.b + start.y * aTransform.d + aTransform.ty };
        center = { x:center.x * aTransform.a + center.y * aTransform.c + aTransform.tx, y:center.x * aTransform.b + center.y * aTransform.d + aTransform.ty };
        x = center.x;
        y = center.y;
        var oldEndAngle = anEndAngle,
            oldStartAngle = aStartAngle;
        anEndAngle = ATAN2(end.y - aTransform.ty, end.x - aTransform.tx);
        aStartAngle = ATAN2(start.y - aTransform.ty, start.x - aTransform.tx);
        if (anEndAngle == aStartAngle && oldEndAngle != oldStartAngle)
            if (oldStartAngle > oldEndAngle)
                anEndAngle = anEndAngle - PI2;
            else
                aStartAngle = aStartAngle - PI2;
        aRadius = { width:aRadius, height:0 };
        aRadius = { width:aRadius.width * aTransform.a + aRadius.height * aTransform.c, height:aRadius.width * aTransform.b + aRadius.height * aTransform.d };
        aRadius = SQRT(aRadius.width * aRadius.width + aRadius.height * aRadius.height);
    }
    aPath.current = { x:x + aRadius * COS(anEndAngle), y:y + aRadius * SIN(anEndAngle) };
    aPath.elements[aPath.count++] = { type:kCGPathElementAddArc, x:x, y:y, radius:aRadius, startAngle:aStartAngle, endAngle:anEndAngle };
}
CGPathAddArcToPoint= function(aPath, aTransform, x1, y1, x2, y2, aRadius)
{
}
CGPathAddCurveToPoint= function(aPath, aTransform, cp1x, cp1y, cp2x, cp2y, x, y)
{
    var cp1 = { x:cp1x, y:cp1y },
        cp2 = { x:cp2x, y:cp2y },
        end = { x:x, y:y };
    if (aTransform)
    {
        cp1 = { x:cp1.x * aTransform.a + cp1.y * aTransform.c + aTransform.tx, y:cp1.x * aTransform.b + cp1.y * aTransform.d + aTransform.ty };
        cp2 = { x:cp2.x * aTransform.a + cp2.y * aTransform.c + aTransform.tx, y:cp2.x * aTransform.b + cp2.y * aTransform.d + aTransform.ty };
        end = { x:end.x * aTransform.a + end.y * aTransform.c + aTransform.tx, y:end.x * aTransform.b + end.y * aTransform.d + aTransform.ty };
    }
   aPath.current = end;
   aPath.elements[aPath.count++] = { type:kCGPathElementAddCurveToPoint, cp1x:cp1.x, cp1y:cp1.y, cp2x:cp2.x, cp2y:cp2.y, x:end.x, y:end.y };
}
CGPathAddLines= function(aPath, aTransform, points, count)
{
    var i = 1;
    if (arguments["count"] == NULL)
        var count = points.length;
    if (!aPath || count < 2)
        return;
    CGPathMoveToPoint(aPath, aTransform, points[0].x, points[0].y);
    for (; i < count; ++i)
        CGPathAddLineToPoint(aPath, aTransform, points[i].x, points[i].y);
}
CGPathAddLineToPoint= function(aPath, aTransform, x, y)
{
    var point = { x:x, y:y };
    if (aTransform != NULL)
        point = { x:point.x * aTransform.a + point.y * aTransform.c + aTransform.tx, y:point.x * aTransform.b + point.y * aTransform.d + aTransform.ty };
    aPath.elements[aPath.count++] = { type: kCGPathElementAddLineToPoint, x:point.x, y:point.y };
    aPath.current = point;
}
CGPathAddPath= function(aPath, aTransform, anotherPath)
{
    for (var i = 0, count = anotherPath.count; i < count; ++i)
    {
        var element = anotherPath.elements[i];
        switch (element.type)
        {
            case kCGPathElementAddLineToPoint: CGPathAddLineToPoint(aPath, aTransform, element.x, element.y);
                                                    break;
            case kCGPathElementAddCurveToPoint: CGPathAddCurveToPoint(aPath, aTransform,
                                                                          element.cp1x, element.cp1y,
                                                                          element.cp2x, element.cp2y,
                                                                          element.x, element.y);
                                                    break;
            case kCGPathElementAddArc: CGPathAddArc(aPath, aTransform, element.x, element.y,
                                                                 element.radius, element.startAngle,
                                                                 element.endAngle, element.isClockwise);
                                                    break;
            case kCGPathElementAddQuadCurveToPoint: CGPathAddQuadCurveToPoint(aPath, aTransform,
                                                                              element.cpx, element.cpy,
                                                                              element.x, element.y);
                                                    break;
            case kCGPathElementMoveToPoint: CGPathMoveToPoint(aPath, aTransform, element.x, element.y);
                                                    break;
            case kCGPathElementCloseSubpath: CGPathCloseSubpath(aPath);
                                                    break;
        }
    }
}
CGPathAddQuadCurveToPoint= function(aPath, aTransform, cpx, cpy, x, y)
{
    var cp = { x:cpx, y:cpy },
        end = { x:x, y:y };
    if (aTransform)
    {
        cp = { x:control.x * aTransform.a + control.y * aTransform.c + aTransform.tx, y:control.x * aTransform.b + control.y * aTransform.d + aTransform.ty };
        end = { x:end.x * aTransform.a + end.y * aTransform.c + aTransform.tx, y:end.x * aTransform.b + end.y * aTransform.d + aTransform.ty };
    }
    aPath.elements[aPath.count++] = { type:kCGPathElementAddQuadCurveToPoint, cpx:cp.x, cpy:cp.y, x:end.x, y:end.y }
    aPath.current = end;
}
CGPathAddRect= function(aPath, aTransform, aRect)
{
    CGPathAddRects(aPath, aTransform, [aRect], 1);
}
CGPathAddRects= function(aPath, aTransform, rects, count)
{
    var i = 0;
    if (arguments["count"] == NULL)
        var count = rects.length;
    for (; i < count; ++i)
    {
        var rect = rects[i];
        CGPathMoveToPoint(aPath, aTransform, (rect.origin.x), (rect.origin.y));
        CGPathAddLineToPoint(aPath, aTransform, (rect.origin.x + rect.size.width), (rect.origin.y));
        CGPathAddLineToPoint(aPath, aTransform, (rect.origin.x + rect.size.width), (rect.origin.y + rect.size.height));
        CGPathAddLineToPoint(aPath, aTransform, (rect.origin.x), (rect.origin.y + rect.size.height));
        CGPathCloseSubpath(aPath);
    }
}
CGPathMoveToPoint= function(aPath, aTransform, x, y)
{
    var point = { x:x, y:y },
        count = aPath.count;
    if (aTransform != NULL)
        point = { x:point.x * aTransform.a + point.y * aTransform.c + aTransform.tx, y:point.x * aTransform.b + point.y * aTransform.d + aTransform.ty };
    aPath.start = point;
    aPath.current = point;
    var previous = aPath.elements[count - 1];
    if (count != 0 && previous.type == kCGPathElementMoveToPoint)
    {
        previous.x = point.x;
        previous.y = point.y;
    }
    else
        aPath.elements[aPath.count++] = { type:kCGPathElementMoveToPoint, x:point.x, y:point.y };
}
var KAPPA = 4.0 * ((SQRT2 - 1.0) / 3.0);
CGPathWithEllipseInRect= function(aRect)
{
    var path = CGPathCreateMutable();
 if ((aRect.size.width) == (aRect.size.height))
        CGPathAddArc(path, nil, (aRect.origin.x + (aRect.size.width) / 2.0), (aRect.origin.y + (aRect.size.height) / 2.0), (aRect.size.width) / 2.0, 0.0, 2 * PI, YES);
 else
 {
     var axis = { width:(aRect.size.width) / 2.0, height:(aRect.size.height) / 2.0 },
         center = { x:(aRect.origin.x) + axis.width, y:(aRect.origin.y) + axis.height };
        CGPathMoveToPoint(path, nil, center.x, center.y - axis.height);
     CGPathAddCurveToPoint(path, nil, center.x + (KAPPA * axis.width), center.y - axis.height, center.x + axis.width, center.y - (KAPPA * axis.height), center.x + axis.width, center.y);
     CGPathAddCurveToPoint(path, nil, center.x + axis.width, center.y + (KAPPA * axis.height), center.x + (KAPPA * axis.width), center.y + axis.height, center.x, center.y + axis.height);
     CGPathAddCurveToPoint(path, nil, center.x - (KAPPA * axis.width), center.y + axis.height, center.x - axis.width, center.y + (KAPPA * axis.height), center.x - axis.width, center.y);
     CGPathAddCurveToPoint(path, nil, center.x - axis.width, center.y - (KAPPA * axis.height), center.x - (KAPPA * axis.width), center.y - axis.height, center.x, center.y - axis.height);
 }
    CGPathCloseSubpath(path);
    return path;
}
CGPathWithRoundedRectangleInRect= function(aRect, xRadius, yRadius , ne, se, sw, nw)
{
    var path = CGPathCreateMutable(),
        xMin = (aRect.origin.x),
        xMax = (aRect.origin.x + aRect.size.width),
        yMin = (aRect.origin.y),
        yMax = (aRect.origin.y + aRect.size.height);
    CGPathMoveToPoint(path, nil, xMin + xRadius, yMin);
 if (ne)
 {
  CGPathAddLineToPoint(path, nil, xMax - xRadius, yMin);
  CGPathAddCurveToPoint(path, nil, xMax - xRadius, yMin, xMax, yMin, xMax, yMin + xRadius);
 }
 else
  CGPathAddLineToPoint(path, nil, xMax, yMin);
 if (se)
 {
  CGPathAddLineToPoint(path, nil, xMax, yMax - xRadius);
  CGPathAddCurveToPoint(path, nil, xMax, yMax - xRadius, xMax, yMax, xMax - xRadius, yMax);
 }
 else
  CGPathAddLineToPoint(path, nil, xMax, yMax);
 if (sw)
 {
  CGPathAddLineToPoint(path, nil, xMin + xRadius, yMax);
  CGPathAddCurveToPoint(path, nil, xMin + xRadius, yMax, xMin, yMax, xMin, yMax - xRadius);
 }
 else
  CGPathAddLineToPoint(path, nil, xMin, yMax);
 if (nw)
 {
  CGPathAddLineToPoint(path, nil, xMin, yMin + xRadius);
  CGPathAddCurveToPoint(path, nil, xMin, yMin + xRadius, xMin, yMin, xMin + xRadius, yMin);
 } else
  CGPathAddLineToPoint(path, nil, xMin, yMin);
    CGPathCloseSubpath(path);
    return path;
}
CGPathCloseSubpath= function(aPath)
{
    var count = aPath.count;
    if (count == 0 || aPath.elements[count - 1].type == kCGPathElementCloseSubpath)
        return;
    aPath.elements[aPath.count++] = { type:kCGPathElementCloseSubpath, points:[aPath.start] };
}
CGPathEqualToPath= function(aPath, anotherPath)
{
    if (aPath == anotherPath)
        return YES;
    if (aPath.count != anotherPath.count || !(aPath.start.x == anotherPath.start.x && aPath.start.y == anotherPath.start.y) || !(aPath.current.x == anotherPath.current.x && aPath.current.y == anotherPath.current.y))
        return NO;
    var i = 0,
        count = aPath.count;
    for (; i < count; ++i)
    {
        var element = aPath[i],
            anotherElement = anotherPath[i];
        if (element.type != anotherElement.type)
            return NO;
        if ((element.type == kCGPathElementAddArc || element.type == kCGPathElementAddArcToPoint) &&
            element.radius != anotherElement.radius)
            return NO;
        var j = element.points.length;
        while (j--)
            if (!(element.points[j].x == anotherElement.points[j].x && element.points[j].y == anotherElement.points[j].y))
                return NO;
    }
    return YES;
}
CGPathGetCurrentPoint= function(aPath)
{
    return { x:aPath.current.x, y:aPath.current.y };
}
CGPathIsEmpty= function(aPath)
{
    return !aPath || aPath.count == 0;
}

p;18;_CPMenuBarWindow.jt;17936;@STATIC;1.0;i;15;_CPMenuWindow.jt;17896;





objj_executeFile("_CPMenuWindow.j", true);


var MENUBAR_HEIGHT = 28.0,
    MENUBAR_MARGIN = 10.0,
    MENUBAR_LEFT_MARGIN = 10.0,
    MENUBAR_RIGHT_MARGIN = 10.0;

var _CPMenuBarWindowBackgroundColor = nil,
    _CPMenuBarWindowFont = nil;

{var the_class = objj_allocateClassPair(CPPanel, "_CPMenuBarWindow"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menu"), new objj_ivar("_highlightView"), new objj_ivar("_menuItemViews"), new objj_ivar("_trackingMenuItem"), new objj_ivar("_iconImageView"), new objj_ivar("_titleField"), new objj_ivar("_textColor"), new objj_ivar("_titleColor"), new objj_ivar("_textShadowColor"), new objj_ivar("_titleShadowColor"), new objj_ivar("_highlightColor"), new objj_ivar("_highlightTextColor"), new objj_ivar("_highlightTextShadowColor")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{

    var contentRect = objj_msgSend(objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"), "contentBounds");

    contentRect.size.height = MENUBAR_HEIGHT;

    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuBarWindow").super_class }, "initWithContentRect:styleMask:", contentRect, CPBorderlessWindowMask);

    if (self)
    {

        objj_msgSend(self, "setLevel:", -1);
        objj_msgSend(self, "setAutoresizingMask:", CPWindowWidthSizable);

        var contentView = objj_msgSend(self, "contentView");

        objj_msgSend(contentView, "setAutoresizesSubviews:", NO);

        objj_msgSend(self, "setBecomesKeyOnlyIfNeeded:", YES);


        _iconImageView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 16.0, 16.0));

        objj_msgSend(contentView, "addSubview:", _iconImageView);

        _titleField = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMakeZero());

        objj_msgSend(_titleField, "setFont:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 13.0));
        objj_msgSend(_titleField, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(_titleField, "setTextShadowOffset:", CGSizeMake(0, 1));

        objj_msgSend(contentView, "addSubview:", _titleField);
    }

    return self;
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{

    var bundleName = objj_msgSend(objj_msgSend(CPBundle, "mainBundle"), "objectForInfoDictionaryKey:", "CPBundleName");

    if (!objj_msgSend(bundleName, "length"))
        document.title = aTitle;
    else if (objj_msgSend(aTitle, "length"))
        document.title = aTitle + " - " + bundleName;
    else
        document.title = bundleName;


    objj_msgSend(_titleField, "setStringValue:", aTitle);
    objj_msgSend(_titleField, "sizeToFit");

    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("setIconImage:"), function(self, _cmd, anImage)
{ with(self)
{
    objj_msgSend(_iconImageView, "setImage:", anImage);
    objj_msgSend(_iconImageView, "setHidden:", anImage == nil);

    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("setIconImageAlphaValue:"), function(self, _cmd, anAlphaValue)
{ with(self)
{
    objj_msgSend(_iconImageView, "setAlphaValue:", anAlphaValue);
}
}), new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (!aColor)
    {
        if (!_CPMenuBarWindowBackgroundColor)
            _CPMenuBarWindowBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(_CPMenuBarWindow, "class")), "pathForResource:", "_CPMenuBarWindow/_CPMenuBarWindowBackground.png"), CGSizeMake(1.0, 28.0)));

        objj_msgSend(objj_msgSend(self, "contentView"), "setBackgroundColor:", _CPMenuBarWindowBackgroundColor);
    }
    else
        objj_msgSend(objj_msgSend(self, "contentView"), "setBackgroundColor:", aColor);
}
}), new objj_method(sel_getUid("setTextColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_textColor == aColor)
        return;

    _textColor = aColor;

    objj_msgSend(_menuItemViews, "makeObjectsPerformSelector:withObject:", sel_getUid("setTextColor:"), _textColor);
}
}), new objj_method(sel_getUid("setTitleColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_titleColor == aColor)
        return;

    _titleColor = aColor;

    objj_msgSend(_titleField, "setTextColor:", aColor ? aColor : objj_msgSend(CPColor, "blackColor"));
}
}), new objj_method(sel_getUid("setTextShadowColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_textShadowColor == aColor)
        return;

    _textShadowColor = aColor;

    objj_msgSend(_menuItemViews, "makeObjectsPerformSelector:withObject:", sel_getUid("setTextShadowColor:"), _textShadowColor);
}
}), new objj_method(sel_getUid("setTitleShadowColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_titleShadowColor == aColor)
        return;

    _titleShadowColor = aColor;

    objj_msgSend(_titleField, "setTextShadowColor:", aColor ? aColor : objj_msgSend(CPColor, "whiteColor"));
}
}), new objj_method(sel_getUid("setHighlightColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_highlightColor == aColor)
        return;

    _highlightColor = aColor;
}
}), new objj_method(sel_getUid("setHighlightTextColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_highlightTextColor == aColor)
        return;

    _highlightTextColor = aColor;


}
}), new objj_method(sel_getUid("setHighlightTextShadowColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_highlightTextShadowColor == aColor)
        return;

    _highlightTextShadowColor = aColor;


}
}), new objj_method(sel_getUid("setMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    if (_menu == aMenu)
        return;

    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");

    if (_menu)
    {
        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPMenuDidAddItemNotification, _menu);

        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPMenuDidChangeItemNotification, _menu);

        objj_msgSend(defaultCenter, "removeObserver:name:object:", self, CPMenuDidRemoveItemNotification, _menu);

        var items = objj_msgSend(_menu, "itemArray"),
            count = items.length;

        while (count--)
            objj_msgSend(objj_msgSend(items[count], "_menuItemView"), "removeFromSuperview");
    }

    _menu = aMenu;

    if (_menu)
    {
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("menuDidAddItem:"), CPMenuDidAddItemNotification, _menu);

        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("menuDidChangeItem:"), CPMenuDidChangeItemNotification, _menu);

        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", self, sel_getUid("menuDidRemoveItem:"), CPMenuDidRemoveItemNotification, _menu);
    }

    _menuItemViews = [];

    var contentView = objj_msgSend(self, "contentView"),
        items = objj_msgSend(_menu, "itemArray"),
        count = items.length;

    for (index = 0; index < count; ++index)
    {
        var item = items[index],
            menuItemView = objj_msgSend(item, "_menuItemView");

        _menuItemViews.push(menuItemView);

        objj_msgSend(menuItemView, "setTextColor:", _textColor);
        objj_msgSend(menuItemView, "setHidden:", objj_msgSend(item, "isHidden"));

        objj_msgSend(menuItemView, "synchronizeWithMenuItem");

        objj_msgSend(contentView, "addSubview:", menuItemView);
    }

    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("menuDidChangeItem:"), function(self, _cmd, aNotification)
{ with(self)
{
    var menuItem = objj_msgSend(_menu, "itemAtIndex:", objj_msgSend(objj_msgSend(aNotification, "userInfo"), "objectForKey:", "CPMenuItemIndex")),
        menuItemView = objj_msgSend(menuItem, "_menuItemView");

    objj_msgSend(menuItemView, "setHidden:", objj_msgSend(menuItem, "isHidden"));
    objj_msgSend(menuItemView, "synchronizeWithMenuItem");

    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("menuDidAddItem:"), function(self, _cmd, aNotification)
{ with(self)
{
    var index = objj_msgSend(objj_msgSend(aNotification, "userInfo"), "objectForKey:", "CPMenuItemIndex"),
        menuItem = objj_msgSend(_menu, "itemAtIndex:", index),
        menuItemView = objj_msgSend(menuItem, "_menuItemView");

    objj_msgSend(_menuItemViews, "insertObject:atIndex:", menuItemView, index);

    objj_msgSend(menuItemView, "setTextColor:", _textColor);
    objj_msgSend(menuItemView, "setHidden:", objj_msgSend(menuItem, "isHidden"));

    objj_msgSend(menuItemView, "synchronizeWithMenuItem");

    objj_msgSend(objj_msgSend(self, "contentView"), "addSubview:", menuItemView);

    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("menuDidRemoveItem:"), function(self, _cmd, aNotification)
{ with(self)
{
    var index = objj_msgSend(objj_msgSend(aNotification, "userInfo"), "objectForKey:", "CPMenuItemIndex"),
        menuItemView = objj_msgSend(_menuItemViews, "objectAtIndex:", index);

    objj_msgSend(_menuItemViews, "removeObjectAtIndex:", index);

    objj_msgSend(menuItemView, "removeFromSuperview");

    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    var constraintRect = CGRectInset(objj_msgSend(objj_msgSend(self, "platformWindow"), "visibleFrame"), 5.0, 0.0);

    constraintRect.size.height -= 5.0;

    objj_msgSend(objj_msgSend(_CPMenuManager, "sharedMenuManager"), "beginTracking:menuContainer:constraintRect:callback:", anEvent, self, constraintRect, function(aMenuContainer, aMenu)
             {
                objj_msgSend(aMenu, "_performActionOfHighlightedItemChain");
                objj_msgSend(aMenu, "_highlightItemAtIndex:", CPNotFound);
             });
}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(CPFont, "systemFontOfSize:", 12.0);
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    var items = objj_msgSend(_menu, "itemArray"),
        index = 0,
        count = items.length,

        x = MENUBAR_LEFT_MARGIN,
        y = 0.0,
        isLeftAligned = YES;

    for (; index < count; ++index)
    {
        var item = items[index];

        if (objj_msgSend(item, "isSeparatorItem"))
        {
            x = CGRectGetWidth(objj_msgSend(self, "frame")) - MENUBAR_RIGHT_MARGIN;
            isLeftAligned = NO;

            continue;
        }

         if (objj_msgSend(item, "isHidden"))
            continue;

        var menuItemView = objj_msgSend(item, "_menuItemView"),
            frame = objj_msgSend(menuItemView, "frame");

        if (isLeftAligned)
        {
            objj_msgSend(menuItemView, "setFrame:", CGRectMake(x, 0.0, CGRectGetWidth(frame), MENUBAR_HEIGHT));

            x += CGRectGetWidth(objj_msgSend(menuItemView, "frame"));
        }
        else
        {
            objj_msgSend(menuItemView, "setFrame:", CGRectMake(x - CGRectGetWidth(frame), 0.0, CGRectGetWidth(frame), MENUBAR_HEIGHT));

            x = CGRectGetMinX(objj_msgSend(menuItemView, "frame"));
        }
    }

    var bounds = objj_msgSend(objj_msgSend(self, "contentView"), "bounds"),
        titleFrame = objj_msgSend(_titleField, "frame");

    if (objj_msgSend(_iconImageView, "isHidden"))
        objj_msgSend(_titleField, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - CGRectGetWidth(titleFrame)) / 2.0, (CGRectGetHeight(bounds) - CGRectGetHeight(titleFrame)) / 2.0));
    else
    {
        var iconFrame = objj_msgSend(_iconImageView, "frame"),
            iconWidth = CGRectGetWidth(iconFrame),
            totalWidth = iconWidth + CGRectGetWidth(titleFrame);

        objj_msgSend(_iconImageView, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - totalWidth) / 2.0, (CGRectGetHeight(bounds) - CGRectGetHeight(iconFrame)) / 2.0));
        objj_msgSend(_titleField, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - totalWidth) / 2.0 + iconWidth, (CGRectGetHeight(bounds) - CGRectGetHeight(titleFrame)) / 2.0));
    }
}
}), new objj_method(sel_getUid("setFrame:display:animate:"), function(self, _cmd, aRect, shouldDisplay, shouldAnimate)
{ with(self)
{
    var size = objj_msgSend(self, "frame").size;

    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuBarWindow").super_class }, "setFrame:display:animate:", aRect, shouldDisplay, shouldAnimate);

    if (!(size.width == aRect.size.width && size.height == aRect.size.height))
        objj_msgSend(self, "tile");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPMenuBarWindow, "class"))
        return;

    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);

    _CPMenuBarWindowFont = objj_msgSend(CPFont, "boldSystemFontOfSize:", 12.0);
}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
    return _CPMenuBarWindowFont;
}
})]);
}

{
var the_class = objj_getClass("_CPMenuBarWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPMenuBarWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("isMenuBar"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("globalFrame"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "frame");
}
}), new objj_method(sel_getUid("scrollingStateForPoint:"), function(self, _cmd, aGlobalLocation)
{ with(self)
{
    return _CPMenuManagerScrollingStateNone;
}
}), new objj_method(sel_getUid("itemIndexAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var items = objj_msgSend(_menu, "itemArray"),
        index = items.length;

    while (index--)
    {
        var item = items[index];

        if (objj_msgSend(item, "isHidden") || objj_msgSend(item, "isSeparatorItem"))
            continue;

        if (CGRectContainsPoint(objj_msgSend(self, "rectForItemAtIndex:", index), aPoint))
            return index;
    }

    return CPNotFound;
}
}), new objj_method(sel_getUid("rectForItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    var menuItem = objj_msgSend(_menu, "itemAtIndex:", anIndex === CPNotFound ? 0 : anIndex);

    return objj_msgSend(objj_msgSend(menuItem, "_menuItemView"), "frame");
}
})]);
}

{var the_class = objj_allocateClassPair(_CPMenuView, "_CPMenuBarView"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("rectForItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(_menuItemViews[anIndex === CPNotFound ? 0 : anIndex], "frame");
}
}), new objj_method(sel_getUid("itemIndexAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds");

    if (!CGRectContainsPoint(bounds, aPoint))
        return CPNotFound;

    var x = aPoint.x,
        low = 0,
        high = _visibleMenuItemInfos.length - 1;

    while (low <= high)
    {
        var middle = FLOOR(low + (high - low) / 2),
            info = _visibleMenuItemInfos[middle],
            frame = objj_msgSend(info.view, "frame");

        if (x < CGRectGetMinX(frame))
            high = middle - 1;

        else if (x > CGRectGetMaxX(frame))
            low = middle + 1;

        else
            return info.index;
   }

   return CPNotFound;
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    var items = objj_msgSend(_menu, "itemArray"),
        index = 0,
        count = items.length,

        x = MENUBAR_LEFT_MARGIN,
        y = 0.0,
        isLeftAligned = YES;

    for (; index < count; ++index)
    {
        var item = items[index];

        if (objj_msgSend(item, "isSeparatorItem"))
        {
            x = CGRectGetWidth(objj_msgSend(self, "frame")) - MENUBAR_RIGHT_MARGIN;
            isLeftAligned = NO;

            continue;
        }

         if (objj_msgSend(item, "isHidden"))
            continue;

        var menuItemView = objj_msgSend(item, "_menuItemView"),
            frame = objj_msgSend(menuItemView, "frame");

        if (isLeftAligned)
        {
            objj_msgSend(menuItemView, "setFrameOrigin:", CGPointMake(x, (MENUBAR_HEIGHT - 1.0 - CGRectGetHeight(frame)) / 2.0));

            x += CGRectGetWidth(objj_msgSend(menuItemView, "frame")) + MENUBAR_MARGIN;
        }
        else
        {
            objj_msgSend(menuItemView, "setFrameOrigin:", CGPointMake(x - CGRectGetWidth(frame), (MENUBAR_HEIGHT - 1.0 - CGRectGetHeight(frame)) / 2.0));

            x = CGRectGetMinX(objj_msgSend(menuItemView, "frame")) - MENUBAR_MARGIN;
        }
    }

    var bounds = objj_msgSend(objj_msgSend(self, "contentView"), "bounds"),
        titleFrame = objj_msgSend(_titleField, "frame");

    if (objj_msgSend(_iconImageView, "isHidden"))
        objj_msgSend(_titleField, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - CGRectGetWidth(titleFrame)) / 2.0, (CGRectGetHeight(bounds) - CGRectGetHeight(titleFrame)) / 2.0));
    else
    {
        var iconFrame = objj_msgSend(_iconImageView, "frame"),
            iconWidth = CGRectGetWidth(iconFrame),
            totalWidth = iconWidth + CGRectGetWidth(titleFrame);

        objj_msgSend(_iconImageView, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - totalWidth) / 2.0, (CGRectGetHeight(bounds) - CGRectGetHeight(iconFrame)) / 2.0));
        objj_msgSend(_titleField, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - totalWidth) / 2.0 + iconWidth, (CGRectGetHeight(bounds) - CGRectGetHeight(titleFrame)) / 2.0));
    }
}
})]);
}

p;16;_CPMenuManager.jt;10595;@STATIC;1.0;I;21;Foundation/CPObject.jt;10549;




objj_executeFile("Foundation/CPObject.j", false);


_CPMenuManagerScrollingStateUp = -1,
_CPMenuManagerScrollingStateDown = 1,
_CPMenuManagerScrollingStateNone = 0;

var STICKY_TIME_INTERVAL = 500;

var SharedMenuManager = nil;

{var the_class = objj_allocateClassPair(CPObject, "_CPMenuManager"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_startTime"), new objj_ivar("_scrollingState"), new objj_ivar("_lastGlobalLocation"), new objj_ivar("_lastMouseOverMenuView"), new objj_ivar("_constraintRect"), new objj_ivar("_menuContainerStack"), new objj_ivar("_trackingCallback")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    if (SharedMenuManager)
        return SharedMenuManager;

    return objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuManager").super_class }, "init");
}
}), new objj_method(sel_getUid("trackingMenuContainer"), function(self, _cmd)
{ with(self)
{
    return _menuContainerStack[0];
}
}), new objj_method(sel_getUid("trackingMenu"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "trackingMenuContainer"), "menu");
}
}), new objj_method(sel_getUid("beginTracking:menuContainer:constraintRect:callback:"), function(self, _cmd, anEvent, aMenuContainer, aRect, aCallback)
{ with(self)
{
    CPApp._activeMenu = objj_msgSend(aMenuContainer, "menu");

    _startTime = objj_msgSend(anEvent, "timestamp");
    _scrollingState = _CPMenuManagerScrollingStateNone;

    _constraintRect = aRect;
    _trackingCallback = aCallback;
    _menuContainerStack = [aMenuContainer];

    objj_msgSend(self, "trackEvent:", anEvent);
}
}), new objj_method(sel_getUid("trackEvent:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type"),
        trackingMenu = objj_msgSend(self, "trackingMenu");


    if (type === CPAppKitDefined)
    {

        objj_msgSend(CPEvent, "stopPeriodicEvents");


        var highlightedItem = objj_msgSend(trackingMenu, "highlightedItem");


        objj_msgSend(self, "showMenu:fromMenu:atPoint:", nil, trackingMenu, nil);

        var delegate = objj_msgSend(trackingMenu, "delegate");

        if (objj_msgSend(delegate, "respondsToSelector:", sel_getUid("menuDidClose:")))
            objj_msgSend(delegate, "menuDidClose:", trackingMenu);

        if (_trackingCallback)
            _trackingCallback(objj_msgSend(self, "trackingMenuContainer"), trackingMenu);

        objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPMenuDidEndTrackingNotification, trackingMenu);

        CPApp._activeMenu = nil;

        return;
    }

    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackEvent:"), CPPeriodicMask | CPMouseMovedMask | CPLeftMouseDraggedMask | CPLeftMouseUpMask | CPAppKitDefinedMask, nil, nil, YES);


    var globalLocation = type === CPPeriodic ? _lastGlobalLocation : objj_msgSend(anEvent, "globalLocation");


    _lastGlobalLocation = globalLocation;


    var activeMenuContainer = objj_msgSend(self, "menuContainerForPoint:", globalLocation),
        activeMenu = objj_msgSend(activeMenuContainer, "menu"),
        menuLocation = objj_msgSend(activeMenuContainer, "convertGlobalToBase:", globalLocation);


    var activeItemIndex = activeMenuContainer ? objj_msgSend(activeMenuContainer, "itemIndexAtPoint:", menuLocation) : CPNotFound,
        activeItem = activeItemIndex !== CPNotFound ? objj_msgSend(activeMenu, "itemAtIndex:", activeItemIndex) : nil;


    if (!objj_msgSend(activeItem, "isEnabled"))
    {
        activeItemIndex = CPNotFound;
        activeItem = nil;
    }

    var mouseOverMenuView = objj_msgSend(activeItem, "view");

    if (type === CPPeriodic)
    {
        if (_scrollingState === _CPMenuManagerScrollingStateUp)
            objj_msgSend(activeMenuContainer, "scrollUp");

        else if (_scrollingState === _CPMenuManagerScrollingStateDown)
            objj_msgSend(activeMenuContainer, "scrollDown");
    }


    if (mouseOverMenuView)
    {
        if (!_lastMouseOverMenuView)
            objj_msgSend(activeMenu, "_highlightItemAtIndex:", CPNotFound);

        if (_lastMouseOverMenuView != mouseOverMenuView)
        {
            objj_msgSend(mouseOverMenuView, "mouseExited:", anEvent);

            objj_msgSend(_lastMouseOverMenuView, "mouseEntered:", anEvent);

            _lastMouseOverMenuView = mouseOverMenuView;
        }

        var menuContainerWindow = activeMenuContainer;

        if (!objj_msgSend(menuContainerWindow, "isKindOfClass:", objj_msgSend(CPWindow, "class")))
            menuContainerWindow = objj_msgSend(menuContainerWindow, "window");

        objj_msgSend(menuContainerWindow, "sendEvent:", objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", type, menuLocation, objj_msgSend(anEvent, "modifierFlags"), objj_msgSend(anEvent, "timestamp"), menuContainerWindow, nil, 0, objj_msgSend(anEvent, "clickCount"), objj_msgSend(anEvent, "pressure")));
    }
    else
    {
        if (_lastMouseOverMenuView)
        {
            objj_msgSend(_lastMouseOverMenuView, "mouseExited:", anEvent);
            _lastMouseOverMenuView = nil;
        }

        objj_msgSend(activeMenu, "_highlightItemAtIndex:", activeItemIndex);

        if (type === CPMouseMoved || type === CPLeftMouseDragged || type === CPLeftMouseDown)
        {
            var oldScrollingState = _scrollingState;

            _scrollingState = objj_msgSend(activeMenuContainer, "scrollingStateForPoint:", globalLocation);

            if (_scrollingState !== oldScrollingState)
            {
                if (_scrollingState === _CPMenuManagerScrollingStateNone)
                    objj_msgSend(CPEvent, "stopPeriodicEvents");

                else if (oldScrollingState === _CPMenuManagerScrollingStateNone)
                    objj_msgSend(CPEvent, "startPeriodicEventsAfterDelay:withPeriod:", 0.0, 0.04);
            }
        }
        else if (type === CPLeftMouseUp && (objj_msgSend(anEvent, "timestamp") - _startTime > STICKY_TIME_INTERVAL))
            objj_msgSend(trackingMenu, "cancelTracking");
    }


    if (objj_msgSend(activeItem, "hasSubmenu"))
    {
        var activeItemRect = objj_msgSend(activeMenuContainer, "rectForItemAtIndex:", activeItemIndex);

        if (objj_msgSend(activeMenuContainer, "isMenuBar"))
            var newMenuOrigin = CGPointMake(CGRectGetMinX(activeItemRect), CGRectGetMaxY(activeItemRect));
        else
            var newMenuOrigin = CGPointMake(CGRectGetMaxX(activeItemRect), CGRectGetMinY(activeItemRect));

        newMenuOrigin = objj_msgSend(activeMenuContainer, "convertBaseToGlobal:", newMenuOrigin);

        objj_msgSend(self, "showMenu:fromMenu:atPoint:", objj_msgSend(activeItem, "submenu"), objj_msgSend(activeItem, "menu"), newMenuOrigin);
    }



    else
        objj_msgSend(self, "showMenu:fromMenu:atPoint:", nil, activeMenu, CGPointMakeZero());
}
}), new objj_method(sel_getUid("menuContainerForPoint:"), function(self, _cmd, aGlobalLocation)
{ with(self)
{
    var count = objj_msgSend(_menuContainerStack, "count"),
        firstMenuContainer = _menuContainerStack[0];


    if (count === 1)
        return firstMenuContainer;

    var firstMenuWindowIndex = 0,
        lastMenuWindowIndex = count - 1;


    if (objj_msgSend(firstMenuContainer, "isMenuBar"))
    {
        if (CGRectContainsPoint(objj_msgSend(firstMenuContainer, "globalFrame"), aGlobalLocation))
            return firstMenuContainer;

        firstMenuWindowIndex = 1;
    }

    var index = count,
        x = aGlobalLocation.x,
        closerDeltaX = Infinity,
        closerMenuContainer = nil;

    while (index-- > firstMenuWindowIndex)
    {
        var menuContainer = _menuContainerStack[index],
            menuContainerFrame = objj_msgSend(menuContainer, "globalFrame"),
            menuContainerMinX = (menuContainerFrame.origin.x),
            menuContainerMaxX = (menuContainerFrame.origin.x + menuContainerFrame.size.width);


        if (x < menuContainerMaxX && x >= menuContainerMinX)
            return menuContainer;


        if (index === firstMenuWindowIndex || index === lastMenuWindowIndex)
        {
            var deltaX = ABS(x < menuContainerMinX ? menuContainerMinX - x : menuContainerMaxX - x);

            if (deltaX < closerDeltaX)
            {
                closerMenuContainer = menuContainer;
                closerDeltaX = deltaX;
            }
        }
    }

    return closerMenuContainer;
}
}), new objj_method(sel_getUid("showMenu:fromMenu:atPoint:"), function(self, _cmd, newMenu, baseMenu, aGlobalLocation)
{ with(self)
{
    var count = _menuContainerStack.length,
        index = count;


    while (index--)
    {
        var menuContainer = _menuContainerStack[index],
            menu = objj_msgSend(menuContainer, "menu");


        if (menu === baseMenu)
            break;


        if (menu === newMenu)
            return objj_msgSend(newMenu, "_highlightItemAtIndex:", CPNotFound);

        objj_msgSend(menuContainer, "orderOut:", self);
        objj_msgSend(menuContainer, "setMenu:", nil);

        objj_msgSend(_CPMenuWindow, "poolMenuWindow:", menuContainer);
        objj_msgSend(_menuContainerStack, "removeObjectAtIndex:", index);
    }

    if (!newMenu)
        return;


    objj_msgSend(newMenu, "_highlightItemAtIndex:", CPNotFound);

    var menuWindow = objj_msgSend(_CPMenuWindow, "menuWindowWithMenu:font:", newMenu, objj_msgSend(_menuContainerStack[0], "font"));

    objj_msgSend(_menuContainerStack, "addObject:", menuWindow);

    objj_msgSend(menuWindow, "setConstraintRect:", _constraintRect);


    if (baseMenu === objj_msgSend(self, "trackingMenu") && objj_msgSend(objj_msgSend(self, "trackingMenuContainer"), "isMenuBar"))
        objj_msgSend(menuWindow, "setBackgroundStyle:", _CPMenuWindowMenuBarBackgroundStyle);
    else
        objj_msgSend(menuWindow, "setBackgroundStyle:", _CPMenuWindowPopUpBackgroundStyle);

    objj_msgSend(menuWindow, "setFrameOrigin:", aGlobalLocation);
    objj_msgSend(menuWindow, "orderFront:", self);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("sharedMenuManager"), function(self, _cmd)
{ with(self)
{
    if (!SharedMenuManager)
        SharedMenuManager = objj_msgSend(objj_msgSend(_CPMenuManager, "alloc"), "init");

    return SharedMenuManager;
}
})]);
}

p;15;_CPMenuWindow.jt;22390;@STATIC;1.0;t;22370;





var _CPMenuWindowPool = [],
    _CPMenuWindowPoolCapacity = 5,

    _CPMenuWindowBackgroundColors = [];

_CPMenuWindowMenuBarBackgroundStyle = 0;
_CPMenuWindowPopUpBackgroundStyle = 1;
_CPMenuWindowAttachedMenuBackgroundStyle = 2;

var STICKY_TIME_INTERVAL = 500,

    TOP_MARGIN = 5.0,
    LEFT_MARGIN = 1.0,
    RIGHT_MARGIN = 1.0,
    BOTTOM_MARGIN = 5.0,

    SCROLL_INDICATOR_HEIGHT = 16.0;




{var the_class = objj_allocateClassPair(CPWindow, "_CPMenuWindow"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menuView"), new objj_ivar("_menuClipView"), new objj_ivar("_moreAboveView"), new objj_ivar("_moreBelowView"), new objj_ivar("_unconstrainedFrame"), new objj_ivar("_constraintRect")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithContentRect:styleMask:"), function(self, _cmd, aRect, aStyleMask)
{ with(self)
{
    _constraintRect = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    _unconstrainedFrame = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };

    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuWindow").super_class }, "initWithContentRect:styleMask:", aRect, CPBorderlessWindowMask);

    if (self)
    {
        objj_msgSend(self, "setLevel:", CPPopUpMenuWindowLevel);
        objj_msgSend(self, "setHasShadow:", YES);
        objj_msgSend(self, "setShadowStyle:", CPMenuWindowShadowStyle);
        objj_msgSend(self, "setAcceptsMouseMovedEvents:", YES);

        var contentView = objj_msgSend(self, "contentView");

        _menuView = objj_msgSend(objj_msgSend(_CPMenuView, "alloc"), "initWithFrame:", CGRectMakeZero());

        _menuClipView = objj_msgSend(objj_msgSend(CPClipView, "alloc"), "initWithFrame:", CGRectMake(LEFT_MARGIN, TOP_MARGIN, 0.0, 0.0));
        objj_msgSend(_menuClipView, "setDocumentView:", _menuView);

        objj_msgSend(contentView, "addSubview:", _menuClipView);

        _moreAboveView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CGRectMakeZero());

        objj_msgSend(_moreAboveView, "setImage:", _CPMenuWindowMoreAboveImage);
        objj_msgSend(_moreAboveView, "setFrameSize:", objj_msgSend(_CPMenuWindowMoreAboveImage, "size"));

        objj_msgSend(contentView, "addSubview:", _moreAboveView);

        _moreBelowView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CGRectMakeZero());

        objj_msgSend(_moreBelowView, "setImage:", _CPMenuWindowMoreBelowImage);
        objj_msgSend(_moreBelowView, "setFrameSize:", objj_msgSend(_CPMenuWindowMoreBelowImage, "size"));

        objj_msgSend(contentView, "addSubview:", _moreBelowView);

        objj_msgSend(self, "setShadowStyle:", CPWindowShadowStyleMenu);
    }

    return self;
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    objj_msgSend(_menuView, "setFont:", aFont);
}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_menuView, "font");
}
}), new objj_method(sel_getUid("setBackgroundStyle:"), function(self, _cmd, aBackgroundStyle)
{ with(self)
{
    objj_msgSend(self, "setBackgroundColor:", objj_msgSend(objj_msgSend(self, "class"), "backgroundColorForBackgroundStyle:", aBackgroundStyle));
}
}), new objj_method(sel_getUid("setMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    objj_msgSend(aMenu, "_setMenuWindow:", self);
    objj_msgSend(_menuView, "setMenu:", aMenu);

    var menuViewSize = objj_msgSend(_menuView, "frame").size;

    objj_msgSend(self, "setFrameSize:", CGSizeMake(LEFT_MARGIN + menuViewSize.width + RIGHT_MARGIN, TOP_MARGIN + menuViewSize.height + BOTTOM_MARGIN));

    objj_msgSend(_menuView, "scrollPoint:", CGPointMake(0.0, 0.0));
    objj_msgSend(_menuClipView, "setFrame:", CGRectMake(LEFT_MARGIN, TOP_MARGIN, menuViewSize.width, menuViewSize.height));
}
}), new objj_method(sel_getUid("setMinWidth:"), function(self, _cmd, aWidth)
{ with(self)
{
    var size = objj_msgSend(self, "unconstrainedFrame").size;

    objj_msgSend(self, "setFrameSize:", CGSizeMake(MAX(size.width, aWidth), size.height));
}
}), new objj_method(sel_getUid("menu"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_menuView, "menu");
}
}), new objj_method(sel_getUid("orderFront:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "setFrame:", _unconstrainedFrame);

    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuWindow").super_class }, "orderFront:", aSender);
}
}), new objj_method(sel_getUid("setConstraintRect:"), function(self, _cmd, aRect)
{ with(self)
{
    _constraintRect = aRect;

    objj_msgSend(self, "setFrame:", _unconstrainedFrame);
}
}), new objj_method(sel_getUid("unconstrainedFrame"), function(self, _cmd)
{ with(self)
{
    return { origin: { x:_unconstrainedFrame.origin.x, y:_unconstrainedFrame.origin.y }, size: { width:_unconstrainedFrame.size.width, height:_unconstrainedFrame.size.height } };
}
}), new objj_method(sel_getUid("setFrameOrigin:"), function(self, _cmd, aPoint)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuWindow").super_class }, "setFrame:", { origin: { x:aPoint.x, y:aPoint.y }, size: { width:(_unconstrainedFrame.size.width), height:(_unconstrainedFrame.size.height) } });
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuWindow").super_class }, "setFrame:", { origin: { x:(_unconstrainedFrame.origin.x), y:(_unconstrainedFrame.origin.y) }, size: { width:aSize.width, height:aSize.height } });
}
}), new objj_method(sel_getUid("setFrame:display:animate:"), function(self, _cmd, aFrame, shouldDisplay, shouldAnimate)
{ with(self)
{


    _unconstrainedFrame = { origin: { x:aFrame.origin.x, y:aFrame.origin.y }, size: { width:aFrame.size.width, height:aFrame.size.height } };

    var constrainedFrame = CGRectIntersection(_unconstrainedFrame, _constraintRect);



    constrainedFrame.origin.x = CGRectGetMinX(_unconstrainedFrame);
    constrainedFrame.size.width = CGRectGetWidth(_unconstrainedFrame);

    if (CGRectGetWidth(constrainedFrame) > CGRectGetWidth(_constraintRect))
        constrainedFrame.size.width = CGRectGetWidth(_constraintRect);

    if (CGRectGetMaxX(constrainedFrame) > CGRectGetMaxX(_constraintRect))
        constrainedFrame.origin.x -= CGRectGetMaxX(constrainedFrame) - CGRectGetMaxX(_constraintRect);

    if (CGRectGetMinX(constrainedFrame) < CGRectGetMinX(_constraintRect))
        constrainedFrame.origin.x = CGRectGetMinX(_constraintRect);

    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuWindow").super_class }, "setFrame:display:animate:", constrainedFrame, shouldDisplay, shouldAnimate);


    var menuViewOrigin = CGPointMake(CGRectGetMinX(aFrame) + LEFT_MARGIN, CGRectGetMinY(aFrame) + TOP_MARGIN),
        moreAbove = menuViewOrigin.y < CGRectGetMinY(constrainedFrame) + TOP_MARGIN,
        moreBelow = menuViewOrigin.y + CGRectGetHeight(objj_msgSend(_menuView, "frame")) > CGRectGetMaxY(constrainedFrame) - BOTTOM_MARGIN,

        topMargin = TOP_MARGIN,
        bottomMargin = BOTTOM_MARGIN,

        contentView = objj_msgSend(self, "contentView"),
        bounds = objj_msgSend(contentView, "bounds");

    if (moreAbove)
    {
        topMargin += SCROLL_INDICATOR_HEIGHT;

        var frame = objj_msgSend(_moreAboveView, "frame");

        objj_msgSend(_moreAboveView, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - CGRectGetWidth(frame)) / 2.0, (TOP_MARGIN + SCROLL_INDICATOR_HEIGHT - CGRectGetHeight(frame)) / 2.0));
    }

    objj_msgSend(_moreAboveView, "setHidden:", !moreAbove);

    if (moreBelow)
    {
        bottomMargin += SCROLL_INDICATOR_HEIGHT;

        objj_msgSend(_moreBelowView, "setFrameOrigin:", CGPointMake((CGRectGetWidth(bounds) - CGRectGetWidth(objj_msgSend(_moreBelowView, "frame"))) / 2.0, CGRectGetHeight(bounds) - SCROLL_INDICATOR_HEIGHT - BOTTOM_MARGIN));
    }

    objj_msgSend(_moreBelowView, "setHidden:", !moreBelow);

    var clipFrame = CGRectMake(LEFT_MARGIN, topMargin, CGRectGetWidth(constrainedFrame) - LEFT_MARGIN - RIGHT_MARGIN, CGRectGetHeight(constrainedFrame) - topMargin - bottomMargin)

    objj_msgSend(_menuClipView, "setFrame:", clipFrame);
    objj_msgSend(_menuView, "setFrameSize:", CGSizeMake(CGRectGetWidth(clipFrame), CGRectGetHeight(objj_msgSend(_menuView, "frame"))));

    objj_msgSend(_menuView, "scrollPoint:", CGPointMake(0.0, objj_msgSend(self, "convertBaseToGlobal:", clipFrame.origin).y - menuViewOrigin.y));
}
}), new objj_method(sel_getUid("hasMinimumNumberOfVisibleItems"), function(self, _cmd)
{ with(self)
{
    var visibleRect = objj_msgSend(_menuView, "visibleRect");


    if (CGRectIsEmpty(visibleRect))
        return NO;

    var numberOfUnhiddenItems = objj_msgSend(_menuView, "numberOfUnhiddenItems"),
        minimumNumberOfVisibleItems = MIN(numberOfUnhiddenItems, 3),
        count = 0,
        index = objj_msgSend(_menuView, "itemIndexAtPoint:", objj_msgSend(_menuView, "convertPoint:fromView:", objj_msgSend(_menuClipView, "frame").origin, nil));

    for (; index < numberOfUnhiddenItems && count < minimumNumberOfVisibleItems; ++index)
    {
        var itemRect = objj_msgSend(_menuView, "rectForUnhiddenItemAtIndex:", index),
            visibleItemRect = CGRectIntersection(visibleRect, itemRect);


        if (CGRectIsEmpty(visibleItemRect))
            break;


        if (CGRectEqualToRect(visibleItemRect, itemRect))
            ++count;
    }

    return count >= minimumNumberOfVisibleItems;
}
}), new objj_method(sel_getUid("canScrollUp"), function(self, _cmd)
{ with(self)
{
    return !objj_msgSend(_moreAboveView, "isHidden");
}
}), new objj_method(sel_getUid("canScrollDown"), function(self, _cmd)
{ with(self)
{
    return !objj_msgSend(_moreBelowView, "isHidden");
}
}), new objj_method(sel_getUid("canScroll"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "canScrollUp") || objj_msgSend(self, "canScrollDown");
}
}), new objj_method(sel_getUid("scrollUp"), function(self, _cmd)
{ with(self)
{
    if (CGRectGetMinY(_unconstrainedFrame) >= CGRectGetMinY(_constraintRect))
        return;

    _unconstrainedFrame.origin.y += 10;

    objj_msgSend(self, "setFrame:", _unconstrainedFrame);
}
}), new objj_method(sel_getUid("scrollDown"), function(self, _cmd)
{ with(self)
{
    if (CGRectGetMaxY(_unconstrainedFrame) <= CGRectGetHeight(_constraintRect))
        return;

    _unconstrainedFrame.origin.y -= 10;

    objj_msgSend(self, "setFrame:", _unconstrainedFrame);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("menuWindowWithMenu:font:"), function(self, _cmd, aMenu, aFont)
{ with(self)
{
    var menuWindow = nil;

    if (_CPMenuWindowPool.length)
    {
        menuWindow = _CPMenuWindowPool.pop();


        objj_msgSend(menuWindow, "setFrameOrigin:", CGPointMakeZero());
    }
    else
        menuWindow = objj_msgSend(objj_msgSend(_CPMenuWindow, "alloc"), "init");

    objj_msgSend(menuWindow, "setFont:", aFont);
    objj_msgSend(menuWindow, "setMenu:", aMenu);
    objj_msgSend(menuWindow, "setMinWidth:", objj_msgSend(aMenu, "minimumWidth"));

    return menuWindow;
}
}), new objj_method(sel_getUid("poolMenuWindow:"), function(self, _cmd, aMenuWindow)
{ with(self)
{
    if (!aMenuWindow || _CPMenuWindowPool.length >= _CPMenuWindowPoolCapacity)
        return;

    _CPMenuWindowPool.push(aMenuWindow);
}
}), new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPMenuWindow, "class"))
        return;

    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);

    _CPMenuWindowMoreAboveImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowMoreAbove.png"), CGSizeMake(38.0, 18.0));
    _CPMenuWindowMoreBelowImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowMoreBelow.png"), CGSizeMake(38.0, 18.0));
}
}), new objj_method(sel_getUid("_standardLeftMargin"), function(self, _cmd)
{ with(self)
{
    return LEFT_MARGIN;
}
}), new objj_method(sel_getUid("backgroundColorForBackgroundStyle:"), function(self, _cmd, aBackgroundStyle)
{ with(self)
{
    var color = _CPMenuWindowBackgroundColors[aBackgroundStyle];

    if (!color)
    {
        var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(self, "class"));

        if (aBackgroundStyle == _CPMenuWindowPopUpBackgroundStyle)
            color = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
                [
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowRounded0.png"), CGSizeMake(4.0, 4.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow1.png"), CGSizeMake(1.0, 4.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowRounded2.png"), CGSizeMake(4.0, 4.0)),

                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow3.png"), CGSizeMake(4.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow4.png"), CGSizeMake(1.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow5.png"), CGSizeMake(4.0, 1.0)),

                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowRounded6.png"), CGSizeMake(4.0, 4.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow7.png"), CGSizeMake(1.0, 4.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowRounded8.png"), CGSizeMake(4.0, 4.0))
                ]));

        else if (aBackgroundStyle == _CPMenuWindowMenuBarBackgroundStyle)
            color = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
                [
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow3.png"), CGSizeMake(4.0, 0.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow4.png"), CGSizeMake(1.0, 0.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow5.png"), CGSizeMake(4.0, 0.0)),

                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow3.png"), CGSizeMake(4.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow4.png"), CGSizeMake(1.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow5.png"), CGSizeMake(4.0, 1.0)),

                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowRounded6.png"), CGSizeMake(4.0, 4.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindow7.png"), CGSizeMake(1.0, 4.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuWindow/_CPMenuWindowRounded8.png"), CGSizeMake(4.0, 4.0))
                ]));

        _CPMenuWindowBackgroundColors[aBackgroundStyle] = color;
    }

    return color;
}
})]);
}

{
var the_class = objj_getClass("_CPMenuWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"_CPMenuWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("globalFrame"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "frame");
}
}), new objj_method(sel_getUid("isMenuBar"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("scrollingStateForPoint:"), function(self, _cmd, aGlobalLocation)
{ with(self)
{
    var frame = objj_msgSend(self, "frame");

    if (!objj_msgSend(self, "canScroll"))
        return _CPMenuManagerScrollingStateNone;


    if (aGlobalLocation.y < CGRectGetMinY(frame) + TOP_MARGIN + SCROLL_INDICATOR_HEIGHT)
        return _CPMenuManagerScrollingStateUp;


    if (aGlobalLocation.y > CGRectGetMaxY(frame) - BOTTOM_MARGIN - SCROLL_INDICATOR_HEIGHT)
        return _CPMenuManagerScrollingStateDown;

    return _CPMenuManagerScrollingStateNone;
}
}), new objj_method(sel_getUid("deltaYForItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return TOP_MARGIN + CGRectGetMinY(objj_msgSend(_menuView, "rectForItemAtIndex:", anIndex));
}
}), new objj_method(sel_getUid("rectForItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(_menuView, "convertRect:toView:", objj_msgSend(_menuView, "rectForItemAtIndex:", anIndex), nil);
}
}), new objj_method(sel_getUid("itemIndexAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{

    if (!CGRectContainsPoint(objj_msgSend(_menuClipView, "bounds"), objj_msgSend(_menuClipView, "convertPoint:fromView:", aPoint, nil)))
        return NO;

    return objj_msgSend(_menuView, "itemIndexAtPoint:", objj_msgSend(_menuView, "convertPoint:fromView:", aPoint, nil));
}
})]);
}





{var the_class = objj_allocateClassPair(CPView, "_CPMenuView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menuItemViews"), new objj_ivar("_visibleMenuItemInfos"), new objj_ivar("_font")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
return _font;
}
}),
new objj_method(sel_getUid("setFont:"), function(self, _cmd, newValue)
{ with(self)
{
_font = newValue;
}
}), new objj_method(sel_getUid("numberOfUnhiddenItems"), function(self, _cmd)
{ with(self)
{
    return _visibleMenuItemInfos.length;
}
}), new objj_method(sel_getUid("rectForUnhiddenItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(self, "rectForItemAtIndex:", _visibleMenuItemInfos[anIndex].index);
}
}), new objj_method(sel_getUid("rectForItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(_menuItemViews[anIndex === CPNotFound ? 0 : anIndex], "frame");
}
}), new objj_method(sel_getUid("itemIndexAtPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    var x = aPoint.x,
        bounds = objj_msgSend(self, "bounds");

    if (x < CGRectGetMinX(bounds) || x > CGRectGetMaxX(bounds))
        return CPNotFound;

    var y = aPoint.y,
        low = 0,
        high = _visibleMenuItemInfos.length - 1;

    while (low <= high)
    {
        var middle = FLOOR(low + (high - low) / 2),
            info = _visibleMenuItemInfos[middle]
            frame = objj_msgSend(info.view, "frame");

        if (y < CGRectGetMinY(frame))
            high = middle - 1;

        else if (y > CGRectGetMaxY(frame))
            low = middle + 1;

        else
            return info.index;
   }

   return CPNotFound;
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_menuItemViews, "makeObjectsPerformSelector:", sel_getUid("removeFromSuperview"));

    _menuItemViews = [];
    _visibleMenuItemInfos = [];

    var menu = objj_msgSend(self, "menu");

    if (!menu)
        return;

    var items = objj_msgSend(menu, "itemArray"),
        index = 0,
        count = objj_msgSend(items, "count"),
        maxWidth = 0,
        y = 0,
        showsStateColumn = objj_msgSend(menu, "showsStateColumn");

    for (; index < count; ++index)
    {
        var item = items[index],
            view = objj_msgSend(item, "_menuItemView");

        _menuItemViews.push(view);

        if (objj_msgSend(item, "isHidden"))
            continue;

        _visibleMenuItemInfos.push({ view:view, index:index });

        objj_msgSend(view, "setFont:", _font);
        objj_msgSend(view, "setShowsStateColumn:", showsStateColumn);
        objj_msgSend(view, "synchronizeWithMenuItem");

        objj_msgSend(view, "setFrameOrigin:", CGPointMake(0.0, y));

        objj_msgSend(self, "addSubview:", view);

        var size = objj_msgSend(view, "minSize"),
            width = size.width;

        if (maxWidth < width)
            maxWidth = width;

        y += size.height;
    }

    for (index = 0; index < count; ++index)
    {
        var view = _menuItemViews[index];

        objj_msgSend(view, "setFrameSize:", CGSizeMake(maxWidth, CGRectGetHeight(objj_msgSend(view, "frame"))));
    }

    objj_msgSend(self, "setAutoresizesSubviews:", NO);
    objj_msgSend(self, "setFrameSize:", CGSizeMake(maxWidth, y));
    objj_msgSend(self, "setAutoresizesSubviews:", YES);
}
}), new objj_method(sel_getUid("setMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuView").super_class }, "setMenu:", aMenu);
    objj_msgSend(self, "tile");
}
})]);
}

p;8;CPMenu.jt;31003;@STATIC;1.0;I;20;Foundation/CPArray.jI;25;Foundation/CPDictionary.jI;33;Foundation/CPNotificationCenter.jI;21;Foundation/CPString.ji;16;_CPMenuManager.ji;15;CPApplication.ji;12;CPClipView.ji;12;CPMenuItem.ji;9;CPPanel.ji;18;_CPMenuBarWindow.ji;15;_CPMenuWindow.jt;30733;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPDictionary.j", false);
objj_executeFile("Foundation/CPNotificationCenter.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("_CPMenuManager.j", true);
objj_executeFile("CPApplication.j", true);
objj_executeFile("CPClipView.j", true);
objj_executeFile("CPMenuItem.j", true);
objj_executeFile("CPPanel.j", true);
CPMenuDidAddItemNotification = "CPMenuDidAddItemNotification";
CPMenuDidChangeItemNotification = "CPMenuDidChangeItemNotification";
CPMenuDidRemoveItemNotification = "CPMenuDidRemoveItemNotification";
CPMenuDidEndTrackingNotification = "CPMenuDidEndTrackingNotification";
var MENUBAR_HEIGHT = 28.0;
var _CPMenuBarVisible = NO,
    _CPMenuBarTitle = "",
    _CPMenuBarIconImage = nil,
    _CPMenuBarIconImageAlphaValue = 1.0,
    _CPMenuBarAttributes = nil,
    _CPMenuBarSharedWindow = nil;
{var the_class = objj_allocateClassPair(CPObject, "CPMenu"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_supermenu"), new objj_ivar("_title"), new objj_ivar("_name"), new objj_ivar("_font"), new objj_ivar("_minimumWidth"), new objj_ivar("_items"), new objj_ivar("_autoenablesItems"), new objj_ivar("_showsStateColumn"), new objj_ivar("_delegate"), new objj_ivar("_highlightedIndex"), new objj_ivar("_menuWindow")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("menuBarHeight"), function(self, _cmd)
{ with(self)
{
    if (self === objj_msgSend(CPApp, "mainMenu"))
        return MENUBAR_HEIGHT;
    return 0.0;
}
}), new objj_method(sel_getUid("initWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPMenu").super_class }, "init");
    if (self)
    {
        _title = aTitle;
        _items = [];
        _autoenablesItems = YES;
        _showsStateColumn = YES;
        objj_msgSend(self, "setMinimumWidth:", 0);
    }
    return self;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithTitle:", "");
}
}), new objj_method(sel_getUid("insertItem:atIndex:"), function(self, _cmd, aMenuItem, anIndex)
{ with(self)
{
    var menu = objj_msgSend(aMenuItem, "menu");
    if (menu)
        if (menu !== self)
            objj_msgSend(CPException, "raise:reason:", CPInternalInconsistencyException, "Attempted to insert item into menu that was already in another menu.");
        else
            return;
    objj_msgSend(aMenuItem, "setMenu:", self);
    objj_msgSend(_items, "insertObject:atIndex:", aMenuItem, anIndex);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPMenuDidAddItemNotification, self, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", anIndex, "CPMenuItemIndex"));
}
}), new objj_method(sel_getUid("insertItemWithTitle:action:keyEquivalent:atIndex:"), function(self, _cmd, aTitle, anAction, aKeyEquivalent, anIndex)
{ with(self)
{
    var item = objj_msgSend(objj_msgSend(CPMenuItem, "alloc"), "initWithTitle:action:keyEquivalent:", aTitle, anAction, aKeyEquivalent);
    objj_msgSend(self, "insertItem:atIndex:", item, anIndex);
    return item;
}
}), new objj_method(sel_getUid("addItem:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    objj_msgSend(self, "insertItem:atIndex:", aMenuItem, objj_msgSend(_items, "count"));
}
}), new objj_method(sel_getUid("addItemWithTitle:action:keyEquivalent:"), function(self, _cmd, aTitle, anAction, aKeyEquivalent)
{ with(self)
{
    return objj_msgSend(self, "insertItemWithTitle:action:keyEquivalent:atIndex:", aTitle, anAction, aKeyEquivalent, objj_msgSend(_items, "count"));
}
}), new objj_method(sel_getUid("removeItem:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    objj_msgSend(self, "removeItemAtIndex:", objj_msgSend(_items, "indexOfObjectIdenticalTo:", aMenuItem));
}
}), new objj_method(sel_getUid("removeItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    if (anIndex < 0 || anIndex >= _items.length)
        return;
    objj_msgSend(_items[anIndex], "setMenu:", nil);
    objj_msgSend(_items, "removeObjectAtIndex:", anIndex);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPMenuDidRemoveItemNotification, self, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", anIndex, "CPMenuItemIndex"));
}
}), new objj_method(sel_getUid("itemChanged:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    if (objj_msgSend(aMenuItem, "menu") != self)
        return;
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:userInfo:", CPMenuDidChangeItemNotification, self, objj_msgSend(CPDictionary, "dictionaryWithObject:forKey:", objj_msgSend(_items, "indexOfObjectIdenticalTo:", aMenuItem), "CPMenuItemIndex"));
}
}), new objj_method(sel_getUid("itemWithTag:"), function(self, _cmd, aTag)
{ with(self)
{
    var index = objj_msgSend(self, "indexOfItemWithTag:", aTag);
    if (index == CPNotFound)
        return nil;
    return _items[index];
}
}), new objj_method(sel_getUid("itemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    var index = objj_msgSend(self, "indexOfItemWithTitle:", aTitle);
    if (index == CPNotFound)
        return nil;
    return _items[index];
}
}), new objj_method(sel_getUid("itemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    return objj_msgSend(_items, "objectAtIndex:", anIndex);
}
}), new objj_method(sel_getUid("numberOfItems"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_items, "count");
}
}), new objj_method(sel_getUid("itemArray"), function(self, _cmd)
{ with(self)
{
    return _items;
}
}), new objj_method(sel_getUid("indexOfItem:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    if (objj_msgSend(aMenuItem, "menu") !== self)
        return CPNotFound;
    return objj_msgSend(_items, "indexOfObjectIdenticalTo:", aMenuItem);
}
}), new objj_method(sel_getUid("indexOfItemWithTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    var index = 0,
        count = _items.length;
    for (; index < count; ++index)
        if (objj_msgSend(_items[index], "title") === aTitle)
            return index;
    return CPNotFound;
}
}), new objj_method(sel_getUid("indexOfItemWithTag:"), function(self, _cmd, aTag)
{ with(self)
{
    var index = 0,
        count = _items.length;
    for (; index < count; ++index)
        if (objj_msgSend(_items[index], "tag") == aTag)
            return index;
    return CPNotFound;
}
}), new objj_method(sel_getUid("indexOfItemWithTarget:andAction:"), function(self, _cmd, aTarget, anAction)
{ with(self)
{
    var index = 0,
        count = _items.length;
    for (; index < count; ++index)
    {
        var item = _items[index];
        if (objj_msgSend(item, "target") == aTarget && (!anAction || objj_msgSend(item, "action") == anAction))
            return index;
    }
    return CPNotFound;
}
}), new objj_method(sel_getUid("indexOfItemWithRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    var index = 0,
        count = _items.length;
    for (; index < count; ++index)
        if (objj_msgSend(objj_msgSend(_items[index], "representedObject"), "isEqual:", anObject))
            return index;
    return CPNotFound;
}
}), new objj_method(sel_getUid("indexOfItemWithSubmenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    var index = 0,
        count = _items.length;
    for (; index < count; ++index)
        if (objj_msgSend(_items[index], "submenu") == aMenu)
            return index;
    return CPNotFound;
}
}), new objj_method(sel_getUid("setSubmenu:forItem:"), function(self, _cmd, aMenu, aMenuItem)
{ with(self)
{
    objj_msgSend(aMenuItem, "setTarget:", aMenuItem);
    objj_msgSend(aMenuItem, "setAction:", sel_getUid("submenuAction:"));
    objj_msgSend(aMenuItem, "setSubmenu:", aMenu);
}
}), new objj_method(sel_getUid("submenuAction:"), function(self, _cmd, aSender)
{ with(self)
{
}
}), new objj_method(sel_getUid("supermenu"), function(self, _cmd)
{ with(self)
{
    return _supermenu;
}
}), new objj_method(sel_getUid("setSupermenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    _supermenu = aMenu;
}
}), new objj_method(sel_getUid("isTornOff"), function(self, _cmd)
{ with(self)
{
    return !_supermenu || self == objj_msgSend(CPApp, "mainMenu");
}
}), new objj_method(sel_getUid("setAutoenablesItems:"), function(self, _cmd, aFlag)
{ with(self)
{
    _autoenablesItems = aFlag;
}
}), new objj_method(sel_getUid("autoenablesItems"), function(self, _cmd)
{ with(self)
{
    return _autoenablesItems;
}
}), new objj_method(sel_getUid("update"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    _title = aTitle;
}
}), new objj_method(sel_getUid("title"), function(self, _cmd)
{ with(self)
{
    return _title;
}
}), new objj_method(sel_getUid("setMinimumWidth:"), function(self, _cmd, aMinimumWidth)
{ with(self)
{
    _minimumWidth = aMinimumWidth;
}
}), new objj_method(sel_getUid("minimumWidth"), function(self, _cmd)
{ with(self)
{
    return _minimumWidth;
}
}), new objj_method(sel_getUid("_performActionOfHighlightedItemChain"), function(self, _cmd)
{ with(self)
{
    var highlightedItem = objj_msgSend(self, "highlightedItem");
    while (objj_msgSend(highlightedItem, "submenu") && objj_msgSend(highlightedItem, "action") === sel_getUid("submenuAction:"))
        highlightedItem = objj_msgSend(objj_msgSend(highlightedItem, "submenu"), "highlightedItem");
    if (highlightedItem && objj_msgSend(highlightedItem, "isEnabled"))
        objj_msgSend(CPApp, "sendAction:to:from:", objj_msgSend(highlightedItem, "action"), objj_msgSend(highlightedItem, "target"), highlightedItem);
}
}), new objj_method(sel_getUid("popUpMenuPositioningItem:atLocation:inView:callback:"), function(self, _cmd, anItem, aLocation, aView, aCallback)
{ with(self)
{
    objj_msgSend(self, "_popUpMenuPositioningItem:atLocation:topY:bottomY:inView:callback:", anItem, aLocation, aLocation.y, aLocation.y, aView, aCallback);
}
}), new objj_method(sel_getUid("_popUpMenuPositioningItem:atLocation:topY:bottomY:inView:callback:"), function(self, _cmd, anItem, aLocation, aTopY, aBottomY, aView, aCallback)
{ with(self)
{
    var itemIndex = 0;
    if (anItem)
    {
        itemIndex = objj_msgSend(self, "indexOfItem:", anItem);
        if (itemIndex === CPNotFound)
            throw "In call to popUpMenuPositioningItem:atLocation:inView:callback:, menu item " +
                    anItem + " is not present in menu " + self;
    }
    var theWindow = objj_msgSend(aView, "window");
    if (aView && !theWindow)
        throw "In call to popUpMenuPositioningItem:atLocation:inView:callback:, view is not in any window.";
    var delegate = objj_msgSend(self, "delegate");
    if (objj_msgSend(delegate, "respondsToSelector:", sel_getUid("menuWillOpen:")))
        objj_msgSend(delegate, "menuWillOpen:", aMenu);
    if (aView)
        aLocation = objj_msgSend(theWindow, "convertBaseToGlobal:", objj_msgSend(aView, "convertPoint:toView:", aLocation, nil));
    var menuWindow = objj_msgSend(_CPMenuWindow, "menuWindowWithMenu:font:", self, objj_msgSend(self, "font"));
    objj_msgSend(menuWindow, "setBackgroundStyle:", _CPMenuWindowPopUpBackgroundStyle);
    if (anItem)
        aLocation.y -= objj_msgSend(menuWindow, "deltaYForItemAtIndex:", itemIndex);
    var constraintRect = objj_msgSend(CPMenu, "_constraintRectForView:", aView);
    objj_msgSend(menuWindow, "setFrameOrigin:", aLocation);
    objj_msgSend(menuWindow, "setConstraintRect:", constraintRect);
    if (!objj_msgSend(menuWindow, "hasMinimumNumberOfVisibleItems"))
    {
        var unconstrainedFrame = objj_msgSend(menuWindow, "unconstrainedFrame"),
            unconstrainedY = CGRectGetMinY(unconstrainedFrame);
        if (unconstrainedY >= CGRectGetMaxY(constraintRect) || objj_msgSend(menuWindow, "canScrollDown"))
        {
            if (aView)
                aTopY = objj_msgSend(theWindow, "convertBaseToGlobal:", objj_msgSend(aView, "convertPoint:toView:", CGPointMake(0.0, aTopY), nil)).y;
            unconstrainedFrame.origin.y = MIN(CGRectGetMaxY(constraintRect), aTopY) - CGRectGetHeight(unconstrainedFrame);
        }
        else if (unconstrainedY < CGRectGetMinY(constraintRect) || objj_msgSend(menuWindow, "canScrollUp"))
        {
            if (aView)
                aBottomY = objj_msgSend(theWindow, "convertBaseToGlobal:", objj_msgSend(aView, "convertPoint:toView:", CGPointMake(0.0, aBottomY), nil)).y;
            unconstrainedFrame.origin.y = MAX(CGRectGetMinY(constraintRect), aBottomY);
        }
        objj_msgSend(menuWindow, "setFrameOrigin:", CGRectIntersection(unconstrainedFrame, constraintRect).origin);
    }
    objj_msgSend(menuWindow, "orderFront:", self);
    objj_msgSend(objj_msgSend(_CPMenuManager, "sharedMenuManager"), "beginTracking:menuContainer:constraintRect:callback:", objj_msgSend(CPApp, "currentEvent"), menuWindow, constraintRect, objj_msgSend(CPMenu, "trackingCallbackWithCallback:", aCallback));
}
}), new objj_method(sel_getUid("setShowsStateColumn:"), function(self, _cmd, shouldShowStateColumn)
{ with(self)
{
    _showsStateColumn = shouldShowStateColumn;
}
}), new objj_method(sel_getUid("showsStateColumn"), function(self, _cmd)
{ with(self)
{
    return _showsStateColumn;
}
}), new objj_method(sel_getUid("highlightedItem"), function(self, _cmd)
{ with(self)
{
    return _highlightedIndex >= 0 ? _items[_highlightedIndex] : nil;
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("cancelTracking"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "performSelector:target:argument:order:modes:", sel_getUid("_fireCancelTrackingEvent"), self, nil, 0, [CPDefaultRunLoopMode]);
}
}), new objj_method(sel_getUid("_fireCancelTrackingEvent"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(CPApp, "sendEvent:", objj_msgSend(CPEvent, "otherEventWithType:location:modifierFlags:timestamp:windowNumber:context:subtype:data1:data2:", CPAppKitDefined, { x:0.0, y:0.0 }, 0, 0, 0, 0, 0, 0, 0));
}
}), new objj_method(sel_getUid("_setMenuWindow:"), function(self, _cmd, aMenuWindow)
{ with(self)
{
    _menuWindow = aMenuWindow;
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    _font = aFont;
}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
    return _font;
}
}), new objj_method(sel_getUid("performKeyEquivalent:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (_autoenablesItems)
        objj_msgSend(self, "update");
    var index = 0,
        count = _items.length,
        characters = objj_msgSend(anEvent, "charactersIgnoringModifiers"),
        modifierFlags = objj_msgSend(anEvent, "modifierFlags");
    for(; index < count; ++index)
    {
        var item = _items[index],
            modifierMask = objj_msgSend(item, "keyEquivalentModifierMask");
        if (objj_msgSend(item, "keyEquivalent") === objj_msgSend(objj_msgSend(item, "keyEquivalent"), "uppercaseString"))
            modifierMask |= CPShiftKeyMask;
        if (CPBrowserIsOperatingSystem(CPWindowsOperatingSystem) && (modifierMask & CPCommandKeyMask))
        {
            modifierMask |= CPControlKeyMask;
            modifierMask &= ~CPCommandKeyMask;
        }
        if ((modifierFlags & (CPShiftKeyMask | CPAlternateKeyMask | CPCommandKeyMask | CPControlKeyMask)) == modifierMask &&
            objj_msgSend(characters, "caseInsensitiveCompare:", objj_msgSend(item, "keyEquivalent")) == CPOrderedSame)
        {
            if (objj_msgSend(item, "isEnabled"))
                objj_msgSend(self, "performActionForItemAtIndex:", index);
            else
            {
            }
            return YES;
        }
        if (objj_msgSend(objj_msgSend(item, "submenu"), "performKeyEquivalent:", anEvent))
            return YES;
   }
   return NO;
}
}), new objj_method(sel_getUid("performActionForItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    var item = _items[anIndex];
    objj_msgSend(CPApp, "sendAction:to:from:", objj_msgSend(item, "action"), objj_msgSend(item, "target"), item);
}
}), new objj_method(sel_getUid("_itemIsHighlighted:"), function(self, _cmd, aMenuItem)
{ with(self)
{
    return _items[_highlightedIndex] == aMenuItem;
}
}), new objj_method(sel_getUid("_highlightItemAtIndex:"), function(self, _cmd, anIndex)
{ with(self)
{
    var previousHighlightedIndex = _highlightedIndex;
    _highlightedIndex = anIndex;
    if (previousHighlightedIndex !== CPNotFound)
        objj_msgSend(objj_msgSend(_items[previousHighlightedIndex], "_menuItemView"), "highlight:", NO);
    if (_highlightedIndex !== CPNotFound)
        objj_msgSend(objj_msgSend(_items[_highlightedIndex], "_menuItemView"), "highlight:", YES);
}
}), new objj_method(sel_getUid("_setMenuName:"), function(self, _cmd, aName)
{ with(self)
{
    if (_name === aName)
        return;
    _name = aName;
    if (_name === "CPMainMenu")
        objj_msgSend(CPApp, "setMainMenu:", self);
}
}), new objj_method(sel_getUid("_menuName"), function(self, _cmd)
{ with(self)
{
    return _name;
}
}), new objj_method(sel_getUid("awakeFromCib"), function(self, _cmd)
{ with(self)
{
    if (_name === "_CPMainMenu")
    {
        objj_msgSend(self, "_setMenuName:", "CPMainMenu");
        objj_msgSend(CPMenu, "setMenuBarVisible:", YES);
    }
}
}), new objj_method(sel_getUid("_menuWithName:"), function(self, _cmd, aName)
{ with(self)
{
    if (aName === _name)
        return self;
    for (var i = 0, count = objj_msgSend(_items, "count"); i < count; i++)
    {
        var menu = objj_msgSend(objj_msgSend(_items[i], "submenu"), "_menuWithName:", aName);
        if (menu)
            return menu;
    }
    return nil;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "class"), "setMenuBarAttributes:", objj_msgSend(CPDictionary, "dictionary"));
}
}), new objj_method(sel_getUid("menuBarVisible"), function(self, _cmd)
{ with(self)
{
    return _CPMenuBarVisible;
}
}), new objj_method(sel_getUid("setMenuBarVisible:"), function(self, _cmd, menuBarShouldBeVisible)
{ with(self)
{
    if (_CPMenuBarVisible == menuBarShouldBeVisible)
        return;
    _CPMenuBarVisible = menuBarShouldBeVisible;
    if (objj_msgSend(CPPlatform, "supportsNativeMainMenu"))
        return;
    if (menuBarShouldBeVisible)
    {
        if (!_CPMenuBarSharedWindow)
            _CPMenuBarSharedWindow = objj_msgSend(objj_msgSend(_CPMenuBarWindow, "alloc"), "init");
        objj_msgSend(_CPMenuBarSharedWindow, "setMenu:", objj_msgSend(CPApp, "mainMenu"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTitle:", _CPMenuBarTitle);
        objj_msgSend(_CPMenuBarSharedWindow, "setIconImage:", _CPMenuBarIconImage);
        objj_msgSend(_CPMenuBarSharedWindow, "setIconImageAlphaValue:", _CPMenuBarIconImageAlphaValue);
        objj_msgSend(_CPMenuBarSharedWindow, "setColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarBackgroundColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTextColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTextColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTitleColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTitleColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTextShadowColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTextShadowColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTitleShadowColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTitleShadowColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setHighlightColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarHighlightColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setHighlightTextColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarHighlightTextColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setHighlightTextShadowColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarHighlightTextShadowColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "orderFront:", self);
    }
    else
        objj_msgSend(_CPMenuBarSharedWindow, "orderOut:", self);
    objj_msgSend(objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"), "resizeEvent:", nil);
}
}), new objj_method(sel_getUid("setMenuBarTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    _CPMenuBarTitle = aTitle;
    objj_msgSend(_CPMenuBarSharedWindow, "setTitle:", _CPMenuBarTitle);
}
}), new objj_method(sel_getUid("menuBarTitle"), function(self, _cmd)
{ with(self)
{
    return _CPMenuBarTitle;
}
}), new objj_method(sel_getUid("setMenuBarIconImage:"), function(self, _cmd, anImage)
{ with(self)
{
    _CPMenuBarImage = anImage;
    objj_msgSend(_CPMenuBarSharedWindow, "setIconImage:", anImage);
}
}), new objj_method(sel_getUid("menuBarIconImage"), function(self, _cmd)
{ with(self)
{
    return _CPMenuBarImage;
}
}), new objj_method(sel_getUid("setMenuBarAttributes:"), function(self, _cmd, attributes)
{ with(self)
{
    if (_CPMenuBarAttributes == attributes)
        return;
    _CPMenuBarAttributes = objj_msgSend(attributes, "copy");
    var textColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarTextColor"),
        titleColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarTitleColor"),
        textShadowColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarTextShadowColor"),
        titleShadowColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarTitleShadowColor"),
        highlightColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarHighlightColor"),
        highlightTextColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarHighlightTextColor"),
        highlightTextShadowColor = objj_msgSend(attributes, "objectForKey:", "CPMenuBarHighlightTextShadowColor");
    if (!textColor && titleColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", titleColor, "CPMenuBarTextColor");
    else if (textColor && !titleColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", textColor, "CPMenuBarTitleColor");
    else if (!textColor && !titleColor)
    {
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "colorWithRed:green:blue:alpha:", 0.051, 0.2, 0.275, 1.0), "CPMenuBarTextColor");
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "colorWithRed:green:blue:alpha:", 0.051, 0.2, 0.275, 1.0), "CPMenuBarTitleColor");
    }
    if (!textShadowColor && titleShadowColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", titleShadowColor, "CPMenuBarTextShadowColor");
    else if (textShadowColor && !titleShadowColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", textShadowColor, "CPMenuBarTitleShadowColor");
    else if (!textShadowColor && !titleShadowColor)
    {
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "whiteColor"), "CPMenuBarTextShadowColor");
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "whiteColor"), "CPMenuBarTitleShadowColor");
    }
    if (!highlightColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 94.0/255.0, 130.0/255.0, 186.0/255.0, 1.0), "CPMenuBarHighlightColor");
    if (!highlightTextColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "whiteColor"), "CPMenuBarHighlightTextColor");
    if (!highlightTextShadowColor)
        objj_msgSend(_CPMenuBarAttributes, "setObject:forKey:", objj_msgSend(CPColor, "blackColor"), "CPMenuBarHighlightTextShadowColor");
    if (_CPMenuBarSharedWindow)
    {
        objj_msgSend(_CPMenuBarSharedWindow, "setColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarBackgroundColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTextColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTextColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTitleColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTitleColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTextShadowColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTextShadowColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setTitleShadowColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarTitleShadowColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setHighlightColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarHighlightColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setHighlightTextColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarHighlightTextColor"));
        objj_msgSend(_CPMenuBarSharedWindow, "setHighlightTextShadowColor:", objj_msgSend(_CPMenuBarAttributes, "objectForKey:", "CPMenuBarHighlightTextShadowColor"));
    }
}
}), new objj_method(sel_getUid("menuBarAttributes"), function(self, _cmd)
{ with(self)
{
    return _CPMenuBarAttributes;
}
}), new objj_method(sel_getUid("_setMenuBarIconImageAlphaValue:"), function(self, _cmd, anAlphaValue)
{ with(self)
{
    _CPMenuBarIconImageAlphaValue = anAlphaValue;
    objj_msgSend(_CPMenuBarSharedWindow, "setIconImageAlphaValue:", anAlphaValue);
}
}), new objj_method(sel_getUid("menuBarHeight"), function(self, _cmd)
{ with(self)
{
    return MENUBAR_HEIGHT;
}
}), new objj_method(sel_getUid("_constraintRectForView:"), function(self, _cmd, aView)
{ with(self)
{
    if (objj_msgSend(CPPlatform, "isBrowser"))
        return CGRectInset(objj_msgSend(objj_msgSend(objj_msgSend(aView, "window"), "platformWindow"), "contentBounds"), 5.0, 5.0);
    return CGRectInset(objj_msgSend(objj_msgSend(objj_msgSend(aView, "window"), "screen"), "visibleFrame"), 5.0, 5.0);
}
}), new objj_method(sel_getUid("trackingCallbackWithCallback:"), function(self, _cmd, aCallback)
{ with(self)
{
    return function(aMenuWindow, aMenu)
    {
        objj_msgSend(aMenuWindow, "setMenu:", nil);
        objj_msgSend(aMenuWindow, "orderOut:", self);
        objj_msgSend(_CPMenuWindow, "poolMenuWindow:", aMenuWindow);
        if (aCallback)
            aCallback(aMenu);
        objj_msgSend(aMenu, "_performActionOfHighlightedItemChain");
    }
}
}), new objj_method(sel_getUid("popUpContextMenu:withEvent:forView:"), function(self, _cmd, aMenu, anEvent, aView)
{ with(self)
{
    objj_msgSend(self, "popUpContextMenu:withEvent:forView:withFont:", aMenu, anEvent, aView, nil);
}
}), new objj_method(sel_getUid("popUpContextMenu:withEvent:forView:withFont:"), function(self, _cmd, aMenu, anEvent, aView, aFont)
{ with(self)
{
    var delegate = objj_msgSend(aMenu, "delegate");
    if (objj_msgSend(delegate, "respondsToSelector:", sel_getUid("menuWillOpen:")))
        objj_msgSend(delegate, "menuWillOpen:", aMenu);
    if (!aFont)
        aFont = objj_msgSend(CPFont, "systemFontOfSize:", 12.0);
    var theWindow = objj_msgSend(aView, "window"),
        menuWindow = objj_msgSend(_CPMenuWindow, "menuWindowWithMenu:font:", aMenu, aFont);
    objj_msgSend(menuWindow, "setBackgroundStyle:", _CPMenuWindowPopUpBackgroundStyle);
    var constraintRect = objj_msgSend(CPMenu, "_constraintRectForView:", aView),
        aLocation = objj_msgSend(objj_msgSend(anEvent, "window"), "convertBaseToGlobal:", objj_msgSend(anEvent, "locationInWindow"));
    objj_msgSend(menuWindow, "setConstraintRect:", constraintRect);
    objj_msgSend(menuWindow, "setFrameOrigin:", aLocation);
    if (!objj_msgSend(menuWindow, "hasMinimumNumberOfVisibleItems"))
    {
        var unconstrainedFrame = objj_msgSend(menuWindow, "unconstrainedFrame"),
            unconstrainedY = CGRectGetMinY(unconstrainedFrame);
        if (unconstrainedY >= CGRectGetMaxY(constraintRect) || objj_msgSend(menuWindow, "canScrollDown"))
            unconstrainedFrame.origin.y = MIN(CGRectGetMaxY(constraintRect), aLocation.y) - CGRectGetHeight(unconstrainedFrame);
        else if (unconstrainedY < CGRectGetMinY(constraintRect) || objj_msgSend(menuWindow, "canScrollUp"))
            unconstrainedFrame.origin.y = MAX(CGRectGetMinY(constraintRect), aLocation.y);
        objj_msgSend(menuWindow, "setFrameOrigin:", CGRectIntersection(unconstrainedFrame, constraintRect).origin);
    }
    objj_msgSend(menuWindow, "orderFront:", self);
    objj_msgSend(objj_msgSend(_CPMenuManager, "sharedMenuManager"), "beginTracking:menuContainer:constraintRect:callback:", anEvent, menuWindow, objj_msgSend(CPMenu, "_constraintRectForView:", aView), objj_msgSend(CPMenu, "trackingCallbackWithCallback:", nil));
}
})]);
}
var CPMenuTitleKey = "CPMenuTitleKey",
    CPMenuNameKey = "CPMenuNameKey",
    CPMenuItemsKey = "CPMenuItemsKey",
    CPMenuShowsStateColumnKey = "CPMenuShowsStateColumnKey";
{
var the_class = objj_getClass("CPMenu")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPMenu\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPMenu").super_class }, "init");
    if (self)
    {
        _title = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuTitleKey);
        _items = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuItemsKey);
        objj_msgSend(self, "_setMenuName:", objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuNameKey));
        _showsStateColumn = !objj_msgSend(aCoder, "containsValueForKey:", CPMenuShowsStateColumnKey) || objj_msgSend(aCoder, "decodeBoolForKey:", CPMenuShowsStateColumnKey);
        objj_msgSend(self, "setMinimumWidth:", 0);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    objj_msgSend(aCoder, "encodeObject:forKey:", _title, CPMenuTitleKey);
    if (_name)
        objj_msgSend(aCoder, "encodeObject:forKey:", _name, CPMenuNameKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _items, CPMenuItemsKey);
    if (!_showsStateColumn)
        objj_msgSend(aCoder, "encodeBool:forKey:", _showsStateColumn, CPMenuShowsStateColumnKey);
}
})]);
}
objj_executeFile("_CPMenuBarWindow.j", true);
objj_executeFile("_CPMenuWindow.j", true);

p;24;_CPMenuItemMenuBarView.jt;9656;@STATIC;1.0;t;9637;

var HORIZONTAL_MARGIN = 8.0,
    SUBMENU_INDICATOR_MARGIN = 3.0,
    VERTICAL_MARGIN = 4.0;

var SelectionColor = nil,
    SUBMENU_INDICATOR_COLOR = nil,
    _CPMenuItemSelectionColor = nil,
    _CPMenuItemTextShadowColor = nil,

    _CPMenuItemDefaultStateImages = [],
    _CPMenuItemDefaultStateHighlightedImages = [];

{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemMenuBarView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menuItem"), new objj_ivar("_font"), new objj_ivar("_textColor"), new objj_ivar("_textShadowColor"), new objj_ivar("_isDirty"), new objj_ivar("_imageAndTextView"), new objj_ivar("_submenuIndicatorView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("menuItem"), function(self, _cmd)
{ with(self)
{
return _menuItem;
}
}),
new objj_method(sel_getUid("setMenuItem:"), function(self, _cmd, newValue)
{ with(self)
{
_menuItem = newValue;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuItemMenuBarView").super_class }, "initWithFrame:", aFrame);

    if (self)
    {
        _imageAndTextView = objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", CGRectMake(HORIZONTAL_MARGIN, 0.0, 0.0, 0.0));

        objj_msgSend(_imageAndTextView, "setImagePosition:", CPImageLeft);
        objj_msgSend(_imageAndTextView, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
        objj_msgSend(_imageAndTextView, "setAutoresizingMask:", CPViewMinYMargin | CPViewMaxYMargin);

        objj_msgSend(self, "addSubview:", _imageAndTextView);

        _submenuIndicatorView = objj_msgSend(objj_msgSend(_CPMenuItemMenuBarSubmenuIndicatorView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 9.0, 6.0));

        objj_msgSend(_submenuIndicatorView, "setAutoresizingMask:", CPViewMinYMargin | CPViewMaxYMargin);

        objj_msgSend(self, "addSubview:", _submenuIndicatorView);

        objj_msgSend(self, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
    }

    return self;
}
}), new objj_method(sel_getUid("textColor"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(_menuItem, "isEnabled"))
        return objj_msgSend(CPColor, "lightGrayColor");

    return _textColor || objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 70.0 / 255.0, 69.0 / 255.0, 69.0 / 255.0, 1.0);
}
}), new objj_method(sel_getUid("textShadowColor"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(_menuItem, "isEnabled"))
        return objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.8, 0.8);

    return _textShadowColor || objj_msgSend(CPColor, "colorWithWhite:alpha:", 1.0, 0.8);
}
}), new objj_method(sel_getUid("update"), function(self, _cmd)
{ with(self)
{
    var x = HORIZONTAL_MARGIN,
        height = 0.0;

    objj_msgSend(_imageAndTextView, "setFont:", objj_msgSend(_menuItem, "font") || objj_msgSend(_CPMenuBarWindow, "font"));
    objj_msgSend(_imageAndTextView, "setVerticalAlignment:", CPCenterVerticalTextAlignment);
    objj_msgSend(_imageAndTextView, "setImage:", objj_msgSend(_menuItem, "image"));
    objj_msgSend(_imageAndTextView, "setText:", objj_msgSend(_menuItem, "title"));
    objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "textColor"));
    objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));
    objj_msgSend(_imageAndTextView, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
    objj_msgSend(_imageAndTextView, "sizeToFit");

    var imageAndTextViewFrame = objj_msgSend(_imageAndTextView, "frame");

    imageAndTextViewFrame.origin.x = x;
    x += CGRectGetWidth(imageAndTextViewFrame);
    height = MAX(height, CGRectGetHeight(imageAndTextViewFrame));

    var hasSubmenuIndicator = objj_msgSend(_menuItem, "hasSubmenu") && objj_msgSend(_menuItem, "action");

    if (hasSubmenuIndicator)
    {
        objj_msgSend(_submenuIndicatorView, "setHidden:", NO);
        objj_msgSend(_submenuIndicatorView, "setColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_submenuIndicatorView, "setShadowColor:", objj_msgSend(self, "textShadowColor"));

        var submenuViewFrame = objj_msgSend(_submenuIndicatorView, "frame");

        submenuViewFrame.origin.x = x + SUBMENU_INDICATOR_MARGIN;

        x = CGRectGetMaxX(submenuViewFrame);
        height = MAX(height, CGRectGetHeight(submenuViewFrame));
    }
    else
        objj_msgSend(_submenuIndicatorView, "setHidden:", YES);

    height += 2.0 * VERTICAL_MARGIN;

    imageAndTextViewFrame.origin.y = FLOOR((height - CGRectGetHeight(imageAndTextViewFrame)) / 2.0);
    objj_msgSend(_imageAndTextView, "setFrame:", imageAndTextViewFrame);

    if (hasSubmenuIndicator)
    {
        submenuViewFrame.origin.y = FLOOR((height - CGRectGetHeight(submenuViewFrame)) / 2.0) + 1.0;
        objj_msgSend(_submenuIndicatorView, "setFrame:", submenuViewFrame);
    }

    _minSize = CGSizeMake(x + HORIZONTAL_MARGIN, height);

    objj_msgSend(self, "setAutoresizesSubviews:", NO);
    objj_msgSend(self, "setFrameSize:", _minSize);
    objj_msgSend(self, "setAutoresizesSubviews:", YES);
}
}), new objj_method(sel_getUid("highlight:"), function(self, _cmd, shouldHighlight)
{ with(self)
{

    if (!objj_msgSend(_menuItem, "isEnabled"))
        return;

    if (shouldHighlight)
    {
        objj_msgSend(self, "setBackgroundColor:", SelectionColor);

        objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_imageAndTextView, "setTextShadowColor:", _CPMenuItemTextShadowColor);

        objj_msgSend(_submenuIndicatorView, "setColor:", objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_submenuIndicatorView, "setShadowColor:", objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.1, 0.7));
    }
    else
    {
        objj_msgSend(self, "setBackgroundColor:", nil);

        objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));

        objj_msgSend(_submenuIndicatorView, "setColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_submenuIndicatorView, "setShadowColor:", objj_msgSend(self, "textShadowColor"));
    }
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self !== objj_msgSend(_CPMenuItemMenuBarView, "class"))
        return;

    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);

    SelectionColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "_CPMenuBarWindow/_CPMenuBarWindowBackgroundSelected.png"), CGSizeMake(1.0, 28.0)));

    SUBMENU_INDICATOR_COLOR = objj_msgSend(CPColor, "grayColor");

    _CPMenuItemSelectionColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 95.0 / 255.0, 131.0 / 255.0, 185.0 / 255.0, 1.0);
    _CPMenuItemTextShadowColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 26.0 / 255.0,  73.0 / 255.0, 109.0 / 255.0, 1.0);

    _CPMenuItemDefaultStateImages[CPOffState] = nil;
    _CPMenuItemDefaultStateHighlightedImages[CPOffState] = nil;

    _CPMenuItemDefaultStateImages[CPOnState] = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPMenuItem/CPMenuItemOnState.png"), CGSizeMake(14.0, 14.0));
    _CPMenuItemDefaultStateHighlightedImages[CPOnState] = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPMenuItem/CPMenuItemOnStateHighlighted.png"), CGSizeMake(14.0, 14.0));

    _CPMenuItemDefaultStateImages[CPMixedState] = nil;
    _CPMenuItemDefaultStateHighlightedImages[CPMixedState] = nil;
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "init");
}
})]);
}

{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemMenuBarSubmenuIndicatorView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_color"), new objj_ivar("_shadowColor")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_color === aColor)
        return;

    _color = aColor;

    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("setShadowColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_shadowColor === aColor)
        return;

    _shadowColor = aColor;

    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        bounds = objj_msgSend(self, "bounds");

    bounds.size.height -= 1.0;
    bounds.size.width -= 2.0;
    bounds.origin.x += 1.0;

    CGContextBeginPath(context);

    CGContextMoveToPoint(context, CGRectGetMinX(bounds), CGRectGetMinY(bounds));
    CGContextAddLineToPoint(context, CGRectGetMaxX(bounds), CGRectGetMinY(bounds));
    CGContextAddLineToPoint(context, CGRectGetMidX(bounds), CGRectGetMaxY(bounds));

    CGContextClosePath(context);

    CGContextSetShadowWithColor(context, CGSizeMake(0.0, 1.0), 1.1, _shadowColor);
    CGContextSetFillColor(context, _color);
    CGContextFillPath(context);
}
})]);
}

p;26;_CPMenuItemSeparatorView.jt;1395;@STATIC;1.0;I;15;AppKit/CPView.jt;1356;


objj_executeFile("AppKit/CPView.j", false);


{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemSeparatorView"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuItemSeparatorView").super_class }, "initWithFrame:", aFrame);

    if (self)
        objj_msgSend(self, "setAutoresizingMask:", CPViewWidthSizable);

    return self;
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        bounds = objj_msgSend(self, "bounds");

    CGContextBeginPath(context);

    CGContextMoveToPoint(context, CGRectGetMinX(bounds), FLOOR(CGRectGetMidY(bounds)) - 0.5);
    CGContextAddLineToPoint(context, CGRectGetMaxX(bounds), FLOOR(CGRectGetMidY(bounds)) - 0.5);

    CGContextSetStrokeColor(context, objj_msgSend(CPColor, "lightGrayColor"));
    CGContextStrokePath(context);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 0.0, 10.0));
}
})]);
}

p;25;_CPMenuItemStandardView.jt;12358;@STATIC;1.0;t;12338;

var LEFT_MARGIN = 3.0,
    RIGHT_MARGIN = 14.0 + 3.0,
    STATE_COLUMN_WIDTH = 14.0,
    INDENTATION_WIDTH = 17.0,
    VERTICAL_MARGIN = 4.0,

    RIGHT_COLUMNS_MARGIN = 30.0,
    KEY_EQUIVALENT_MARGIN = 10.0;

var SUBMENU_INDICATOR_COLOR = nil,
    _CPMenuItemSelectionColor = nil,
    _CPMenuItemTextShadowColor = nil,

    _CPMenuItemDefaultStateImages = [],
    _CPMenuItemDefaultStateHighlightedImages = [];

{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemStandardView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menuItem"), new objj_ivar("_font"), new objj_ivar("_textColor"), new objj_ivar("_textShadowColor"), new objj_ivar("_minSize"), new objj_ivar("_isDirty"), new objj_ivar("_stateView"), new objj_ivar("_imageAndTextView"), new objj_ivar("_keyEquivalentView"), new objj_ivar("_submenuIndicatorView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("menuItem"), function(self, _cmd)
{ with(self)
{
return _menuItem;
}
}),
new objj_method(sel_getUid("setMenuItem:"), function(self, _cmd, newValue)
{ with(self)
{
_menuItem = newValue;
}
}),
new objj_method(sel_getUid("minSize"), function(self, _cmd)
{ with(self)
{
return _minSize;
}
}), new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuItemStandardView").super_class }, "initWithFrame:", aFrame);

    if (self)
    {
        _stateView = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 0.0, 0.0));

        objj_msgSend(_stateView, "setImageScaling:", CPScaleNone);

        objj_msgSend(self, "addSubview:", _stateView);

        _imageAndTextView = objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 0.0, 0.0));

        objj_msgSend(_imageAndTextView, "setImagePosition:", CPImageLeft);
        objj_msgSend(_imageAndTextView, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));

        objj_msgSend(self, "addSubview:", _imageAndTextView);

        _keyEquivalentView = objj_msgSend(objj_msgSend(_CPImageAndTextView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 0.0, 0.0));

        objj_msgSend(_keyEquivalentView, "setImagePosition:", CPNoImage);
        objj_msgSend(_keyEquivalentView, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
        objj_msgSend(_keyEquivalentView, "setAutoresizingMask:", CPViewMinXMargin);

        objj_msgSend(self, "addSubview:", _keyEquivalentView);

        _submenuIndicatorView = objj_msgSend(objj_msgSend(_CPMenuItemSubmenuIndicatorView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, 8.0, 10.0));

        objj_msgSend(_submenuIndicatorView, "setColor:", SUBMENU_INDICATOR_COLOR);
        objj_msgSend(_submenuIndicatorView, "setAutoresizingMask:", CPViewMinXMargin);

        objj_msgSend(self, "addSubview:", _submenuIndicatorView);

        objj_msgSend(self, "setAutoresizingMask:", CPViewWidthSizable);
    }

    return self;
}
}), new objj_method(sel_getUid("textColor"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(_menuItem, "isEnabled"))
        return objj_msgSend(CPColor, "lightGrayColor");

    return _textColor || objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 70.0 / 255.0, 69.0 / 255.0, 69.0 / 255.0, 1.0);
}
}), new objj_method(sel_getUid("textShadowColor"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(_menuItem, "isEnabled"))
        return nil;

    return _textShadowColor || objj_msgSend(CPColor, "colorWithWhite:alpha:", 1.0, 0.8);
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    _font = aFont;
}
}), new objj_method(sel_getUid("update"), function(self, _cmd)
{ with(self)
{
    var x = LEFT_MARGIN + objj_msgSend(_menuItem, "indentationLevel") * INDENTATION_WIDTH,
        height = 0.0,
        hasStateColumn = objj_msgSend(objj_msgSend(_menuItem, "menu"), "showsStateColumn");

    if (hasStateColumn)
    {
        objj_msgSend(_stateView, "setHidden:", NO);
        objj_msgSend(_stateView, "setImage:", _CPMenuItemDefaultStateImages[objj_msgSend(_menuItem, "state")] || nil);

        x += STATE_COLUMN_WIDTH;
    }
    else
        objj_msgSend(_stateView, "setHidden:", YES);

    objj_msgSend(_imageAndTextView, "setFont:", objj_msgSend(_menuItem, "font") || _font);
    objj_msgSend(_imageAndTextView, "setVerticalAlignment:", CPCenterVerticalTextAlignment);
    objj_msgSend(_imageAndTextView, "setImage:", objj_msgSend(_menuItem, "image"));
    objj_msgSend(_imageAndTextView, "setText:", objj_msgSend(_menuItem, "title"));
    objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "textColor"));
    objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));
    objj_msgSend(_imageAndTextView, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
    objj_msgSend(_imageAndTextView, "sizeToFit");

    var imageAndTextViewFrame = objj_msgSend(_imageAndTextView, "frame");

    imageAndTextViewFrame.origin.x = x;
    x += CGRectGetWidth(imageAndTextViewFrame);
    height = MAX(height, CGRectGetHeight(imageAndTextViewFrame));

    var hasKeyEquivalent = !!objj_msgSend(_menuItem, "keyEquivalent"),
        hasSubmenu = objj_msgSend(_menuItem, "hasSubmenu");

    if (hasKeyEquivalent || hasSubmenu)
        x += RIGHT_COLUMNS_MARGIN;

    if (hasKeyEquivalent)
    {
        objj_msgSend(_keyEquivalentView, "setFont:", objj_msgSend(_menuItem, "font") || _font);
        objj_msgSend(_keyEquivalentView, "setVerticalAlignment:", CPCenterVerticalTextAlignment);
        objj_msgSend(_keyEquivalentView, "setImage:", objj_msgSend(_menuItem, "image"));
        objj_msgSend(_keyEquivalentView, "setText:", objj_msgSend(_menuItem, "keyEquivalentStringRepresentation"));
        objj_msgSend(_keyEquivalentView, "setTextColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_keyEquivalentView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));
        objj_msgSend(_keyEquivalentView, "setTextShadowOffset:", CGSizeMake(0, 1));
        objj_msgSend(_keyEquivalentView, "setFrameOrigin:", CGPointMake(x, VERTICAL_MARGIN));
        objj_msgSend(_keyEquivalentView, "sizeToFit");

        var keyEquivalentViewFrame = objj_msgSend(_keyEquivalentView, "frame");

        keyEquivalentViewFrame.origin.x = x;
        x += CGRectGetWidth(keyEquivalentViewFrame);
        height = MAX(height, CGRectGetHeight(keyEquivalentViewFrame));

        if (hasSubmenu)
            x += RIGHT_COLUMNS_MARGIN;
    }
    else
        objj_msgSend(_keyEquivalentView, "setHidden:", YES);

    if (hasSubmenu)
    {
        objj_msgSend(_submenuIndicatorView, "setHidden:", NO);

        var submenuViewFrame = objj_msgSend(_submenuIndicatorView, "frame");

        submenuViewFrame.origin.x = x;

        x += CGRectGetWidth(submenuViewFrame);
        height = MAX(height, CGRectGetHeight(submenuViewFrame));
    }
    else
        objj_msgSend(_submenuIndicatorView, "setHidden:", YES);

    height += 2.0 * VERTICAL_MARGIN;

    imageAndTextViewFrame.origin.y = FLOOR((height - CGRectGetHeight(imageAndTextViewFrame)) / 2.0);
    objj_msgSend(_imageAndTextView, "setFrame:", imageAndTextViewFrame);

    if (hasStateColumn)
        objj_msgSend(_stateView, "setFrameSize:", CGSizeMake(STATE_COLUMN_WIDTH, height));

    if (hasKeyEquivalent)
    {
        keyEquivalentViewFrame.origin.y = FLOOR((height - CGRectGetHeight(keyEquivalentViewFrame)) / 2.0);
        objj_msgSend(_keyEquivalentView, "setFrame:", keyEquivalentViewFrame);
    }

    if (hasSubmenu)
    {
        submenuViewFrame.origin.y = FLOOR((height - CGRectGetHeight(submenuViewFrame)) / 2.0);
        objj_msgSend(_submenuIndicatorView, "setFrame:", submenuViewFrame);
    }

    _minSize = CGSizeMake(x + RIGHT_MARGIN, height);

    objj_msgSend(self, "setAutoresizesSubviews:", NO);
    objj_msgSend(self, "setFrameSize:", _minSize);
    objj_msgSend(self, "setAutoresizesSubviews:", YES);
}
}), new objj_method(sel_getUid("highlight:"), function(self, _cmd, shouldHighlight)
{ with(self)
{

    if (!objj_msgSend(_menuItem, "isEnabled"))
        return;

    if (shouldHighlight)
    {
        objj_msgSend(self, "setBackgroundColor:", _CPMenuItemSelectionColor);

        objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_keyEquivalentView, "setTextColor:", objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_submenuIndicatorView, "setColor:", objj_msgSend(CPColor, "whiteColor"));

        objj_msgSend(_imageAndTextView, "setTextShadowColor:", _CPMenuItemTextShadowColor);
        objj_msgSend(_keyEquivalentView, "setTextShadowColor:", _CPMenuItemTextShadowColor);
    }
    else
    {
        objj_msgSend(self, "setBackgroundColor:", nil);

        objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_keyEquivalentView, "setTextColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_submenuIndicatorView, "setColor:", SUBMENU_INDICATOR_COLOR);

        objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));
        objj_msgSend(_keyEquivalentView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));
    }

    if (shouldHighlight)
        objj_msgSend(_stateView, "setImage:", _CPMenuItemDefaultStateHighlightedImages[objj_msgSend(_menuItem, "state")] || nil);
    else
        objj_msgSend(_stateView, "setImage:", _CPMenuItemDefaultStateImages[objj_msgSend(_menuItem, "state")] || nil);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self !== objj_msgSend(_CPMenuItemStandardView, "class"))
        return;

    SUBMENU_INDICATOR_COLOR = objj_msgSend(CPColor, "grayColor");

    _CPMenuItemSelectionColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 95.0 / 255.0, 131.0 / 255.0, 185.0 / 255.0, 1.0);
    _CPMenuItemTextShadowColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 26.0 / 255.0,  73.0 / 255.0, 109.0 / 255.0, 1.0)

    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);

    _CPMenuItemDefaultStateImages[CPOffState] = nil;
    _CPMenuItemDefaultStateHighlightedImages[CPOffState] = nil;

    _CPMenuItemDefaultStateImages[CPOnState] = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPMenuItem/CPMenuItemOnState.png"), CGSizeMake(14.0, 14.0));
    _CPMenuItemDefaultStateHighlightedImages[CPOnState] = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPMenuItem/CPMenuItemOnStateHighlighted.png"), CGSizeMake(14.0, 14.0));

    _CPMenuItemDefaultStateImages[CPMixedState] = nil;
    _CPMenuItemDefaultStateHighlightedImages[CPMixedState] = nil;
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "alloc"), "init");
}
}), new objj_method(sel_getUid("_standardLeftMargin"), function(self, _cmd)
{ with(self)
{
    return LEFT_MARGIN + STATE_COLUMN_WIDTH;
}
})]);
}

{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemSubmenuIndicatorView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_color")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_color === aColor)
        return;

    _color = aColor;

    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort"),
        bounds = objj_msgSend(self, "bounds");

    CGContextBeginPath(context);

    CGContextMoveToPoint(context, CGRectGetMinX(bounds), CGRectGetMinY(bounds));
    CGContextAddLineToPoint(context, CGRectGetMaxX(bounds), CGRectGetMidY(bounds));
    CGContextAddLineToPoint(context, CGRectGetMinX(bounds), CGRectGetMaxY(bounds));

    CGContextClosePath(context);

    CGContextSetFillColor(context, _color);
    CGContextFillPath(context);
}
})]);
}

p;17;_CPMenuItemView.jt;9172;@STATIC;1.0;i;26;_CPMenuItemSeparatorView.ji;25;_CPMenuItemStandardView.ji;24;_CPMenuItemMenuBarView.jt;9063;


objj_executeFile("_CPMenuItemSeparatorView.j", true);
objj_executeFile("_CPMenuItemStandardView.j", true);
objj_executeFile("_CPMenuItemMenuBarView.j", true);


var LEFT_MARGIN = 3.0,
    RIGHT_MARGIN = 16.0,
    STATE_COLUMN_WIDTH = 14.0,
    INDENTATION_WIDTH = 17.0,
    VERTICAL_MARGIN = 4.0;

var _CPMenuItemSelectionColor = nil,
    _CPMenuItemTextShadowColor = nil,

    _CPMenuItemDefaultStateImages = [],
    _CPMenuItemDefaultStateHighlightedImages = [];




{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_menuItem"), new objj_ivar("_view"), new objj_ivar("_font"), new objj_ivar("_textColor"), new objj_ivar("_textShadowColor"), new objj_ivar("_minSize"), new objj_ivar("_isDirty"), new objj_ivar("_showsStateColumn"), new objj_ivar("_stateView"), new objj_ivar("_imageAndTextView"), new objj_ivar("_submenuView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:forMenuItem:"), function(self, _cmd, aFrame, aMenuItem)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPMenuItemView").super_class }, "initWithFrame:", aFrame);

    if (self)
    {
        _menuItem = aMenuItem;
        _showsStateColumn = YES;
        _isDirty = YES;

        objj_msgSend(self, "setAutoresizingMask:", CPViewWidthSizable);

        objj_msgSend(self, "synchronizeWithMenuItem");
    }

    return self;
}
}), new objj_method(sel_getUid("minSize"), function(self, _cmd)
{ with(self)
{
    return _minSize;
}
}), new objj_method(sel_getUid("setDirty"), function(self, _cmd)
{ with(self)
{
    _isDirty = YES;
}
}), new objj_method(sel_getUid("synchronizeWithMenuItem"), function(self, _cmd)
{ with(self)
{
    var menuItemView = objj_msgSend(_menuItem, "view");

    if (objj_msgSend(_menuItem, "isSeparatorItem"))
    {
        if (!objj_msgSend(_view, "isKindOfClass:", objj_msgSend(_CPMenuItemSeparatorView, "class")))
        {
            objj_msgSend(_view, "removeFromSuperview");
            _view = objj_msgSend(_CPMenuItemSeparatorView, "view");
        }
    }
    else if (menuItemView)
    {
        if (_view !== menuItemView)
        {
            objj_msgSend(_view, "removeFromSuperview");
            _view = menuItemView;
        }
    }

    else if (objj_msgSend(_menuItem, "menu") == objj_msgSend(CPApp, "mainMenu"))
    {
        if (!objj_msgSend(_view, "isKindOfClass:", objj_msgSend(_CPMenuItemMenuBarView, "class")))
        {
            objj_msgSend(_view, "removeFromSuperview");
            _view = objj_msgSend(_CPMenuItemMenuBarView, "view");
        }

        objj_msgSend(_view, "setMenuItem:", _menuItem);
    }
    else
    {
        if (!objj_msgSend(_view, "isKindOfClass:", objj_msgSend(_CPMenuItemStandardView, "class")))
        {
            objj_msgSend(_view, "removeFromSuperview");
            _view = objj_msgSend(_CPMenuItemStandardView, "view");
        }

        objj_msgSend(_view, "setMenuItem:", _menuItem);
    }

    if (objj_msgSend(_view, "superview") !== self)
        objj_msgSend(self, "addSubview:", _view);

    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("update")))
        objj_msgSend(_view, "update");

    _minSize = objj_msgSend(_view, "frame").size;
    objj_msgSend(self, "setAutoresizesSubviews:", NO);
    objj_msgSend(self, "setFrameSize:", _minSize);
    objj_msgSend(self, "setAutoresizesSubviews:", YES);
}
}), new objj_method(sel_getUid("setShowsStateColumn:"), function(self, _cmd, shouldShowStateColumn)
{ with(self)
{
    _showsStateColumn = shouldShowStateColumn;
}
}), new objj_method(sel_getUid("highlight:"), function(self, _cmd, shouldHighlight)
{ with(self)
{
    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("highlight:")))
        objj_msgSend(_view, "highlight:", shouldHighlight);
}
}), new objj_method(sel_getUid("activate:"), function(self, _cmd, shouldActivate)
{ with(self)
{
    objj_msgSend(_imageAndTextView, "setImage:", objj_msgSend(_menuItem, "image"));

    if (shouldActivate)
    {
        objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "activateColor") || objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "activateShadowColor") || objj_msgSend(CPColor, "blackColor"));
        objj_msgSend(_submenuView, "setColor:", objj_msgSend(self, "activateColor") || objj_msgSend(CPColor, "whiteColor"));
    }
    else
    {
        objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "textColor"));
        objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));
        objj_msgSend(_submenuView, "setColor:", objj_msgSend(self, "textColor"));
    }
}
}), new objj_method(sel_getUid("eventOnSubmenu:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(_menuItem, "hasSubmenu"))
        return NO;

    return CGRectContainsPoint(objj_msgSend(_submenuView, "frame"), objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil));
}
}), new objj_method(sel_getUid("isHidden"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_menuItem, "isHidden");
}
}), new objj_method(sel_getUid("menuItem"), function(self, _cmd)
{ with(self)
{
    return _menuItem;
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    if (_font === aFont)
        return;

    _font = aFont;

    if (objj_msgSend(_view, "respondsToSelector:", sel_getUid("setFont:")))
        objj_msgSend(_view, "setFont:", aFont);

    objj_msgSend(self, "setDirty");
}
}), new objj_method(sel_getUid("setTextColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_textColor == aColor)
        return;

    _textColor = aColor;

    objj_msgSend(_imageAndTextView, "setTextColor:", objj_msgSend(self, "textColor"));
    objj_msgSend(_submenuView, "setColor:", objj_msgSend(self, "textColor"));
}
}), new objj_method(sel_getUid("textColor"), function(self, _cmd)
{ with(self)
{
    return nil;
}
}), new objj_method(sel_getUid("setTextShadowColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_textShadowColor == aColor)
        return;

    _textShadowColor = aColor;

    objj_msgSend(_imageAndTextView, "setTextShadowColor:", objj_msgSend(self, "textShadowColor"));

}
}), new objj_method(sel_getUid("textShadowColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_menuItem, "isEnabled") ? (_textShadowColor ? _textShadowColor : objj_msgSend(CPColor, "colorWithWhite:alpha:", 1.0, 0.8)) : objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.8, 0.8);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPMenuItemView, "class"))
        return;

    _CPMenuItemSelectionColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 95.0 / 255.0, 131.0 / 255.0, 185.0 / 255.0, 1.0);
    _CPMenuItemTextShadowColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 26.0 / 255.0,  73.0 / 255.0, 109.0 / 255.0, 1.0)

    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);

    _CPMenuItemDefaultStateImages[CPOffState] = nil;
    _CPMenuItemDefaultStateHighlightedImages[CPOffState] = nil;

    _CPMenuItemDefaultStateImages[CPOnState] = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPMenuItem/CPMenuItemOnState.png"), CGSizeMake(14.0, 14.0));
    _CPMenuItemDefaultStateHighlightedImages[CPOnState] = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPMenuItem/CPMenuItemOnStateHighlighted.png"), CGSizeMake(14.0, 14.0));

    _CPMenuItemDefaultStateImages[CPMixedState] = nil;
    _CPMenuItemDefaultStateHighlightedImages[CPMixedState] = nil;
}
}), new objj_method(sel_getUid("leftMargin"), function(self, _cmd)
{ with(self)
{
    return LEFT_MARGIN + STATE_COLUMN_WIDTH;
}
})]);
}

{var the_class = objj_allocateClassPair(CPView, "_CPMenuItemArrowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_color")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setColor:"), function(self, _cmd, aColor)
{ with(self)
{
    if (_color == aColor)
        return;

    _color = aColor;

    objj_msgSend(self, "setNeedsDisplay:", YES);
}
}), new objj_method(sel_getUid("drawRect:"), function(self, _cmd, aRect)
{ with(self)
{
    var context = objj_msgSend(objj_msgSend(CPGraphicsContext, "currentContext"), "graphicsPort");

    CGContextBeginPath(context);

    CGContextMoveToPoint(context, 1.0, 4.0);
    CGContextAddLineToPoint(context, 9.0, 4.0);
    CGContextAddLineToPoint(context, 5.0, 8.0);
    CGContextAddLineToPoint(context, 1.0, 4.0);

    CGContextClosePath(context);

    CGContextSetFillColor(context, _color);
    CGContextFillPath(context);
}
})]);
}

p;12;CPMenuItem.jt;19164;@STATIC;1.0;I;20;Foundation/CPCoder.jI;21;Foundation/CPObject.jI;21;Foundation/CPString.ji;9;CPImage.ji;8;CPMenu.ji;8;CPView.ji;17;_CPMenuItemView.jt;19008;objj_executeFile("Foundation/CPCoder.j", false);
objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPString.j", false);
objj_executeFile("CPImage.j", true);
objj_executeFile("CPMenu.j", true);
objj_executeFile("CPView.j", true);
objj_executeFile("_CPMenuItemView.j", true);
{var the_class = objj_allocateClassPair(CPObject, "CPMenuItem"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_isSeparator"), new objj_ivar("_title"), new objj_ivar("_font"), new objj_ivar("_target"), new objj_ivar("_action"), new objj_ivar("_isEnabled"), new objj_ivar("_isHidden"), new objj_ivar("_tag"), new objj_ivar("_state"), new objj_ivar("_image"), new objj_ivar("_alternateImage"), new objj_ivar("_onStateImage"), new objj_ivar("_offStateImage"), new objj_ivar("_mixedStateImage"), new objj_ivar("_submenu"), new objj_ivar("_menu"), new objj_ivar("_keyEquivalent"), new objj_ivar("_keyEquivalentModifierMask"), new objj_ivar("_mnemonicLocation"), new objj_ivar("_isAlternate"), new objj_ivar("_indentationLevel"), new objj_ivar("_toolTip"), new objj_ivar("_representedObject"), new objj_ivar("_view"), new objj_ivar("_menuItemView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithTitle:action:keyEquivalent:", "", nil, nil);
}
}), new objj_method(sel_getUid("initWithTitle:action:keyEquivalent:"), function(self, _cmd, aTitle, anAction, aKeyEquivalent)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPMenuItem").super_class }, "init");
    if (self)
    {
        _isSeparator = NO;
        _title = aTitle;
        _action = anAction;
        _isEnabled = YES;
        _tag = 0;
        _state = CPOffState;
        _keyEquivalent = aKeyEquivalent || "";
        _keyEquivalentModifierMask = CPPlatformActionKeyMask;
        _indentationLevel = 0;
        _mnemonicLocation = CPNotFound;
    }
    return self;
}
}), new objj_method(sel_getUid("setEnabled:"), function(self, _cmd, isEnabled)
{ with(self)
{
    if (objj_msgSend(_menu, "autoenablesItems"))
        return;
    _isEnabled = isEnabled;
    objj_msgSend(_menuItemView, "setDirty");
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("isEnabled"), function(self, _cmd)
{ with(self)
{
    return _isEnabled;
}
}), new objj_method(sel_getUid("setHidden:"), function(self, _cmd, isHidden)
{ with(self)
{
    if (_isHidden == isHidden)
        return;
    _isHidden = isHidden;
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("isHidden"), function(self, _cmd)
{ with(self)
{
    return _isHidden;
}
}), new objj_method(sel_getUid("isHiddenOrHasHiddenAncestor"), function(self, _cmd)
{ with(self)
{
    if (_isHidden)
        return YES;
    var supermenu = objj_msgSend(_menu, "supermenu");
    if (objj_msgSend(objj_msgSend(supermenu, "itemAtIndex:", objj_msgSend(supermenu, "indexOfItemWithSubmenu:", _menu)), "isHiddenOrHasHiddenAncestor"))
        return YES;
    return NO;
}
}), new objj_method(sel_getUid("setTarget:"), function(self, _cmd, aTarget)
{ with(self)
{
    _target = aTarget;
}
}), new objj_method(sel_getUid("target"), function(self, _cmd)
{ with(self)
{
    return _target;
}
}), new objj_method(sel_getUid("setAction:"), function(self, _cmd, anAction)
{ with(self)
{
    _action = anAction;
}
}), new objj_method(sel_getUid("action"), function(self, _cmd)
{ with(self)
{
    return _action;
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    _mnemonicLocation = CPNotFound;
    if (_title == aTitle)
        return;
    _title = aTitle;
    objj_msgSend(_menuItemView, "setDirty");
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("title"), function(self, _cmd)
{ with(self)
{
    return _title;
}
}), new objj_method(sel_getUid("setTextColor:"), function(self, _cmd, aColor)
{ with(self)
{
}
}), new objj_method(sel_getUid("setFont:"), function(self, _cmd, aFont)
{ with(self)
{
    if (_font == aFont)
        return;
    _font = aFont;
    objj_msgSend(_menu, "itemChanged:", self);
    objj_msgSend(_menuItemView, "setDirty");
}
}), new objj_method(sel_getUid("font"), function(self, _cmd)
{ with(self)
{
    return _font;
}
}), new objj_method(sel_getUid("setTag:"), function(self, _cmd, aTag)
{ with(self)
{
    _tag = aTag;
}
}), new objj_method(sel_getUid("tag"), function(self, _cmd)
{ with(self)
{
    return _tag;
}
}), new objj_method(sel_getUid("setState:"), function(self, _cmd, aState)
{ with(self)
{
    if (_state == aState)
        return;
    _state = aState;
    objj_msgSend(_menu, "itemChanged:", self);
    objj_msgSend(_menuItemView, "setDirty");
}
}), new objj_method(sel_getUid("state"), function(self, _cmd)
{ with(self)
{
    return _state;
}
}), new objj_method(sel_getUid("setImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_image == anImage)
        return;
    _image = anImage;
    objj_msgSend(_menuItemView, "setDirty");
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("image"), function(self, _cmd)
{ with(self)
{
    return _image;
}
}), new objj_method(sel_getUid("setAlternateImage:"), function(self, _cmd, anImage)
{ with(self)
{
    _alternateImage = anImage;
}
}), new objj_method(sel_getUid("alternateImage"), function(self, _cmd)
{ with(self)
{
    return _alternateImage;
}
}), new objj_method(sel_getUid("setOnStateImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_onStateImage == anImage)
        return;
    _onStateImage = anImage;
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("onStateImage"), function(self, _cmd)
{ with(self)
{
    return _onStateImage;
}
}), new objj_method(sel_getUid("setOffStateImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_offStateImage == anImage)
        return;
    _offStateImage = anImage;
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("offStateImage"), function(self, _cmd)
{ with(self)
{
    return _offStateImage;
}
}), new objj_method(sel_getUid("setMixedStateImage:"), function(self, _cmd, anImage)
{ with(self)
{
    if (_mixedStateImage == anImage)
        return;
    _mixedStateImage = anImage;
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("mixedStateImage"), function(self, _cmd)
{ with(self)
{
    return _mixedStateImage;
}
}), new objj_method(sel_getUid("setSubmenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    if (_submenu === aMenu)
        return;
    var supermenu = objj_msgSend(_submenu, "supermenu");
    if (supermenu)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException,  "Can't add submenu \"" + objj_msgSend(aMenu, "title") + "\" to item \"" + objj_msgSend(self, "title") + "\", because it is already submenu of \"" + objj_msgSend(objj_msgSend(aMenu, "supermenu"), "title") + "\"");
    _submenu = aMenu;
    if (_submenu)
    {
        objj_msgSend(_submenu, "setSupermenu:", _menu);
        objj_msgSend(self, "setTarget:", _menu);
        objj_msgSend(self, "setAction:", sel_getUid("submenuAction:"));
    }
    else
    {
        objj_msgSend(self, "setTarget:", nil);
        objj_msgSend(self, "setAction:", NULL);
    }
    objj_msgSend(_menuItemView, "setDirty");
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("submenu"), function(self, _cmd)
{ with(self)
{
    return _submenu;
}
}), new objj_method(sel_getUid("hasSubmenu"), function(self, _cmd)
{ with(self)
{
    return _submenu ? YES : NO;
}
}), new objj_method(sel_getUid("isSeparatorItem"), function(self, _cmd)
{ with(self)
{
    return _isSeparator;
}
}), new objj_method(sel_getUid("setMenu:"), function(self, _cmd, aMenu)
{ with(self)
{
    _menu = aMenu;
}
}), new objj_method(sel_getUid("menu"), function(self, _cmd)
{ with(self)
{
    return _menu;
}
}), new objj_method(sel_getUid("setKeyEquivalent:"), function(self, _cmd, aString)
{ with(self)
{
    _keyEquivalent = aString || "";
}
}), new objj_method(sel_getUid("keyEquivalent"), function(self, _cmd)
{ with(self)
{
    return _keyEquivalent;
}
}), new objj_method(sel_getUid("setKeyEquivalentModifierMask:"), function(self, _cmd, aMask)
{ with(self)
{
    _keyEquivalentModifierMask = aMask;
}
}), new objj_method(sel_getUid("keyEquivalentModifierMask"), function(self, _cmd)
{ with(self)
{
    return _keyEquivalentModifierMask;
}
}), new objj_method(sel_getUid("keyEquivalentStringRepresentation"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(_keyEquivalent, "length"))
        return "";
    var string = _keyEquivalent.toUpperCase(),
        needsShift = _keyEquivalentModifierMask & CPShiftKeyMask || string === _keyEquivalent;
    if (CPBrowserIsOperatingSystem(CPMacOperatingSystem))
    {
        if (_keyEquivalentModifierMask & CPCommandKeyMask)
            string = "⌘" + string;
        if (needsShift)
            string = "⇧" + string;
        if (_keyEquivalentModifierMask & CPAlternateKeyMask)
            string = "⌥" + string;
        if (_keyEquivalentModifierMask & CPControlKeyMask)
            string = "^" + string;
    }
    else
    {
        if (needsShift)
            string = "Shift-" + string;
        if (_keyEquivalentModifierMask & CPAlternateKeyMask)
            string = "Alt-" + string;
        if (_keyEquivalentModifierMask & CPControlKeyMask || _keyEquivalentModifierMask & CPCommandKeyMask)
            string = "Ctrl-" + string;
    }
    return string;
}
}), new objj_method(sel_getUid("setMnemonicLocation:"), function(self, _cmd, aLocation)
{ with(self)
{
    _mnemonicLocation = aLocation;
}
}), new objj_method(sel_getUid("mnemonicLocation"), function(self, _cmd)
{ with(self)
{
    return _mnemonicLocation;
}
}), new objj_method(sel_getUid("setTitleWithMnemonicLocation:"), function(self, _cmd, aTitle)
{ with(self)
{
    var location = objj_msgSend(aTitle, "rangeOfString:", "&").location;
    if (location == CPNotFound)
        objj_msgSend(self, "setTitle:", aTitle);
    else
    {
        objj_msgSend(self, "setTitle:", objj_msgSend(aTitle, "substringToIndex:", location) + objj_msgSend(aTitle, "substringFromIndex:", location + 1));
        objj_msgSend(self, "setMnemonicLocation:", location);
    }
}
}), new objj_method(sel_getUid("mnemonic"), function(self, _cmd)
{ with(self)
{
    return _mnemonicLocation == CPNotFound ? "" : objj_msgSend(_title, "characterAtIndex:", _mnemonicLocation);
}
}), new objj_method(sel_getUid("setAlternate:"), function(self, _cmd, isAlternate)
{ with(self)
{
    _isAlternate = isAlternate;
}
}), new objj_method(sel_getUid("isAlternate"), function(self, _cmd)
{ with(self)
{
    return _isAlternate;
}
}), new objj_method(sel_getUid("setIndentationLevel:"), function(self, _cmd, aLevel)
{ with(self)
{
    if (aLevel < 0)
        objj_msgSend(CPException, "raise:reason:", CPInvalidArgumentException, "setIndentationLevel: argument must be greater than or equal to 0.");
    _indentationLevel = MIN(15, aLevel);
}
}), new objj_method(sel_getUid("indentationLevel"), function(self, _cmd)
{ with(self)
{
    return _indentationLevel;
}
}), new objj_method(sel_getUid("setToolTip:"), function(self, _cmd, aToolTip)
{ with(self)
{
    _toolTip = aToolTip;
}
}), new objj_method(sel_getUid("toolTip"), function(self, _cmd)
{ with(self)
{
    return _toolTip;
}
}), new objj_method(sel_getUid("setRepresentedObject:"), function(self, _cmd, anObject)
{ with(self)
{
    _representedObject = anObject;
}
}), new objj_method(sel_getUid("representedObject"), function(self, _cmd)
{ with(self)
{
    return _representedObject;
}
}), new objj_method(sel_getUid("setView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_view === aView)
        return;
    _view = aView;
    objj_msgSend(_menuItemView, "setDirty");
    objj_msgSend(_menu, "itemChanged:", self);
}
}), new objj_method(sel_getUid("view"), function(self, _cmd)
{ with(self)
{
    return _view;
}
}), new objj_method(sel_getUid("isHighlighted"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "menu"), "highlightedItem") == self;
}
}), new objj_method(sel_getUid("_menuItemView"), function(self, _cmd)
{ with(self)
{
    if (!_menuItemView)
        _menuItemView = objj_msgSend(objj_msgSend(_CPMenuItemView, "alloc"), "initWithFrame:forMenuItem:", CGRectMakeZero(), self);
    return _menuItemView;
}
}), new objj_method(sel_getUid("_isSelectable"), function(self, _cmd)
{ with(self)
{
    return !objj_msgSend(self, "submenu") || objj_msgSend(self, "action") !== sel_getUid("submenuAction:") || objj_msgSend(self, "target") !== objj_msgSend(self, "menu");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("separatorItem"), function(self, _cmd)
{ with(self)
{
    var separatorItem = objj_msgSend(objj_msgSend(self, "alloc"), "initWithTitle:action:keyEquivalent:", "", nil, nil);
    separatorItem._isSeparator = YES;
    return separatorItem;
}
})]);
}
var CPMenuItemIsSeparatorKey = "CPMenuItemIsSeparatorKey",
    CPMenuItemTitleKey = "CPMenuItemTitleKey",
    CPMenuItemTargetKey = "CPMenuItemTargetKey",
    CPMenuItemActionKey = "CPMenuItemActionKey",
    CPMenuItemIsEnabledKey = "CPMenuItemIsEnabledKey",
    CPMenuItemIsHiddenKey = "CPMenuItemIsHiddenKey",
    CPMenuItemTagKey = "CPMenuItemTagKey",
    CPMenuItemStateKey = "CPMenuItemStateKey",
    CPMenuItemImageKey = "CPMenuItemImageKey",
    CPMenuItemAlternateImageKey = "CPMenuItemAlternateImageKey",
    CPMenuItemSubmenuKey = "CPMenuItemSubmenuKey",
    CPMenuItemMenuKey = "CPMenuItemMenuKey",
    CPMenuItemKeyEquivalentKey = "CPMenuItemKeyEquivalentKey",
    CPMenuItemKeyEquivalentModifierMaskKey = "CPMenuItemKeyEquivalentModifierMaskKey",
    CPMenuItemIndentationLevelKey = "CPMenuItemIndentationLevelKey",
    CPMenuItemRepresentedObjectKey = "CPMenuItemRepresentedObjectKey",
    CPMenuItemViewKey = "CPMenuItemViewKey";
{
var the_class = objj_getClass("CPMenuItem")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPMenuItem\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("initWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPMenuItem").super_class }, "init");
    if (self)
    {
        _isSeparator = objj_msgSend(aCoder, "containsValueForKey:", CPMenuItemIsSeparatorKey) && objj_msgSend(aCoder, "decodeBoolForKey:", CPMenuItemIsSeparatorKey);
        _title = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuItemTitleKey);
        _target = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuItemTargetKey);
        _action = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuItemActionKey);
        _isEnabled = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemIsEnabledKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemIsEnabledKey)) : (YES);
        _isHidden = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemIsHiddenKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemIsHiddenKey)) : (NO);
        _tag = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemTagKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemTagKey)) : (0);
        _state = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemStateKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemStateKey)) : (CPOffState);
        _image = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemImageKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemImageKey)) : (nil);
        _alternateImage = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemAlternateImageKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemAlternateImageKey)) : (nil);
        _menu = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemMenuKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemMenuKey)) : (nil);
        objj_msgSend(self, "setSubmenu:", objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemSubmenuKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemSubmenuKey)) : (nil));
        _keyEquivalent = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuItemKeyEquivalentKey) || "";
        _keyEquivalentModifierMask = objj_msgSend(aCoder, "decodeObjectForKey:", CPMenuItemKeyEquivalentModifierMaskKey) || 0;
        objj_msgSend(self, "setIndentationLevel:", objj_msgSend(aCoder, "decodeIntForKey:", CPMenuItemIndentationLevelKey) || 0);
        _representedObject = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemRepresentedObjectKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemRepresentedObjectKey)) : (nil);
        _view = objj_msgSend(aCoder, "containsValueForKey:", (CPMenuItemViewKey)) ? objj_msgSend(aCoder, "decodeObjectForKey:", (CPMenuItemViewKey)) : (nil);
    }
    return self;
}
}), new objj_method(sel_getUid("encodeWithCoder:"), function(self, _cmd, aCoder)
{ with(self)
{
    if (_isSeparator)
        objj_msgSend(aCoder, "encodeBool:forKey:", _isSeparator, CPMenuItemIsSeparatorKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _title, CPMenuItemTitleKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _target, CPMenuItemTargetKey);
    objj_msgSend(aCoder, "encodeObject:forKey:", _action, CPMenuItemActionKey);
    if ((_isEnabled) !== (YES)) objj_msgSend(aCoder, "encodeObject:forKey:", (_isEnabled), (CPMenuItemIsEnabledKey));;
    if ((_isHidden) !== (NO)) objj_msgSend(aCoder, "encodeObject:forKey:", (_isHidden), (CPMenuItemIsHiddenKey));;
    if ((_tag) !== (0)) objj_msgSend(aCoder, "encodeObject:forKey:", (_tag), (CPMenuItemTagKey));;
    if ((_state) !== (CPOffState)) objj_msgSend(aCoder, "encodeObject:forKey:", (_state), (CPMenuItemStateKey));;
    if ((_image) !== (nil)) objj_msgSend(aCoder, "encodeObject:forKey:", (_image), (CPMenuItemImageKey));;
    if ((_alternateImage) !== (nil)) objj_msgSend(aCoder, "encodeObject:forKey:", (_alternateImage), (CPMenuItemAlternateImageKey));;
    if ((_submenu) !== (nil)) objj_msgSend(aCoder, "encodeObject:forKey:", (_submenu), (CPMenuItemSubmenuKey));;
    if ((_menu) !== (nil)) objj_msgSend(aCoder, "encodeObject:forKey:", (_menu), (CPMenuItemMenuKey));;
    if (_keyEquivalent && _keyEquivalent.length)
        objj_msgSend(aCoder, "encodeObject:forKey:", _keyEquivalent, CPMenuItemKeyEquivalentKey);
    if (_keyEquivalentModifierMask)
        objj_msgSend(aCoder, "encodeObject:forKey:", _keyEquivalentModifierMask, CPMenuItemKeyEquivalentModifierMaskKey);
    if (_indentationLevel > 0)
        objj_msgSend(aCoder, "encodeInt:forKey:", _indentationLevel, CPMenuItemIndentationLevelKey);
    if ((_representedObject) !== (nil)) objj_msgSend(aCoder, "encodeObject:forKey:", (_representedObject), (CPMenuItemRepresentedObjectKey));;
    if ((_view) !== (nil)) objj_msgSend(aCoder, "encodeObject:forKey:", (_view), (CPMenuItemViewKey));;
}
})]);
}

p;31;_CPBorderlessBridgeWindowView.jt;2517;@STATIC;1.0;i;15;_CPWindowView.jt;2478;objj_executeFile("_CPWindowView.j", true);
var _CPToolbarViewBackgroundColor = nil;
{var the_class = objj_allocateClassPair(_CPWindowView, "_CPBorderlessBridgeWindowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_toolbarBackgroundView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("setShowsResizeIndicator:"), function(self, _cmd, shouldShowResizeIndicator)
{ with(self)
{
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPBorderlessBridgeWindowView").super_class }, "tile");
    var theWindow = objj_msgSend(self, "window"),
        bounds = objj_msgSend(self, "bounds");
    objj_msgSend(objj_msgSend(theWindow, "contentView"), "setFrame:", CGRectMake(0.0, objj_msgSend(self, "toolbarMaxY"), CGRectGetWidth(bounds), CGRectGetHeight(bounds) - objj_msgSend(self, "toolbarMaxY")));
    if (!objj_msgSend(objj_msgSend(theWindow, "toolbar"), "isVisible"))
    {
        objj_msgSend(_toolbarBackgroundView, "removeFromSuperview");
        _toolbarBackgroundView = nil;
        return;
    }
    if (!_toolbarBackgroundView)
    {
        _toolbarBackgroundView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMakeZero());
        objj_msgSend(_toolbarBackgroundView, "setBackgroundColor:", objj_msgSend(objj_msgSend(self, "class"), "toolbarBackgroundColor"));
        objj_msgSend(_toolbarBackgroundView, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(self, "addSubview:positioned:relativeTo:", _toolbarBackgroundView, CPWindowBelow, nil);
    }
    var frame = CGRectMakeZero();
    frame.origin = CGPointMakeCopy(objj_msgSend(self, "toolbarOffset"));
    frame.size = objj_msgSend(_toolbarView, "frame").size;
    objj_msgSend(_toolbarBackgroundView, "setFrame:", frame);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("toolbarBackgroundColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPToolbarViewBackgroundColor)
        _CPToolbarViewBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(_CPBorderlessBridgeWindowView, "class")), "pathForResource:", "_CPToolbarView/_CPToolbarViewBackground.png"), CGSizeMake(1.0, 59.0)));
    return _CPToolbarViewBackgroundColor;
}
})]);
}

p;25;_CPBorderlessWindowView.jt;229;@STATIC;1.0;i;15;_CPWindowView.jt;191;objj_executeFile("_CPWindowView.j", true);
{var the_class = objj_allocateClassPair(_CPWindowView, "_CPBorderlessWindowView"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
}

p;23;_CPDocModalWindowView.jt;1878;@STATIC;1.0;i;15;_CPWindowView.jt;1839;


objj_executeFile("_CPWindowView.j", true);

var _CPStandardWindowViewBodyBackgroundColor = nil;

{var the_class = objj_allocateClassPair(_CPWindowView, "_CPDocModalWindowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_bodyView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:styleMask:"), function(self, _cmd, aFrame, aStyleMask)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPDocModalWindowView").super_class }, "initWithFrame:styleMask:", aFrame, aStyleMask);

    if (self)
    {
        var theClass = objj_msgSend(self, "class"),
              bounds = objj_msgSend(self, "bounds");

       _bodyView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, CGRectGetWidth(bounds), CGRectGetHeight(bounds)));

        objj_msgSend(_bodyView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
        objj_msgSend(_bodyView, "setBackgroundColor:", objj_msgSend(theClass, "bodyBackgroundColor"));
        objj_msgSend(_bodyView, "setHitTests:", NO);

        objj_msgSend(self, "addSubview:", _bodyView);
     }

    return self;
}
}), new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    return aFrameRect;
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    return aContentRect;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("bodyBackgroundColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPStandardWindowViewBodyBackgroundColor)
        _CPStandardWindowViewBodyBackgroundColor = objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.96, 0.9);

    return _CPStandardWindowViewBodyBackgroundColor;
}
})]);
}

p;18;_CPHUDWindowView.jt;8708;@STATIC;1.0;t;8689;var _CPHUDWindowViewBackgroundColor = nil,
    CPHUDCloseButtonImage = nil;
var HUD_TITLEBAR_HEIGHT = 26.0;
{var the_class = objj_allocateClassPair(_CPWindowView, "_CPHUDWindowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_toolbarView"), new objj_ivar("_titleField"), new objj_ivar("_closeButton")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    var contentRect = objj_msgSend(objj_msgSend(self, "class"), "contentRectForFrameRect:", aFrameRect);
    if (objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "toolbar"), "isVisible"))
    {
        toolbarHeight = CGRectGetHeight(objj_msgSend(objj_msgSend(self, "toolbarView"), "frame"));
        contentRect.origin.y += toolbarHeight;
        contentRect.size.height -= toolbarHeight;
    }
    return contentRect;
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    var frameRect = objj_msgSend(objj_msgSend(self, "class"), "frameRectForContentRect:", aContentRect);
    if (objj_msgSend(objj_msgSend(objj_msgSend(self, "window"), "toolbar"), "isVisible"))
    {
        toolbarHeight = CGRectGetHeight(objj_msgSend(objj_msgSend(self, "toolbarView"), "frame"));
        frameRect.origin.y -= toolbarHeight;
        frameRect.size.height += toolbarHeight;
    }
    return frameRect;
}
}), new objj_method(sel_getUid("initWithFrame:styleMask:"), function(self, _cmd, aFrame, aStyleMask)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPHUDWindowView").super_class }, "initWithFrame:styleMask:", aFrame, aStyleMask);
    if (self)
    {
        var bounds = objj_msgSend(self, "bounds");
        objj_msgSend(self, "setBackgroundColor:", _CPHUDWindowViewBackgroundColor);
        _titleField = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMakeZero());
        objj_msgSend(_titleField, "setHitTests:", NO);
        objj_msgSend(_titleField, "setFont:", objj_msgSend(CPFont, "systemFontOfSize:", 11.0));
        objj_msgSend(_titleField, "setTextColor:", objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_titleField, "setTextShadowColor:", objj_msgSend(CPColor, "blackColor"));
        objj_msgSend(_titleField, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
        objj_msgSend(_titleField, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_titleField, "setLineBreakMode:", CPLineBreakByTruncatingTail);
        objj_msgSend(_titleField, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(_titleField, "setStringValue:", "Untitled");
        objj_msgSend(_titleField, "sizeToFit");
        objj_msgSend(_titleField, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_titleField, "setStringValue:", "");
        objj_msgSend(_titleField, "setFrame:", CGRectMake(20.0, 3.0, CGRectGetWidth(objj_msgSend(self, "bounds")) - 40.0, CGRectGetHeight(objj_msgSend(_titleField, "frame"))));
        objj_msgSend(self, "addSubview:", _titleField);
        if (_styleMask & CPClosableWindowMask)
        {
            var closeSize = objj_msgSend(_CPHUDWindowViewCloseImage, "size");
            _closeButton = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CGRectMake(4.0, 4.0, closeSize.width, closeSize.height));
            objj_msgSend(_closeButton, "setBordered:", NO);
            objj_msgSend(_closeButton, "setImage:", _CPHUDWindowViewCloseImage);
            objj_msgSend(_closeButton, "setAlternateImage:", _CPHUDWindowViewCloseActiveImage);
            objj_msgSend(self, "addSubview:", _closeButton);
        }
        objj_msgSend(self, "setResizeIndicatorOffset:", CGSizeMake(5.0, 5.0));
    }
    return self;
}
}), new objj_method(sel_getUid("viewDidMoveToWindow"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_closeButton, "setTarget:", objj_msgSend(self, "window"));
    objj_msgSend(_closeButton, "setAction:", sel_getUid("performClose:"));
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    objj_msgSend(_titleField, "setStringValue:", aTitle);
}
}), new objj_method(sel_getUid("toolbarView"), function(self, _cmd)
{ with(self)
{
    return _toolbarView;
}
}), new objj_method(sel_getUid("toolbarLabelColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPColor, "whiteColor");
}
}), new objj_method(sel_getUid("toolbarLabelShadowColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPColor, "blackColor");
}
}), new objj_method(sel_getUid("toolbarOffset"), function(self, _cmd)
{ with(self)
{
    return CGSizeMake(0.0, HUD_TITLEBAR_HEIGHT);
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPHUDWindowView").super_class }, "tile");
    var theWindow = objj_msgSend(self, "window"),
        bounds = objj_msgSend(self, "bounds"),
        width = CGRectGetWidth(bounds);
    objj_msgSend(_titleField, "setFrame:", CGRectMake(20.0, 3.0, width - 40.0, CGRectGetHeight(objj_msgSend(_titleField, "frame"))));
    var maxY = objj_msgSend(self, "toolbarMaxY");
    objj_msgSend(objj_msgSend(theWindow, "contentView"), "setFrameOrigin:", CGPointMake(0.0, maxY, width, CGRectGetHeight(bounds) - maxY));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPHUDWindowView, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", self);
    _CPHUDWindowViewBackgroundColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
        [
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground0.png"), CPSizeMake(6.0, 78.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground1.png"), CPSizeMake(1.0, 78.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground2.png"), CPSizeMake(6.0, 78.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground3.png"), CPSizeMake(6.0, 1.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground4.png"), CPSizeMake(5.0, 5.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground5.png"), CPSizeMake(6.0, 1.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground6.png"), CPSizeMake(6.0, 6.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground7.png"), CPSizeMake(6.0, 6.0)),
            objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/HUD/CPWindowHUDBackground8.png"), CPSizeMake(6.0, 6.0))
        ]));
    _CPHUDWindowViewCloseImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "HUDTheme/WindowClose.png"), CPSizeMake(20.0, 20.0));
    _CPHUDWindowViewCloseActiveImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "HUDTheme/WindowCloseActive.png"), CPSizeMake(20.0, 20.0));
}
}), new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    var contentRect = CGRectMakeCopy(aFrameRect),
        titleBarHeight = HUD_TITLEBAR_HEIGHT;
    contentRect.origin.y += titleBarHeight;
    contentRect.size.height -= titleBarHeight;
    return contentRect;
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    var frameRect = CGRectMakeCopy(aContentRect),
        titleBarHeight = HUD_TITLEBAR_HEIGHT;
    frameRect.origin.y -= titleBarHeight;
    frameRect.size.height += titleBarHeight;
    return frameRect;
}
})]);
}

p;23;_CPStandardWindowView.jt;16395;@STATIC;1.0;i;15;_CPWindowView.jt;16355;objj_executeFile("_CPWindowView.j", true);
var GRADIENT_HEIGHT = 41.0;
var _CPTexturedWindowHeadGradientColor = nil,
    _CPTexturedWindowHeadSolidColor = nil;
{var the_class = objj_allocateClassPair(CPView, "_CPTexturedWindowHeadView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_gradientView"), new objj_ivar("_solidView"), new objj_ivar("_dividerView")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPTexturedWindowHeadView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        var theClass = objj_msgSend(self, "class"),
            bounds = objj_msgSend(self, "bounds");
        _gradientView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, CGRectGetWidth(bounds), GRADIENT_HEIGHT));
        objj_msgSend(_gradientView, "setBackgroundColor:", objj_msgSend(theClass, "gradientColor"));
        objj_msgSend(self, "addSubview:", _gradientView);
        _solidView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, GRADIENT_HEIGHT, CGRectGetWidth(bounds), CGRectGetHeight(bounds) - GRADIENT_HEIGHT));
        objj_msgSend(_solidView, "setBackgroundColor:", objj_msgSend(theClass, "solidColor"));
        objj_msgSend(self, "addSubview:", _solidView);
    }
    return self;
}
}), new objj_method(sel_getUid("resizeSubviewsWithOldSize:"), function(self, _cmd, aSize)
{ with(self)
{
    var bounds = objj_msgSend(self, "bounds");
    objj_msgSend(_gradientView, "setFrameSize:", CGSizeMake(CGRectGetWidth(bounds), GRADIENT_HEIGHT));
    objj_msgSend(_solidView, "setFrameSize:", CGSizeMake(CGRectGetWidth(bounds), CGRectGetHeight(bounds) - GRADIENT_HEIGHT));
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("gradientColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPTexturedWindowHeadGradientColor)
    {
        var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(_CPWindowView, "class"));
        _CPTexturedWindowHeadGradientColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPThreePartImage, "alloc"), "initWithImageSlices:isVertical:", 
            [
                objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardTop0.png"), CGSizeMake(6.0, 41.0)),
                objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardTop1.png"), CGSizeMake(1.0, 41.0)),
                objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardTop2.png"), CGSizeMake(6.0, 41.0))
            ], NO
        ));
    }
    return _CPTexturedWindowHeadGradientColor;
}
}), new objj_method(sel_getUid("solidColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPTexturedWindowHeadSolidColor)
        _CPTexturedWindowHeadSolidColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 195.0 / 255.0, 195.0 / 255.0, 195.0 / 255.0, 1.0);
    return _CPTexturedWindowHeadSolidColor;
}
})]);
}
var _CPStandardWindowViewBodyBackgroundColor = nil,
    _CPStandardWindowViewDividerBackgroundColor = nil,
    _CPStandardWindowViewTitleBackgroundColor = nil,
    _CPStandardWindowViewCloseButtonImage = nil,
    _CPStandardWindowViewCloseButtonHighlightedImage = nil,
    _CPStandardWindowViewCloseButtonUnsavedImage = nil,
    _CPStandardWindowViewCloseButtonUnsavedHighlightedImage = nil,
    _CPStandardWindowViewMinimizeButtonImage = nil,
    _CPStandardWindowViewMinimizeButtonHighlightedImage = nil;
var STANDARD_GRADIENT_HEIGHT = 41.0;
    STANDARD_TITLEBAR_HEIGHT = 25.0;
{var the_class = objj_allocateClassPair(_CPWindowView, "_CPStandardWindowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_headView"), new objj_ivar("_dividerView"), new objj_ivar("_bodyView"), new objj_ivar("_toolbarView"), new objj_ivar("_titleField"), new objj_ivar("_closeButton"), new objj_ivar("_minimizeButton"), new objj_ivar("_isDocumentEdited")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    var contentRect = objj_msgSend(objj_msgSend(self, "class"), "contentRectForFrameRect:", aFrameRect),
        theToolbar = objj_msgSend(objj_msgSend(self, "window"), "toolbar");
    if (objj_msgSend(theToolbar, "isVisible"))
    {
        toolbarHeight = CGRectGetHeight(objj_msgSend(objj_msgSend(theToolbar, "_toolbarView"), "frame"));
        contentRect.origin.y += toolbarHeight;
        contentRect.size.height -= toolbarHeight;
    }
    return contentRect;
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    var frameRect = objj_msgSend(objj_msgSend(self, "class"), "frameRectForContentRect:", aContentRect),
        theToolbar = objj_msgSend(objj_msgSend(self, "window"), "toolbar");
    if (objj_msgSend(theToolbar, "isVisible"))
    {
        toolbarHeight = CGRectGetHeight(objj_msgSend(objj_msgSend(theToolbar, "_toolbarView"), "frame"));
        frameRect.origin.y -= toolbarHeight;
        frameRect.size.height += toolbarHeight;
    }
    return frameRect;
}
}), new objj_method(sel_getUid("initWithFrame:styleMask:"), function(self, _cmd, aFrame, aStyleMask)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPStandardWindowView").super_class }, "initWithFrame:styleMask:", aFrame, aStyleMask);
    if (self)
    {
        var theClass = objj_msgSend(self, "class"),
            bounds = objj_msgSend(self, "bounds");
        _headView = objj_msgSend(objj_msgSend(_CPTexturedWindowHeadView, "alloc"), "initWithFrame:", CGRectMake(0.0, 0.0, CGRectGetWidth(bounds), objj_msgSend(objj_msgSend(self, "class"), "titleBarHeight")));
        objj_msgSend(_headView, "setAutoresizingMask:", CPViewWidthSizable);;
        objj_msgSend(_headView, "setHitTests:", NO);
        objj_msgSend(self, "addSubview:", _headView);
        _dividerView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, CGRectGetMaxY(objj_msgSend(_headView, "frame")), CGRectGetWidth(bounds), 1.0));
        objj_msgSend(_dividerView, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_dividerView, "setBackgroundColor:", objj_msgSend(theClass, "dividerBackgroundColor"));
        objj_msgSend(_dividerView, "setHitTests:", NO);
        objj_msgSend(self, "addSubview:", _dividerView);
        var y = CGRectGetMaxY(objj_msgSend(_dividerView, "frame"));
        _bodyView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(0.0, y, CGRectGetWidth(bounds), CGRectGetHeight(bounds) - y));
        objj_msgSend(_bodyView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
        objj_msgSend(_bodyView, "setBackgroundColor:", objj_msgSend(theClass, "bodyBackgroundColor"));
        objj_msgSend(_bodyView, "setHitTests:", NO);
        objj_msgSend(self, "addSubview:", _bodyView);
        objj_msgSend(self, "setResizeIndicatorOffset:", CGSizeMake(2.0, 2.0));
        _titleField = objj_msgSend(objj_msgSend(CPTextField, "alloc"), "initWithFrame:", CGRectMakeZero());
        objj_msgSend(_titleField, "setFont:", objj_msgSend(CPFont, "boldSystemFontOfSize:", 12.0));
        objj_msgSend(_titleField, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_titleField, "setLineBreakMode:", CPLineBreakByTruncatingTail);
        objj_msgSend(_titleField, "setAlignment:", CPCenterTextAlignment);
        objj_msgSend(_titleField, "setTextShadowColor:", objj_msgSend(CPColor, "whiteColor"));
        objj_msgSend(_titleField, "setTextShadowOffset:", CGSizeMake(0.0, 1.0));
        objj_msgSend(_titleField, "setStringValue:", "Untitled");
        objj_msgSend(_titleField, "sizeToFit");
        objj_msgSend(_titleField, "setAutoresizingMask:", CPViewWidthSizable);
        objj_msgSend(_titleField, "setStringValue:", "");
        objj_msgSend(self, "addSubview:", _titleField);
        if (_styleMask & CPClosableWindowMask)
        {
            if (!_CPStandardWindowViewCloseButtonImage)
            {
                var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPWindow, "class"));
                _CPStandardWindowViewCloseButtonImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardCloseButton.png"), CGSizeMake(16.0, 16.0));
                _CPStandardWindowViewCloseButtonHighlightedImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardCloseButtonHighlighted.png"), CGSizeMake(16.0, 16.0));
                _CPStandardWindowViewCloseButtonUnsavedImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardCloseButtonUnsaved.png"), CGSizeMake(16.0, 16.0));
                _CPStandardWindowViewCloseButtonUnsavedHighlightedImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardCloseButtonUnsavedHighlighted.png"), CGSizeMake(16.0, 16.0));
            }
            _closeButton = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CGRectMake(8.0, 7.0, 16.0, 16.0));
            objj_msgSend(_closeButton, "setBordered:", NO);
            objj_msgSend(self, "_updateCloseButton");
            objj_msgSend(self, "addSubview:", _closeButton);
        }
        if (_styleMask & CPMiniaturizableWindowMask && !objj_msgSend(CPPlatform, "isBrowser"))
        {
            if (!_CPStandardWindowViewMinimizeButtonImage)
            {
                var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPWindow, "class"));
                _CPStandardWindowViewMinimizeButtonImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardMinimizeButton.png"), CGSizeMake(16.0, 16.0));
                _CPStandardWindowViewMinimizeButtonHighlightedImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/Standard/CPWindowStandardMinimizeButtonHighlighted.png"), CGSizeMake(16.0, 16.0));
            }
            _minimizeButton = objj_msgSend(objj_msgSend(CPButton, "alloc"), "initWithFrame:", CGRectMake(27.0, 7.0, 16.0, 16.0));
            objj_msgSend(_minimizeButton, "setBordered:", NO);
            objj_msgSend(_minimizeButton, "setImage:", _CPStandardWindowViewMinimizeButtonImage);
            objj_msgSend(_minimizeButton, "setAlternateImage:", _CPStandardWindowViewMinimizeButtonHighlightedImage);
            objj_msgSend(self, "addSubview:", _minimizeButton);
        }
        objj_msgSend(self, "tile");
    }
    return self;
}
}), new objj_method(sel_getUid("viewDidMoveToWindow"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(_closeButton, "setTarget:", objj_msgSend(self, "window"));
    objj_msgSend(_closeButton, "setAction:", sel_getUid("performClose:"));
    objj_msgSend(_minimizeButton, "setTarget:", objj_msgSend(self, "window"));
    objj_msgSend(_minimizeButton, "setAction:", sel_getUid("performMiniaturize:"));
}
}), new objj_method(sel_getUid("toolbarOffset"), function(self, _cmd)
{ with(self)
{
    return CGSizeMake(0.0, objj_msgSend(objj_msgSend(self, "class"), "titleBarHeight"));
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPStandardWindowView").super_class }, "tile");
    var theWindow = objj_msgSend(self, "window"),
        bounds = objj_msgSend(self, "bounds"),
        width = CGRectGetWidth(bounds);
    objj_msgSend(_headView, "setFrameSize:", CGSizeMake(width, objj_msgSend(self, "toolbarMaxY")));
    objj_msgSend(_dividerView, "setFrame:", CGRectMake(0.0, CGRectGetMaxY(objj_msgSend(_headView, "frame")), width, 1.0));
    var dividerMaxY = CGRectGetMaxY(objj_msgSend(_dividerView, "frame"));
    objj_msgSend(_bodyView, "setFrame:", CGRectMake(0.0, dividerMaxY, width, CGRectGetHeight(bounds) - dividerMaxY));
    var leftOffset = 8;
    if (_closeButton)
        leftOffset += 19.0;
    if (_minimizeButton)
        leftOffset += 19.0;
    objj_msgSend(_titleField, "setFrame:", CGRectMake(leftOffset, 5.0, width - leftOffset*2.0, CGRectGetHeight(objj_msgSend(_titleField, "frame"))));
    objj_msgSend(objj_msgSend(theWindow, "contentView"), "setFrameOrigin:", CGPointMake(0.0, CGRectGetMaxY(objj_msgSend(_dividerView, "frame"))));
}
}), new objj_method(sel_getUid("_updateCloseButton"), function(self, _cmd)
{ with(self)
{
    if (_isDocumentEdited)
    {
        objj_msgSend(_closeButton, "setImage:", _CPStandardWindowViewCloseButtonUnsavedImage);
        objj_msgSend(_closeButton, "setAlternateImage:", _CPStandardWindowViewCloseButtonUnsavedHighlightedImage);
    }
    else
    {
        objj_msgSend(_closeButton, "setImage:", _CPStandardWindowViewCloseButtonImage);
        objj_msgSend(_closeButton, "setAlternateImage:", _CPStandardWindowViewCloseButtonHighlightedImage);
    }
}
}), new objj_method(sel_getUid("setDocumentEdited:"), function(self, _cmd, isEdited)
{ with(self)
{
    _isDocumentEdited = isEdited;
    objj_msgSend(self, "_updateCloseButton");
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    objj_msgSend(_titleField, "setStringValue:", aTitle);
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (CGRectContainsPoint(objj_msgSend(_headView, "frame"), objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil)))
        return objj_msgSend(self, "trackMoveWithEvent:", anEvent);
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPStandardWindowView").super_class }, "mouseDown:", anEvent);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("bodyBackgroundColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPStandardWindowViewBodyBackgroundColor)
        _CPStandardWindowViewBodyBackgroundColor = objj_msgSend(CPColor, "colorWithWhite:alpha:", 0.96, 1.0);
    return _CPStandardWindowViewBodyBackgroundColor;
}
}), new objj_method(sel_getUid("dividerBackgroundColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPStandardWindowViewDividerBackgroundColor)
        _CPStandardWindowViewDividerBackgroundColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 125.0 / 255.0, 125.0 / 255.0, 125.0 / 255.0, 1.0);
    return _CPStandardWindowViewDividerBackgroundColor;
}
}), new objj_method(sel_getUid("titleColor"), function(self, _cmd)
{ with(self)
{
    if (!_CPStandardWindowViewTitleBackgroundColor)
        _CPStandardWindowViewTitleBackgroundColor = objj_msgSend(CPColor, "colorWithCalibratedRed:green:blue:alpha:", 44.0 / 255.0, 44.0 / 255.0, 44.0 / 255.0, 1.0);
    return _CPStandardWindowViewTitleBackgroundColor;
}
}), new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    var contentRect = CGRectMakeCopy(aFrameRect),
        titleBarHeight = objj_msgSend(self, "titleBarHeight") + 1.0;
    contentRect.origin.y += titleBarHeight;
    contentRect.size.height -= titleBarHeight;
    return contentRect;
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    var frameRect = CGRectMakeCopy(aContentRect),
        titleBarHeight = objj_msgSend(self, "titleBarHeight") + 1.0;
    frameRect.origin.y -= titleBarHeight;
    frameRect.size.height += titleBarHeight;
    return frameRect;
}
}), new objj_method(sel_getUid("titleBarHeight"), function(self, _cmd)
{ with(self)
{
    return STANDARD_TITLEBAR_HEIGHT;
}
})]);
}

p;15;_CPWindowView.jt;11882;@STATIC;1.0;i;8;CPView.ji;13;CPImageView.jt;11832;objj_executeFile("CPView.j", true);
objj_executeFile("CPImageView.j", true);
var _CPWindowViewResizeIndicatorImage = nil;
{var the_class = objj_allocateClassPair(CPView, "_CPWindowView"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_styleMask"), new objj_ivar("_resizeIndicator"), new objj_ivar("_resizeIndicatorOffset"), new objj_ivar("_toolbarView"), new objj_ivar("_resizeFrame"), new objj_ivar("_mouseDraggedPoint"), new objj_ivar("_cachedScreenFrame")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "class"), "contentRectForFrameRect:", aFrameRect);
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "class"), "frameRectForContentRect:", aContentRect);
}
}), new objj_method(sel_getUid("initWithFrame:styleMask:"), function(self, _cmd, aFrame, aStyleMask)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPWindowView").super_class }, "initWithFrame:", aFrame);
    if (self)
    {
        _styleMask = aStyleMask;
        _resizeIndicatorOffset = CGSizeMake(0.0, 0.0);
        _toolbarOffset = CGSizeMake(0.0, 0.0);
    }
    return self;
}
}), new objj_method(sel_getUid("setDocumentEdited:"), function(self, _cmd, isEdited)
{ with(self)
{
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
}
}), new objj_method(sel_getUid("acceptsFirstMouse:"), function(self, _cmd, anEvent)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("mouseDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    var theWindow = objj_msgSend(self, "window");
    if ((_styleMask & CPResizableWindowMask) && _resizeIndicator)
    {
        var frame = objj_msgSend(_resizeIndicator, "frame");
        if (CGRectContainsPoint(frame, objj_msgSend(self, "convertPoint:fromView:", objj_msgSend(anEvent, "locationInWindow"), nil)))
            return objj_msgSend(self, "trackResizeWithEvent:", anEvent);
    }
    if (objj_msgSend(theWindow, "isMovableByWindowBackground"))
        objj_msgSend(self, "trackMoveWithEvent:", anEvent);
    else
        objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPWindowView").super_class }, "mouseDown:", anEvent);
}
}), new objj_method(sel_getUid("trackResizeWithEvent:"), function(self, _cmd, anEvent)
{ with(self)
{
    var location = objj_msgSend(anEvent, "locationInWindow"),
        type = objj_msgSend(anEvent, "type");
    if (type === CPLeftMouseUp)
        return;
    var theWindow = objj_msgSend(self, "window");
    if (type === CPLeftMouseDown)
    {
        var frame = objj_msgSend(theWindow, "frame");
        _resizeFrame = CGRectMake(location.x, location.y, CGRectGetWidth(frame), CGRectGetHeight(frame));
    }
    else if (type === CPLeftMouseDragged)
    {
     var newSize = CGSizeMake(CGRectGetWidth(_resizeFrame) + location.x - CGRectGetMinX(_resizeFrame), CGRectGetHeight(_resizeFrame) + location.y - CGRectGetMinY(_resizeFrame));
        if (theWindow._isSheet && theWindow._parentView && (theWindow._frame.size.width !== newSize.width))
     objj_msgSend(theWindow._parentView, "_setAttachedSheetFrameOrigin");
  objj_msgSend(theWindow, "setFrameSize:", newSize);
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackResizeWithEvent:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("_pointWithinScreenFrame:"), function(self, _cmd, aPoint)
{ with(self)
{
    if (!objj_msgSend(CPPlatform, "isBrowser"))
        return aPoint;
    var visibleFrame = _cachedScreenFrame;
    if (!visibleFrame)
        visibleFrame = objj_msgSend(objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"), "visibleFrame");
    var minPointY = 0;
    if(objj_msgSend(CPMenu, "menuBarVisible"))
        minPointY = objj_msgSend(objj_msgSend(CPApp, "mainMenu"), "menuBarHeight");
    var restrictedPoint = CGPointMake(0, 0);
    restrictedPoint.x = MIN(MAX(aPoint.x, -_frame.size.width + 4.0), CGRectGetMaxX(visibleFrame) - 4.0);
    restrictedPoint.y = MIN(MAX(aPoint.y, minPointY), CGRectGetMaxY(visibleFrame) - 8.0);
    return restrictedPoint;
}
}), new objj_method(sel_getUid("trackMoveWithEvent:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type");
    if (type === CPLeftMouseUp)
    {
        _cachedScreenFrame = nil;
        return;
    }
    else if (type === CPLeftMouseDown)
    {
        _mouseDraggedPoint = objj_msgSend(objj_msgSend(self, "window"), "convertBaseToGlobal:", objj_msgSend(anEvent, "locationInWindow"));
        _cachedScreenFrame = objj_msgSend(objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"), "visibleFrame");
    }
    else if (type === CPLeftMouseDragged)
    {
        var theWindow = objj_msgSend(self, "window"),
            frame = objj_msgSend(theWindow, "frame"),
            location = objj_msgSend(theWindow, "convertBaseToGlobal:", objj_msgSend(anEvent, "locationInWindow")),
            origin = objj_msgSend(self, "_pointWithinScreenFrame:", CGPointMake((frame.origin.x) + (location.x - _mouseDraggedPoint.x),
                                                               (frame.origin.y) + (location.y - _mouseDraggedPoint.y)));
        objj_msgSend(theWindow, "setFrameOrigin:", origin);
        _mouseDraggedPoint = objj_msgSend(self, "_pointWithinScreenFrame:", location);
    }
    objj_msgSend(CPApp, "setTarget:selector:forNextEventMatchingMask:untilDate:inMode:dequeue:", self, sel_getUid("trackMoveWithEvent:"), CPLeftMouseDraggedMask | CPLeftMouseUpMask, nil, nil, YES);
}
}), new objj_method(sel_getUid("setShowsResizeIndicator:"), function(self, _cmd, shouldShowResizeIndicator)
{ with(self)
{
    if (shouldShowResizeIndicator)
    {
        var size = objj_msgSend(_CPWindowViewResizeIndicatorImage, "size"),
            boundsSize = objj_msgSend(self, "frame").size;
        _resizeIndicator = objj_msgSend(objj_msgSend(CPImageView, "alloc"), "initWithFrame:", CGRectMake(boundsSize.width - size.width - _resizeIndicatorOffset.width, boundsSize.height - size.height - _resizeIndicatorOffset.height, size.width, size.height));
        objj_msgSend(_resizeIndicator, "setImage:", _CPWindowViewResizeIndicatorImage);
        objj_msgSend(_resizeIndicator, "setAutoresizingMask:", CPViewMinXMargin | CPViewMinYMargin);
        objj_msgSend(self, "addSubview:", _resizeIndicator);
    }
    else
    {
        objj_msgSend(_resizeIndicator, "removeFromSuperview");
        _resizeIndicator = nil;
    }
}
}), new objj_method(sel_getUid("showsResizeIndicator"), function(self, _cmd)
{ with(self)
{
    return _resizeIndicator !== nil;
}
}), new objj_method(sel_getUid("setResizeIndicatorOffset:"), function(self, _cmd, anOffset)
{ with(self)
{
    if (CGSizeEqualToSize(_resizeIndicatorOffset, anOffset))
        return;
    _resizeIndicatorOffset = anOffset;
    if (!_resizeIndicator)
        return;
    var size = objj_msgSend(_resizeIndicator, "frame").size,
        boundsSize = objj_msgSend(self, "frame").size;
    objj_msgSend(_resizeIndicator, "setFrameOrigin:", CGPointMake(boundsSize.width - size.width - anOffset.width, boundsSize.height - size.height - anOffset.height));
}
}), new objj_method(sel_getUid("resizeIndicatorOffset"), function(self, _cmd)
{ with(self)
{
    return _resizeIndicatorOffset;
}
}), new objj_method(sel_getUid("windowDidChangeDocumentEdited"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("windowDidChangeDocumentSaving"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("showsToolbar"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("toolbarOffset"), function(self, _cmd)
{ with(self)
{
    return CGSizeMakeZero();
}
}), new objj_method(sel_getUid("toolbarLabelColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPColor, "blackColor");
}
}), new objj_method(sel_getUid("toolbarMaxY"), function(self, _cmd)
{ with(self)
{
    if (!_toolbarView || objj_msgSend(_toolbarView, "isHidden"))
        return objj_msgSend(self, "toolbarOffset").height;
    return CGRectGetMaxY(objj_msgSend(_toolbarView, "frame"));
}
}), new objj_method(sel_getUid("toolbarView"), function(self, _cmd)
{ with(self)
{
    return _toolbarView;
}
}), new objj_method(sel_getUid("tile"), function(self, _cmd)
{ with(self)
{
    var theWindow = objj_msgSend(self, "window"),
        bounds = objj_msgSend(self, "bounds"),
        width = CGRectGetWidth(bounds);
    if (objj_msgSend(objj_msgSend(theWindow, "toolbar"), "isVisible"))
    {
        var toolbarView = objj_msgSend(self, "toolbarView"),
            toolbarOffset = objj_msgSend(self, "toolbarOffset");
        objj_msgSend(toolbarView, "setFrame:", CGRectMake(toolbarOffset.width, toolbarOffset.height, width, CGRectGetHeight(objj_msgSend(toolbarView, "frame"))));
    }
    if (objj_msgSend(self, "showsResizeIndicator"))
    {
        var size = objj_msgSend(_resizeIndicator, "frame").size,
            boundsSize = objj_msgSend(self, "bounds").size;
        objj_msgSend(_resizeIndicator, "setFrameOrigin:", CGPointMake(boundsSize.width - size.width - _resizeIndicatorOffset.width, boundsSize.height - size.height - _resizeIndicatorOffset.height));
    }
}
}), new objj_method(sel_getUid("noteToolbarChanged"), function(self, _cmd)
{ with(self)
{
    var theWindow = objj_msgSend(self, "window"),
        toolbar = objj_msgSend(theWindow, "toolbar"),
        toolbarView = objj_msgSend(toolbar, "_toolbarView");
    if (_toolbarView !== toolbarView)
    {
        objj_msgSend(_toolbarView, "removeFromSuperview");
        if (toolbarView)
        {
            objj_msgSend(toolbarView, "removeFromSuperview");
            objj_msgSend(toolbarView, "FIXME_setIsHUD:", _styleMask & CPHUDBackgroundWindowMask);
            objj_msgSend(self, "addSubview:", toolbarView);
        }
        _toolbarView = toolbarView;
    }
    objj_msgSend(toolbarView, "setHidden:", !objj_msgSend(self, "showsToolbar") || !objj_msgSend(toolbar, "isVisible"));
    if (theWindow)
    {
        var contentRect = objj_msgSend(self, "convertRect:toView:", objj_msgSend(objj_msgSend(theWindow, "contentView"), "frame"), nil);
        contentRect.origin = objj_msgSend(theWindow, "convertBaseToGlobal:", contentRect.origin);
        objj_msgSend(self, "setAutoresizesSubviews:", NO);
        objj_msgSend(theWindow, "setFrame:", objj_msgSend(theWindow, "frameRectForContentRect:", contentRect));
        objj_msgSend(self, "setAutoresizesSubviews:", YES);
    }
    objj_msgSend(self, "tile");
}
}), new objj_method(sel_getUid("didAddSubview:"), function(self, _cmd, aView)
{ with(self)
{
    if (!_resizeIndicator || aView === _resizeIndicator)
        return;
    objj_msgSend(self, "addSubview:", _resizeIndicator);
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(_CPWindowView, "class"))
        return;
    _CPWindowViewResizeIndicatorImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPWindow, "class")), "pathForResource:", "_CPWindowView/_CPWindowViewResizeIndicator.png"), CGSizeMake(12.0, 12.0));
}
}), new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrameRect)
{ with(self)
{
    return CGRectMakeCopy(aFrameRect);
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    return CGRectMakeCopy(aContentRect);
}
})]);
}

p;10;CPWindow.jt;71005;@STATIC;1.0;I;25;Foundation/CPCountedSet.jI;33;Foundation/CPNotificationCenter.jI;26;Foundation/CPUndoManager.ji;12;CGGeometry.ji;13;CPAnimation.ji;13;CPResponder.ji;10;CPScreen.ji;18;CPPlatformWindow.ji;15;_CPWindowView.ji;23;_CPStandardWindowView.ji;23;_CPDocModalWindowView.ji;18;_CPHUDWindowView.ji;25;_CPBorderlessWindowView.ji;31;_CPBorderlessBridgeWindowView.ji;14;CPDragServer.ji;8;CPView.jt;70599;objj_executeFile("Foundation/CPCountedSet.j", false);
objj_executeFile("Foundation/CPNotificationCenter.j", false);
objj_executeFile("Foundation/CPUndoManager.j", false);
objj_executeFile("CGGeometry.j", true);
objj_executeFile("CPAnimation.j", true);
objj_executeFile("CPResponder.j", true);
objj_executeFile("CPScreen.j", true);
objj_executeFile("CPPlatformWindow.j", true);
CPBorderlessWindowMask = 0;
CPTitledWindowMask = 1 << 0;
CPClosableWindowMask = 1 << 1;
CPMiniaturizableWindowMask = 1 << 2;
CPResizableWindowMask = 1 << 3;
CPTexturedBackgroundWindowMask = 1 << 8;
CPBorderlessBridgeWindowMask = 1 << 20;
CPHUDBackgroundWindowMask = 1 << 21;
CPWindowNotSizable = 0;
CPWindowMinXMargin = 1;
CPWindowWidthSizable = 2;
CPWindowMaxXMargin = 4;
CPWindowMinYMargin = 8;
CPWindowHeightSizable = 16;
CPWindowMaxYMargin = 32;
CPBackgroundWindowLevel = -1;
CPNormalWindowLevel = 0;
CPFloatingWindowLevel = 3;
CPSubmenuWindowLevel = 3;
CPTornOffMenuWindowLevel = 3;
CPMainMenuWindowLevel = 24;
CPStatusWindowLevel = 25;
CPModalPanelWindowLevel = 8;
CPPopUpMenuWindowLevel = 101;
CPDraggingWindowLevel = 500;
CPScreenSaverWindowLevel = 1000;
CPWindowOut = 0;
CPWindowAbove = 1;
CPWindowBelow = 2;
CPWindowWillCloseNotification = "CPWindowWillCloseNotification";
CPWindowDidBecomeMainNotification = "CPWindowDidBecomeMainNotification";
CPWindowDidResignMainNotification = "CPWindowDidResignMainNotification";
CPWindowDidResizeNotification = "CPWindowDidResizeNotification";
CPWindowDidMoveNotification = "CPWindowDidMoveNotification";
CPWindowWillBeginSheetNotification = "CPWindowWillBeginSheetNotification";
CPWindowDidEndSheetNotification = "CPWindowDidEndSheetNotification";
CPWindowDidMiniaturizeNotification = "CPWindowDidMiniaturizeNotification";
CPWindowWillMiniaturizeNotification = "CPWindowWillMiniaturizeNotification";
CPWindowDidDeminiaturizeNotification = "CPWindowDidDeminiaturizeNotification";
CPWindowShadowStyleStandard = 0;
CPWindowShadowStyleMenu = 1;
CPWindowShadowStylePanel = 2;
var SHADOW_MARGIN_LEFT = 20.0,
    SHADOW_MARGIN_RIGHT = 19.0,
    SHADOW_MARGIN_TOP = 10.0,
    SHADOW_MARGIN_BOTTOM = 10.0,
    SHADOW_DISTANCE = 5.0,
    _CPWindowShadowColor = nil;
var CPWindowSaveImage = nil,
    CPWindowSavingImage = nil;
{var the_class = objj_allocateClassPair(CPResponder, "CPWindow"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_platformWindow"), new objj_ivar("_windowNumber"), new objj_ivar("_styleMask"), new objj_ivar("_frame"), new objj_ivar("_level"), new objj_ivar("_isVisible"), new objj_ivar("_isMiniaturized"), new objj_ivar("_isAnimating"), new objj_ivar("_hasShadow"), new objj_ivar("_isMovableByWindowBackground"), new objj_ivar("_shadowStyle"), new objj_ivar("_showsResizeIndicator"), new objj_ivar("_isDocumentEdited"), new objj_ivar("_isDocumentSaving"), new objj_ivar("_shadowView"), new objj_ivar("_windowView"), new objj_ivar("_contentView"), new objj_ivar("_toolbarView"), new objj_ivar("_mouseEnteredStack"), new objj_ivar("_leftMouseDownView"), new objj_ivar("_rightMouseDownView"), new objj_ivar("_toolbar"), new objj_ivar("_firstResponder"), new objj_ivar("_initialFirstResponder"), new objj_ivar("_delegate"), new objj_ivar("_title"), new objj_ivar("_acceptsMouseMovedEvents"), new objj_ivar("_ignoresMouseEvents"), new objj_ivar("_windowController"), new objj_ivar("_minSize"), new objj_ivar("_maxSize"), new objj_ivar("_undoManager"), new objj_ivar("_representedURL"), new objj_ivar("_registeredDraggedTypes"), new objj_ivar("_registeredDraggedTypesArray"), new objj_ivar("_inclusiveRegisteredDraggedTypes"), new objj_ivar("_defaultButton"), new objj_ivar("_defaultButtonEnabled"), new objj_ivar("_autorecalculatesKeyViewLoop"), new objj_ivar("_keyViewLoopIsDirty"), new objj_ivar("_sharesChromeWithPlatformWindow"), new objj_ivar("_DOMElement"), new objj_ivar("_autoresizingMask"), new objj_ivar("_delegateRespondsToWindowWillReturnUndoManagerSelector"), new objj_ivar("_isFullPlatformWindow"), new objj_ivar("_fullPlatformWindowSession"), new objj_ivar("_sheetContext"), new objj_ivar("_parentView"), new objj_ivar("_isSheet")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithContentRect:styleMask:", { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } }, CPTitledWindowMask);
}
}), new objj_method(sel_getUid("initWithContentRect:styleMask:"), function(self, _cmd, aContentRect, aStyleMask)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWindow").super_class }, "init");
    if (self)
    {
        var windowViewClass = objj_msgSend(objj_msgSend(self, "class"), "_windowViewClassForStyleMask:", aStyleMask);
        _frame = objj_msgSend(windowViewClass, "frameRectForContentRect:", aContentRect);
        objj_msgSend(self, "_setSharesChromeWithPlatformWindow:", !objj_msgSend(CPPlatform, "isBrowser"));
        if (objj_msgSend(CPPlatform, "isBrowser"))
            objj_msgSend(self, "setPlatformWindow:", objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"));
        else
        {
            objj_msgSend(self, "setPlatformWindow:", objj_msgSend(objj_msgSend(CPPlatformWindow, "alloc"), "initWithContentRect:", _frame));
            objj_msgSend(self, "platformWindow")._only = self;
        }
        _isFullPlatformWindow = NO;
        _registeredDraggedTypes = objj_msgSend(CPSet, "set");
        _registeredDraggedTypesArray = [];
        _isSheet = NO;
        _windowNumber = objj_msgSend(CPApp._windows, "count");
        CPApp._windows[_windowNumber] = self;
        _styleMask = aStyleMask;
        objj_msgSend(self, "setLevel:", CPNormalWindowLevel);
        _minSize = CGSizeMake(0.0, 0.0);
        _maxSize = CGSizeMake(1000000.0, 1000000.0);
        _windowView = objj_msgSend(objj_msgSend(windowViewClass, "alloc"), "initWithFrame:styleMask:", CGRectMake(0.0, 0.0, CGRectGetWidth(_frame), CGRectGetHeight(_frame)), aStyleMask);
        objj_msgSend(_windowView, "_setWindow:", self);
        objj_msgSend(_windowView, "setNextResponder:", self);
        objj_msgSend(self, "setMovableByWindowBackground:", aStyleMask & CPHUDBackgroundWindowMask);
        objj_msgSend(self, "setContentView:", objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMakeZero()));
        _firstResponder = self;
        _DOMElement = document.createElement("div");
        _DOMElement.style.position = "absolute";
        _DOMElement.style.visibility = "visible";
        _DOMElement.style.zIndex = 0;
        if (!objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
        {
            if (NULL) var ____p = _CGPointApplyAffineTransform(CGPointMake((_frame.origin.x), (_frame.origin.y)), NULL); else var ____p = { x:(_frame.origin.x), y:(_frame.origin.y) }; _DOMElement.style.left = ROUND(____p.x) + "px";_DOMElement.style.top = ROUND(____p.y) + "px";;
        }
        _DOMElement.style.width = MAX(0.0, ROUND(1)) + "px"; _DOMElement.style.height = MAX(0.0, ROUND(1)) + "px";;
        _DOMElement.appendChild(_windowView._DOMElement);
        objj_msgSend(self, "setNextResponder:", CPApp);
        objj_msgSend(self, "setHasShadow:", aStyleMask !== CPBorderlessWindowMask);
        if (aStyleMask & CPBorderlessBridgeWindowMask)
            objj_msgSend(self, "setFullPlatformWindow:", YES);
        _defaultButtonEnabled = YES;
        _keyViewLoopIsDirty = YES;
        objj_msgSend(self, "setShowsResizeIndicator:", _styleMask & CPResizableWindowMask);
    }
    return self;
}
}), new objj_method(sel_getUid("platformWindow"), function(self, _cmd)
{ with(self)
{
    return _platformWindow;
}
}), new objj_method(sel_getUid("setPlatformWindow:"), function(self, _cmd, aPlatformWindow)
{ with(self)
{
    _platformWindow = aPlatformWindow;
}
}), new objj_method(sel_getUid("awakeFromCib"), function(self, _cmd)
{ with(self)
{
    if (_initialFirstResponder)
        objj_msgSend(self, "makeFirstResponder:", _initialFirstResponder);
    _keyViewLoopIsDirty = !objj_msgSend(self, "_hasKeyViewLoop");
}
}), new objj_method(sel_getUid("_setWindowView:"), function(self, _cmd, aWindowView)
{ with(self)
{
    if (_windowView === aWindowView)
        return;
    var oldWindowView = _windowView;
    _windowView = aWindowView;
    if (oldWindowView)
    {
        objj_msgSend(oldWindowView, "_setWindow:", nil);
        objj_msgSend(oldWindowView, "noteToolbarChanged");
        _DOMElement.removeChild(oldWindowView._DOMElement);
    }
    if (_windowView)
    {
        _DOMElement.appendChild(_windowView._DOMElement);
        var contentRect = objj_msgSend(_contentView, "convertRect:toView:", objj_msgSend(_contentView, "bounds"), nil);
        contentRect.origin = objj_msgSend(self, "convertBaseToGlobal:", contentRect.origin);
        objj_msgSend(_windowView, "_setWindow:", self);
        objj_msgSend(_windowView, "setNextResponder:", self);
        objj_msgSend(_windowView, "addSubview:", _contentView);
        objj_msgSend(_windowView, "setTitle:", _title);
        objj_msgSend(_windowView, "noteToolbarChanged");
        objj_msgSend(_windowView, "setShowsResizeIndicator:", objj_msgSend(self, "showsResizeIndicator"));
        objj_msgSend(self, "setFrame:", objj_msgSend(self, "frameRectForContentRect:", contentRect));
    }
}
}), new objj_method(sel_getUid("setFullPlatformWindow:"), function(self, _cmd, shouldBeFullPlatformWindow)
{ with(self)
{
    if (!objj_msgSend(_platformWindow, "supportsFullPlatformWindows"))
        return;
    shouldBeFullPlatformWindow = !!shouldBeFullPlatformWindow;
    if (_isFullPlatformWindow === shouldBeFullPlatformWindow)
        return;
    _isFullPlatformWindow = shouldBeFullPlatformWindow;
    if (_isFullPlatformWindow)
    {
        _fullPlatformWindowSession = _CPWindowFullPlatformWindowSessionMake(_windowView, objj_msgSend(self, "contentRectForFrameRect:", objj_msgSend(self, "frame")), objj_msgSend(self, "hasShadow"), objj_msgSend(self, "level"));
        var fullPlatformWindowViewClass = objj_msgSend(objj_msgSend(self, "class"), "_windowViewClassForFullPlatformWindowStyleMask:", _styleMask),
            windowView = objj_msgSend(objj_msgSend(fullPlatformWindowViewClass, "alloc"), "initWithFrame:styleMask:", CGRectMakeZero(), _styleMask);
        objj_msgSend(self, "_setWindowView:", windowView);
        objj_msgSend(self, "setLevel:", CPBackgroundWindowLevel);
        objj_msgSend(self, "setHasShadow:", NO);
        objj_msgSend(self, "setAutoresizingMask:", CPWindowWidthSizable | CPWindowHeightSizable);
        objj_msgSend(self, "setFrame:", objj_msgSend(_platformWindow, "visibleFrame"));
    }
    else
    {
        var windowView = _fullPlatformWindowSession.windowView;
        objj_msgSend(self, "_setWindowView:", windowView);
        objj_msgSend(self, "setLevel:", _fullPlatformWindowSession.level);
        objj_msgSend(self, "setHasShadow:", _fullPlatformWindowSession.hasShadow);
        objj_msgSend(self, "setAutoresizingMask:", CPWindowNotSizable);
        objj_msgSend(self, "setFrame:", objj_msgSend(windowView, "frameRectForContentRect:", _fullPlatformWindowSession.contentRect));
    }
}
}), new objj_method(sel_getUid("isFullPlatformWindow"), function(self, _cmd)
{ with(self)
{
    return _isFullPlatformWindow;
}
}), new objj_method(sel_getUid("styleMask"), function(self, _cmd)
{ with(self)
{
    return _styleMask;
}
}), new objj_method(sel_getUid("contentRectForFrameRect:"), function(self, _cmd, aFrame)
{ with(self)
{
    return objj_msgSend(_windowView, "contentRectForFrameRect:", aFrame);
}
}), new objj_method(sel_getUid("frameRectForContentRect:"), function(self, _cmd, aContentRect)
{ with(self)
{
    return objj_msgSend(_windowView, "frameRectForContentRect:", aContentRect);
}
}), new objj_method(sel_getUid("frame"), function(self, _cmd)
{ with(self)
{
    return { origin: { x:_frame.origin.x, y:_frame.origin.y }, size: { width:_frame.size.width, height:_frame.size.height } };
}
}), new objj_method(sel_getUid("_setClippedFrame:display:animate:"), function(self, _cmd, aFrame, shouldDisplay, shouldAnimate)
{ with(self)
{
    aFrame.size.width = MIN(MAX(aFrame.size.width, _minSize.width), _maxSize.width)
    aFrame.size.height = MIN(MAX(aFrame.size.height, _minSize.height), _maxSize.height);
    objj_msgSend(self, "setFrame:display:animate:", aFrame, shouldDisplay, shouldAnimate);
}
}), new objj_method(sel_getUid("setFrame:display:animate:"), function(self, _cmd, aFrame, shouldDisplay, shouldAnimate)
{ with(self)
{
    aFrame = { origin: { x:aFrame.origin.x, y:aFrame.origin.y }, size: { width:aFrame.size.width, height:aFrame.size.height } };
    var value = aFrame.origin.x,
        delta = value - FLOOR(value);
    if (delta)
        aFrame.origin.x = value > 0.879 ? CEIL(value) : FLOOR(value);
    value = aFrame.origin.y;
    delta = value - FLOOR(value);
    if (delta)
        aFrame.origin.y = value > 0.879 ? CEIL(value) : FLOOR(value);
    value = aFrame.size.width;
    delta = value - FLOOR(value);
    if (delta)
        aFrame.size.width = value > 0.15 ? CEIL(value) : FLOOR(value);
    value = aFrame.size.height;
    delta = value - FLOOR(value);
    if (delta)
        aFrame.size.height = value > 0.15 ? CEIL(value) : FLOOR(value);
    if (shouldAnimate)
    {
        var animation = objj_msgSend(objj_msgSend(_CPWindowFrameAnimation, "alloc"), "initWithWindow:targetFrame:", self, aFrame);
        objj_msgSend(animation, "startAnimation");
    }
    else
    {
        var origin = _frame.origin,
            newOrigin = aFrame.origin;
        if (!(origin.x == newOrigin.x && origin.y == newOrigin.y))
        {
            origin.x = newOrigin.x;
            origin.y = newOrigin.y;
            if (!objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
            {
                if (NULL) var ____p = _CGPointApplyAffineTransform(CGPointMake(origin.x, origin.y), NULL); else var ____p = { x:origin.x, y:origin.y }; _DOMElement.style.left = ROUND(____p.x) + "px";_DOMElement.style.top = ROUND(____p.y) + "px";;
            }
            objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidMoveNotification, self);
        }
        var size = _frame.size,
            newSize = aFrame.size;
        if (!(size.width == newSize.width && size.height == newSize.height))
        {
            size.width = newSize.width;
            size.height = newSize.height;
            objj_msgSend(_windowView, "setFrameSize:", size);
            if (_hasShadow)
                objj_msgSend(_shadowView, "setFrameSize:", { width:SHADOW_MARGIN_LEFT + size.width + SHADOW_MARGIN_RIGHT, height:SHADOW_MARGIN_BOTTOM + size.height + SHADOW_MARGIN_TOP + SHADOW_DISTANCE });
            if (!_isAnimating)
                objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidResizeNotification, self);
        }
        if (objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
            objj_msgSend(_platformWindow, "setContentRect:", _frame);
    }
}
}), new objj_method(sel_getUid("setFrame:display:"), function(self, _cmd, aFrame, shouldDisplay)
{ with(self)
{
    objj_msgSend(self, "_setClippedFrame:display:animate:", aFrame, shouldDisplay, NO);
}
}), new objj_method(sel_getUid("setFrame:"), function(self, _cmd, aFrame)
{ with(self)
{
    objj_msgSend(self, "_setClippedFrame:display:animate:", aFrame, YES, NO);
}
}), new objj_method(sel_getUid("setFrameOrigin:"), function(self, _cmd, anOrigin)
{ with(self)
{
    objj_msgSend(self, "_setClippedFrame:display:animate:", { origin: { x:anOrigin.x, y:anOrigin.y }, size: { width:(_frame.size.width), height:(_frame.size.height) } }, YES, NO);
}
}), new objj_method(sel_getUid("setFrameSize:"), function(self, _cmd, aSize)
{ with(self)
{
    objj_msgSend(self, "_setClippedFrame:display:animate:", { origin: { x:(_frame.origin.x), y:(_frame.origin.y) }, size: { width:aSize.width, height:aSize.height } }, YES, NO);
}
}), new objj_method(sel_getUid("orderFront:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(_platformWindow, "orderFront:", self);
    objj_msgSend(_platformWindow, "order:window:relativeTo:", CPWindowAbove, self, nil);
}
}), new objj_method(sel_getUid("orderBack:"), function(self, _cmd, aSender)
{ with(self)
{
}
}), new objj_method(sel_getUid("orderOut:"), function(self, _cmd, aSender)
{ with(self)
{
    if (objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
        objj_msgSend(_platformWindow, "orderOut:", self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowWillClose:")))
        objj_msgSend(_delegate, "windowWillClose:", self);
    objj_msgSend(_platformWindow, "order:window:relativeTo:", CPWindowOut, self, nil);
    if (objj_msgSend(CPApp, "keyWindow") == self)
    {
        objj_msgSend(self, "resignKeyWindow");
        CPApp._keyWindow = nil;
    }
}
}), new objj_method(sel_getUid("orderWindow:relativeTo:"), function(self, _cmd, aPlace, otherWindowNumber)
{ with(self)
{
    objj_msgSend(_platformWindow, "order:window:relativeTo:", aPlace, self, CPApp._windows[otherWindowNumber]);
}
}), new objj_method(sel_getUid("setLevel:"), function(self, _cmd, aLevel)
{ with(self)
{
    _level = aLevel;
    if (objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
        objj_msgSend(_platformWindow, "setLevel:", aLevel);
}
}), new objj_method(sel_getUid("level"), function(self, _cmd)
{ with(self)
{
    return _level;
}
}), new objj_method(sel_getUid("isVisible"), function(self, _cmd)
{ with(self)
{
    return _isVisible;
}
}), new objj_method(sel_getUid("showsResizeIndicator"), function(self, _cmd)
{ with(self)
{
    return _showsResizeIndicator;
}
}), new objj_method(sel_getUid("setShowsResizeIndicator:"), function(self, _cmd, shouldShowResizeIndicator)
{ with(self)
{
    shouldShowResizeIndicator = !!shouldShowResizeIndicator;
    if (_showsResizeIndicator === shouldShowResizeIndicator)
        return;
    _showsResizeIndicator = shouldShowResizeIndicator;
    objj_msgSend(_windowView, "setShowsResizeIndicator:", objj_msgSend(self, "showsResizeIndicator"));
}
}), new objj_method(sel_getUid("resizeIndicatorOffset"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_windowView, "resizeIndicatorOffset");
}
}), new objj_method(sel_getUid("setResizeIndicatorOffset:"), function(self, _cmd, anOffset)
{ with(self)
{
    objj_msgSend(_windowView, "setResizeIndicatorOffset:", anOffset);
}
}), new objj_method(sel_getUid("setContentView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_contentView)
        objj_msgSend(_contentView, "removeFromSuperview");
    var bounds = CGRectMake(0.0, 0.0, CGRectGetWidth(_frame), CGRectGetHeight(_frame));
    _contentView = aView;
    objj_msgSend(_contentView, "setFrame:", objj_msgSend(self, "contentRectForFrameRect:", bounds));
    objj_msgSend(_contentView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
    objj_msgSend(_windowView, "addSubview:", _contentView);
}
}), new objj_method(sel_getUid("contentView"), function(self, _cmd)
{ with(self)
{
    return _contentView;
}
}), new objj_method(sel_getUid("setBackgroundColor:"), function(self, _cmd, aColor)
{ with(self)
{
    objj_msgSend(_windowView, "setBackgroundColor:", aColor);
}
}), new objj_method(sel_getUid("backgroundColor"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(_windowView, "backgroundColor");
}
}), new objj_method(sel_getUid("setMinSize:"), function(self, _cmd, aSize)
{ with(self)
{
    if (CGSizeEqualToSize(_minSize, aSize))
        return;
    _minSize = CGSizeCreateCopy(aSize);
    var size = CGSizeMakeCopy(objj_msgSend(self, "frame").size),
        needsFrameChange = NO;
    if (size.width < _minSize.width)
    {
        size.width = _minSize.width;
        needsFrameChange = YES;
    }
    if (size.height < _minSize.height)
    {
        size.height = _minSize.height;
        needsFrameChange = YES;
    }
    if (needsFrameChange)
        objj_msgSend(self, "setFrameSize:", size);
}
}), new objj_method(sel_getUid("minSize"), function(self, _cmd)
{ with(self)
{
    return _minSize;
}
}), new objj_method(sel_getUid("setMaxSize:"), function(self, _cmd, aSize)
{ with(self)
{
    if (CGSizeEqualToSize(_maxSize, aSize))
        return;
    _maxSize = CGSizeCreateCopy(aSize);
    var size = CGSizeMakeCopy(objj_msgSend(self, "frame").size),
        needsFrameChange = NO;
    if (size.width > _maxSize.width)
    {
        size.width = _maxSize.width;
        needsFrameChange = YES;
    }
    if (size.height > _maxSize.height)
    {
        size.height = _maxSize.height;
        needsFrameChange = YES;
    }
    if (needsFrameChange)
        objj_msgSend(self, "setFrameSize:", size);
}
}), new objj_method(sel_getUid("maxSize"), function(self, _cmd)
{ with(self)
{
    return _maxSize;
}
}), new objj_method(sel_getUid("hasShadow"), function(self, _cmd)
{ with(self)
{
    return _hasShadow;
}
}), new objj_method(sel_getUid("_updateShadow"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
    {
        if (_shadowView)
        {
            _DOMElement.removeChild(_shadowView._DOMElement);
            _shadowView = nil;
        }
        objj_msgSend(_platformWindow, "setHasShadow:", _hasShadow);
        return;
    }
    if (_hasShadow && !_shadowView)
    {
        var bounds = objj_msgSend(_windowView, "bounds");
        _shadowView = objj_msgSend(objj_msgSend(CPView, "alloc"), "initWithFrame:", CGRectMake(-SHADOW_MARGIN_LEFT, -SHADOW_MARGIN_TOP + SHADOW_DISTANCE,
            SHADOW_MARGIN_LEFT + CGRectGetWidth(bounds) + SHADOW_MARGIN_RIGHT, SHADOW_MARGIN_TOP + CGRectGetHeight(bounds) + SHADOW_MARGIN_BOTTOM));
        if (!_CPWindowShadowColor)
        {
            var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPWindow, "class"));
            _CPWindowShadowColor = objj_msgSend(CPColor, "colorWithPatternImage:", objj_msgSend(objj_msgSend(CPNinePartImage, "alloc"), "initWithImageSlices:", 
                [
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow0.png"), CGSizeMake(20.0, 19.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow1.png"), CGSizeMake(1.0, 19.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow2.png"), CGSizeMake(19.0, 19.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow3.png"), CGSizeMake(20.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow4.png"), CGSizeMake(1.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow5.png"), CGSizeMake(19.0, 1.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow6.png"), CGSizeMake(20.0, 18.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow7.png"), CGSizeMake(1.0, 18.0)),
                    objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPWindow/CPWindowShadow8.png"), CGSizeMake(19.0, 18.0))
                ]));
        }
        objj_msgSend(_shadowView, "setBackgroundColor:", _CPWindowShadowColor);
        objj_msgSend(_shadowView, "setAutoresizingMask:", CPViewWidthSizable | CPViewHeightSizable);
        _DOMElement.insertBefore(_shadowView._DOMElement, _windowView._DOMElement);
    }
    else if (!_hasShadow && _shadowView)
    {
        _DOMElement.removeChild(_shadowView._DOMElement);
        _shadowView = nil;
    }
}
}), new objj_method(sel_getUid("setHasShadow:"), function(self, _cmd, shouldHaveShadow)
{ with(self)
{
    if (_hasShadow === shouldHaveShadow)
        return;
    _hasShadow = shouldHaveShadow;
    objj_msgSend(self, "_updateShadow");
}
}), new objj_method(sel_getUid("setShadowStyle:"), function(self, _cmd, aStyle)
{ with(self)
{
    _shadowStyle = aStyle;
    objj_msgSend(objj_msgSend(self, "platformWindow"), "setShadowStyle:", _shadowStyle);
}
}), new objj_method(sel_getUid("setDelegate:"), function(self, _cmd, aDelegate)
{ with(self)
{
    _delegate = aDelegate;
    _delegateRespondsToWindowWillReturnUndoManagerSelector = objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowWillReturnUndoManager:"));
    var defaultCenter = objj_msgSend(CPNotificationCenter, "defaultCenter");
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowDidBecomeMain:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("windowDidBecomeMain:"), CPWindowDidBecomeMainNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowDidResignMain:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("windowDidResignMain:"), CPWindowDidResignMainNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowDidMove:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("windowDidMove:"), CPWindowDidMoveNotification, self);
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowDidResize:")))
        objj_msgSend(defaultCenter, "addObserver:selector:name:object:", _delegate, sel_getUid("windowDidResize:"), CPWindowDidResizeNotification, self);
}
}), new objj_method(sel_getUid("delegate"), function(self, _cmd)
{ with(self)
{
    return _delegate;
}
}), new objj_method(sel_getUid("setWindowController:"), function(self, _cmd, aWindowController)
{ with(self)
{
    _windowController = aWindowController;
}
}), new objj_method(sel_getUid("windowController"), function(self, _cmd)
{ with(self)
{
    return _windowController;
}
}), new objj_method(sel_getUid("doCommandBySelector:"), function(self, _cmd, aSelector)
{ with(self)
{
    if (objj_msgSend(_delegate, "respondsToSelector:", aSelector))
        objj_msgSend(_delegate, "performSelector:", aSelector);
    else
        objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPWindow").super_class }, "doCommandBySelector:", aSelector);
}
}), new objj_method(sel_getUid("acceptsFirstResponder"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("makeFirstResponder:"), function(self, _cmd, aResponder)
{ with(self)
{
    if (_firstResponder == aResponder)
        return YES;
    if(!objj_msgSend(_firstResponder, "resignFirstResponder"))
        return NO;
    if(!aResponder || !objj_msgSend(aResponder, "acceptsFirstResponder") || !objj_msgSend(aResponder, "becomeFirstResponder"))
    {
        _firstResponder = self;
        return NO;
    }
    _firstResponder = aResponder;
    return YES;
}
}), new objj_method(sel_getUid("firstResponder"), function(self, _cmd)
{ with(self)
{
    return _firstResponder;
}
}), new objj_method(sel_getUid("acceptsMouseMovedEvents"), function(self, _cmd)
{ with(self)
{
    return _acceptsMouseMovedEvents;
}
}), new objj_method(sel_getUid("setAcceptsMouseMovedEvents:"), function(self, _cmd, shouldAcceptMouseMovedEvents)
{ with(self)
{
    _acceptsMouseMovedEvents = shouldAcceptMouseMovedEvents;
}
}), new objj_method(sel_getUid("ignoresMouseEvents"), function(self, _cmd)
{ with(self)
{
    return _ignoresMouseEvents;
}
}), new objj_method(sel_getUid("setIgnoresMouseEvents:"), function(self, _cmd, shouldIgnoreMouseEvents)
{ with(self)
{
    _ignoresMouseEvents = shouldIgnoreMouseEvents;
}
}), new objj_method(sel_getUid("title"), function(self, _cmd)
{ with(self)
{
    return _title;
}
}), new objj_method(sel_getUid("setTitle:"), function(self, _cmd, aTitle)
{ with(self)
{
    _title = aTitle;
    objj_msgSend(_windowView, "setTitle:", aTitle);
    objj_msgSend(self, "_synchronizeMenuBarTitleWithWindowTitle");
}
}), new objj_method(sel_getUid("setTitleWithRepresentedFilename:"), function(self, _cmd, aFilePath)
{ with(self)
{
    objj_msgSend(self, "setRepresentedFilename:", aFilePath);
    objj_msgSend(self, "setTitle:", objj_msgSend(aFilePath, "lastPathComponent"));
}
}), new objj_method(sel_getUid("setRepresentedFilename:"), function(self, _cmd, aFilePath)
{ with(self)
{
    objj_msgSend(self, "setRepresentedURL:", aFilePath);
}
}), new objj_method(sel_getUid("representedFilename"), function(self, _cmd)
{ with(self)
{
    return _representedURL;
}
}), new objj_method(sel_getUid("setRepresentedURL:"), function(self, _cmd, aURL)
{ with(self)
{
    _representedURL = aURL;
}
}), new objj_method(sel_getUid("representedURL"), function(self, _cmd)
{ with(self)
{
    return _representedURL;
}
}), new objj_method(sel_getUid("screen"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(objj_msgSend(CPScreen, "alloc"), "init");
}
}), new objj_method(sel_getUid("setMovableByWindowBackground:"), function(self, _cmd, shouldBeMovableByWindowBackground)
{ with(self)
{
    _isMovableByWindowBackground = shouldBeMovableByWindowBackground;
}
}), new objj_method(sel_getUid("isMovableByWindowBackground"), function(self, _cmd)
{ with(self)
{
    return _isMovableByWindowBackground;
}
}), new objj_method(sel_getUid("center"), function(self, _cmd)
{ with(self)
{
    var size = objj_msgSend(self, "frame").size,
        containerSize = objj_msgSend(CPPlatform, "isBrowser") ? objj_msgSend(_platformWindow, "contentBounds").size : objj_msgSend(objj_msgSend(self, "screen"), "visibleFrame").size;
    objj_msgSend(self, "setFrameOrigin:", CGPointMake((containerSize.width - size.width) / 2.0, (containerSize.height - size.height) / 2.0));
}
}), new objj_method(sel_getUid("sendEvent:"), function(self, _cmd, anEvent)
{ with(self)
{
    var type = objj_msgSend(anEvent, "type"),
        point = objj_msgSend(anEvent, "locationInWindow");
    switch (type)
    {
        case CPKeyUp: return objj_msgSend(objj_msgSend(self, "firstResponder"), "keyUp:", anEvent);
        case CPKeyDown: return objj_msgSend(objj_msgSend(self, "firstResponder"), "keyDown:", anEvent);
        case CPScrollWheel: return objj_msgSend(objj_msgSend(_windowView, "hitTest:", point), "scrollWheel:", anEvent);
        case CPLeftMouseUp: if (!_leftMouseDownView)
                                        return objj_msgSend(objj_msgSend(_windowView, "hitTest:", point), "mouseUp:", anEvent);
                                    objj_msgSend(_leftMouseDownView, "mouseUp:", anEvent)
                                    _leftMouseDownView = nil;
                                    return;
        case CPLeftMouseDown: _leftMouseDownView = objj_msgSend(_windowView, "hitTest:", point);
                                    if (_leftMouseDownView != _firstResponder && objj_msgSend(_leftMouseDownView, "acceptsFirstResponder"))
                                        objj_msgSend(self, "makeFirstResponder:", _leftMouseDownView);
                                    objj_msgSend(CPApp, "activateIgnoringOtherApps:", YES);
                                    var theWindow = objj_msgSend(anEvent, "window");
                                    if (objj_msgSend(theWindow, "isKeyWindow") || objj_msgSend(theWindow, "becomesKeyOnlyIfNeeded") && !objj_msgSend(_leftMouseDownView, "needsPanelToBecomeKey"))
                                        return objj_msgSend(_leftMouseDownView, "mouseDown:", anEvent);
                                    else
                                    {
                                        objj_msgSend(self, "makeKeyAndOrderFront:", self);
                                        if (objj_msgSend(_leftMouseDownView, "acceptsFirstMouse:", anEvent))
                                            return objj_msgSend(_leftMouseDownView, "mouseDown:", anEvent)
                                    }
                                    break;
        case CPLeftMouseDragged: if (!_leftMouseDownView)
                                        return objj_msgSend(objj_msgSend(_windowView, "hitTest:", point), "mouseDragged:", anEvent);
                                    return objj_msgSend(_leftMouseDownView, "mouseDragged:", anEvent);
        case CPRightMouseUp: return objj_msgSend(_rightMouseDownView, "mouseUp:", anEvent);
        case CPRightMouseDown: _rightMouseDownView = objj_msgSend(_windowView, "hitTest:", point);
                                    return objj_msgSend(_rightMouseDownView, "mouseDown:", anEvent);
        case CPRightMouseDragged: return objj_msgSend(_rightMouseDownView, "mouseDragged:", anEvent);
        case CPMouseMoved: if (!_acceptsMouseMovedEvents)
                                        return;
                                    if (!_mouseEnteredStack)
                                        _mouseEnteredStack = [];
                                    var hitTestView = objj_msgSend(_windowView, "hitTest:", point);
                                    if (objj_msgSend(_mouseEnteredStack, "count") && objj_msgSend(_mouseEnteredStack, "lastObject") === hitTestView)
                                        return objj_msgSend(hitTestView, "mouseMoved:", anEvent);
                                    var view = hitTestView,
                                        mouseEnteredStack = [];
                                    while (view)
                                    {
                                        mouseEnteredStack.unshift(view);
                                        view = objj_msgSend(view, "superview");
                                    }
                                    var deviation = MIN(_mouseEnteredStack.length, mouseEnteredStack.length);
                                    while (deviation--)
                                        if (_mouseEnteredStack[deviation] === mouseEnteredStack[deviation])
                                            break;
                                    var index = deviation + 1,
                                        count = _mouseEnteredStack.length;
                                    if (index < count)
                                    {
                                        var event = objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", CPMouseExited, point, objj_msgSend(anEvent, "modifierFlags"), objj_msgSend(anEvent, "timestamp"), _windowNumber, nil, -1, 1, 0);
                                        for (; index < count; ++index)
                                            objj_msgSend(_mouseEnteredStack[index], "mouseExited:", event);
                                    }
                                    index = deviation + 1;
                                    count = mouseEnteredStack.length;
                                    if (index < count)
                                    {
                                        var event = objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", CPMouseEntered, point, objj_msgSend(anEvent, "modifierFlags"), objj_msgSend(anEvent, "timestamp"), _windowNumber, nil, -1, 1, 0);
                                        for (; index < count; ++index)
                                            objj_msgSend(mouseEnteredStack[index], "mouseEntered:", event);
                                    }
                                    _mouseEnteredStack = mouseEnteredStack;
                                    objj_msgSend(hitTestView, "mouseMoved:", anEvent);
    }
}
}), new objj_method(sel_getUid("windowNumber"), function(self, _cmd)
{ with(self)
{
    return _windowNumber;
}
}), new objj_method(sel_getUid("becomeKeyWindow"), function(self, _cmd)
{ with(self)
{
    if (_firstResponder != self && objj_msgSend(_firstResponder, "respondsToSelector:", sel_getUid("becomeKeyWindow")))
        objj_msgSend(_firstResponder, "becomeKeyWindow");
}
}), new objj_method(sel_getUid("canBecomeKeyWindow"), function(self, _cmd)
{ with(self)
{
    return YES;
}
}), new objj_method(sel_getUid("isKeyWindow"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPApp, "keyWindow") == self;
}
}), new objj_method(sel_getUid("makeKeyAndOrderFront:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "orderFront:", self);
    objj_msgSend(self, "makeKeyWindow");
    objj_msgSend(self, "makeMainWindow");
}
}), new objj_method(sel_getUid("makeKeyWindow"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(self, "canBecomeKeyWindow"))
        return;
    objj_msgSend(CPApp._keyWindow, "resignKeyWindow");
    CPApp._keyWindow = self;
    objj_msgSend(self, "becomeKeyWindow");
}
}), new objj_method(sel_getUid("resignKeyWindow"), function(self, _cmd)
{ with(self)
{
    if (_firstResponder != self && objj_msgSend(_firstResponder, "respondsToSelector:", sel_getUid("resignKeyWindow")))
        objj_msgSend(_firstResponder, "resignKeyWindow");
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowDidResignKey:")))
        objj_msgSend(_delegate, "windowDidResignKey:", self);
}
}), new objj_method(sel_getUid("dragImage:at:offset:event:pasteboard:source:slideBack:"), function(self, _cmd, anImage, imageLocation, mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "dragImage:fromWindow:at:offset:event:pasteboard:source:slideBack:", anImage, self, objj_msgSend(self, "convertBaseToGlobal:", imageLocation), mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack);
}
}), new objj_method(sel_getUid("_noteRegisteredDraggedTypes:"), function(self, _cmd, pasteboardTypes)
{ with(self)
{
    if (!pasteboardTypes)
        return;
    if (!_inclusiveRegisteredDraggedTypes)
        _inclusiveRegisteredDraggedTypes = objj_msgSend(CPCountedSet, "set");
    objj_msgSend(_inclusiveRegisteredDraggedTypes, "unionSet:", pasteboardTypes);
}
}), new objj_method(sel_getUid("_noteUnregisteredDraggedTypes:"), function(self, _cmd, pasteboardTypes)
{ with(self)
{
    if (!pasteboardTypes)
        return;
    objj_msgSend(_inclusiveRegisteredDraggedTypes, "minusSet:", pasteboardTypes)
    if (objj_msgSend(_inclusiveRegisteredDraggedTypes, "count") === 0)
        _inclusiveRegisteredDraggedTypes = nil;
}
}), new objj_method(sel_getUid("dragView:at:offset:event:pasteboard:source:slideBack:"), function(self, _cmd, aView, viewLocation, mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "dragView:fromWindow:at:offset:event:pasteboard:source:slideBack:", aView, self, objj_msgSend(self, "convertBaseToGlobal:", viewLocation), mouseOffset, anEvent, aPasteboard, aSourceObject, slideBack);
}
}), new objj_method(sel_getUid("registerForDraggedTypes:"), function(self, _cmd, pasteboardTypes)
{ with(self)
{
    if (!pasteboardTypes)
        return;
    objj_msgSend(self, "_noteUnregisteredDraggedTypes:", _registeredDraggedTypes);
    objj_msgSend(_registeredDraggedTypes, "addObjectsFromArray:", pasteboardTypes)
    objj_msgSend(self, "_noteRegisteredDraggedTypes:", _registeredDraggedTypes);
    _registeredDraggedTypesArray = nil;
}
}), new objj_method(sel_getUid("registeredDraggedTypes"), function(self, _cmd)
{ with(self)
{
    if (!_registeredDraggedTypesArray)
        _registeredDraggedTypesArray = objj_msgSend(_registeredDraggedTypes, "allObjects")
    return _registeredDraggedTypesArray;
}
}), new objj_method(sel_getUid("unregisterDraggedTypes"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_noteUnregisteredDraggedTypes:", _registeredDraggedTypes);
    _registeredDraggedTypes = objj_msgSend(CPSet, "set");
    _registeredDraggedTypesArray = [];
}
}), new objj_method(sel_getUid("setDocumentEdited:"), function(self, _cmd, isDocumentEdited)
{ with(self)
{
    if (_isDocumentEdited == isDocumentEdited)
        return;
    _isDocumentEdited = isDocumentEdited;
    objj_msgSend(CPMenu, "_setMenuBarIconImageAlphaValue:", _isDocumentEdited ? 0.5 : 1.0);
    objj_msgSend(_windowView, "setDocumentEdited:", isDocumentEdited);
}
}), new objj_method(sel_getUid("isDocumentEdited"), function(self, _cmd)
{ with(self)
{
    return _isDocumentEdited;
}
}), new objj_method(sel_getUid("setDocumentSaving:"), function(self, _cmd, isDocumentSaving)
{ with(self)
{
    if (_isDocumentSaving == isDocumentSaving)
        return;
    _isDocumentSaving = isDocumentSaving;
    objj_msgSend(self, "_synchronizeSaveMenuWithDocumentSaving");
    objj_msgSend(_windowView, "windowDidChangeDocumentSaving");
}
}), new objj_method(sel_getUid("isDocumentSaving"), function(self, _cmd)
{ with(self)
{
    return _isDocumentSaving;
}
}), new objj_method(sel_getUid("_synchronizeSaveMenuWithDocumentSaving"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(self, "isMainWindow"))
        return;
    var mainMenu = objj_msgSend(CPApp, "mainMenu"),
        index = objj_msgSend(mainMenu, "indexOfItemWithTitle:", _isDocumentSaving ? "Save" : "Saving...");
    if (index == CPNotFound)
        return;
    var item = objj_msgSend(mainMenu, "itemAtIndex:", index);
    if (_isDocumentSaving)
    {
        CPWindowSaveImage = objj_msgSend(item, "image");
        objj_msgSend(item, "setTitle:", "Saving...");
        objj_msgSend(item, "setImage:", CPWindowSavingImage);
        objj_msgSend(item, "setEnabled:", NO);
    }
    else
    {
        objj_msgSend(item, "setTitle:", "Save");
        objj_msgSend(item, "setImage:", CPWindowSaveImage);
        objj_msgSend(item, "setEnabled:", YES);
    }
}
}), new objj_method(sel_getUid("performMiniaturize:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(self, "miniaturize:", aSender);
}
}), new objj_method(sel_getUid("miniaturize:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowWillMiniaturizeNotification, self);
    objj_msgSend(objj_msgSend(self, "platformWindow"), "miniaturize:", sender);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidMiniaturizeNotification, self);
    _isMiniaturized = YES;
}
}), new objj_method(sel_getUid("deminiaturize:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "platformWindow"), "deminiaturize:", sender);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidDeminiaturizeNotification, self);
    _isMiniaturized = NO;
}
}), new objj_method(sel_getUid("isMiniaturized"), function(self, _cmd)
{ with(self)
{
    return _isMiniaturized;
}
}), new objj_method(sel_getUid("performClose:"), function(self, _cmd, aSender)
{ with(self)
{
    if (!(_styleMask & CPClosableWindowMask))
        return;
    if (objj_msgSend(self, "isFullBridge"))
    {
        var event = objj_msgSend(CPApp, "currentEvent");
        if (objj_msgSend(event, "type") === CPKeyDown && objj_msgSend(event, "characters") === "w" && (objj_msgSend(event, "modifierFlags") & CPPlatformActionKeyMask))
        {
            objj_msgSend(objj_msgSend(self, "platformWindow"), "_propagateCurrentDOMEvent:", YES);
            return;
        }
    }
    if (objj_msgSend(_delegate, "respondsToSelector:", sel_getUid("windowShouldClose:")))
    {
        if (!objj_msgSend(_delegate, "windowShouldClose:", self))
            return;
    }
    else if (objj_msgSend(self, "respondsToSelector:", sel_getUid("windowShouldClose:")) && !objj_msgSend(self, "windowShouldClose:", self))
        return;
    var documents = objj_msgSend(_windowController, "documents");
    if (objj_msgSend(documents, "count"))
    {
        var index = objj_msgSend(documents, "indexOfObject:", objj_msgSend(_windowController, "document"));
        objj_msgSend(documents[index], "shouldCloseWindowController:delegate:shouldCloseSelector:contextInfo:", _windowController, self, sel_getUid("_windowControllerContainingDocument:shouldClose:contextInfo:"), {documents:objj_msgSend(documents, "copy"), visited:0, index:index});
    }
    else
        objj_msgSend(self, "close");
}
}), new objj_method(sel_getUid("_windowControllerContainingDocument:shouldClose:contextInfo:"), function(self, _cmd, document, shouldClose, context)
{ with(self)
{
    if (shouldClose)
    {
        var windowController = objj_msgSend(self, "windowController"),
            documents = context.documents,
            count = objj_msgSend(documents, "count"),
            visited = ++context.visited,
            index = ++context.index % count;
        objj_msgSend(document, "removeWindowController:", windowController);
        if (visited < count)
        {
            objj_msgSend(windowController, "setDocument:", documents[index]);
            objj_msgSend(documents[index], "shouldCloseWindowController:delegate:shouldCloseSelector:contextInfo:", _windowController, self, sel_getUid("_windowControllerContainingDocument:shouldClose:contextInfo:"), context);
        }
        else
            objj_msgSend(self, "close");
    }
}
}), new objj_method(sel_getUid("close"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowWillCloseNotification, self);
    objj_msgSend(self, "orderOut:", nil);
}
}), new objj_method(sel_getUid("isMainWindow"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPApp, "mainWindow") == self;
}
}), new objj_method(sel_getUid("canBecomeMainWindow"), function(self, _cmd)
{ with(self)
{
    if (objj_msgSend(self, "isVisible"))
        return YES;
    return NO;
}
}), new objj_method(sel_getUid("makeMainWindow"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(self, "canBecomeMainWindow"))
        return;
    objj_msgSend(CPApp._mainWindow, "resignMainWindow");
    CPApp._mainWindow = self;
    objj_msgSend(self, "becomeMainWindow");
}
}), new objj_method(sel_getUid("becomeMainWindow"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "_synchronizeMenuBarTitleWithWindowTitle");
    objj_msgSend(self, "_synchronizeSaveMenuWithDocumentSaving");
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidBecomeMainNotification, self);
}
}), new objj_method(sel_getUid("resignMainWindow"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidResignMainNotification, self);
}
}), new objj_method(sel_getUid("toolbar"), function(self, _cmd)
{ with(self)
{
    return _toolbar;
}
}), new objj_method(sel_getUid("setToolbar:"), function(self, _cmd, aToolbar)
{ with(self)
{
    if (_toolbar === aToolbar)
        return;
    objj_msgSend(objj_msgSend(aToolbar, "_window"), "setToolbar:", nil);
    objj_msgSend(_toolbar, "_setWindow:", nil);
    _toolbar = aToolbar;
    objj_msgSend(_toolbar, "_setWindow:", self);
    objj_msgSend(self, "_noteToolbarChanged");
}
}), new objj_method(sel_getUid("toggleToolbarShown:"), function(self, _cmd, aSender)
{ with(self)
{
    var toolbar = objj_msgSend(self, "toolbar");
    objj_msgSend(toolbar, "setVisible:", !objj_msgSend(toolbar, "isVisible"));
}
}), new objj_method(sel_getUid("_noteToolbarChanged"), function(self, _cmd)
{ with(self)
{
    var frame = CGRectMakeCopy(objj_msgSend(self, "frame")),
        newFrame;
    objj_msgSend(_windowView, "noteToolbarChanged");
    if (_isFullPlatformWindow)
        newFrame = objj_msgSend(_platformWindow, "visibleFrame");
    else
    {
        newFrame = CGRectMakeCopy(objj_msgSend(self, "frame"));
        newFrame.origin = frame.origin;
    }
    objj_msgSend(self, "setFrame:", newFrame);
}
}), new objj_method(sel_getUid("_setFrame:delegate:duration:curve:"), function(self, _cmd, aFrame, delegate, duration, curve)
{ with(self)
{
    var animation = objj_msgSend(objj_msgSend(_CPWindowFrameAnimation, "alloc"), "initWithWindow:targetFrame:", self, aFrame);
    objj_msgSend(animation, "setDelegate:", delegate);
    objj_msgSend(animation, "setAnimationCurve:", curve);
    objj_msgSend(animation, "setDuration:", duration);
    objj_msgSend(animation, "startAnimation");
}
}), new objj_method(sel_getUid("_setAttachedSheetFrameOrigin"), function(self, _cmd)
{ with(self)
{
    var attachedSheet = objj_msgSend(self, "attachedSheet");
    var contentRect = objj_msgSend(objj_msgSend(self, "contentView"), "frame"),
        sheetFrame = CGRectMakeCopy(objj_msgSend(attachedSheet, "frame"));
    sheetFrame.origin.y = CGRectGetMinY(_frame) + CGRectGetMinY(contentRect);
    sheetFrame.origin.x = CGRectGetMinX(_frame) + FLOOR((CGRectGetWidth(_frame) - CGRectGetWidth(sheetFrame)) / 2.0);
    objj_msgSend(attachedSheet, "setFrame:display:animate:", sheetFrame, YES, NO);
}
}), new objj_method(sel_getUid("_attachSheet:modalDelegate:didEndSelector:contextInfo:"), function(self, _cmd, aSheet, aModalDelegate, aDidEndSelector, aContextInfo)
{ with(self)
{
    var sheetFrame = objj_msgSend(aSheet, "frame");
    _sheetContext = {"sheet":aSheet, "modalDelegate":aModalDelegate, "endSelector":aDidEndSelector, "contextInfo":aContextInfo, "frame":CGRectMakeCopy(sheetFrame), "returnCode":-1, "opened": NO};
    objj_msgSend(self, "_attachSheetWindow:", aSheet);
}
}), new objj_method(sel_getUid("_attachSheetWindow:"), function(self, _cmd, aSheet)
{ with(self)
{
    var sheetFrame = objj_msgSend(aSheet, "frame"),
        frame = objj_msgSend(self, "frame"),
        sheetContent = objj_msgSend(aSheet, "contentView");
    objj_msgSend(self, "_setUpMasksForView:", sheetContent);
    aSheet._isSheet = YES;
    aSheet._parentView = self;
    var originx = frame.origin.x + FLOOR((frame.size.width - sheetFrame.size.width)/2),
        originy = frame.origin.y + objj_msgSend(objj_msgSend(self, "contentView"), "frame").origin.y,
        startFrame = CGRectMake(originx, originy, sheetFrame.size.width, 0),
        endFrame = CGRectMake(originx, originy, sheetFrame.size.width, sheetFrame.size.height);
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowWillBeginSheetNotification, self);
    objj_msgSend(CPApp, "runModalForWindow:", aSheet);
    objj_msgSend(aSheet, "orderFront:", self);
    objj_msgSend(aSheet, "setFrame:display:animate:", startFrame, YES, NO);
    _sheetContext["opened"] = YES;
    objj_msgSend(aSheet, "_setFrame:delegate:duration:curve:", endFrame, self, 0.2, CPAnimationEaseOut);
    objj_msgSend(aSheet, "becomeKeyWindow");
}
}), new objj_method(sel_getUid("_detachSheetWindow"), function(self, _cmd)
{ with(self)
{
    var sheet = objj_msgSend(self, "attachedSheet"),
        startFrame = objj_msgSend(sheet, "frame"),
        endFrame = CGRectMakeCopy(startFrame);
    endFrame.size.height = 0;
    _sheetContext["frame"] = startFrame;
    var sheetContent = objj_msgSend(sheet, "contentView");
    objj_msgSend(self, "_setUpMasksForView:", sheetContent);
    _sheetContext["opened"] = NO;
    objj_msgSend(sheet, "_setFrame:delegate:duration:curve:", endFrame, self, 0.2, CPAnimationEaseIn);
}
}), new objj_method(sel_getUid("animationDidEnd:"), function(self, _cmd, anim)
{ with(self)
{
    var sheet = _sheetContext["sheet"];
    if (anim._window != sheet)
        return;
    var sheetContent = objj_msgSend(sheet, "contentView");
    if (_sheetContext["opened"] === YES)
    {
        objj_msgSend(self, "_restoreMasksForView:", sheetContent);
        return;
    }
    objj_msgSend(CPApp, "stopModal");
    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPWindowDidEndSheetNotification, self);
    objj_msgSend(sheet, "orderOut:", self);
    var lastFrame = _sheetContext["frame"];
    objj_msgSend(sheet, "setFrame:", lastFrame);
    objj_msgSend(self, "_restoreMasksForView:", sheetContent);
    var delegate = _sheetContext["modalDelegate"],
        endSelector = _sheetContext["endSelector"];
    if (delegate != nil && endSelector != nil)
        objj_msgSend(delegate, endSelector, sheet, _sheetContext["returnCode"], _sheetContext["contextInfo"]);
    _sheetContext = nil;
    sheet._parentView = nil;
}
}), new objj_method(sel_getUid("_setUpMasksForView:"), function(self, _cmd, aView)
{ with(self)
{
    var views = objj_msgSend(aView, "subviews");
    objj_msgSend(views, "addObject:", aView);
    for (var i = 0, count = objj_msgSend(views, "count"); i < count; i++)
    {
        var view = objj_msgSend(views, "objectAtIndex:", i),
            mask = objj_msgSend(view, "autoresizingMask"),
            maskToAdd = (mask & CPViewMinYMargin) ? 128 : CPViewMinYMargin;
        objj_msgSend(view, "setAutoresizingMask:", (mask | maskToAdd));
    }
}
}), new objj_method(sel_getUid("_restoreMasksForView:"), function(self, _cmd, aView)
{ with(self)
{
    var views = objj_msgSend(aView, "subviews");
    objj_msgSend(views, "addObject:", aView);
    for (var i = 0, count = objj_msgSend(views, "count"); i < count; i++)
    {
        var view = objj_msgSend(views, "objectAtIndex:", i),
            mask = objj_msgSend(view, "autoresizingMask"),
            maskToRemove = (mask & 128) ? 128 : CPViewMinYMargin;
        objj_msgSend(view, "setAutoresizingMask:", (mask & (~ maskToRemove)));
    }
}
}), new objj_method(sel_getUid("attachedSheet"), function(self, _cmd)
{ with(self)
{
    if (_sheetContext === nil)
        return nil;
   return _sheetContext["sheet"];
}
}), new objj_method(sel_getUid("isSheet"), function(self, _cmd)
{ with(self)
{
    return _isSheet;
}
}), new objj_method(sel_getUid("becomesKeyOnlyIfNeeded"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("worksWhenModal"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("performKeyEquivalent:"), function(self, _cmd, anEvent)
{ with(self)
{
    return objj_msgSend(objj_msgSend(self, "contentView"), "performKeyEquivalent:", anEvent);
}
}), new objj_method(sel_getUid("keyDown:"), function(self, _cmd, anEvent)
{ with(self)
{
    if (!objj_msgSend(anEvent, "_couldBeKeyEquivalent") || !objj_msgSend(self, "performKeyEquivalent:", anEvent))
        objj_msgSend(self, "interpretKeyEvents:", [anEvent]);
}
}), new objj_method(sel_getUid("insertNewline:"), function(self, _cmd, sender)
{ with(self)
{
    if (_defaultButton && _defaultButtonEnabled)
        objj_msgSend(_defaultButton, "performClick:", nil);
}
}), new objj_method(sel_getUid("insertTab:"), function(self, _cmd, sender)
{ with(self)
{
    objj_msgSend(self, "selectNextKeyView:", nil);
}
}), new objj_method(sel_getUid("_dirtyKeyViewLoop"), function(self, _cmd)
{ with(self)
{
    if (_autorecalculatesKeyViewLoop)
        _keyViewLoopIsDirty = YES;
}
}), new objj_method(sel_getUid("_hasKeyViewLoop"), function(self, _cmd)
{ with(self)
{
    var subviews = [];
    objj_msgSend(self, "_appendSubviewsOf:toArray:", _contentView, subviews);
    for (var i = 0, count = objj_msgSend(subviews, "count"); i<count; i++)
    {
        if (subviews[i]._nextKeyView)
            return YES;
    }
    return NO;
}
}), new objj_method(sel_getUid("recalculateKeyViewLoop"), function(self, _cmd)
{ with(self)
{
    var subviews = [];
    objj_msgSend(self, "_appendSubviewsOf:toArray:", _contentView, subviews);
    var keyViewOrder = objj_msgSend(subviews, "sortedArrayUsingFunction:context:", keyViewComparator, _contentView),
        count = objj_msgSend(keyViewOrder, "count");
    for (var i=0; i<count; i++)
        objj_msgSend(keyViewOrder[i], "setNextKeyView:", keyViewOrder[(i+1)%count]);
    _keyViewLoopIsDirty = NO;
}
}), new objj_method(sel_getUid("_appendSubviewsOf:toArray:"), function(self, _cmd, aView, anArray)
{ with(self)
{
    var subviews = objj_msgSend(aView, "subviews"),
        count = objj_msgSend(subviews, "count");
    while (count--)
        objj_msgSend(self, "_appendSubviewsOf:toArray:", subviews[count], anArray);
    objj_msgSend(anArray, "addObject:", aView);
}
}), new objj_method(sel_getUid("setAutorecalculatesKeyViewLoop:"), function(self, _cmd, shouldRecalculate)
{ with(self)
{
    if (_autorecalculatesKeyViewLoop === shouldRecalculate)
        return;
    _autorecalculatesKeyViewLoop = shouldRecalculate;
    if (_keyViewLoopIsDirty)
        objj_msgSend(self, "recalculateKeyViewLoop");
    else if (_autorecalculatesKeyViewLoop)
        objj_msgSend(self, "_dirtyKeyViewLoop");
}
}), new objj_method(sel_getUid("autorecalculatesKeyViewLoop"), function(self, _cmd)
{ with(self)
{
    return _autorecalculatesKeyViewLoop;
}
}), new objj_method(sel_getUid("selectNextKeyView:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(_firstResponder, "isKindOfClass:", objj_msgSend(CPView, "class")))
        objj_msgSend(self, "selectKeyViewFollowingView:", _firstResponder);
}
}), new objj_method(sel_getUid("selectPreviousKeyView:"), function(self, _cmd, sender)
{ with(self)
{
    if (objj_msgSend(_firstResponder, "isKindOfClass:", objj_msgSend(CPView, "class")))
        objj_msgSend(self, "selectKeyViewPrecedingView:", _firstResponder);
}
}), new objj_method(sel_getUid("selectKeyViewFollowingView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_keyViewLoopIsDirty)
        objj_msgSend(self, "recalculateKeyViewLoop");
    objj_msgSend(self, "makeFirstResponder:", objj_msgSend(aView, "nextValidKeyView"));
}
}), new objj_method(sel_getUid("selectKeyViewPrecedingView:"), function(self, _cmd, aView)
{ with(self)
{
    if (_keyViewLoopIsDirty)
        objj_msgSend(self, "recalculateKeyViewLoop");
    objj_msgSend(self, "makeFirstResponder:", objj_msgSend(aView, "previousValidKeyView"));
}
}), new objj_method(sel_getUid("setDefaultButtonCell:"), function(self, _cmd, aButton)
{ with(self)
{
    objj_msgSend(self, "setDefaultButton:", aButton);
}
}), new objj_method(sel_getUid("defaultButtonCell"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "defaultButton");
}
}), new objj_method(sel_getUid("setDefaultButton:"), function(self, _cmd, aButton)
{ with(self)
{
    objj_msgSend(_defaultButton, "setDefaultButton:", NO);
    _defaultButton = aButton;
    objj_msgSend(_defaultButton, "setDefaultButton:", YES);
}
}), new objj_method(sel_getUid("defaultButton"), function(self, _cmd)
{ with(self)
{
    return _defaultButton;
}
}), new objj_method(sel_getUid("enableKeyEquivalentForDefaultButton"), function(self, _cmd)
{ with(self)
{
    _defaultButtonEnabled = YES;
}
}), new objj_method(sel_getUid("enableKeyEquivalentForDefaultButtonCell"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "enableKeyEquivalentForDefaultButton");
}
}), new objj_method(sel_getUid("disableKeyEquivalentForDefaultButton"), function(self, _cmd)
{ with(self)
{
    _defaultButtonEnabled = NO;
}
}), new objj_method(sel_getUid("disableKeyEquivalentForDefaultButtonCell"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "disableKeyEquivalentForDefaultButton");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self != objj_msgSend(CPWindow, "class"))
        return;
    var bundle = objj_msgSend(CPBundle, "bundleForClass:", objj_msgSend(CPWindow, "class"));
    CPWindowSavingImage = objj_msgSend(objj_msgSend(CPImage, "alloc"), "initWithContentsOfFile:size:", objj_msgSend(bundle, "pathForResource:", "CPProgressIndicator/CPProgressIndicatorSpinningStyleRegular.gif"), CGSizeMake(16.0, 16.0))
}
}), new objj_method(sel_getUid("_windowViewClassForStyleMask:"), function(self, _cmd, aStyleMask)
{ with(self)
{
    if (aStyleMask & CPHUDBackgroundWindowMask)
        return _CPHUDWindowView;
    else if (aStyleMask === CPBorderlessWindowMask)
        return _CPBorderlessWindowView;
    else if (aStyleMask & CPDocModalWindowMask)
        return _CPDocModalWindowView;
    return _CPStandardWindowView;
}
}), new objj_method(sel_getUid("_windowViewClassForFullPlatformWindowStyleMask:"), function(self, _cmd, aStyleMask)
{ with(self)
{
    return _CPBorderlessBridgeWindowView;
}
}), new objj_method(sel_getUid("frameRectForContentRect:styleMask:"), function(self, _cmd, aContentRect, aStyleMask)
{ with(self)
{
    return objj_msgSend(objj_msgSend(objj_msgSend(self, "class"), "_windowViewClassForStyleMask:", aStyleMask), "frameRectForContentRect:", aContentRect);
}
})]);
}
var keyViewComparator = function(a, b, context)
{
    var viewBounds = objj_msgSend(a, "convertRect:toView:", objj_msgSend(a, "bounds"), nil),
        otherBounds = objj_msgSend(b, "convertRect:toView:", objj_msgSend(b, "bounds"), nil);
    if (CGRectGetMinY(viewBounds) < CGRectGetMinY(otherBounds))
        return -1;
    else if (CGRectGetMinY(viewBounds) == CGRectGetMinY(otherBounds) && CGRectGetMinX(viewBounds) < CGRectGetMinX(otherBounds))
        return -1;
    else if (CGRectGetMinX(viewBounds) == CGRectGetMinX(otherBounds) && CGRectGetMinX(viewBounds) == CGRectGetMinX(otherBounds))
        return 0;
    else
        return 1;
}
{
var the_class = objj_getClass("CPWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("_synchronizeMenuBarTitleWithWindowTitle"), function(self, _cmd)
{ with(self)
{
    if (!objj_msgSend(_windowController, "document") || !objj_msgSend(self, "isMainWindow"))
        return;
    objj_msgSend(CPMenu, "setMenuBarTitle:", _title);
}
})]);
}
{
var the_class = objj_getClass("CPWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("resizeWithOldPlatformWindowSize:"), function(self, _cmd, aSize)
{ with(self)
{
    if (objj_msgSend(self, "isFullPlatformWindow"))
        return objj_msgSend(self, "setFrame:", objj_msgSend(_platformWindow, "visibleFrame"));
    if (_autoresizingMask == CPWindowNotSizable)
        return;
    var frame = objj_msgSend(_platformWindow, "contentBounds"),
        newFrame = CGRectMakeCopy(_frame),
        dX = (CGRectGetWidth(frame) - aSize.width) /
            (((_autoresizingMask & CPWindowMinXMargin) ? 1 : 0) + (_autoresizingMask & CPWindowWidthSizable ? 1 : 0) + (_autoresizingMask & CPWindowMaxXMargin ? 1 : 0)),
        dY = (CGRectGetHeight(frame) - aSize.height) /
            ((_autoresizingMask & CPWindowMinYMargin ? 1 : 0) + (_autoresizingMask & CPWindowHeightSizable ? 1 : 0) + (_autoresizingMask & CPWindowMaxYMargin ? 1 : 0));
    if (_autoresizingMask & CPWindowMinXMargin)
        newFrame.origin.x += dX;
    if (_autoresizingMask & CPWindowWidthSizable)
        newFrame.size.width += dX;
    if (_autoresizingMask & CPWindowMinYMargin)
        newFrame.origin.y += dY;
    if (_autoresizingMask & CPWindowHeightSizable)
        newFrame.size.height += dY;
    objj_msgSend(self, "setFrame:", newFrame);
}
}), new objj_method(sel_getUid("setAutoresizingMask:"), function(self, _cmd, anAutoresizingMask)
{ with(self)
{
    _autoresizingMask = anAutoresizingMask;
}
}), new objj_method(sel_getUid("autoresizingMask"), function(self, _cmd)
{ with(self)
{
    return _autoresizingMask;
}
}), new objj_method(sel_getUid("convertBaseToGlobal:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(CPPlatform, "isBrowser") ? objj_msgSend(self, "convertBaseToPlatformWindow:", aPoint) : objj_msgSend(self, "convertBaseToScreen:", aPoint);
}
}), new objj_method(sel_getUid("convertGlobalToBase:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(CPPlatform, "isBrowser") ? objj_msgSend(self, "convertPlatformWindowToBase:", aPoint) : objj_msgSend(self, "convertScreenToBase:", aPoint);
}
}), new objj_method(sel_getUid("convertBaseToPlatformWindow:"), function(self, _cmd, aPoint)
{ with(self)
{
    if (objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
        return aPoint;
    var origin = objj_msgSend(self, "frame").origin;
    return { x:aPoint.x + origin.x, y:aPoint.y + origin.y };
}
}), new objj_method(sel_getUid("convertPlatformWindowToBase:"), function(self, _cmd, aPoint)
{ with(self)
{
    if (objj_msgSend(self, "_sharesChromeWithPlatformWindow"))
        return aPoint;
    var origin = objj_msgSend(self, "frame").origin;
    return { x:aPoint.x - origin.x, y:aPoint.y - origin.y };
}
}), new objj_method(sel_getUid("convertScreenToBase:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(self, "convertPlatformWindowToBase:", objj_msgSend(_platformWindow, "convertScreenToBase:", aPoint));
}
}), new objj_method(sel_getUid("convertBaseToScreen:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(_platformWindow, "convertBaseToScreen:", objj_msgSend(self, "convertBaseToPlatformWindow:", aPoint));
}
}), new objj_method(sel_getUid("_setSharesChromeWithPlatformWindow:"), function(self, _cmd, shouldShareFrameWithPlatformWindow)
{ with(self)
{
    if (shouldShareFrameWithPlatformWindow && objj_msgSend(CPPlatform, "isBrowser"))
        return;
    _sharesChromeWithPlatformWindow = shouldShareFrameWithPlatformWindow;
    objj_msgSend(self, "_updateShadow");
}
}), new objj_method(sel_getUid("_sharesChromeWithPlatformWindow"), function(self, _cmd)
{ with(self)
{
    return _sharesChromeWithPlatformWindow;
}
}), new objj_method(sel_getUid("undoManager"), function(self, _cmd)
{ with(self)
{
    if (_undoManager)
        return _undoManager;
    var documentUndoManager = objj_msgSend(objj_msgSend(_windowController, "document"), "undoManager");
    if (documentUndoManager)
        return documentUndoManager;
    if (_delegateRespondsToWindowWillReturnUndoManagerSelector)
        return objj_msgSend(_delegate, "windowWillReturnUndoManager:", self);
    if (!_undoManager)
        _undoManager = objj_msgSend(objj_msgSend(CPUndoManager, "alloc"), "init");
    return _undoManager;
}
}), new objj_method(sel_getUid("undo:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "undoManager"), "undo");
}
}), new objj_method(sel_getUid("redo:"), function(self, _cmd, aSender)
{ with(self)
{
    objj_msgSend(objj_msgSend(self, "undoManager"), "redo");
}
}), new objj_method(sel_getUid("containsPoint:"), function(self, _cmd, aPoint)
{ with(self)
{
    return CGRectContainsPoint(_frame, aPoint);
}
})]);
}
{
var the_class = objj_getClass("CPWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("setFullBridge:"), function(self, _cmd, shouldBeFullBridge)
{ with(self)
{
    objj_msgSend(self, "setFullPlatformWindow:", shouldBeFullBridge);
}
}), new objj_method(sel_getUid("isFullBridge"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "isFullPlatformWindow");
}
}), new objj_method(sel_getUid("convertBaseToBridge:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(self, "convertBaseToPlatformWindow:", aPoint);
}
}), new objj_method(sel_getUid("convertBridgeToBase:"), function(self, _cmd, aPoint)
{ with(self)
{
    return objj_msgSend(self, "convertPlatformWindowToBase:", aPoint);
}
})]);
}
var interpolate = function(fromValue, toValue, progress)
{
    return fromValue + (toValue - fromValue) * progress;
}
{var the_class = objj_allocateClassPair(CPAnimation, "_CPWindowFrameAnimation"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_window"), new objj_ivar("_startFrame"), new objj_ivar("_targetFrame")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithWindow:targetFrame:"), function(self, _cmd, aWindow, aTargetFrame)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPWindowFrameAnimation").super_class }, "initWithDuration:animationCurve:", 0.2, CPAnimationLinear);
    if (self)
    {
        _window = aWindow;
        _targetFrame = CGRectMakeCopy(aTargetFrame);
        _startFrame = CGRectMakeCopy(objj_msgSend(_window, "frame"));
    }
    return self;
}
}), new objj_method(sel_getUid("startAnimation"), function(self, _cmd)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPWindowFrameAnimation").super_class }, "startAnimation");
    _window._isAnimating = YES;
}
}), new objj_method(sel_getUid("setCurrentProgress:"), function(self, _cmd, aProgress)
{ with(self)
{
    objj_msgSendSuper({ receiver:self, super_class:objj_getClass("_CPWindowFrameAnimation").super_class }, "setCurrentProgress:", aProgress);
    var value = objj_msgSend(self, "currentValue");
    if (value == 1.0)
        _window._isAnimating = NO;
    var newFrame = CGRectMake(interpolate(CGRectGetMinX(_startFrame), CGRectGetMinX(_targetFrame), value),
                              interpolate(CGRectGetMinY(_startFrame), CGRectGetMinY(_targetFrame), value),
                              interpolate(CGRectGetWidth(_startFrame), CGRectGetWidth(_targetFrame), value),
                              interpolate(CGRectGetHeight(_startFrame), CGRectGetHeight(_targetFrame), value));
    objj_msgSend(_window, "setFrame:display:animate:", newFrame, YES, NO);
}
})]);
}
_CPWindowFullPlatformWindowSessionMake= function(aWindowView, aContentRect, hasShadow, aLevel)
{
    return { windowView:aWindowView, contentRect:aContentRect, hasShadow:hasShadow, level:aLevel };
}
CPStandardWindowShadowStyle = 0;
CPMenuWindowShadowStyle = 1;
CPPanelWindowShadowStyle = 2;
CPCustomWindowShadowStyle = 3;
objj_executeFile("_CPWindowView.j", true);
objj_executeFile("_CPStandardWindowView.j", true);
objj_executeFile("_CPDocModalWindowView.j", true);
objj_executeFile("_CPHUDWindowView.j", true);
objj_executeFile("_CPBorderlessWindowView.j", true);
objj_executeFile("_CPBorderlessBridgeWindowView.j", true);
objj_executeFile("CPDragServer.j", true);
objj_executeFile("CPView.j", true);

p;12;CPPlatform.jt;4604;@STATIC;1.0;I;21;Foundation/CPObject.jt;4559;objj_executeFile("Foundation/CPObject.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPBasePlatform"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("bootstrap"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(CPPlatformString, "bootstrap");
    objj_msgSend(CPPlatformWindow, "setPrimaryPlatformWindow:", objj_msgSend(objj_msgSend(CPPlatformWindow, "alloc"), "_init"));
}
}), new objj_method(sel_getUid("isBrowser"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("supportsDragAndDrop"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("supportsNativeMainMenu"), function(self, _cmd)
{ with(self)
{
    return NO;
}
}), new objj_method(sel_getUid("terminateApplication"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("activateIgnoringOtherApps:"), function(self, _cmd, shouldIgnoreOtherApps)
{ with(self)
{
}
}), new objj_method(sel_getUid("hideOtherApplications:"), function(self, _cmd, aSender)
{ with(self)
{
}
}), new objj_method(sel_getUid("hide:"), function(self, _cmd, aSender)
{ with(self)
{
}
})]);
}
if (typeof window["CPPlatformEnableHTMLDragAndDrop"] === "undefined")
    CPPlatformEnableHTMLDragAndDrop = NO;
CPPlatformDidClearBodyElementNotification = "CPPlatformDidClearBodyElementNotification";
CPPlatformWillClearBodyElementNotification = "CPPlatformWillClearBodyElementNotification";
var screenNeedsInitialization = NO,
    mainBodyElement = nil,
    elementRemovalTest = new RegExp("\\bcpdontremove\\b", "g");
{var the_class = objj_allocateClassPair(CPBasePlatform, "CPPlatform"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("initialize"), function(self, _cmd)
{ with(self)
{
    if (self !== objj_msgSend(CPPlatform, "class"))
        return;
    screenNeedsInitialization = objj_msgSend(CPPlatform, "isBrowser");
}
}), new objj_method(sel_getUid("isBrowser"), function(self, _cmd)
{ with(self)
{
    return typeof window.cpIsDesktop === "undefined";
}
}), new objj_method(sel_getUid("supportsDragAndDrop"), function(self, _cmd)
{ with(self)
{
    return CPFeatureIsCompatible(CPHTMLDragAndDropFeature) && (CPPlatformEnableHTMLDragAndDrop || !objj_msgSend(self, "isBrowser"));
}
}), new objj_method(sel_getUid("supportsNativeMainMenu"), function(self, _cmd)
{ with(self)
{
    return (typeof window["cpSetMainMenu"] === "function");
}
}), new objj_method(sel_getUid("terminateApplication"), function(self, _cmd)
{ with(self)
{
    if (typeof window["cpTerminate"] === "function")
        window.cpTerminate();
}
}), new objj_method(sel_getUid("activateIgnoringOtherApps:"), function(self, _cmd, shouldIgnoreOtherApps)
{ with(self)
{
    if (typeof window["cpActivateIgnoringOtherApps"] === "function")
        window.cpActivateIgnoringOtherApps(!!shouldIgnoreOtherApps);
}
}), new objj_method(sel_getUid("hideOtherApplications:"), function(self, _cmd, aSender)
{ with(self)
{
    if (typeof window["cpHideOtherApplications"] === "function")
        window.cpHideOtherApplications();
}
}), new objj_method(sel_getUid("hide:"), function(self, _cmd, aSender)
{ with(self)
{
    if (typeof window["cpHide"] === "function")
        window.cpHide();
}
}), new objj_method(sel_getUid("mainBodyElement"), function(self, _cmd)
{ with(self)
{
    if (!mainBodyElement)
        mainBodyElement = document.getElementById("cappuccino-body") || document.body;

    return mainBodyElement;
}
}), new objj_method(sel_getUid("initializeScreenIfNecessary"), function(self, _cmd)
{ with(self)
{
    if (!screenNeedsInitialization)
        return;

    screenNeedsInitialization = NO;

    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPPlatformWillClearBodyElementNotification, self);

    var bodyElement = objj_msgSend(self, "mainBodyElement");


    var children = bodyElement.childNodes,
        length = children.length;

    while (length--)
    {
        var element = children[length];
        if (!element.className || element.className.match(elementRemovalTest) === null)
            bodyElement.removeChild(element);
    }

    bodyElement.style.overflow = "hidden";

    if (document.documentElement)
        document.documentElement.style.overflow = "hidden";

    objj_msgSend(objj_msgSend(CPNotificationCenter, "defaultCenter"), "postNotificationName:object:", CPPlatformDidClearBodyElementNotification, self);
}
})]);
}

p;18;CPPlatformString.jt;3511;@STATIC;1.0;I;21;Foundation/CPObject.jt;3466;objj_executeFile("Foundation/CPObject.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPBasePlatformString"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("bootstrap"), function(self, _cmd)
{ with(self)
{
}
}), new objj_method(sel_getUid("sizeOfString:withFont:forWidth:"), function(self, _cmd, aString, aFont, aWidth)
{ with(self)
{
    return { width:0.0, height:0.0 };
}
})]);
}
var DOMSpanElement = nil,
    DOMIFrameElement = nil,
    DefaultFont = nil;
{var the_class = objj_allocateClassPair(CPBasePlatformString, "CPPlatformString"),
meta_class = the_class.isa;objj_registerClassPair(the_class);
class_addMethods(meta_class, [new objj_method(sel_getUid("bootstrap"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "createDOMElements");
}
}), new objj_method(sel_getUid("createDOMElements"), function(self, _cmd)
{ with(self)
{
    DOMIFrameElement = document.createElement("iframe");
    DOMIFrameElement.name = "iframe_" + FLOOR(RAND() * 10000);
    DOMIFrameElement.style.position = "absolute";
    DOMIFrameElement.style.left = "-100px";
    DOMIFrameElement.style.top = "-100px";
    DOMIFrameElement.style.width = "1px";
    DOMIFrameElement.style.height = "1px";
    DOMIFrameElement.style.borderWidth = "0px";
    DOMIFrameElement.style.overflow = "hidden";
    DOMIFrameElement.style.zIndex = 100000000000;
    DOMIFrameElement.className = "cpdontremove";
    var bodyElement = objj_msgSend(CPPlatform, "mainBodyElement");
    bodyElement.appendChild(DOMIFrameElement);
    var DOMIFrameDocument = (DOMIFrameElement.contentDocument || DOMIFrameElement.contentWindow.document);
    DOMIFrameDocument.write("<html><head></head><body></body></html>");
    DOMIFrameDocument.close();
    var DOMDivElement = DOMIFrameDocument.createElement("div");
    DOMDivElement.style.position = "absolute";
    DOMDivElement.style.width = "100000px";
    DOMIFrameDocument.body.appendChild(DOMDivElement);
    DOMSpanElement = DOMIFrameDocument.createElement("span");
    DOMSpanElement.style.position = "absolute";
    DOMSpanElement.style.whiteSpace = "pre";
    DOMSpanElement.style.visibility = "visible";
    DOMSpanElement.style.padding = "0px";
    DOMSpanElement.style.margin = "0px";
    DOMDivElement.appendChild(DOMSpanElement);
}
}), new objj_method(sel_getUid("sizeOfString:withFont:forWidth:"), function(self, _cmd, aString, aFont, aWidth)
{ with(self)
{
    if (!aFont)
    {
        if (!DefaultFont)
            DefaultFont = objj_msgSend(CPFont, "systemFontOfSize:", 12.0);
        aFont = DefaultFont;
    }
    if (!DOMIFrameElement)
        objj_msgSend(self, "createDOMElements");
    var style = DOMSpanElement.style;
    if (!aWidth)
    {
        style.width = "";
        style.whiteSpace = "pre";
    }
    else
    {
        style.width = ROUND(aWidth) + "px";
        style.wordWrap = "break-word";
        style.whiteSpace = "-o-pre-wrap";
        style.whiteSpace = "-pre-wrap";
        style.whiteSpace = "-moz-pre-wrap";
        style.whiteSpace = "pre-wrap";
    }
    style.font = objj_msgSend(aFont, "cssString");
    if (CPFeatureIsCompatible(CPJavascriptInnerTextFeature))
        DOMSpanElement.innerText = aString;
    else if (CPFeatureIsCompatible(CPJavascriptTextContentFeature))
        DOMSpanElement.textContent = aString;
    return { width:DOMSpanElement.clientWidth, height:DOMSpanElement.clientHeight };
}
})]);
}

p;18;CPPlatformWindow.jt;5954;@STATIC;1.0;I;21;Foundation/CPObject.ji;22;CPPlatformWindow+DOM.jt;5882;objj_executeFile("Foundation/CPObject.j", false);
var PrimaryPlatformWindow = NULL;
{var the_class = objj_allocateClassPair(CPObject, "CPPlatformWindow"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_contentRect"), new objj_ivar("_level"), new objj_ivar("_hasShadow"), new objj_ivar("_shadowStyle"), new objj_ivar("_DOMWindow"), new objj_ivar("_DOMBodyElement"), new objj_ivar("_DOMFocusElement"), new objj_ivar("_windowLevels"), new objj_ivar("_windowLayers"), new objj_ivar("_mouseIsDown"), new objj_ivar("_mouseDownWindow"), new objj_ivar("_lastMouseUp"), new objj_ivar("_lastMouseDown"), new objj_ivar("_charCodes"), new objj_ivar("_keyCode"), new objj_ivar("_lastKey"), new objj_ivar("_capsLockActive"), new objj_ivar("_ignoreNativeCopyOrCutEvent"), new objj_ivar("_ignoreNativePastePreparation"), new objj_ivar("_DOMEventMode"), new objj_ivar("_DOMPasteboardElement"), new objj_ivar("_pasteboardKeyDownEvent"), new objj_ivar("_overriddenEventType")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithContentRect:"), function(self, _cmd, aRect)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPlatformWindow").super_class }, "init");
    if (self)
    {
        _contentRect = { origin: { x:aRect.origin.x, y:aRect.origin.y }, size: { width:aRect.size.width, height:aRect.size.height } };
        _windowLevels = [];
        _windowLayers = objj_msgSend(CPDictionary, "dictionary");
        _charCodes = {};
    }
    return self;
}
}), new objj_method(sel_getUid("init"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "initWithContentRect:", { origin: { x:0.0, y:0.0 }, size: { width:400.0, height:500.0 } });
}
}), new objj_method(sel_getUid("contentRect"), function(self, _cmd)
{ with(self)
{
    return { origin: { x:_contentRect.origin.x, y:_contentRect.origin.y }, size: { width:_contentRect.size.width, height:_contentRect.size.height } };
}
}), new objj_method(sel_getUid("contentBounds"), function(self, _cmd)
{ with(self)
{
    var contentBounds = objj_msgSend(self, "contentRect");
    contentBounds.origin = { x:0.0, y:0.0 };
    return contentBounds;
}
}), new objj_method(sel_getUid("visibleFrame"), function(self, _cmd)
{ with(self)
{
    var frame = objj_msgSend(self, "contentBounds");
    frame.origin = CGPointMakeZero();
    if (objj_msgSend(CPMenu, "menuBarVisible") && objj_msgSend(CPPlatformWindow, "primaryPlatformWindow") === self)
    {
        var menuBarHeight = objj_msgSend(objj_msgSend(CPApp, "mainMenu"), "menuBarHeight");
        frame.origin.y += menuBarHeight;
        frame.size.height -= menuBarHeight;
    }
    return frame;
}
}), new objj_method(sel_getUid("usableContentFrame"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(self, "visibleFrame");
}
}), new objj_method(sel_getUid("setContentRect:"), function(self, _cmd, aRect)
{ with(self)
{
    if (!aRect || ((_contentRect.origin.x == aRect.origin.x && _contentRect.origin.y == aRect.origin.y) && (_contentRect.size.width == aRect.size.width && _contentRect.size.height == aRect.size.height)))
        return;
    _contentRect = { origin: { x:aRect.origin.x, y:aRect.origin.y }, size: { width:aRect.size.width, height:aRect.size.height } };
    objj_msgSend(self, "updateNativeContentRect");
}
}), new objj_method(sel_getUid("updateFromNativeContentRect"), function(self, _cmd)
{ with(self)
{
    objj_msgSend(self, "setContentRect:", objj_msgSend(self, "nativeContentRect"));
}
}), new objj_method(sel_getUid("convertBaseToScreen:"), function(self, _cmd, aPoint)
{ with(self)
{
    var contentRect = objj_msgSend(self, "contentRect");
    return { x:aPoint.x + (contentRect.origin.x), y:aPoint.y + (contentRect.origin.y) };
}
}), new objj_method(sel_getUid("convertScreenToBase:"), function(self, _cmd, aPoint)
{ with(self)
{
    var contentRect = objj_msgSend(self, "contentRect");
    return { x:aPoint.x - (contentRect.origin.x), y:aPoint.y - (contentRect.origin.y) };
}
}), new objj_method(sel_getUid("isVisible"), function(self, _cmd)
{ with(self)
{
    return _DOMWindow !== NULL;
}
}), new objj_method(sel_getUid("deminiaturize:"), function(self, _cmd, sender)
{ with(self)
{
    if (_DOMWindow && typeof _DOMWindow["cpDeminiaturize"] === "function")
        _DOMWindow.cpDeminiaturize();
}
}), new objj_method(sel_getUid("miniaturize:"), function(self, _cmd, sender)
{ with(self)
{
    if (_DOMWindow && typeof _DOMWindow["cpMiniaturize"] === "function")
        _DOMWindow.cpMiniaturize();
}
}), new objj_method(sel_getUid("setLevel:"), function(self, _cmd, aLevel)
{ with(self)
{
    _level = aLevel;
    if (_DOMWindow && _DOMWindow.cpSetLevel)
        _DOMWindow.cpSetLevel(aLevel);
}
}), new objj_method(sel_getUid("setHasShadow:"), function(self, _cmd, shouldHaveShadow)
{ with(self)
{
    _hasShadow = shouldHaveShadow;
    if (_DOMWindow && _DOMWindow.cpSetHasShadow)
        _DOMWindow.cpSetHasShadow(shouldHaveShadow);
}
}), new objj_method(sel_getUid("setShadowStyle:"), function(self, _cmd, aStyle)
{ with(self)
{
    _shadowStyle = aStyle;
    if (_DOMWindow && _DOMWindow.cpSetShadowStyle)
        _shadowStyle.cpSetShadowStyle(aStyle);
}
}), new objj_method(sel_getUid("supportsFullPlatformWindows"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPPlatform, "isBrowser");
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("visiblePlatformWindows"), function(self, _cmd)
{ with(self)
{
    return objj_msgSend(CPSet, "set");
}
}), new objj_method(sel_getUid("primaryPlatformWindow"), function(self, _cmd)
{ with(self)
{
    return PrimaryPlatformWindow;
}
}), new objj_method(sel_getUid("setPrimaryPlatformWindow:"), function(self, _cmd, aPlatformWindow)
{ with(self)
{
    PrimaryPlatformWindow = aPlatformWindow;
}
})]);
}
objj_executeFile("CPPlatformWindow+DOM.j", true);

p;18;CPDOMWindowLayer.jt;2817;@STATIC;1.0;I;20;Foundation/CPArray.jI;21;Foundation/CPObject.jt;2747;objj_executeFile("Foundation/CPArray.j", false);
objj_executeFile("Foundation/CPObject.j", false);
{var the_class = objj_allocateClassPair(CPObject, "CPDOMWindowLayer"),
meta_class = the_class.isa;class_addIvars(the_class, [new objj_ivar("_level"), new objj_ivar("_windows"), new objj_ivar("_DOMElement")]);
objj_registerClassPair(the_class);
class_addMethods(the_class, [new objj_method(sel_getUid("initWithLevel:"), function(self, _cmd, aLevel)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPDOMWindowLayer").super_class }, "init");
    if (self)
    {
        _level = aLevel;
        _windows = [];
        _DOMElement = document.createElement("div");
        _DOMElement.style.position = "absolute";
        _DOMElement.style.top = "0px";
        _DOMElement.style.left = "0px";
        _DOMElement.style.width = "1px";
        _DOMElement.style.height = "1px";
    }
    return self;
}
}), new objj_method(sel_getUid("level"), function(self, _cmd)
{ with(self)
{
    return _level;
}
}), new objj_method(sel_getUid("removeWindow:"), function(self, _cmd, aWindow)
{ with(self)
{
    if (!aWindow._isVisible)
        return;
    var index = aWindow._index,
        count = _windows.length - 1;
    _DOMElement.removeChild(aWindow._DOMElement);
    objj_msgSend(_windows, "removeObjectAtIndex:", aWindow._index);
    for (; index < count; ++index)
    {
        _windows[index]._index = index;
        _windows[index]._DOMElement.style.zIndex = index;
    }
    aWindow._isVisible = NO;
}
}), new objj_method(sel_getUid("insertWindow:atIndex:"), function(self, _cmd, aWindow, anIndex)
{ with(self)
{
    var count = objj_msgSend(_windows, "count"),
        zIndex = (anIndex == CPNotFound ? count : anIndex),
        isVisible = aWindow._isVisible;
    if (isVisible)
    {
        zIndex = MIN(zIndex, aWindow._index);
        objj_msgSend(_windows, "removeObjectAtIndex:", aWindow._index);
    }
    else
        ++count;
    if (anIndex == CPNotFound || anIndex >= count)
        objj_msgSend(_windows, "addObject:", aWindow);
    else
        objj_msgSend(_windows, "insertObject:atIndex:", aWindow, anIndex);
    for (; zIndex < count; ++zIndex)
    {
        _windows[zIndex]._index = zIndex;
        _windows[zIndex]._DOMElement.style.zIndex = zIndex;
    }
    if (aWindow._DOMElement.parentNode !== _DOMElement)
    {
        _DOMElement.appendChild(aWindow._DOMElement);
        aWindow._isVisible = YES;
        if (objj_msgSend(aWindow, "isFullBridge"))
            objj_msgSend(aWindow, "setFrame:", objj_msgSend(aWindow._platformWindow, "usableContentFrame"));
    }
}
}), new objj_method(sel_getUid("orderedWindows"), function(self, _cmd)
{ with(self)
{
    return _windows;
}
})]);
}

p;22;CPPlatformWindow+DOM.jt;44849;@STATIC;1.0;I;21;Foundation/CPObject.jI;22;Foundation/CPRunLoop.ji;9;CPEvent.ji;17;CPCompatibility.ji;18;CPDOMWindowLayer.ji;12;CPPlatform.ji;18;CPPlatformWindow.ji;26;CPPlatformWindow+DOMKeys.jt;44647;objj_executeFile("Foundation/CPObject.j", false);
objj_executeFile("Foundation/CPRunLoop.j", false);
objj_executeFile("CPEvent.j", true);
objj_executeFile("CPCompatibility.j", true);
objj_executeFile("CPDOMWindowLayer.j", true);
objj_executeFile("CPPlatform.j", true);
objj_executeFile("CPPlatformWindow.j", true);
objj_executeFile("CPPlatformWindow+DOMKeys.j", true);
var PlatformWindows = objj_msgSend(CPSet, "set");
var CPDOMEventGetClickCount,
    CPDOMEventStop,
    StopDOMEventPropagation;
var KeyCodesToPrevent = {},
    CharacterKeysToPrevent = {},
    MozKeyCodeToKeyCodeMap = {
        61: 187,
        59: 186
    };
KeyCodesToPrevent[CPKeyCodes.A] = YES;
var supportsNativeDragAndDrop = objj_msgSend(CPPlatform, "supportsDragAndDrop");
{
var the_class = objj_getClass("CPPlatformWindow")
if(!the_class) throw new SyntaxError("*** Could not find definition for class \"CPPlatformWindow\"");
var meta_class = the_class.isa;class_addMethods(the_class, [new objj_method(sel_getUid("_init"), function(self, _cmd)
{ with(self)
{
    self = objj_msgSendSuper({ receiver:self, super_class:objj_getClass("CPPlatformWindow").super_class }, "init");
    if (self)
    {
        _DOMWindow = window;
        _contentRect = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
        _windowLevels = [];
        _windowLayers = objj_msgSend(CPDictionary, "dictionary");
        objj_msgSend(self, "registerDOMWindow");
        objj_msgSend(self, "updateFromNativeContentRect");
        _charCodes = {};
    }
    return self;
}
}), new objj_method(sel_getUid("nativeContentRect"), function(self, _cmd)
{ with(self)
{
    if (!_DOMWindow)
        return objj_msgSend(self, "contentRect");
    if (_DOMWindow.cpFrame)
        return _DOMWindow.cpFrame();
    var contentRect = { origin: { x:0.0, y:0.0 }, size: { width:0.0, height:0.0 } };
    if (window.screenTop)
        contentRect.origin = { x:_DOMWindow.screenLeft, y:_DOMWindow.screenTop };
    else if (window.screenX)
        contentRect.origin = { x:_DOMWindow.screenX, y:_DOMWindow.screenY };
    if (_DOMWindow.innerWidth)
        contentRect.size = { width:_DOMWindow.innerWidth, height:_DOMWindow.innerHeight };
    else if (document.documentElement && document.documentElement.clientWidth)
        contentRect.size = { width:_DOMWindow.document.documentElement.clientWidth, height:_DOMWindow.document.documentElement.clientHeight };
    else
        contentRect.size = { width:_DOMWindow.document.body.clientWidth, height:_DOMWindow.document.body.clientHeight };
    return contentRect;
}
}), new objj_method(sel_getUid("updateNativeContentRect"), function(self, _cmd)
{ with(self)
{
    if (!_DOMWindow)
        return;
    if (typeof _DOMWindow["cpSetFrame"] === "function")
        return _DOMWindow.cpSetFrame(objj_msgSend(self, "contentRect"));
    var origin = objj_msgSend(self, "contentRect").origin,
        nativeOrigin = objj_msgSend(self, "nativeContentRect").origin;
    if (origin.x !== nativeOrigin.x || origin.y !== nativeOrigin.y)
    {
        _DOMWindow.moveBy(origin.x - nativeOrigin.x, origin.y - nativeOrigin.y);
    }
    var size = objj_msgSend(self, "contentRect").size,
        nativeSize = objj_msgSend(self, "nativeContentRect").size;
    if (size.width !== nativeSize.width || size.height !== nativeSize.height)
    {
        _DOMWindow.resizeBy(size.width - nativeSize.width, size.height - nativeSize.height);
    }
}
}), new objj_method(sel_getUid("orderBack:"), function(self, _cmd, aSender)
{ with(self)
{
    if (_DOMWindow)
        _DOMWindow.blur();
}
}), new objj_method(sel_getUid("createDOMElements"), function(self, _cmd)
{ with(self)
{
    var theDocument = _DOMWindow.document;
    _DOMFocusElement = theDocument.createElement("input");
    _DOMFocusElement.style.position = "absolute";
    _DOMFocusElement.style.zIndex = "-1000";
    _DOMFocusElement.style.opacity = "0";
    _DOMFocusElement.style.filter = "alpha(opacity=0)";
    _DOMFocusElement.className = "cpdontremove";
    _DOMBodyElement.appendChild(_DOMFocusElement);
    _DOMPasteboardElement = theDocument.createElement("textarea");
    _DOMPasteboardElement.style.position = "absolute";
    _DOMPasteboardElement.style.top = "-10000px";
    _DOMPasteboardElement.style.zIndex = "999";
    _DOMPasteboardElement.className = "cpdontremove";
    _DOMBodyElement.appendChild(_DOMPasteboardElement);
    _DOMPasteboardElement.blur();
}
}), new objj_method(sel_getUid("registerDOMWindow"), function(self, _cmd)
{ with(self)
{
    var theDocument = _DOMWindow.document;
    _DOMBodyElement = theDocument.getElementById("cappuccino-body") || theDocument.body;
    if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        _DOMBodyElement.style["-khtml-user-select"] = "none";
    _DOMBodyElement.webkitTouchCallout = "none";
    objj_msgSend(self, "createDOMElements");
    objj_msgSend(self, "_addLayers");
    var theClass = objj_msgSend(self, "class"),
        dragEventImplementation = class_getMethodImplementation(theClass, sel_getUid("dragEvent:")),
        dragEventCallback = function (anEvent) { dragEventImplementation(self, nil, anEvent); },
        resizeEventSelector = sel_getUid("resizeEvent:"),
        resizeEventImplementation = class_getMethodImplementation(theClass, resizeEventSelector),
        resizeEventCallback = function (anEvent) { resizeEventImplementation(self, nil, anEvent); },
        copyEventSelector = sel_getUid("copyEvent:"),
        copyEventImplementation = class_getMethodImplementation(theClass, copyEventSelector),
        copyEventCallback = function (anEvent) {copyEventImplementation(self, nil, anEvent); },
        pasteEventSelector = sel_getUid("pasteEvent:"),
        pasteEventImplementation = class_getMethodImplementation(theClass, pasteEventSelector),
        pasteEventCallback = function (anEvent) {pasteEventImplementation(self, nil, anEvent); },
        keyEventSelector = sel_getUid("keyEvent:"),
        keyEventImplementation = class_getMethodImplementation(theClass, keyEventSelector),
        keyEventCallback = function (anEvent) { keyEventImplementation(self, nil, anEvent); },
        mouseEventSelector = sel_getUid("mouseEvent:"),
        mouseEventImplementation = class_getMethodImplementation(theClass, mouseEventSelector),
        mouseEventCallback = function (anEvent) { mouseEventImplementation(self, nil, anEvent); },
        scrollEventSelector = sel_getUid("scrollEvent:"),
        scrollEventImplementation = class_getMethodImplementation(theClass, scrollEventSelector),
        scrollEventCallback = function (anEvent) { scrollEventImplementation(self, nil, anEvent); },
        touchEventSelector = sel_getUid("touchEvent:"),
        touchEventImplementation = class_getMethodImplementation(theClass, touchEventSelector),
        touchEventCallback = function (anEvent) { touchEventImplementation(self, nil, anEvent); };
    if (theDocument.addEventListener)
    {
        if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        {
            theDocument.addEventListener("dragstart", dragEventCallback, NO);
            theDocument.addEventListener("drag", dragEventCallback, NO);
            theDocument.addEventListener("dragend", dragEventCallback, NO);
            theDocument.addEventListener("dragover", dragEventCallback, NO);
            theDocument.addEventListener("dragleave", dragEventCallback, NO);
            theDocument.addEventListener("drop", dragEventCallback, NO);
        }
        theDocument.addEventListener("mouseup", mouseEventCallback, NO);
        theDocument.addEventListener("mousedown", mouseEventCallback, NO);
        theDocument.addEventListener("mousemove", mouseEventCallback, NO);
        theDocument.addEventListener("beforecopy", copyEventCallback, NO);
        theDocument.addEventListener("beforecut", copyEventCallback, NO);
        theDocument.addEventListener("beforepaste", pasteEventCallback, NO);
        theDocument.addEventListener("keyup", keyEventCallback, NO);
        theDocument.addEventListener("keydown", keyEventCallback, NO);
        theDocument.addEventListener("keypress", keyEventCallback, NO);
        theDocument.addEventListener("touchstart", touchEventCallback, NO);
        theDocument.addEventListener("touchend", touchEventCallback, NO);
        theDocument.addEventListener("touchmove", touchEventCallback, NO);
        theDocument.addEventListener("touchcancel", touchEventCallback, NO);
        _DOMWindow.addEventListener("DOMMouseScroll", scrollEventCallback, NO);
        _DOMWindow.addEventListener("mousewheel", scrollEventCallback, NO);
        _DOMWindow.addEventListener("resize", resizeEventCallback, NO);
        _DOMWindow.addEventListener("unload", function()
        {
            objj_msgSend(self, "updateFromNativeContentRect");
            objj_msgSend(self, "_removeLayers");
            theDocument.removeEventListener("mouseup", mouseEventCallback, NO);
            theDocument.removeEventListener("mousedown", mouseEventCallback, NO);
            theDocument.removeEventListener("mousemove", mouseEventCallback, NO);
            theDocument.removeEventListener("keyup", keyEventCallback, NO);
            theDocument.removeEventListener("keydown", keyEventCallback, NO);
            theDocument.removeEventListener("keypress", keyEventCallback, NO);
            theDocument.removeEventListener("beforecopy", copyEventCallback, NO);
            theDocument.removeEventListener("beforecut", copyEventCallback, NO);
            theDocument.removeEventListener("beforepaste", pasteEventCallback, NO);
            theDocument.removeEventListener("touchstart", touchEventCallback, NO);
            theDocument.removeEventListener("touchend", touchEventCallback, NO);
            theDocument.removeEventListener("touchmove", touchEventCallback, NO);
            _DOMWindow.removeEventListener("resize", resizeEventCallback, NO);
            _DOMWindow.removeEventListener("DOMMouseScroll", scrollEventCallback, NO);
            _DOMWindow.removeEventListener("mousewheel", scrollEventCallback, NO);
            objj_msgSend(PlatformWindows, "removeObject:", self);
            self._DOMWindow = nil;
        }, NO);
    }
    else
    {
        theDocument.attachEvent("onmouseup", mouseEventCallback);
        theDocument.attachEvent("onmousedown", mouseEventCallback);
        theDocument.attachEvent("onmousemove", mouseEventCallback);
        theDocument.attachEvent("ondblclick", mouseEventCallback);
        theDocument.attachEvent("onkeyup", keyEventCallback);
        theDocument.attachEvent("onkeydown", keyEventCallback);
        theDocument.attachEvent("onkeypress", keyEventCallback);
        _DOMWindow.attachEvent("onresize", resizeEventCallback);
        _DOMWindow.onmousewheel = scrollEventCallback;
        theDocument.onmousewheel = scrollEventCallback;
        _DOMBodyElement.ondrag = function () { return NO; };
        _DOMBodyElement.onselectstart = function () { return _DOMWindow.event.srcElement === _DOMPasteboardElement; };
        _DOMWindow.attachEvent("onbeforeunload", function()
        {
            objj_msgSend(self, "updateFromNativeContentRect");
            objj_msgSend(self, "_removeLayers");
            theDocument.detachEvent("onmouseup", mouseEventCallback);
            theDocument.detachEvent("onmousedown", mouseEventCallback);
            theDocument.detachEvent("onmousemove", mouseEventCallback);
            theDocument.detachEvent("ondblclick", mouseEventCallback);
            theDocument.detachEvent("onkeyup", keyEventCallback);
            theDocument.detachEvent("onkeydown", keyEventCallback);
            theDocument.detachEvent("onkeypress", keyEventCallback);
            _DOMWindow.detachEvent("onresize", resizeEventCallback);
            _DOMWindow.onmousewheel = NULL;
            theDocument.onmousewheel = NULL;
            _DOMBodyElement.ondrag = NULL;
            _DOMBodyElement.onselectstart = NULL;
            objj_msgSend(PlatformWindows, "removeObject:", self);
            self._DOMWindow = nil;
        }, NO);
    }
}
}), new objj_method(sel_getUid("orderFront:"), function(self, _cmd, aSender)
{ with(self)
{
    if (_DOMWindow)
        return _DOMWindow.focus();
    _DOMWindow = window.open("", "_blank", "menubar=no,location=no,resizable=yes,scrollbars=no,status=no,left=" + (_contentRect.origin.x) + ",top=" + (_contentRect.origin.y) + ",width=" + (_contentRect.size.width) + ",height=" + (_contentRect.size.height));
    objj_msgSend(PlatformWindows, "addObject:", self);
    _DOMWindow.document.write("<html><head></head><body style = 'background-color:transparent;'></body></html>");
    _DOMWindow.document.close();
    if (!objj_msgSend(CPPlatform, "isBrowser"))
    {
        _DOMWindow.cpWindowNumber = objj_msgSend(self._only, "windowNumber");
        _DOMWindow.cpSetFrame(_contentRect);
        _DOMWindow.cpSetLevel(_level);
        _DOMWindow.cpSetHasShadow(_hasShadow);
        _DOMWindow.cpSetShadowStyle(_shadowStyle);
    }
    objj_msgSend(self, "registerDOMWindow");
    _DOMBodyElement.style.cursor = objj_msgSend(objj_msgSend(CPCursor, "currentCursor"), "_cssString");
}
}), new objj_method(sel_getUid("orderOut:"), function(self, _cmd, aSender)
{ with(self)
{
    if (!_DOMWindow)
        return;
    _DOMWindow.close();
}
}), new objj_method(sel_getUid("dragEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    var type = aDOMEvent.type,
        dragServer = objj_msgSend(CPDragServer, "sharedDragServer"),
        location = { x:aDOMEvent.clientX, y:aDOMEvent.clientY },
        pasteboard = objj_msgSend(_CPDOMDataTransferPasteboard, "DOMDataTransferPasteboard");
    objj_msgSend(pasteboard, "_setDataTransfer:", aDOMEvent.dataTransfer);
    if (aDOMEvent.type === "dragstart")
    {
        objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
        objj_msgSend(pasteboard, "_setPasteboard:", objj_msgSend(dragServer, "draggingPasteboard"));
        var draggedWindow = objj_msgSend(dragServer, "draggedWindow"),
            draggedWindowFrame = objj_msgSend(draggedWindow, "frame"),
            DOMDragElement = draggedWindow._DOMElement;
        DOMDragElement.style.left = -(draggedWindowFrame.size.width) + "px";
        DOMDragElement.style.top = -(draggedWindowFrame.size.height) + "px";
        _DOMBodyElement.appendChild(DOMDragElement);
        var draggingOffset = objj_msgSend(dragServer, "draggingOffset");
        aDOMEvent.dataTransfer.setDragImage(DOMDragElement, draggingOffset.width, draggingOffset.height);
        aDOMEvent.dataTransfer.effectAllowed = "all";
        objj_msgSend(dragServer, "draggingStartedInPlatformWindow:globalLocation:", self, objj_msgSend(CPPlatform, "isBrowser") ? location : { x:aDOMEvent.screenX, y:aDOMEvent.screenY });
    }
    else if (type === "drag")
    {
        var y = aDOMEvent.screenY;
        if (CPFeatureIsCompatible(CPHTML5DragAndDropSourceYOffBy1))
            y -= 1;
        objj_msgSend(dragServer, "draggingSourceUpdatedWithGlobalLocation:", objj_msgSend(CPPlatform, "isBrowser") ? location : { x:aDOMEvent.screenX, y:y });
    }
    else if (type === "dragover" || type === "dragleave")
    {
        if (aDOMEvent.preventDefault)
            aDOMEvent.preventDefault();
        var dropEffect = "none",
            dragOperation = objj_msgSend(dragServer, "draggingUpdatedInPlatformWindow:location:", self, location);
        if (dragOperation === CPDragOperationMove || dragOperation === CPDragOperationGeneric || dragOperation === CPDragOperationPrivate)
            dropEffect = "move";
        else if (dragOperation === CPDragOperationCopy)
            dropEffect = "copy";
        else if (dragOperation === CPDragOperationLink)
            dropEffect = "link";
        aDOMEvent.dataTransfer.dropEffect = dropEffect;
    }
    else if (type === "dragend")
    {
        var dropEffect = aDOMEvent.dataTransfer.dropEffect;
        if (dropEffect === "move")
            dragOperation = CPDragOperationMove;
        else if (dropEffect === "copy")
            dragOperation = CPDragOperationCopy;
        else if (dropEffect === "link")
            dragOperation = CPDragOperationLink;
        else
            dragOperation = CPDragOperationNone;
        objj_msgSend(dragServer, "draggingEndedInPlatformWindow:globalLocation:operation:", self, objj_msgSend(CPPlatform, "isBrowser") ? location : { x:aDOMEvent.screenX, y:aDOMEvent.screenY }, dragOperation);
    }
    else
    {
        objj_msgSend(dragServer, "performDragOperationInPlatformWindow:", self);
        if (aDOMEvent.preventDefault)
            aDOMEvent.preventDefault();
        if (aDOMEvent.stopPropagation)
            aDOMEvent.stopPropagation();
    }
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("keyEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    var event,
        timestamp = aDOMEvent.timeStamp ? aDOMEvent.timeStamp : new Date(),
        sourceElement = (aDOMEvent.target || aDOMEvent.srcElement),
        windowNumber = objj_msgSend(objj_msgSend(CPApp, "keyWindow"), "windowNumber"),
        modifierFlags = (aDOMEvent.shiftKey ? CPShiftKeyMask : 0) |
                        (aDOMEvent.ctrlKey ? CPControlKeyMask : 0) |
                        (aDOMEvent.altKey ? CPAlternateKeyMask : 0) |
                        (aDOMEvent.metaKey ? CPCommandKeyMask : 0);
    StopDOMEventPropagation = !!(!(modifierFlags & (CPControlKeyMask | CPCommandKeyMask)) ||
                              CharacterKeysToPrevent[String.fromCharCode(aDOMEvent.keyCode || aDOMEvent.charCode).toLowerCase()] ||
                              KeyCodesToPrevent[aDOMEvent.keyCode]);
    var isNativePasteEvent = NO,
        isNativeCopyOrCutEvent = NO,
        overrideCharacters = nil;
    switch (aDOMEvent.type)
    {
        case "keydown":
                            if (aDOMEvent.keyCode.keyCode in MozKeyCodeToKeyCodeMap)
                                _keyCode = MozKeyCodeToKeyCodeMap[aDOMEvent.keyCode];
                            else
                                _keyCode = aDOMEvent.keyCode;
                            var characters = String.fromCharCode(_keyCode).toLowerCase();
                            overrideCharacters = (modifierFlags & CPShiftKeyMask || _capsLockActive) ? characters.toUpperCase() : characters;
                            if (_keyCode === CPKeyCodes.CAPS_LOCK)
                                _capsLockActive = YES;
                            if (modifierFlags & (CPControlKeyMask | CPCommandKeyMask))
                            {
                                var eligibleForCopyPaste = objj_msgSend(self, "_validateCopyCutOrPasteEvent:flags:", aDOMEvent, modifierFlags);
                                if (characters === "v" && eligibleForCopyPaste)
                                {
                                    if (!_ignoreNativePastePreparation)
                                    {
                                        _DOMPasteboardElement.select();
                                        _DOMPasteboardElement.value = "";
                                    }
                                    isNativePasteEvent = YES;
                                }
                                else if ((characters == "c" || characters == "x") && eligibleForCopyPaste)
                                {
                                    isNativeCopyOrCutEvent = YES;
                                    if (_ignoreNativeCopyOrCutEvent)
                                        break;
                                }
                            }
                            else if (CPKeyCodes.firesKeyPressEvent(_keyCode, _lastKey, aDOMEvent.shiftKey, aDOMEvent.ctrlKey, aDOMEvent.altKey))
                            {
                                StopDOMEventPropagation = NO;
                                break;
                            }
                            else
                            {
                            }
        case "keypress":
                            if (aDOMEvent.type === "keypress" && (modifierFlags & (CPControlKeyMask | CPCommandKeyMask)))
                                break;
                            var keyCode = _keyCode,
                                charCode = aDOMEvent.keyCode || aDOMEvent.charCode,
                                isARepeat = (_charCodes[keyCode] != nil);
                            _lastKey = keyCode;
                            _charCodes[keyCode] = charCode;
                            var characters = overrideCharacters || String.fromCharCode(charCode),
                                charactersIgnoringModifiers = characters.toLowerCase();
                            if (!overrideCharacters && (modifierFlags & CPCommandKeyMask) && ((modifierFlags & CPShiftKeyMask) || _capsLockActive))
                                characters = characters.toUpperCase();
                            event = objj_msgSend(CPEvent, "keyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:", CPKeyDown, location, modifierFlags, timestamp, windowNumber, nil, characters, charactersIgnoringModifiers, isARepeat, keyCode);
                            if (isNativePasteEvent)
                            {
                                _pasteboardKeyDownEvent = event;
                                window.setNativeTimeout(function () { objj_msgSend(self, "_checkPasteboardElement") }, 0);
                            }
                            break;
        case "keyup": var keyCode = aDOMEvent.keyCode,
                                charCode = _charCodes[keyCode];
                            _keyCode = -1;
                            _lastKey = -1;
                            _charCodes[keyCode] = nil;
                            _ignoreNativeCopyOrCutEvent = NO;
                            _ignoreNativePastePreparation = NO;
                            if (keyCode === CPKeyCodes.CAPS_LOCK)
                                _capsLockActive = NO;
                            var characters = String.fromCharCode(charCode),
                                charactersIgnoringModifiers = characters.toLowerCase();
                            if (!(modifierFlags & CPShiftKeyMask) && (modifierFlags & CPCommandKeyMask) && !_capsLockActive)
                                characters = charactersIgnoringModifiers;
                            event = objj_msgSend(CPEvent, "keyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:", CPKeyUp, location, modifierFlags,  timestamp, windowNumber, nil, characters, charactersIgnoringModifiers, NO, keyCode);
                            break;
    }
    if (event && !isNativePasteEvent)
    {
        event._DOMEvent = aDOMEvent;
        objj_msgSend(CPApp, "sendEvent:", event);
        if (isNativeCopyOrCutEvent)
        {
            objj_msgSend(self, "_primePasteboardElement");
        }
    }
    if (StopDOMEventPropagation)
        CPDOMEventStop(aDOMEvent, self);
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("copyEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    if (objj_msgSend(self, "_validateCopyCutOrPasteEvent:flags:", aDOMEvent, CPPlatformActionKeyMask) && !_ignoreNativeCopyOrCutEvent)
    {
        var cut = aDOMEvent.type === "beforecut",
            keyCode = cut ? CPKeyCodes.X : CPKeyCodes.C,
            characters = cut ? "x" : "c",
            timestamp = aDOMEvent.timeStamp ? aDOMEvent.timeStamp : new Date(),
            windowNumber = objj_msgSend(objj_msgSend(CPApp, "keyWindow"), "windowNumber"),
            modifierFlags = CPPlatformActionKeyMask;
        event = objj_msgSend(CPEvent, "keyEventWithType:location:modifierFlags:timestamp:windowNumber:context:characters:charactersIgnoringModifiers:isARepeat:keyCode:", CPKeyDown, location, modifierFlags, timestamp, windowNumber, nil, characters, characters, NO, keyCode);
        event._DOMEvent = aDOMEvent;
        objj_msgSend(CPApp, "sendEvent:", event);
        objj_msgSend(self, "_primePasteboardElement");
        _ignoreNativeCopyOrCutEvent = YES;
    }
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("pasteEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    if (objj_msgSend(self, "_validateCopyCutOrPasteEvent:flags:", aDOMEvent, CPPlatformActionKeyMask))
    {
        _DOMPasteboardElement.focus();
        _DOMPasteboardElement.select();
        _DOMPasteboardElement.value = "";
        _ignoreNativePastePreparation = YES;
    }
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("_validateCopyCutOrPasteEvent:flags:"), function(self, _cmd, aDOMEvent, modifierFlags)
{ with(self)
{
    return (
            ((aDOMEvent.target || aDOMEvent.srcElement).nodeName.toUpperCase() !== "INPUT" &&
             (aDOMEvent.target || aDOMEvent.srcElement).nodeName.toUpperCase() !== "TEXTAREA"
            ) || aDOMEvent.target === _DOMPasteboardElement
           ) &&
            (modifierFlags & CPPlatformActionKeyMask);
}
}), new objj_method(sel_getUid("_primePasteboardElement"), function(self, _cmd)
{ with(self)
{
    var pasteboard = objj_msgSend(CPPasteboard, "generalPasteboard"),
        types = objj_msgSend(pasteboard, "types");
    if (types.length)
    {
        if (objj_msgSend(types, "indexOfObjectIdenticalTo:", CPStringPboardType) != CPNotFound)
            _DOMPasteboardElement.value = objj_msgSend(pasteboard, "stringForType:", CPStringPboardType);
        else
            _DOMPasteboardElement.value = objj_msgSend(pasteboard, "_generateStateUID");
        _DOMPasteboardElement.focus();
        _DOMPasteboardElement.select();
        window.setNativeTimeout(function() { objj_msgSend(self, "_clearPasteboardElement"); }, 0);
    }
}
}), new objj_method(sel_getUid("_checkPasteboardElement"), function(self, _cmd)
{ with(self)
{
    var value = _DOMPasteboardElement.value;
    if (objj_msgSend(value, "length"))
    {
        var pasteboard = objj_msgSend(CPPasteboard, "generalPasteboard");
        if (objj_msgSend(pasteboard, "_stateUID") != value)
        {
            objj_msgSend(pasteboard, "declareTypes:owner:", [CPStringPboardType], self);
            objj_msgSend(pasteboard, "setString:forType:", value, CPStringPboardType);
        }
    }
    objj_msgSend(self, "_clearPasteboardElement");
    objj_msgSend(CPApp, "sendEvent:", _pasteboardKeyDownEvent);
    _pasteboardKeyDownEvent = nil;
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("_clearPasteboardElement"), function(self, _cmd)
{ with(self)
{
    _DOMPasteboardElement.value = "";
    _DOMPasteboardElement.blur();
}
}), new objj_method(sel_getUid("scrollEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    if(!aDOMEvent)
        aDOMEvent = window.event;
    if (CPFeatureIsCompatible(CPJavaScriptMouseWheelValues_8_15))
    {
        var x = 0.0,
            y = 0.0,
            element = aDOMEvent.target;
        while (element.nodeType !== 1)
            element = element.parentNode;
        if (element.offsetParent)
        {
            do
            {
                x += element.offsetLeft;
                y += element.offsetTop;
            } while (element = element.offsetParent);
        }
        var location = { x:(x + ((aDOMEvent.clientX - 8) / 15)), y:(y + ((aDOMEvent.clientY - 8) / 15)) };
    }
    else
        var location = { x:aDOMEvent.clientX, y:aDOMEvent.clientY };
    var deltaX = 0.0,
        deltaY = 0.0,
        windowNumber = 0,
        timestamp = aDOMEvent.timeStamp ? aDOMEvent.timeStamp : new Date(),
        modifierFlags = (aDOMEvent.shiftKey ? CPShiftKeyMask : 0) |
                        (aDOMEvent.ctrlKey ? CPControlKeyMask : 0) |
                        (aDOMEvent.altKey ? CPAlternateKeyMask : 0) |
                        (aDOMEvent.metaKey ? CPCommandKeyMask : 0);
    StopDOMEventPropagation = YES;
    var theWindow = objj_msgSend(self, "hitTest:", location);
    if (!theWindow)
        return;
    var windowNumber = objj_msgSend(theWindow, "windowNumber");
    location = objj_msgSend(theWindow, "convertBridgeToBase:", location);
    if(typeof aDOMEvent.wheelDeltaX != "undefined")
    {
        deltaX = aDOMEvent.wheelDeltaX / 120.0;
        deltaY = aDOMEvent.wheelDeltaY / 120.0;
    }
    else if (aDOMEvent.wheelDelta)
        deltaY = aDOMEvent.wheelDelta / 120.0;
    else if (aDOMEvent.detail)
        deltaY = -aDOMEvent.detail / 3.0;
    else
        return;
    if(!CPFeatureIsCompatible(CPJavaScriptNegativeMouseWheelValues))
    {
        deltaX = -deltaX;
        deltaY = -deltaY;
    }
    var event = objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", CPScrollWheel, location, modifierFlags, timestamp, windowNumber, nil, -1, 1, 0 );
    event._DOMEvent = aDOMEvent;
    event._deltaX = deltaX;
    event._deltaY = deltaY;
    objj_msgSend(CPApp, "sendEvent:", event);
    if (StopDOMEventPropagation)
        CPDOMEventStop(aDOMEvent, self);
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("resizeEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    if (objj_msgSend(CPPlatform, "isBrowser"))
        objj_msgSend(CPApp._activeMenu, "cancelTracking");
    var oldSize = objj_msgSend(self, "contentRect").size;
    objj_msgSend(self, "updateFromNativeContentRect");
    var levels = _windowLevels,
        layers = _windowLayers,
        levelCount = levels.length;
    while (levelCount--)
    {
        var windows = objj_msgSend(layers, "objectForKey:", levels[levelCount])._windows,
            windowCount = windows.length;
        while (windowCount--)
            objj_msgSend(windows[windowCount], "resizeWithOldPlatformWindowSize:", oldSize);
    }
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("touchEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    if (aDOMEvent.touches && (aDOMEvent.touches.length == 1 || (aDOMEvent.touches.length == 0 && aDOMEvent.changedTouches.length == 1)))
    {
        var newEvent = {};
        switch(aDOMEvent.type)
        {
            case CPDOMEventTouchStart: newEvent.type = CPDOMEventMouseDown;
                                        break;
            case CPDOMEventTouchEnd: newEvent.type = CPDOMEventMouseUp;
                                        break;
            case CPDOMEventTouchMove: newEvent.type = CPDOMEventMouseMoved;
                                        break;
            case CPDOMEventTouchCancel: newEvent.type = CPDOMEventMouseUp;
                                        break;
        }
        var touch = aDOMEvent.touches.length ? aDOMEvent.touches[0] : aDOMEvent.changedTouches[0];
        newEvent.clientX = touch.clientX;
        newEvent.clientY = touch.clientY;
        newEvent.timestamp = aDOMEvent.timestamp;
        newEvent.target = aDOMEvent.target;
        newEvent.shiftKey = newEvent.ctrlKey = newEvent.altKey = newEvent.metaKey = false;
        newEvent.preventDefault = function(){if(aDOMEvent.preventDefault) aDOMEvent.preventDefault()};
        newEvent.stopPropagation = function(){if(aDOMEvent.stopPropagation) aDOMEvent.stopPropagation()};
        objj_msgSend(self, "mouseEvent:", newEvent);
        return;
    }
    else
    {
        if (aDOMEvent.preventDefault)
            aDOMEvent.preventDefault();
        if (aDOMEvent.stopPropagation)
            aDOMEvent.stopPropagation();
    }
}
}), new objj_method(sel_getUid("mouseEvent:"), function(self, _cmd, aDOMEvent)
{ with(self)
{
    var type = _overriddenEventType || aDOMEvent.type;
    if (type === "dblclick")
    {
        _overriddenEventType = CPDOMEventMouseDown;
        objj_msgSend(self, "mouseEvent:", aDOMEvent);
        _overriddenEventType = CPDOMEventMouseUp;
        objj_msgSend(self, "mouseEvent:", aDOMEvent);
        _overriddenEventType = nil;
        return;
    }
    var event,
        location = { x:aDOMEvent.clientX, y:aDOMEvent.clientY },
        timestamp = aDOMEvent.timeStamp ? aDOMEvent.timeStamp : new Date(),
        sourceElement = (aDOMEvent.target || aDOMEvent.srcElement),
        windowNumber = 0,
        modifierFlags = (aDOMEvent.shiftKey ? CPShiftKeyMask : 0) |
                        (aDOMEvent.ctrlKey ? CPControlKeyMask : 0) |
                        (aDOMEvent.altKey ? CPAlternateKeyMask : 0) |
                        (aDOMEvent.metaKey ? CPCommandKeyMask : 0);
    StopDOMEventPropagation = YES;
    if (_mouseDownWindow)
        windowNumber = objj_msgSend(_mouseDownWindow, "windowNumber");
    else
    {
        var theWindow = objj_msgSend(self, "hitTest:", location);
        if ((aDOMEvent.type === CPDOMEventMouseDown) && theWindow)
            _mouseDownWindow = theWindow;
        windowNumber = objj_msgSend(theWindow, "windowNumber");
    }
    if (windowNumber)
        location = objj_msgSend(CPApp._windows[windowNumber], "convertPlatformWindowToBase:", location);
    if (type === "mouseup")
    {
        if(_mouseIsDown)
        {
            event = _CPEventFromNativeMouseEvent(aDOMEvent, CPLeftMouseUp, location, modifierFlags, timestamp, windowNumber, nil, -1, CPDOMEventGetClickCount(_lastMouseUp, timestamp, location), 0);
            _mouseIsDown = NO;
            _lastMouseUp = event;
            _mouseDownWindow = nil;
        }
        if(_DOMEventMode)
        {
            _DOMEventMode = NO;
            return;
        }
    }
    else if (type === "mousedown")
    {
        if (sourceElement.tagName === "INPUT" && sourceElement != _DOMFocusElement)
        {
            if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
            {
                _DOMBodyElement.setAttribute("draggable", "false");
                _DOMBodyElement.style["-khtml-user-drag"] = "none";
            }
            _DOMEventMode = YES;
            _mouseIsDown = YES;
            objj_msgSend(CPApp, "sendEvent:", objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", CPLeftMouseDown, location, modifierFlags, timestamp, windowNumber, nil, -1, CPDOMEventGetClickCount(_lastMouseDown, timestamp, location), 0));
            objj_msgSend(CPApp, "sendEvent:", objj_msgSend(CPEvent, "mouseEventWithType:location:modifierFlags:timestamp:windowNumber:context:eventNumber:clickCount:pressure:", CPLeftMouseUp, location, modifierFlags, timestamp, windowNumber, nil, -1, CPDOMEventGetClickCount(_lastMouseDown, timestamp, location), 0));
            return;
        }
        else if (objj_msgSend(CPPlatform, "supportsDragAndDrop"))
        {
            _DOMBodyElement.setAttribute("draggable", "true");
            _DOMBodyElement.style["-khtml-user-drag"] = "element";
        }
        event = _CPEventFromNativeMouseEvent(aDOMEvent, CPLeftMouseDown, location, modifierFlags, timestamp, windowNumber, nil, -1, CPDOMEventGetClickCount(_lastMouseDown, timestamp, location), 0);
        _mouseIsDown = YES;
        _lastMouseDown = event;
    }
    else
    {
        if (_DOMEventMode)
            return;
        event = _CPEventFromNativeMouseEvent(aDOMEvent, _mouseIsDown ? CPLeftMouseDragged : CPMouseMoved, location, modifierFlags, timestamp, windowNumber, nil, -1, 1, 0);
    }
    var isDragging = objj_msgSend(objj_msgSend(CPDragServer, "sharedDragServer"), "isDragging");
    if (event && (!isDragging || !supportsNativeDragAndDrop))
    {
        event._DOMEvent = aDOMEvent;
        objj_msgSend(CPApp, "sendEvent:", event);
    }
    if (StopDOMEventPropagation && (!supportsNativeDragAndDrop || type !== "mousedown" && !isDragging))
        CPDOMEventStop(aDOMEvent, self);
    objj_msgSend(objj_msgSend(CPRunLoop, "currentRunLoop"), "limitDateForMode:", CPDefaultRunLoopMode);
}
}), new objj_method(sel_getUid("layerAtLevel:create:"), function(self, _cmd, aLevel, aFlag)
{ with(self)
{
    var layer = objj_msgSend(_windowLayers, "objectForKey:", aLevel);
    if (!layer && aFlag)
    {
        layer = objj_msgSend(objj_msgSend(CPDOMWindowLayer, "alloc"), "initWithLevel:", aLevel);
        objj_msgSend(_windowLayers, "setObject:forKey:", layer, aLevel);
        var low = 0,
            high = _windowLevels.length - 1,
            middle;
        while (low <= high)
        {
            middle = FLOOR((low + high) / 2);
            if (_windowLevels[middle] > aLevel)
                high = middle - 1;
            else
                low = middle + 1;
        }
        objj_msgSend(_windowLevels, "insertObject:atIndex:", aLevel, _windowLevels[middle] > aLevel ? middle : middle + 1);
        layer._DOMElement.style.zIndex = aLevel;
        _DOMBodyElement.appendChild(layer._DOMElement);
    }
    return layer;
}
}), new objj_method(sel_getUid("order:window:relativeTo:"), function(self, _cmd, aPlace, aWindow, otherWindow)
{ with(self)
{
    objj_msgSend(CPPlatform, "initializeScreenIfNecessary");
    var layer = objj_msgSend(self, "layerAtLevel:create:", objj_msgSend(aWindow, "level"), aPlace != CPWindowOut);
    if (aPlace == CPWindowOut)
        return objj_msgSend(layer, "removeWindow:", aWindow);
    objj_msgSend(layer, "insertWindow:atIndex:", aWindow, (otherWindow ? (aPlace == CPWindowAbove ? otherWindow._index + 1 : otherWindow._index) : CPNotFound));
}
}), new objj_method(sel_getUid("_removeLayers"), function(self, _cmd)
{ with(self)
{
    var levels = _windowLevels,
        layers = _windowLayers,
        levelCount = levels.length;
    while (levelCount--)
    {
        var layer = objj_msgSend(layers, "objectForKey:", levels[levelCount]);
        _DOMBodyElement.removeChild(layer._DOMElement);
    }
}
}), new objj_method(sel_getUid("_addLayers"), function(self, _cmd)
{ with(self)
{
    var levels = _windowLevels,
        layers = _windowLayers,
        levelCount = levels.length;
    while (levelCount--)
    {
        var layer = objj_msgSend(layers, "objectForKey:", levels[levelCount]);
        _DOMBodyElement.appendChild(layer._DOMElement);
    }
}
}), new objj_method(sel_getUid("_dragHitTest:pasteboard:"), function(self, _cmd, aPoint, aPasteboard)
{ with(self)
{
    var levels = _windowLevels,
        layers = _windowLayers,
        levelCount = levels.length;
    while (levelCount--)
    {
        if (levels[levelCount] >= CPDraggingWindowLevel)
            continue;
        var windows = objj_msgSend(layers, "objectForKey:", levels[levelCount])._windows,
            windowCount = windows.length;
        while (windowCount--)
        {
            var theWindow = windows[windowCount];
            if (objj_msgSend(theWindow, "_sharesChromeWithPlatformWindow"))
                return objj_msgSend(theWindow, "_dragHitTest:pasteboard:", aPoint, aPasteboard);
            if (objj_msgSend(theWindow, "containsPoint:", aPoint))
                return objj_msgSend(theWindow, "_dragHitTest:pasteboard:", aPoint, aPasteboard);
        }
    }
    return nil;
}
}), new objj_method(sel_getUid("_propagateCurrentDOMEvent:"), function(self, _cmd, aFlag)
{ with(self)
{
    StopDOMEventPropagation = !aFlag;
}
}), new objj_method(sel_getUid("_willPropagateCurrentDOMEvent"), function(self, _cmd)
{ with(self)
{
    return !StopDOMEventPropagation;
}
}), new objj_method(sel_getUid("hitTest:"), function(self, _cmd, location)
{ with(self)
{
    if (self._only)
        return self._only;
    var levels = _windowLevels,
        layers = _windowLayers,
        levelCount = levels.length,
        theWindow = nil;
    while (levelCount-- && !theWindow)
    {
        var windows = objj_msgSend(layers, "objectForKey:", levels[levelCount])._windows,
            windowCount = windows.length;
        while (windowCount-- && !theWindow)
        {
            var candidateWindow = windows[windowCount];
            if (!candidateWindow._ignoresMouseEvents && objj_msgSend(candidateWindow, "containsPoint:", location))
                theWindow = candidateWindow;
        }
    }
    return theWindow;
}
})]);
class_addMethods(meta_class, [new objj_method(sel_getUid("visiblePlatformWindows"), function(self, _cmd)
{ with(self)
{
    return PlatformWindows;
}
}), new objj_method(sel_getUid("preventCharacterKeysFromPropagating:"), function(self, _cmd, characters)
{ with(self)
{
    for(var i=characters.length; i>0; i--)
        CharacterKeysToPrevent[""+characters[i-1].toLowerCase()] = YES;
}
}), new objj_method(sel_getUid("preventCharacterKeyFromPropagating:"), function(self, _cmd, character)
{ with(self)
{
    CharacterKeysToPrevent[character.toLowerCase()] = YES;
}
}), new objj_method(sel_getUid("clearCharacterKeysToPreventFromPropagating"), function(self, _cmd)
{ with(self)
{
    CharacterKeysToPrevent = {};
}
}), new objj_method(sel_getUid("preventKeyCodesFromPropagating:"), function(self, _cmd, keyCodes)
{ with(self)
{
    for(var i=keyCodes.length; i>0; i--)
        KeyCodesToPrevent[keyCodes[i-1]] = YES;
}
}), new objj_method(sel_getUid("preventKeyCodeFromPropagating:"), function(self, _cmd, keyCode)
{ with(self)
{
    KeyCodesToPrevent[keyCode] = YES;
}
}), new objj_method(sel_getUid("clearKeyCodesToPreventFromPropagating"), function(self, _cmd)
{ with(self)
{
    KeyCodesToPrevent = {};
}
})]);
}
var CPEventClass = objj_msgSend(CPEvent, "class");
var _CPEventFromNativeMouseEvent = function(aNativeEvent, anEventType, aPoint, modifierFlags, aTimestamp, aWindowNumber, aGraphicsContext, anEventNumber, aClickCount, aPressure)
{
    aNativeEvent.isa = CPEventClass;
    aNativeEvent._type = anEventType;
    aNativeEvent._location = aPoint;
    aNativeEvent._modifierFlags = modifierFlags;
    aNativeEvent._timestamp = aTimestamp;
    aNativeEvent._windowNumber = aWindowNumber;
    aNativeEvent._window = nil;
    aNativeEvent._context = aGraphicsContext;
    aNativeEvent._eventNumber = anEventNumber;
    aNativeEvent._clickCount = aClickCount;
    aNativeEvent._pressure = aPressure;
    return aNativeEvent;
}
var CLICK_SPACE_DELTA = 5.0,
    CLICK_TIME_DELTA = (typeof document != "undefined" && document.addEventListener) ? 350.0 : 1000.0;
var CPDOMEventGetClickCount = function(aComparisonEvent, aTimestamp, aLocation)
{
    if (!aComparisonEvent)
        return 1;
    var comparisonLocation = objj_msgSend(aComparisonEvent, "locationInWindow");
    return (aTimestamp - objj_msgSend(aComparisonEvent, "timestamp") < CLICK_TIME_DELTA &&
        ABS(comparisonLocation.x - aLocation.x) < CLICK_SPACE_DELTA &&
        ABS(comparisonLocation.y - aLocation.y) < CLICK_SPACE_DELTA) ? objj_msgSend(aComparisonEvent, "clickCount") + 1 : 1;
}
var CPDOMEventStop = function(aDOMEvent, aPlatformWindow)
{
    aDOMEvent.cancelBubble = true;
    aDOMEvent.returnValue = false;
    if (aDOMEvent.preventDefault)
        aDOMEvent.preventDefault();
    if (aDOMEvent.stopPropagation)
        aDOMEvent.stopPropagation();
    if (aDOMEvent.type === CPDOMEventMouseDown)
    {
        aPlatformWindow._DOMFocusElement.focus();
        aPlatformWindow._DOMFocusElement.blur();
    }
}
CPWindowObjectList= function()
{
    var platformWindow = objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"),
        levels = platformWindow._windowLevels,
        layers = platformWindow._windowLayers,
        levelCount = levels.length,
        windowObjects = [];
    while (levelCount--)
    {
        var windows = objj_msgSend(layers, "objectForKey:", levels[levelCount])._windows,
            windowCount = windows.length;
        while (windowCount--)
            windowObjects.push(windows[windowCount]);
    }
    return windowObjects;
}
CPWindowList= function()
{
    var platformWindow = objj_msgSend(CPPlatformWindow, "primaryPlatformWindow"),
        levels = platformWindow._windowLevels,
        layers = platformWindow._windowLayers,
        levelCount = levels.length,
        windowNumbers = [];
    while (levelCount--)
    {
        var windows = objj_msgSend(layers, "objectForKey:", levels[levelCount])._windows,
            windowCount = windows.length;
        while (windowCount--)
            windowNumbers.push(objj_msgSend(windows[windowCount], "windowNumber"));
    }
    return windowNumbers;
}

p;26;CPPlatformWindow+DOMKeys.jt;3269;@STATIC;1.0;t;3250;CPKeyCodes = {
  BACKSPACE: 8,
  TAB: 9,
  NUM_CENTER: 12,
  ENTER: 13,
  SHIFT: 16,
  CTRL: 17,
  ALT: 18,
  PAUSE: 19,
  CAPS_LOCK: 20,
  ESC: 27,
  SPACE: 32,
  PAGE_UP: 33,
  PAGE_DOWN: 34,
  END: 35,
  HOME: 36,
  LEFT: 37,
  UP: 38,
  RIGHT: 39,
  DOWN: 40,
  PRINT_SCREEN: 44,
  INSERT: 45,
  DELETE: 46,
  ZERO: 48,
  ONE: 49,
  TWO: 50,
  THREE: 51,
  FOUR: 52,
  FIVE: 53,
  SIX: 54,
  SEVEN: 55,
  EIGHT: 56,
  NINE: 57,
  QUESTION_MARK: 63,
  A: 65,
  B: 66,
  C: 67,
  D: 68,
  E: 69,
  F: 70,
  G: 71,
  H: 72,
  I: 73,
  J: 74,
  K: 75,
  L: 76,
  M: 77,
  N: 78,
  O: 79,
  P: 80,
  Q: 81,
  R: 82,
  S: 83,
  T: 84,
  U: 85,
  V: 86,
  W: 87,
  X: 88,
  Y: 89,
  Z: 90,
  META: 91,
  CONTEXT_MENU: 93,
  NUM_ZERO: 96,
  NUM_ONE: 97,
  NUM_TWO: 98,
  NUM_THREE: 99,
  NUM_FOUR: 100,
  NUM_FIVE: 101,
  NUM_SIX: 102,
  NUM_SEVEN: 103,
  NUM_EIGHT: 104,
  NUM_NINE: 105,
  NUM_MULTIPLY: 106,
  NUM_PLUS: 107,
  NUM_MINUS: 109,
  NUM_PERIOD: 110,
  NUM_DIVISION: 111,
  F1: 112,
  F2: 113,
  F3: 114,
  F4: 115,
  F5: 116,
  F6: 117,
  F7: 118,
  F8: 119,
  F9: 120,
  F10: 121,
  F11: 122,
  F12: 123,
  NUMLOCK: 144,
  SEMICOLON: 186,
  DASH: 189,
  EQUALS: 187,
  COMMA: 188,
  PERIOD: 190,
  SLASH: 191,
  APOSTROPHE: 192,
  SINGLE_QUOTE: 222,
  OPEN_SQUARE_BRACKET: 219,
  BACKSLASH: 220,
  CLOSE_SQUARE_BRACKET: 221,
  WIN_KEY: 224,
  MAC_FF_META: 224,
  WIN_IME: 229
};
CPKeyCodes.firesKeyPressEvent = function(keyCode, opt_heldKeyCode, opt_shiftKey, opt_ctrlKey, opt_altKey)
{
    if (!CPFeatureIsCompatible(CPJavascriptRemedialKeySupport))
        return true;
    if (CPBrowserIsOperatingSystem(CPMacOperatingSystem) && opt_altKey)
        return CPKeyCodes.isCharacterKey(keyCode);
    if (opt_altKey && !opt_ctrlKey)
        return false;
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine) && !opt_shiftKey && (opt_ctrlKey || opt_altKey))
        return false;
    if (CPBrowserIsEngine(CPInternetExplorerBrowserEngine) && opt_ctrlKey && opt_heldKeyCode == keyCode)
        return false;
    switch (keyCode)
    {
        case CPKeyCodes.ENTER: return true;
        case CPKeyCodes.ESC: return !CPBrowserIsEngine(CPWebKitBrowserEngine);
    }
    return CPKeyCodes.isCharacterKey(keyCode);
};
CPKeyCodes.isCharacterKey = function(keyCode)
{
    if (keyCode >= CPKeyCodes.ZERO && keyCode <= CPKeyCodes.NINE)
        return true;
    if (keyCode >= CPKeyCodes.NUM_ZERO && keyCode <= CPKeyCodes.NUM_MULTIPLY)
        return true;
    if (keyCode >= CPKeyCodes.A && keyCode <= CPKeyCodes.Z)
        return true;
    switch (keyCode)
    {
        case CPKeyCodes.SPACE:
        case CPKeyCodes.QUESTION_MARK:
        case CPKeyCodes.NUM_PLUS:
        case CPKeyCodes.NUM_MINUS:
        case CPKeyCodes.NUM_PERIOD:
        case CPKeyCodes.NUM_DIVISION:
        case CPKeyCodes.SEMICOLON:
        case CPKeyCodes.DASH:
        case CPKeyCodes.EQUALS:
        case CPKeyCodes.COMMA:
        case CPKeyCodes.PERIOD:
        case CPKeyCodes.SLASH:
        case CPKeyCodes.APOSTROPHE:
        case CPKeyCodes.SINGLE_QUOTE:
        case CPKeyCodes.OPEN_SQUARE_BRACKET:
        case CPKeyCodes.BACKSLASH:
        case CPKeyCodes.CLOSE_SQUARE_BRACKET:
            return true;
        default:
            return false;
    }
}

e;